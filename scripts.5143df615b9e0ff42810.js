!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["global/window","global/document"],t):(e=e||self).videojs=t(e.window,e.document)}(this,function(e,t){e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t;var i="7.6.0";function n(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t,i){return(a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return i&&r(a,i.prototype),a}).apply(null,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e,t){return t=t||e.slice(0),e.raw=t,e}var l=[],u=function t(i){function n(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];r("log",o,t)}var r,a,s,o="info";return a=i,s=n,r=function(t,i,n){var r=s.levels[i],o=new RegExp("^("+r+")$");if("log"!==t&&n.unshift(t.toUpperCase()+":"),n.unshift(a+":"),l&&l.push([].concat(n)),e.console){var u=e.console[t];u||"debug"!==t||(u=e.console.info||e.console.log),u&&r&&o.test(t)&&u[Array.isArray(n)?"apply":"call"](e.console,n)}},n.createLogger=function(e){return t(i+": "+e)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:o},n.level=function(e){if("string"==typeof e){if(!n.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');o=e}return o},(n.history=function(){return l?[].concat(l):[]}).filter=function(e){return(l||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})},n.history.clear=function(){l&&(l.length=0)},n.history.disable=function(){null!==l&&(l.length=0,l=null)},n.history.enable=function(){null===l&&(l=[])},n.error=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("error",o,t)},n.warn=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("warn",o,t)},n.debug=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return r("debug",o,t)},n}("VIDEOJS"),c=u.createLogger,h=function(e){for(var t="",i=0;i<arguments.length;i++)t+=e[i].replace(/\n\r?\s*/g,"")+(arguments[i+1]||"");return t},d=Object.prototype.toString,f=function(e){return g(e)?Object.keys(e):[]};function p(e,t){f(e).forEach(function(i){return t(e[i],i)})}function m(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return Object.assign?Object.assign.apply(Object,[e].concat(i)):(i.forEach(function(t){t&&p(t,function(t,i){e[i]=t})}),e)}function g(e){return!!e&&"object"==typeof e}function v(e){return g(e)&&"[object Object]"===d.call(e)&&e.constructor===Object}function y(t,i){if(!t||!i)return"";if("function"!=typeof e.getComputedStyle)return"";var n=e.getComputedStyle(t);return n?n[i]:""}function b(){var e=o(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);return b=function(){return e},e}function _(e){return"string"==typeof e&&/\S/.test(e)}function T(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function S(){return t===e.document}function k(e){return g(e)&&1===e.nodeType}function w(){try{return e.parent!==e.self}catch(t){return!0}}function C(e){return function(i,n){if(!_(i))return t[e](null);_(n)&&(n=t.querySelector(n));var r=k(n)?n:t;return r[e]&&r[e](i)}}function x(e,i,n,r){void 0===e&&(e="div"),void 0===i&&(i={}),void 0===n&&(n={});var a=t.createElement(e);return Object.getOwnPropertyNames(i).forEach(function(e){var t=i[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(u.warn(h(b(),e,t)),a.setAttribute(e,t)):"textContent"===e?E(a,t):a[e]=t}),Object.getOwnPropertyNames(n).forEach(function(e){a.setAttribute(e,n[e])}),r&&G(a,r),a}function E(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function L(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function A(e,t){return T(t),e.classList?e.classList.contains(t):new RegExp("(^|\\s)"+t+"($|\\s)").test(e.className)}function P(e,t){return e.classList?e.classList.add(t):A(e,t)||(e.className=(e.className+" "+t).trim()),e}function O(e,t){return e.classList?e.classList.remove(t):(T(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function I(e,t,i){var n=A(e,t);if("function"==typeof i&&(i=i(e,t)),"boolean"!=typeof i&&(i=!n),i!==n)return i?P(e,t):O(e,t),e}function M(e,t){Object.getOwnPropertyNames(t).forEach(function(i){var n=t[i];null==n||!1===n?e.removeAttribute(i):e.setAttribute(i,!0===n?"":n)})}function D(e){var t={};if(e&&e.attributes&&0<e.attributes.length)for(var i=e.attributes,n=i.length-1;0<=n;n--){var r=i[n].name,a=i[n].value;"boolean"!=typeof e[r]&&-1===",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")||(a=null!==a),t[r]=a}return t}function U(e,t){return e.getAttribute(t)}function R(e,t,i){e.setAttribute(t,i)}function N(e,t){e.removeAttribute(t)}function B(){t.body.focus(),t.onselectstart=function(){return!1}}function j(){t.onselectstart=function(){return!0}}function F(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),i={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(i[e]=t[e])}),i.height||(i.height=parseFloat(y(e,"height"))),i.width||(i.width=parseFloat(y(e,"width"))),i}}function H(i){var n;if(i.getBoundingClientRect&&i.parentNode&&(n=i.getBoundingClientRect()),!n)return{left:0,top:0};var r=t.documentElement,a=t.body,s=n.top+(e.pageYOffset||a.scrollTop)-(r.clientTop||a.clientTop||0);return{left:Math.round(n.left+(e.pageXOffset||a.scrollLeft)-(r.clientLeft||a.clientLeft||0)),top:Math.round(s)}}function W(e,t){var i={},n=H(e),r=e.offsetWidth,a=e.offsetHeight,s=n.left,o=t.pageY,l=t.pageX;return t.changedTouches&&(l=t.changedTouches[0].pageX,o=t.changedTouches[0].pageY),i.y=Math.max(0,Math.min(1,(n.top-o+a)/a)),i.x=Math.max(0,Math.min(1,(l-s)/r)),i}function z(e){return g(e)&&3===e.nodeType}function q(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function V(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),k(e)||z(e)?e:"string"==typeof e&&/\S/.test(e)?t.createTextNode(e):void 0}).filter(function(e){return e})}function G(e,t){return V(t).forEach(function(t){return e.appendChild(t)}),e}function $(e,t){return G(q(e),t)}function Y(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||0===e.button&&0===e.buttons||0===e.button&&1===e.buttons}var X=C("querySelector"),K=C("querySelectorAll"),Q=Object.freeze({isReal:S,isEl:k,isInFrame:w,createEl:x,textContent:E,prependTo:L,hasClass:A,addClass:P,removeClass:O,toggleClass:I,setAttributes:M,getAttributes:D,getAttribute:U,setAttribute:R,removeAttribute:N,blockTextSelection:B,unblockTextSelection:j,getBoundingClientRect:F,findPosition:H,getPointerPosition:W,isTextNode:z,emptyEl:q,normalizeContent:V,appendContent:G,insertContent:$,isSingleLeftClick:Y,$:X,$$:K}),J=1;function Z(){return J++}var ee={},te="vdata"+Math.floor(e.performance&&e.performance.now()||Date.now());function ie(e){var t=e[te];return t=t||(e[te]=Z()),ee[t]||(ee[t]={}),ee[t]}function ne(e){var t=e[te];return!!t&&!!Object.getOwnPropertyNames(ee[t]).length}function re(e){var t=e[te];if(t){delete ee[t];try{delete e[te]}catch(t){e.removeAttribute?e.removeAttribute(te):e[te]=null}}}function ae(e,t){var i=ie(e);0===i.handlers[t].length&&(delete i.handlers[t],e.removeEventListener?e.removeEventListener(t,i.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,i.dispatcher)),Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled),0===Object.getOwnPropertyNames(i).length&&re(e)}function se(e,t,i,n){i.forEach(function(i){e(t,i,n)})}function oe(i){function n(){return!0}function r(){return!1}if(!i||!i.isPropagationStopped){var a=i||e.event;for(var s in i={},a)"layerX"!==s&&"layerY"!==s&&"keyLocation"!==s&&"webkitMovementX"!==s&&"webkitMovementY"!==s&&("returnValue"===s&&a.preventDefault||(i[s]=a[s]));if(i.target||(i.target=i.srcElement||t),i.relatedTarget||(i.relatedTarget=i.fromElement===i.target?i.toElement:i.fromElement),i.preventDefault=function(){a.preventDefault&&a.preventDefault(),i.returnValue=!1,a.returnValue=!1,i.defaultPrevented=!0},i.defaultPrevented=!1,i.stopPropagation=function(){a.stopPropagation&&a.stopPropagation(),i.cancelBubble=!0,a.cancelBubble=!0,i.isPropagationStopped=n},i.isPropagationStopped=r,i.stopImmediatePropagation=function(){a.stopImmediatePropagation&&a.stopImmediatePropagation(),i.isImmediatePropagationStopped=n,i.stopPropagation()},i.isImmediatePropagationStopped=r,null!=i.clientX){var o=t.documentElement,l=t.body;i.pageX=i.clientX+(o&&o.scrollLeft||l&&l.scrollLeft||0)-(o&&o.clientLeft||l&&l.clientLeft||0),i.pageY=i.clientY+(o&&o.scrollTop||l&&l.scrollTop||0)-(o&&o.clientTop||l&&l.clientTop||0)}i.which=i.charCode||i.keyCode,null!=i.button&&(i.button=1&i.button?0:4&i.button?1:2&i.button?2:0)}return i}var le=!1;!function(){try{var t=Object.defineProperty({},"passive",{get:function(){le=!0}});e.addEventListener("test",null,t),e.removeEventListener("test",null,t)}catch(t){}}();var ue=["touchstart","touchmove"];function ce(e,t,i){if(Array.isArray(t))return se(ce,e,t,i);var n=ie(e);if(n.handlers||(n.handlers={}),n.handlers[t]||(n.handlers[t]=[]),i.guid||(i.guid=Z()),n.handlers[t].push(i),n.dispatcher||(n.disabled=!1,n.dispatcher=function(t,i){if(!n.disabled){t=oe(t);var r=n.handlers[t.type];if(r)for(var a=r.slice(0),s=0,o=a.length;s<o&&!t.isImmediatePropagationStopped();s++)try{a[s].call(e,t,i)}catch(t){u.error(t)}}}),1===n.handlers[t].length)if(e.addEventListener){var r=!1;le&&-1<ue.indexOf(t)&&(r={passive:!0}),e.addEventListener(t,n.dispatcher,r)}else e.attachEvent&&e.attachEvent("on"+t,n.dispatcher)}function he(e,t,i){if(ne(e)){var n=ie(e);if(n.handlers){if(Array.isArray(t))return se(he,e,t,i);function r(e,t){n.handlers[t]=[],ae(e,t)}if(void 0!==t){var a=n.handlers[t];if(a)if(i){if(i.guid)for(var s=0;s<a.length;s++)a[s].guid===i.guid&&a.splice(s--,1);ae(e,t)}else r(e,t)}else for(var o in n.handlers)Object.prototype.hasOwnProperty.call(n.handlers||{},o)&&r(e,o)}}}function de(e,t,i){var n=ne(e)?ie(e):{},r=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=oe(t),n.dispatcher&&n.dispatcher.call(e,t,i),r&&!t.isPropagationStopped()&&!0===t.bubbles)de.call(null,r,t,i);else if(!r&&!t.defaultPrevented&&t.target&&t.target[t.type]){var a=ie(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function fe(e,t,i){if(Array.isArray(t))return se(fe,e,t,i);function n(){he(e,t,n),i.apply(this,arguments)}n.guid=i.guid=i.guid||Z(),ce(e,t,n)}function pe(e,t,i){function n(){he(e,t,n),i.apply(this,arguments)}n.guid=i.guid=i.guid||Z(),ce(e,t,n)}var me,ge,ve=Object.freeze({fixEvent:oe,on:ce,off:he,trigger:de,one:fe,any:pe}),ye=!1,be=function(){if(S()&&!1!==me.options.autoSetup){var e=Array.prototype.slice.call(t.getElementsByTagName("video")),i=Array.prototype.slice.call(t.getElementsByTagName("audio")),n=Array.prototype.slice.call(t.getElementsByTagName("video-js")),r=e.concat(i,n);if(r&&0<r.length)for(var a=0,s=r.length;a<s;a++){var o=r[a];if(!o||!o.getAttribute){_e(1);break}void 0===o.player&&null!==o.getAttribute("data-setup")&&me(o)}else ye||_e(1)}};function _e(t,i){i&&(me=i),e.setTimeout(be,t)}function Te(e){var i=t.createElement("style");return i.className=e,i}function Se(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t}function ke(e,t,i){function n(){return t.apply(e,arguments)}return t.guid||(t.guid=Z()),n.guid=i?i+"_"+t.guid:t.guid,n}function we(t,i){var n=e.performance.now();return function(){var r=e.performance.now();i<=r-n&&(t.apply(void 0,arguments),n=r)}}function Ce(){}function xe(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length}function Ee(e){if(!e.nodeName&&!Ie(e))throw new Error("Invalid target; must be a DOM node or evented object.")}function Le(e){if(!xe(e))throw new Error("Invalid event type; must be a non-empty string or array.")}function Ae(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")}function Pe(e,t){var i,n,r,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return r=a?(i=e.eventBusEl_,3<=t.length&&t.shift(),n=t[0],t[1]):(i=t[0],n=t[1],t[2]),Ee(i),Le(n),Ae(r),{isTargetingSelf:a,target:i,type:n,listener:r=ke(e,r)}}function Oe(e,t,i,n){Ee(e),e.nodeName?ve[t](e,i,n):e[t](i,n)}S()&&"complete"===t.readyState?ye=!0:fe(e,"load",function(){ye=!0}),Ce.prototype.allowedEvents_={},Ce.prototype.addEventListener=Ce.prototype.on=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},ce(this,e,t),this.addEventListener=i},Ce.prototype.removeEventListener=Ce.prototype.off=function(e,t){he(this,e,t)},Ce.prototype.one=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},fe(this,e,t),this.addEventListener=i},Ce.prototype.any=function(e,t){var i=this.addEventListener;this.addEventListener=function(){},pe(this,e,t),this.addEventListener=i},Ce.prototype.dispatchEvent=Ce.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=oe(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),de(this,e)},Ce.prototype.queueTrigger=function(t){var i=this;ge=ge||new Map;var n=t.type||t,r=ge.get(this);r||(r=new Map,ge.set(this,r));var a=r.get(n);r.delete(n),e.clearTimeout(a);var s=e.setTimeout(function(){0===r.size&&(r=null,ge.delete(i)),i.trigger(t)},0);r.set(n,s)};var Ie=function(e){return e instanceof Ce||!!e.eventBusEl_&&["on","one","off","trigger"].every(function(t){return"function"==typeof e[t]})},Me={on:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Pe(this,i),a=r.isTargetingSelf,s=r.target,o=r.type,l=r.listener;if(Oe(s,"on",o,l),!a){function u(){return e.off(s,o,l)}function c(){return e.off("dispose",u)}u.guid=l.guid,c.guid=l.guid,Oe(this,"on","dispose",u),Oe(s,"on","dispose",c)}},one:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Pe(this,i),a=r.target,s=r.type,o=r.listener;if(r.isTargetingSelf)Oe(a,"one",s,o);else{function l(){e.off(a,s,l);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];o.apply(null,i)}l.guid=o.guid,Oe(a,"one",s,l)}},any:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Pe(this,i),a=r.target,s=r.type,o=r.listener;if(r.isTargetingSelf)Oe(a,"any",s,o);else{function l(){e.off(a,s,l);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];o.apply(null,i)}l.guid=o.guid,Oe(a,"any",s,l)}},off:function(e,t,i){if(!e||xe(e))he(this.eventBusEl_,e,t);else{var n=e,r=t;Ee(n),Le(r),Ae(i),i=ke(this,i),this.off("dispose",i),n.nodeName?(he(n,r,i),he(n,"dispose",i)):Ie(n)&&(n.off(r,i),n.off("dispose",i))}},trigger:function(e,t){return de(this.eventBusEl_,e,t)}};function De(t,i){void 0===i&&(i={});var n=i.eventBusKey;if(n){if(!t[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');t.eventBusEl_=t[n]}else t.eventBusEl_=x("span",{className:"vjs-event-bus"});return m(t,Me),t.eventedCallbacks&&t.eventedCallbacks.forEach(function(e){e()}),t.on("dispose",function(){t.off(),e.setTimeout(function(){t.eventBusEl_=null},0)}),t}var Ue={state:{},setState:function(e){var t,i=this;return"function"==typeof e&&(e=e()),p(e,function(e,n){i.state[n]!==e&&((t=t||{})[n]={from:i.state[n],to:e}),i.state[n]=e}),t&&Ie(this)&&this.trigger({changes:t,type:"statechanged"}),t}};function Re(e,t){return m(e,Ue),e.state=m({},e.state,t),"function"==typeof e.handleStateChanged&&Ie(e)&&e.on("statechanged",e.handleStateChanged),e}function Ne(e){return"string"!=typeof e?e:e.charAt(0).toUpperCase()+e.slice(1)}function Be(){for(var e={},t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.forEach(function(t){t&&p(t,function(t,i){v(t)?(v(e[i])||(e[i]={}),e[i]=Be(e[i],t)):e[i]=t})}),e}var je=function(){function t(e,t,i){if(this.player_=!e&&this.play?e=this:e,this.parentComponent_=null,this.options_=Be({},this.options_),t=this.options_=Be(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var n=e&&e.id&&e.id()||"no_player";this.id_=n+"_component_"+Z()}this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&De(this,{eventBusKey:this.el_?"el_":null}),Re(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},!(this.childNameIndex_={})!==t.initChildren&&this.initChildren(),this.ready(i),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var i=t.prototype;return i.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),re(this.el_),this.el_=null),this.player_=null},i.player=function(){return this.player_},i.options=function(e){return e&&(this.options_=Be(this.options_,e)),this.options_},i.el=function(){return this.el_},i.createEl=function(e,t,i){return x(e,t,i)},i.localize=function(e,t,i){void 0===i&&(i=e);var n=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),a=r&&r[n],s=n&&n.split("-")[0],o=r&&r[s],l=i;return a&&a[e]?l=a[e]:o&&o[e]&&(l=o[e]),t&&(l=l.replace(/\{(\d+)\}/g,function(e,i){var n=t[i-1],r=n;return void 0===n&&(r=e),r})),l},i.contentEl=function(){return this.contentEl_||this.el_},i.id=function(){return this.id_},i.name=function(){return this.name_},i.children=function(){return this.children_},i.getChildById=function(e){return this.childIndex_[e]},i.getChild=function(e){if(e)return e=Ne(e),this.childNameIndex_[e]},i.addChild=function(e,i,n){var r,a;if(void 0===i&&(i={}),void 0===n&&(n=this.children_.length),"string"==typeof e){a=Ne(e);var s=i.componentClass||a;i.name=a;var o=t.getComponent(s);if(!o)throw new Error("Component "+s+" does not exist");if("function"!=typeof o)return null;r=new o(this.player_||this,i)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(n,0,r),r.parentComponent_=this,"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(a=a||r.name&&Ne(r.name()))&&(this.childNameIndex_[a]=r),"function"==typeof r.el&&r.el()){var l=this.contentEl().children[n]||null;this.contentEl().insertBefore(r.el(),l)}return r},i.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,i=this.children_.length-1;0<=i;i--)if(this.children_[i]===e){t=!0,this.children_.splice(i,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[e.name()]=null;var n=e.el();n&&n.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},i.initChildren=function(){var e=this,i=this.options_.children;if(i){var n,r=this.options_,a=t.getComponent("Tech");(n=Array.isArray(i)?i:Object.keys(i)).concat(Object.keys(this.options_).filter(function(e){return!n.some(function(t){return"string"==typeof t?e===t:e===t.name})})).map(function(t){var n,r;return r="string"==typeof t?i[n=t]||e.options_[n]||{}:(n=t.name,t),{name:n,opts:r}}).filter(function(e){var i=t.getComponent(e.opts.componentClass||Ne(e.name));return i&&!a.isTech(i)}).forEach(function(t){var i=t.name,n=t.opts;if(void 0!==r[i]&&(n=r[i]),!1!==n){!0===n&&(n={}),n.playerOptions=e.options_.playerOptions;var a=e.addChild(i,n);a&&(e[i]=a)}})}},i.buildCSSClass=function(){return""},i.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},i.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},i.$=function(e,t){return X(e,t||this.contentEl())},i.$$=function(e,t){return K(e,t||this.contentEl())},i.hasClass=function(e){return A(this.el_,e)},i.addClass=function(e){P(this.el_,e)},i.removeClass=function(e){O(this.el_,e)},i.toggleClass=function(e,t){I(this.el_,e,t)},i.show=function(){this.removeClass("vjs-hidden")},i.hide=function(){this.addClass("vjs-hidden")},i.lockShowing=function(){this.addClass("vjs-lock-showing")},i.unlockShowing=function(){this.removeClass("vjs-lock-showing")},i.getAttribute=function(e){return U(this.el_,e)},i.setAttribute=function(e,t){R(this.el_,e,t)},i.removeAttribute=function(e){N(this.el_,e)},i.width=function(e,t){return this.dimension("width",e,t)},i.height=function(e,t){return this.dimension("height",e,t)},i.dimensions=function(e,t){this.width(e,!0),this.height(t)},i.dimension=function(e,t,i){if(void 0!==t)return null!==t&&t==t||(t=0),this.el_.style[e]=-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?t:"auto"===t?"":t+"px",void(i||this.trigger("componentresize"));if(!this.el_)return 0;var n=this.el_.style[e],r=n.indexOf("px");return-1!==r?parseInt(n.slice(0,r),10):parseInt(this.el_["offset"+Ne(e)],10)},i.currentDimension=function(t){var i=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof e.getComputedStyle){var n=e.getComputedStyle(this.el_);i=n.getPropertyValue(t)||n[t]}if(0===(i=parseFloat(i))){var r="offset"+Ne(t);i=this.el_[r]}return i},i.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},i.currentWidth=function(){return this.currentDimension("width")},i.currentHeight=function(){return this.currentDimension("height")},i.focus=function(){this.el_.focus()},i.blur=function(){this.el_.blur()},i.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},i.handleKeyPress=function(e){this.handleKeyDown(e)},i.emitTapEvents=function(){var t,i=0,n=null;function r(){t=!1}this.on("touchstart",function(r){1===r.touches.length&&(n={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},i=e.performance.now(),t=!0)}),this.on("touchmove",function(e){if(1<e.touches.length)t=!1;else if(n){var i=e.touches[0].pageX-n.pageX,r=e.touches[0].pageY-n.pageY;10<Math.sqrt(i*i+r*r)&&(t=!1)}}),this.on("touchleave",r),this.on("touchcancel",r),this.on("touchend",function(r){!(n=null)===t&&e.performance.now()-i<200&&(r.preventDefault(),this.trigger("tap"))})},i.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=ke(this.player(),this.player().reportUserActivity);function i(i){t(),this.clearInterval(e)}this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)}),this.on("touchmove",t),this.on("touchend",i),this.on("touchcancel",i)}},i.setTimeout=function(t,i){var n,r,a=this;return t=ke(this,t),n=e.setTimeout(function(){a.off("dispose",r),t()},i),(r=function(){return a.clearTimeout(n)}).guid="vjs-timeout-"+n,this.on("dispose",r),n},i.clearTimeout=function(t){function i(){}return e.clearTimeout(t),i.guid="vjs-timeout-"+t,this.off("dispose",i),t},i.setInterval=function(t,i){var n=this;function r(){return n.clearInterval(a)}t=ke(this,t);var a=e.setInterval(t,i);return r.guid="vjs-interval-"+a,this.on("dispose",r),a},i.clearInterval=function(t){function i(){}return e.clearInterval(t),i.guid="vjs-interval-"+t,this.off("dispose",i),t},i.requestAnimationFrame=function(t){var i,n,r=this;return this.supportsRaf_?(t=ke(this,t),i=e.requestAnimationFrame(function(){r.off("dispose",n),t()}),(n=function(){return r.cancelAnimationFrame(i)}).guid="vjs-raf-"+i,this.on("dispose",n),i):this.setTimeout(t,1e3/60)},i.cancelAnimationFrame=function(t){if(this.supportsRaf_){function i(){}return e.cancelAnimationFrame(t),i.guid="vjs-raf-"+t,this.off("dispose",i),t}return this.clearTimeout(t)},t.registerComponent=function(e,i){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var n=t.getComponent("Tech"),r=n&&n.isTech(i),a=t===i||t.prototype.isPrototypeOf(i.prototype);if(r||!a)throw new Error('Illegal component, "'+e+'"; '+(r?"techs must be registered using Tech.registerTech()":"must be a Component subclass")+".");e=Ne(e),t.components_||(t.components_={});var s=t.getComponent("Player");if("Player"===e&&s&&s.players){var o=s.players,l=Object.keys(o);if(o&&0<l.length&&l.map(function(e){return o[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=i},t.getComponent=function(e){if(e)return e=Ne(e),t.components_&&t.components_[e]?t.components_[e]:void 0},t}();je.prototype.supportsRaf_="function"==typeof e.requestAnimationFrame&&"function"==typeof e.cancelAnimationFrame,je.registerComponent("Component",je);var Fe,He,We,ze,qe=e.navigator&&e.navigator.userAgent||"",Ve=/AppleWebKit\/([\d.]+)/i.exec(qe),Ge=Ve?parseFloat(Ve.pop()):null,$e=/iPad/i.test(qe),Ye=/iPhone/i.test(qe)&&!$e,Xe=/iPod/i.test(qe),Ke=Ye||$e||Xe,Qe=(Fe=qe.match(/OS (\d+)_/i))&&Fe[1]?Fe[1]:null,Je=/Android/i.test(qe),Ze=function(){var e=qe.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);return t&&i?parseFloat(e[1]+"."+e[2]):t||null}(),et=Je&&Ze<5&&Ge<537,tt=/Firefox/i.test(qe),it=/Edge/i.test(qe),nt=!it&&(/Chrome/i.test(qe)||/CriOS/i.test(qe)),rt=(He=qe.match(/(Chrome|CriOS)\/(\d+)/))&&He[2]?parseFloat(He[2]):null,at=(!(ze=(We=/MSIE\s(\d+)\.\d/.exec(qe))&&parseFloat(We[1]))&&/Trident\/7.0/i.test(qe)&&/rv:11.0/.test(qe)&&(ze=11),ze),st=/Safari/i.test(qe)&&!nt&&!Je&&!it,ot=(st||Ke)&&!nt,lt=/Windows/i.test(qe),ut=S()&&("ontouchstart"in e||e.navigator.maxTouchPoints||e.DocumentTouch&&e.document instanceof e.DocumentTouch),ct=Object.freeze({IS_IPAD:$e,IS_IPHONE:Ye,IS_IPOD:Xe,IS_IOS:Ke,IOS_VERSION:Qe,IS_ANDROID:Je,ANDROID_VERSION:Ze,IS_NATIVE_ANDROID:et,IS_FIREFOX:tt,IS_EDGE:it,IS_CHROME:nt,CHROME_VERSION:rt,IE_VERSION:at,IS_SAFARI:st,IS_ANY_SAFARI:ot,IS_WINDOWS:lt,TOUCH_ENABLED:ut});function ht(e,t,i,n){return function(e,t,i){if("number"!=typeof n||n<0||i<n)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+n+") is non-numeric or out of bounds (0-"+i+").")}(e,0,i.length-1),i[n][t]}function dt(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:ht.bind(null,"start",0,e),end:ht.bind(null,"end",1,e)}}function ft(e,t){return Array.isArray(e)?dt(e):void 0===e||void 0===t?dt():dt([[e,t]])}function pt(e,t){var i,n,r=0;if(!t)return 0;e&&e.length||(e=ft(0,0));for(var a=0;a<e.length;a++)i=e.start(a),t<(n=e.end(a))&&(n=t),r+=n-i;return r/t}for(var mt,gt={prefixed:!0},vt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],yt=vt[0],bt=0;bt<vt.length;bt++)if(vt[bt][1]in t){mt=vt[bt];break}if(mt){for(var _t=0;_t<mt.length;_t++)gt[yt[_t]]=mt[_t];gt.prefixed=mt[0]!==yt[0]}function Tt(e){if(e instanceof Tt)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:g(e)&&("number"==typeof e.code&&(this.code=e.code),m(this,e)),this.message||(this.message=Tt.defaultMessages[this.code]||"")}Tt.prototype.code=0,Tt.prototype.message="",Tt.prototype.status=null,Tt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Tt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var St=0;St<Tt.errorTypes.length;St++)Tt[Tt.errorTypes[St]]=St,Tt.prototype[Tt.errorTypes[St]]=St;function kt(e){return null!=e&&"function"==typeof e.then}function wt(e){kt(e)&&e.then(null,function(e){})}function Ct(e){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,i,n){return e[i]&&(t[i]=e[i]),t},{cues:e.cues&&Array.prototype.map.call(e.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})}function xt(e,t){return e(t={exports:{}},t.exports),t.exports}var Et=xt(function(e,t){function i(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return s[e];var i,a=String(e);return(i=n[a.toLowerCase()])?i:(i=r[a.toLowerCase()])||(1===a.length?a.charCodeAt(0):void 0)}i.isEventKey=function(e,t){if(e&&"object"==typeof e){var i=e.which||e.keyCode||e.charCode;if(null==i)return!1;if("string"==typeof t){var a;if(a=n[t.toLowerCase()])return a===i;if(a=r[t.toLowerCase()])return a===i}else if("number"==typeof t)return t===i;return!1}};var n=(t=e.exports=i).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},r=t.aliases={windows:91,"\u21e7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(a=97;a<123;a++)n[String.fromCharCode(a)]=a-32;for(var a=48;a<58;a++)n[a-48]=a;for(a=1;a<13;a++)n["f"+a]=a+111;for(a=0;a<10;a++)n["numpad "+a]=a+96;var s=t.names=t.title={};for(a in n)s[n[a]]=a;for(var o in r)n[o]=r[o]}),Lt="vjs-modal-dialog",At=function(i){function r(e,t){var n;return(n=i.call(this,e,t)||this).opened_=n.hasBeenOpened_=n.hasBeenFilled_=!1,n.closeable(!n.options_.uncloseable),n.content(n.options_.content),n.contentEl_=x("div",{className:Lt+"-content"},{role:"document"}),n.descEl_=x("p",{className:Lt+"-description vjs-control-text",id:n.el().getAttribute("aria-describedby")}),E(n.descEl_,n.description()),n.el_.appendChild(n.descEl_),n.el_.appendChild(n.contentEl_),n}n(r,i);var a=r.prototype;return a.createEl=function(){return i.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},a.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,i.prototype.dispose.call(this)},a.buildCSSClass=function(){return Lt+" vjs-hidden "+i.prototype.buildCSSClass.call(this)},a.label=function(){return this.localize(this.options_.label||"Modal Window")},a.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},a.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},a.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},a.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},a.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,i=this.getChild("closeButton");if(t&&!i){var n=this.contentEl_;this.contentEl_=this.el_,i=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=n,this.on(i,"close",this.close)}!t&&i&&(this.off(i,"close",this.close),this.removeChild(i),i.dispose())}return this.closeable_},a.fill=function(){this.fillWith(this.content())},a.fillWith=function(e){var t=this.contentEl(),i=t.parentNode,n=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,i.removeChild(t),this.empty(),$(t,e),this.trigger("modalfill"),n?i.insertBefore(t,n):i.appendChild(t);var r=this.getChild("closeButton");r&&i.appendChild(r.el_)},a.empty=function(){this.trigger("beforemodalempty"),q(this.contentEl()),this.trigger("modalempty")},a.content=function(e){return void 0!==e&&(this.content_=e),this.content_},a.conditionalFocus_=function(){var e=t.activeElement,i=this.player_.el_;this.previouslyActiveEl_=null,!i.contains(e)&&i!==e||(this.previouslyActiveEl_=e,this.focus())},a.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},a.handleKeyDown=function(e){if(e.stopPropagation(),Et.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(Et.isEventKey(e,"Tab")){for(var i,n=this.focusableEls_(),r=this.el_.querySelector(":focus"),a=0;a<n.length;a++)if(r===n[a]){i=a;break}t.activeElement===this.el_&&(i=0),e.shiftKey&&0===i?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||i!==n.length-1||(n[0].focus(),e.preventDefault())}},a.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof e.HTMLAnchorElement||t instanceof e.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof e.HTMLInputElement||t instanceof e.HTMLSelectElement||t instanceof e.HTMLTextAreaElement||t instanceof e.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof e.HTMLIFrameElement||t instanceof e.HTMLObjectElement||t instanceof e.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},r}(je);At.prototype.options_={pauseOnOpen:!0,temporary:!0},je.registerComponent("ModalDialog",At);var Pt=function(e){function t(t){var i;void 0===t&&(t=[]),(i=e.call(this)||this).tracks_=[],Object.defineProperty(s(i),"length",{get:function(){return this.tracks_.length}});for(var n=0;n<t.length;n++)i.addTrack(t[n]);return i}n(t,e);var i=t.prototype;return i.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},i.removeTrack=function(e){for(var t,i=0,n=this.length;i<n;i++)if(this[i]===e){(t=this[i]).off&&t.off(),this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},i.getTrackById=function(e){for(var t=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===e){t=r;break}}return t},t}(Ce);for(var Ot in Pt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Pt.prototype.allowedEvents_)Pt.prototype["on"+Ot]=null;function It(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].enabled=!1)}function Mt(e,t){for(var i=0;i<e.length;i++)Object.keys(e[i]).length&&t.id!==e[i].id&&(e[i].selected=!1)}function Dt(i){var n=["protocol","hostname","port","pathname","search","hash","host"],r=t.createElement("a");r.href=i;var a,s=""===r.host&&"file:"!==r.protocol;s&&((a=t.createElement("div")).innerHTML='<a href="'+i+'"></a>',r=a.firstChild,a.setAttribute("style","display:none; position:absolute;"),t.body.appendChild(a));for(var o={},l=0;l<n.length;l++)o[n[l]]=r[n[l]];return"http:"===o.protocol&&(o.host=o.host.replace(/:80$/,"")),"https:"===o.protocol&&(o.host=o.host.replace(/:443$/,"")),o.protocol||(o.protocol=e.location.protocol),s&&t.body.removeChild(a),o}function Ut(e){if(!e.match(/^https?:\/\//)){var i=t.createElement("div");i.innerHTML='<a href="'+e+'">x</a>',e=i.firstChild.href}return e}function Rt(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(e);if(t)return t.pop().toLowerCase()}return""}function Nt(t){var i=e.location,n=Dt(t);return(":"===n.protocol?i.protocol:n.protocol)+n.host!==i.protocol+i.host}var Bt=function(e){function t(t){var i;void 0===t&&(t=[]);for(var n=t.length-1;0<=n;n--)if(t[n].enabled){It(t,t[n]);break}return(i=e.call(this,t)||this).changing_=!1,i}n(t,e);var i=t.prototype;return i.addTrack=function(t){var i=this;t.enabled&&It(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.enabledChange_=function(){i.changing_||(i.changing_=!0,It(i,t),i.changing_=!1,i.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},i.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(Pt),jt=function(e){function t(t){var i;void 0===t&&(t=[]);for(var n=t.length-1;0<=n;n--)if(t[n].selected){Mt(t,t[n]);break}return(i=e.call(this,t)||this).changing_=!1,Object.defineProperty(s(i),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),i}n(t,e);var i=t.prototype;return i.addTrack=function(t){var i=this;t.selected&&Mt(this,t),e.prototype.addTrack.call(this,t),t.addEventListener&&(t.selectedChange_=function(){i.changing_||(i.changing_=!0,Mt(i,t),i.changing_=!1,i.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},i.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(Pt),Ft=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.addTrack=function(t){var i=this;e.prototype.addTrack.call(this,t),this.queueChange_||(this.queueChange_=function(){return i.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return i.trigger("selectedlanguagechange")}),t.addEventListener("modechange",this.queueChange_),-1===["metadata","chapters"].indexOf(t.kind)&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},i.removeTrack=function(t){e.prototype.removeTrack.call(this,t),t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(Pt),Ht=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=e.length;t<i;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,i=0,n=this.trackElements_.length;i<n;i++)if(e===this.trackElements_[i].track){t=this.trackElements_[i];break}return t},t.removeTrackElement_=function(e){for(var t=0,i=this.trackElements_.length;t<i;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),Wt=function(){function e(t){e.prototype.setCues_.call(this,t),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=e.prototype;return t.setCues_=function(e){var t=this.length||0,i=0,n=e.length;function r(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})}if(this.cues_=e,this.length_=e.length,t<n)for(i=t;i<n;i++)r.call(this,i)},t.getCueById=function(e){for(var t=null,i=0,n=this.length;i<n;i++){var r=this[i];if(r.id===e){t=r;break}}return t},e}(),zt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},qt={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Vt={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Gt={disabled:"disabled",hidden:"hidden",showing:"showing"},$t=function(e){function t(t){var i;function n(e){Object.defineProperty(s(i),e,{get:function(){return r[e]},set:function(){}})}void 0===t&&(t={}),i=e.call(this)||this;var r={id:t.id||"vjs_track_"+Z(),kind:t.kind||"",label:t.label||"",language:t.language||""};for(var a in r)n(a);return i}return n(t,e),t}(Ce),Yt=Object.freeze({parseUrl:Dt,getAbsoluteURL:Ut,getFileExtension:Rt,isCrossOrigin:Nt}),Xt=function(e){var t=Kt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},Kt=Object.prototype.toString;function Qt(e){var t=ii.call(e);return"[object Arguments]"===t||"[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Function]"===ii.call(e.callee)}var Jt,Zt=Array.prototype.slice,ei=Object.prototype.toString,ti=Function.prototype.bind||function(e){var t=this;if("function"!=typeof t||"[object Function]"!==ei.call(t))throw new TypeError("Function.prototype.bind called on incompatible "+t);for(var i,n=Zt.call(arguments,1),r=Math.max(0,t.length-n.length),a=[],s=0;s<r;s++)a.push("$"+s);if(i=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof i){var r=t.apply(this,n.concat(Zt.call(arguments)));return Object(r)===r?r:this}return t.apply(e,n.concat(Zt.call(arguments)))}),t.prototype){function o(){}o.prototype=t.prototype,i.prototype=new o,o.prototype=null}return i},ii=Object.prototype.toString;if(!Object.keys){function ni(e){var t=e.constructor;return t&&t.prototype===e}var ri=Object.prototype.hasOwnProperty,ai=Object.prototype.toString,si=Qt,oi=Object.prototype.propertyIsEnumerable,li=!oi.call({toString:null},"toString"),ui=oi.call(function(){},"prototype"),ci=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],hi={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},di=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!hi["$"+e]&&ri.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{ni(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();Jt=function(e){var t=null!==e&&"object"==typeof e,i="[object Function]"===ai.call(e),n=si(e),r=t&&"[object String]"===ai.call(e),a=[];if(!t&&!i&&!n)throw new TypeError("Object.keys called on a non-object");var s=ui&&i;if(r&&0<e.length&&!ri.call(e,0))for(var o=0;o<e.length;++o)a.push(String(o));if(n&&0<e.length)for(var l=0;l<e.length;++l)a.push(String(l));else for(var u in e)s&&"prototype"===u||!ri.call(e,u)||a.push(String(u));if(li)for(var c=function(e){if("undefined"==typeof window||!di)return ni(e);try{return ni(e)}catch(e){return!1}}(e),h=0;h<ci.length;++h)c&&"constructor"===ci[h]||!ri.call(e,ci[h])||a.push(ci[h]);return a}}var fi=Array.prototype.slice,pi=Object.keys,mi=pi?function(e){return pi(e)}:Jt,gi=Object.keys;function vi(e,t,i,n){t in e&&("function"!=typeof n||"[object Function]"!==Ti.call(n)||!n())||(wi?ki(e,t,{configurable:!0,enumerable:!1,value:i,writable:!0}):e[t]=i)}function yi(e,t,i){var n=2<arguments.length?i:{},r=bi(t);_i&&(r=Si.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)vi(e,r[a],t[r[a]],n[r[a]])}mi.shim=function(){return Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return Qt(e)?gi(fi.call(e)):gi(e)}):Object.keys=mi,Object.keys||mi};var bi=mi,_i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),Ti=Object.prototype.toString,Si=Array.prototype.concat,ki=Object.defineProperty,wi=ki&&function(){var e={};try{for(var t in ki(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}();function Ci(e,t){if(1<arguments.length&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var i="$ "+e;if(!(i in ji))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===ji[i]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return ji[i]}function xi(e,t,i,n){var r=zi[t];if("function"!=typeof r)throw new Wi("unknown record type: "+t);if(!r(e,n))throw new Hi(i+" must be a "+t)}function Ei(e){return 0<=e?1:-1}function Li(e){try{var t=$i.call(e);return Yi.test(t)}catch(e){return!1}}function Ai(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(Ki)return function(e){try{return!Li(e)&&($i.call(e),!0)}catch(e){return!1}}(e);if(Li(e))return!1;var t=Xi.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}function Pi(e){return null===e||"function"!=typeof e&&"object"!=typeof e}function Oi(){var e=nn.ToString(nn.CheckObjectCoercible(this));return rn(rn(e,an,""),sn,"")}function Ii(){return String.prototype.trim&&"\u200b"==="\u200b".trim()?String.prototype.trim:Oi}yi.supportsDescriptors=!!wi;var Mi,Di=yi,Ui=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,Ni=Object.getPrototypeOf||function(e){return e.__proto__},Bi="undefined"==typeof Uint8Array?Mi:Ni(Uint8Array),ji={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?Mi:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?Mi:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":Ri?Ni([][Symbol.iterator]()):Mi,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":Mi,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":Mi,"$ %AsyncGenerator%":Mi,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":Mi,"$ %AsyncIteratorPrototype%":Mi,"$ %Atomics%":"undefined"==typeof Atomics?Mi:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?Mi:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?Mi:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?Mi:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?Mi:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?Mi:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?Mi:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":Mi,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":Mi,"$ %Int8Array%":"undefined"==typeof Int8Array?Mi:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?Mi:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?Mi:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?Mi:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?Mi:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?Mi:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":Ri?Ni(Ni([][Symbol.iterator]())):Mi,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?Mi:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&Ri?Ni((new Map)[Symbol.iterator]()):Mi,"$ %MapPrototype%":"undefined"==typeof Map?Mi:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?Mi:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?Mi:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?Mi:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?Mi:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?Mi:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?Mi:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?Mi:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?Mi:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?Mi:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&Ri?Ni((new Set)[Symbol.iterator]()):Mi,"$ %SetPrototype%":"undefined"==typeof Set?Mi:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?Mi:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?Mi:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":Ri?Ni(""[Symbol.iterator]()):Mi,"$ %StringPrototype%":String.prototype,"$ %Symbol%":Ri?Symbol:Mi,"$ %SymbolPrototype%":Ri?Symbol.prototype:Mi,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":Ui,"$ %TypedArray%":Bi,"$ %TypedArrayPrototype%":Bi?Bi.prototype:Mi,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?Mi:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?Mi:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?Mi:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?Mi:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?Mi:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?Mi:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?Mi:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?Mi:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?Mi:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?Mi:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?Mi:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?Mi:WeakSet.prototype},Fi=ti.call(Function.call,Object.prototype.hasOwnProperty),Hi=Ci("%TypeError%"),Wi=Ci("%SyntaxError%"),zi={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var i={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in t)if(Fi(t,n)&&!i[n])return!1;var r=Fi(t,"[[Value]]"),a=Fi(t,"[[Get]]")||Fi(t,"[[Set]]");if(r&&a)throw new Hi("Property Descriptors may not be both accessor and data descriptors");return!0}},qi=Number.isNaN||function(e){return e!=e},Vi=Number.isNaN||function(e){return e!=e},Gi=Number.isFinite||function(e){return"number"==typeof e&&!Vi(e)&&e!==1/0&&e!==-1/0},$i=Function.prototype.toString,Yi=/^\s*class\b/,Xi=Object.prototype.toString,Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,Qi=Object.prototype.toString,Ji=function(e,t){var i;if((i=1<arguments.length?t:"[object Date]"===Qi.call(e)?String:Number)!==String&&i!==Number)throw new TypeError("invalid [[DefaultValue]] hint supplied");var n,r,a=i===String?["toString","valueOf"]:["valueOf","toString"];for(r=0;r<a.length;++r)if(Ai(e[a[r]])&&Pi(n=e[a[r]]()))return n;throw new TypeError("No default value")},Zi=Ci("%Object%"),en=Ci("%TypeError%"),tn=Ci("%String%"),nn={ToPrimitive:function(e,t){return Pi(e)?e:1<arguments.length?Ji(e,t):Ji(e)},ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return qi(t)?0:0!==t&&Gi(t)?Ei(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);return qi(t)||0===t||!Gi(t)?0:function(e,t){var i=e%65536;return Math.floor(0<=i?i:i+65536)}(Ei(t)*Math.floor(Math.abs(t)))},ToString:function(e){return tn(e)},ToObject:function(e){return this.CheckObjectCoercible(e),Zi(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new en(t||"Cannot call method on "+e);return e},IsCallable:Ai,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:qi(e)&&qi(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){if("Object"!==this.Type(e))return!1;var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var i in e)if(Fi(e,i)&&!t[i])return!1;var n=Fi(e,"[[Value]]"),r=Fi(e,"[[Get]]")||Fi(e,"[[Set]]");if(n&&r)throw new en("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(e){return void 0!==e&&(xi(this,"Property Descriptor","Desc",e),!(!Fi(e,"[[Get]]")&&!Fi(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(xi(this,"Property Descriptor","Desc",e),!(!Fi(e,"[[Value]]")&&!Fi(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(xi(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(xi(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new en("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new en("ToPropertyDescriptor requires an object");var t={};if(Fi(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),Fi(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),Fi(e,"value")&&(t["[[Value]]"]=e.value),Fi(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),Fi(e,"get")){var i=e.get;if(void 0!==i&&!this.IsCallable(i))throw new TypeError("getter must be a function");t["[[Get]]"]=i}if(Fi(e,"set")){var n=e.set;if(void 0!==n&&!this.IsCallable(n))throw new en("setter must be a function");t["[[Set]]"]=n}if((Fi(t,"[[Get]]")||Fi(t,"[[Set]]"))&&(Fi(t,"[[Value]]")||Fi(t,"[[Writable]]")))throw new en("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},rn=ti.call(Function.call,String.prototype.replace),an=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,sn=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,on=ti.call(Function.call,Ii());Di(on,{getPolyfill:Ii,implementation:Oi,shim:function(){var e=Ii();return Di(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var ln=on,un=Object.prototype.toString,cn=Object.prototype.hasOwnProperty,hn=function(e){if(!e)return{};var t={};return function(e,t,i){if(!Ai(t))throw new TypeError("iterator must be a function");var n;3<=arguments.length&&(n=i),"[object Array]"===un.call(e)?function(e,t,i){for(var n=0,r=e.length;n<r;n++)cn.call(e,n)&&(null==i?t(e[n],n,e):t.call(i,e[n],n,e))}(e,t,n):"string"==typeof e?function(e,t,i){for(var n=0,r=e.length;n<r;n++)null==i?t(e.charAt(n),n,e):t.call(i,e.charAt(n),n,e)}(e,t,n):function(e,t,i){for(var n in e)cn.call(e,n)&&(null==i?t(e[n],n,e):t.call(i,e[n],n,e))}(e,t,n)}(ln(e).split("\n"),function(e){var i=e.indexOf(":"),n=ln(e.slice(0,i)).toLowerCase(),r=ln(e.slice(i+1));void 0===t[n]?t[n]=r:"[object Array]"!==Object.prototype.toString.call(t[n])?t[n]=[t[n],r]:t[n].push(r)}),t},dn=function(){for(var e={},t=0;t<arguments.length;t++){var i=arguments[t];for(var n in i)fn.call(i,n)&&(e[n]=i[n])}return e},fn=Object.prototype.hasOwnProperty,pn=gn;function mn(e,t,i){var n=e;return Xt(t)?(i=t,"string"==typeof e&&(n={uri:e})):n=dn(t,{uri:e}),n.callback=i,n}function gn(e,t,i){return vn(t=mn(e,t,i))}function vn(e){if(void 0===e.callback)throw new Error("callback argument missing");var t=!1,i=function(i,n,r){t||(t=!0,e.callback(i,n,r))};function n(e){return clearTimeout(o),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,i(e,m)}function r(){if(!s){var t;clearTimeout(o);var n=m,r=null;return 0!==(t=e.useXDR&&void 0===l.status?200:1223===l.status?204:l.status)?(n={body:function(){var e=void 0;if(e=l.response?l.response:l.responseText||("document"===l.responseType?l.responseXML:""!==l.responseType||l.responseXML&&"parsererror"===l.responseXML.documentElement.nodeName?null:l.responseXML),p)try{e=JSON.parse(e)}catch(e){}return e}(),statusCode:t,method:c,headers:{},url:u,rawRequest:l},l.getAllResponseHeaders&&(n.headers=hn(l.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),i(r,n,n.body)}}var a,s,o,l=e.xhr||null,u=(l=l||(e.cors||e.useXDR?new gn.XDomainRequest:new gn.XMLHttpRequest)).url=e.uri||e.url,c=l.method=e.method||"GET",h=e.body||e.data,d=l.headers=e.headers||{},f=!!e.sync,p=!1,m={body:void 0,headers:{},statusCode:0,method:c,url:u,rawRequest:l};if("json"in e&&!1!==e.json&&(p=!0,d.accept||d.Accept||(d.Accept="application/json"),"GET"!==c&&"HEAD"!==c&&(d["content-type"]||d["Content-Type"]||(d["Content-Type"]="application/json"),h=JSON.stringify(!0===e.json?h:e.json))),l.onreadystatechange=function(){4===l.readyState&&setTimeout(r,0)},l.onload=r,l.onerror=n,l.onprogress=function(){},l.onabort=function(){s=!0},l.ontimeout=n,l.open(c,u,!f,e.username,e.password),f||(l.withCredentials=!!e.withCredentials),!f&&0<e.timeout&&(o=setTimeout(function(){if(!s){s=!0,l.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",n(e)}},e.timeout)),l.setRequestHeader)for(a in d)d.hasOwnProperty(a)&&l.setRequestHeader(a,d[a]);else if(e.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(l.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(l),l.send(h||null),l}function yn(t,i){var n=new e.WebVTT.Parser(e,e.vttjs,e.WebVTT.StringDecoder()),r=[];n.oncue=function(e){i.addCue(e)},n.onparsingerror=function(e){r.push(e)},n.onflush=function(){i.trigger({type:"loadeddata",target:i})},n.parse(t),0<r.length&&(e.console&&e.console.groupCollapsed&&e.console.groupCollapsed("Text Track parsing errors for "+i.src),r.forEach(function(e){return u.error(e)}),e.console&&e.console.groupEnd&&e.console.groupEnd()),n.flush()}gn.XMLHttpRequest=e.XMLHttpRequest||function(){},gn.XDomainRequest="withCredentials"in new gn.XMLHttpRequest?gn.XMLHttpRequest:e.XDomainRequest,function(e,t){for(var i=0;i<e.length;i++)t(e[i])}(["get","put","post","patch","head","delete"],function(e){gn["delete"===e?"del":e]=function(t,i,n){return(i=mn(t,i,n)).method=e.toUpperCase(),vn(i)}});var bn=function(t){function i(i){var n;if(void 0===i&&(i={}),!i.tech)throw new Error("A tech was not provided.");var r=Be(i,{kind:Vt[i.kind]||"subtitles",language:i.language||i.srclang||""}),a=Gt[r.mode]||"disabled",o=r.default;"metadata"!==r.kind&&"chapters"!==r.kind||(a="hidden"),(n=t.call(this,r)||this).tech_=r.tech,n.cues_=[],n.activeCues_=[];var l=new Wt(n.cues_),c=new Wt(n.activeCues_),h=!1,d=ke(s(n),function(){this.activeCues=this.activeCues,h&&(this.trigger("cuechange"),h=!1)});return"disabled"!==a&&n.tech_.ready(function(){n.tech_.on("timeupdate",d)},!0),Object.defineProperties(s(n),{default:{get:function(){return o},set:function(){}},mode:{get:function(){return a},set:function(e){var t=this;Gt[e]&&("disabled"!==(a=e)?this.tech_.ready(function(){t.tech_.on("timeupdate",d)},!0):this.tech_.off("timeupdate",d),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?l:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return c;for(var e=this.tech_.currentTime(),t=[],i=0,n=this.cues.length;i<n;i++){var r=this.cues[i];r.startTime<=e&&r.endTime>=e?t.push(r):r.startTime===r.endTime&&r.startTime<=e&&r.startTime+.5>=e&&t.push(r)}if(h=!1,t.length!==this.activeCues_.length)h=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(h=!0);return this.activeCues_=t,c.setCues_(this.activeCues_),c},set:function(){}}}),r.src?(n.src=r.src,function(t,i){var n={uri:t},r=Nt(t);r&&(n.cors=r),pn(n,ke(this,function(t,n,r){if(t)return u.error(t,n);if(i.loaded_=!0,"function"!=typeof e.WebVTT){if(i.tech_){function a(){u.error("vttjs failed to load, stopping trying to process "+i.src),i.tech_.off("vttjsloaded",s)}var s;s=function(){return i.tech_.off("vttjserror",a),yn(r,i)},i.tech_.one("vttjsloaded",s),i.tech_.one("vttjserror",a)}}else yn(r,i)}))}(r.src,s(n))):n.loaded_=!0,n}n(i,t);var r=i.prototype;return r.addCue=function(t){var i=t;if(e.vttjs&&!(t instanceof e.vttjs.VTTCue)){for(var n in i=new e.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)n in i||(i[n]=t[n]);i.id=t.id,i.originalCue_=t}for(var r=this.tech_.textTracks(),a=0;a<r.length;a++)r[a]!==this&&r[a].removeCue(i);this.cues_.push(i),this.cues.setCues_(this.cues_)},r.removeCue=function(e){for(var t=this.cues_.length;t--;){var i=this.cues_[t];if(i===e||i.originalCue_&&i.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},i}($t);bn.prototype.allowedEvents_={cuechange:"cuechange"};var _n=function(e){function t(t){var i;void 0===t&&(t={});var n=Be(t,{kind:qt[t.kind]||""});i=e.call(this,n)||this;var r=!1;return Object.defineProperty(s(i),"enabled",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("enabledchange"))}}),n.enabled&&(i.enabled=n.enabled),i.loaded_=!0,i}return n(t,e),t}($t),Tn=function(e){function t(t){var i;void 0===t&&(t={});var n=Be(t,{kind:zt[t.kind]||""});i=e.call(this,n)||this;var r=!1;return Object.defineProperty(s(i),"selected",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("selectedchange"))}}),n.selected&&(i.selected=n.selected),i}return n(t,e),t}($t),Sn=function(e){function t(t){var i,n;void 0===t&&(t={}),i=e.call(this)||this;var r=new bn(t);return i.kind=r.kind,i.src=r.src,i.srclang=r.language,i.label=r.label,i.default=r.default,Object.defineProperties(s(i),{readyState:{get:function(){return n}},track:{get:function(){return r}}}),n=0,r.addEventListener("loadeddata",function(){n=2,i.trigger({type:"load",target:s(i)})}),i}return n(t,e),t}(Ce);Sn.prototype.allowedEvents_={load:"load"},Sn.NONE=0,Sn.LOADING=1,Sn.LOADED=2,Sn.ERROR=3;var kn={audio:{ListClass:Bt,TrackClass:_n,capitalName:"Audio"},video:{ListClass:jt,TrackClass:Tn,capitalName:"Video"},text:{ListClass:Ft,TrackClass:bn,capitalName:"Text"}};Object.keys(kn).forEach(function(e){kn[e].getterName=e+"Tracks",kn[e].privateName=e+"Tracks_"});var wn={remoteText:{ListClass:Ft,TrackClass:bn,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Ht,TrackClass:Sn,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},Cn=Be(kn,wn);wn.names=Object.keys(wn),kn.names=Object.keys(kn),Cn.names=[].concat(wn.names).concat(kn.names);var xn=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return En.prototype=e,new En};function En(){}function Ln(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function An(e){function t(e,t,i,n){return 3600*(0|e)+60*(0|t)+(0|i)+(0|n)/1e3}var i=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return i?i[3]?t(i[1],i[2],i[3].replace(":",""),i[4]):59<i[1]?t(i[1],i[2],0,i[4]):t(0,i[1],i[2],i[4]):null}function Pn(){this.values=xn(null)}function On(e,t,i,n){var r=n?e.split(n):[e];for(var a in r)if("string"==typeof r[a]){var s=r[a].split(i);2===s.length&&t(s[0],s[1])}}function In(e,t,i){var n,r,a,s=e;function o(){var t=An(e);if(null===t)throw new Ln(Ln.Errors.BadTimeStamp,"Malformed timestamp: "+s);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function l(){e=e.replace(/^\s+/,"")}if(l(),t.startTime=o(),l(),"--\x3e"!==e.substr(0,3))throw new Ln(Ln.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);e=e.substr(3),l(),t.endTime=o(),l(),n=e,r=t,a=new Pn,On(n,function(e,t){switch(e){case"region":for(var n=i.length-1;0<=n;n--)if(i[n].id===t){a.set(e,i[n].region);break}break;case"vertical":a.alt(e,t,["rl","lr"]);break;case"line":var r=t.split(","),s=r[0];a.integer(e,s),a.percent(e,s)&&a.set("snapToLines",!1),a.alt(e,s,["auto"]),2===r.length&&a.alt("lineAlign",r[1],["start","middle","end"]);break;case"position":r=t.split(","),a.percent(e,r[0]),2===r.length&&a.alt("positionAlign",r[1],["start","middle","end"]);break;case"size":a.percent(e,t);break;case"align":a.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),r.region=a.get("region",null),r.vertical=a.get("vertical",""),r.line=a.get("line","auto"),r.lineAlign=a.get("lineAlign","start"),r.snapToLines=a.get("snapToLines",!0),r.size=a.get("size",100),r.align=a.get("align","middle"),r.position=a.get("position",{start:0,left:0,middle:50,end:100,right:100},r.align),r.positionAlign=a.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},r.align)}((Ln.prototype=xn(Error.prototype)).constructor=Ln).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Pn.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,i){for(var n=0;n<i.length;++n)if(t===i[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var Mn={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"\u200e","&rlm;":"\u200f","&nbsp;":"\xa0"},Dn={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},Un={v:"title",lang:"lang"},Rn={rt:"ruby"};function Nn(e,t){function i(){if(!t)return null;var e,i=t.match(/^([^<]*)(<[^>]*>?)?/);return t=t.substr((e=i[1]?i[1]:i[2]).length),e}function n(e){return Mn[e]}function r(e){for(;f=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(f[0],n);return e}function a(t,i){var n=Dn[t];if(!n)return null;var r=e.document.createElement(n);r.localName=n;var a=Un[t];return a&&i&&(r[a]=i.trim()),r}for(var s,o,l=e.document.createElement("div"),u=l,c=[];null!==(s=i());)if("<"!==s[0])u.appendChild(e.document.createTextNode(r(s)));else{if("/"===s[1]){c.length&&c[c.length-1]===s.substr(2).replace(">","")&&(c.pop(),u=u.parentNode);continue}var h,d=An(s.substr(1,s.length-2));if(d){h=e.document.createProcessingInstruction("timestamp",d),u.appendChild(h);continue}var f=s.match(/^<([^.\s\/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!f)continue;if(!(h=a(f[1],f[3])))continue;if(Rn[(o=h).localName]&&Rn[o.localName]!==u.localName)continue;f[2]&&(h.className=f[2].substr(1).replace("."," ")),c.push(f[1]),u.appendChild(h),u=h}return l}var Bn=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function jn(e){for(var t=0;t<Bn.length;t++){var i=Bn[t];if(e>=i[0]&&e<=i[1])return!0}return!1}function Fn(){}function Hn(e,t,i){Fn.call(this),this.cue=t,this.cueDiv=Nn(e,t.text);var n={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(n,this.cueDiv),this.div=e.document.createElement("div"),n={direction:function(e){var t=[],i="";if(!e||!e.childNodes)return"ltr";function n(e,t){for(var i=t.childNodes.length-1;0<=i;i--)e.push(t.childNodes[i])}function r(e){if(!e||!e.length)return null;var t=e.pop(),i=t.textContent||t.innerText;if(i){var a=i.match(/^.*(\n|\r)/);return a?a[e.length=0]:i}return"ruby"===t.tagName?r(e):t.childNodes?(n(e,t),r(e)):void 0}for(n(t,e);i=r(t);)for(var a=0;a<i.length;a++)if(jn(i.charCodeAt(a)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(n),this.div.appendChild(this.cueDiv);var r=0;switch(t.positionAlign){case"start":r=t.position;break;case"middle":r=t.position-t.size/2;break;case"end":r=t.position-t.size}this.applyStyles(""===t.vertical?{left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}:{top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function Wn(e){var t,i,n,r;if(e.div){i=e.div.offsetHeight,n=e.div.offsetWidth,r=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||r,this.height=e.height||i,this.bottom=e.bottom||r+(e.height||i),this.width=e.width||n,this.lineHeight=void 0!==t?t:e.lineHeight}function zn(e,t,i,n){var r=new Wn(t),a=t.cue,s=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,i=t.textTrackList,n=0,r=0;r<i.length&&i[r]!==t;r++)"showing"===i[r].mode&&n++;return-1*++n}(a),o=[];if(a.snapToLines){var l;switch(a.vertical){case"":o=["+y","-y"],l="height";break;case"rl":o=["+x","-x"],l="width";break;case"lr":o=["-x","+x"],l="width"}var u=r.lineHeight,c=u*Math.round(s),h=i[l]+u,d=o[0];Math.abs(c)>h&&(c=c<0?-1:1,c*=Math.ceil(h/u)*u),s<0&&(c+=""===a.vertical?i.height:i.width,o=o.reverse()),r.move(d,c)}else{var f=r.lineHeight/i.height*100;switch(a.lineAlign){case"middle":s-=f/2;break;case"end":s-=f}switch(a.vertical){case"":t.applyStyles({top:t.formatStyle(s,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(s,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(s,"%")})}o=["+y","-x","+x","-y"],r=new Wn(t)}var p=function(e,t){for(var r,a=new Wn(e),s=1,o=0;o<t.length;o++){for(;e.overlapsOppositeAxis(i,t[o])||e.within(i)&&e.overlapsAny(n);)e.move(t[o]);if(e.within(i))return e;var l=e.intersectPercentage(i);l<s&&(r=new Wn(e),s=l),e=new Wn(a)}return r||a}(r,o);t.move(p.toCSSCompatValues(i))}function qn(){}Fn.prototype.applyStyles=function(e,t){for(var i in t=t||this.div,e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},Fn.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(Hn.prototype=xn(Fn.prototype)).constructor=Hn,Wn.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},Wn.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},Wn.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},Wn.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},Wn.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},Wn.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},Wn.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},Wn.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,i=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,n=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||n,height:e.height||t,bottom:e.bottom||n+(e.height||t),width:e.width||i}},qn.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},qn.convertCueToDOMTree=function(e,t){return e&&t?Nn(e,t):null},qn.processCues=function(e,t,i){if(!e||!t||!i)return null;for(;i.firstChild;)i.removeChild(i.firstChild);var n=e.document.createElement("div");if(n.style.position="absolute",n.style.left="0",n.style.right="0",n.style.top="0",n.style.bottom="0",n.style.margin="1.5%",i.appendChild(n),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(t)){var r=[],a=Wn.getSimpleBoxPosition(n),s={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var i,o,l=0;l<t.length;l++)i=new Hn(e,o=t[l],s),n.appendChild(i.div),zn(0,i,a,r),o.displayState=i.div,r.push(Wn.getSimpleBoxPosition(i))}()}else for(var o=0;o<t.length;o++)n.appendChild(t[o].displayState)},(qn.Parser=function(e,t,i){i||(i=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=i||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof Ln))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var t=this;function i(){for(var e=t.buffer,i=0;i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;var n=e.substr(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.substr(i),n}function n(e){e.match(/X-TIMESTAMP-MAP/)?On(e,function(e,i){switch(e){case"X-TIMESTAMP-MAP":!function(e){var i=new Pn;On(e,function(e,t){switch(e){case"MPEGT":i.integer(e+"S",t);break;case"LOCA":i.set(e+"L",An(t))}},/[^\d]:/,/,/),t.ontimestampmap&&t.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}(i)}},/=/):On(e,function(e,i){switch(e){case"Region":!function(e){var i=new Pn;if(On(e,function(e,t){switch(e){case"id":i.set(e,t);break;case"width":i.percent(e,t);break;case"lines":i.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var r=new Pn;if(r.percent("x",n[0]),r.percent("y",n[1]),!r.has("x")||!r.has("y"))break;i.set(e+"X",r.get("x")),i.set(e+"Y",r.get("y"));break;case"scroll":i.alt(e,t,["up"])}},/=/,/\s/),i.has("id")){var n=new(t.vttjs.VTTRegion||t.window.VTTRegion);n.width=i.get("width",100),n.lines=i.get("lines",3),n.regionAnchorX=i.get("regionanchorX",0),n.regionAnchorY=i.get("regionanchorY",100),n.viewportAnchorX=i.get("viewportanchorX",0),n.viewportAnchorY=i.get("viewportanchorY",100),n.scroll=i.get("scroll",""),t.onregion&&t.onregion(n),t.regionList.push({id:i.get("id"),region:n})}}(i)}},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var r;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var a=(r=i()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Ln(Ln.Errors.BadSignature);t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:r=i(),t.state){case"HEADER":/:/.test(r)?n(r):r||(t.state="ID");continue;case"NOTE":r||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(r)){t.state="NOTE";break}if(!r)continue;if(t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,""),t.state="CUE",-1===r.indexOf("--\x3e")){t.cue.id=r;continue}case"CUE":try{In(r,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e),t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==r.indexOf("--\x3e");if(!r||o&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=r;continue;case"BADCUE":r||(t.state="ID");continue}}}catch(e){t.reportOrThrowError(e),"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var e=this;try{if(e.buffer+=e.decoder.decode(),!e.cue&&"HEADER"!==e.state||(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state)throw new Ln(Ln.Errors.BadSignature)}catch(t){e.reportOrThrowError(t)}return e.onflush&&e.onflush(),this}};var Vn=qn,Gn={"":1,lr:1,rl:1},$n={start:1,middle:1,end:1,left:1,right:1};function Yn(e){return"string"==typeof e&&!!$n[e.toLowerCase()]&&e.toLowerCase()}function Xn(e,t,i){this.hasBeenReset=!1;var n="",r=!1,a=e,s=t,o=i,l=null,u="",c=!0,h="auto",d="start",f=50,p="middle",m=50,g="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return n},set:function(e){n=""+e}},pauseOnExit:{enumerable:!0,get:function(){return r},set:function(e){r=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");s=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(e){o=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(e){var t=function(e){return"string"==typeof e&&!!Gn[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");u=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");h=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return d},set:function(e){var t=Yn(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");d=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return f},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");f=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=Yn(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");m=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return g},set:function(e){var t=Yn(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");g=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Xn.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Kn=Xn,Qn={"":!0,up:!0};function Jn(e){return"number"==typeof e&&0<=e&&e<=100}function Zn(){var e=100,t=3,i=0,n=100,r=0,a=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return e},set:function(t){if(!Jn(t))throw new Error("Width must be between 0 and 100.");e=t}},lines:{enumerable:!0,get:function(){return t},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");t=e}},regionAnchorY:{enumerable:!0,get:function(){return n},set:function(e){if(!Jn(e))throw new Error("RegionAnchorX must be between 0 and 100.");n=e}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(e){if(!Jn(e))throw new Error("RegionAnchorY must be between 0 and 100.");i=e}},viewportAnchorY:{enumerable:!0,get:function(){return a},set:function(e){if(!Jn(e))throw new Error("ViewportAnchorY must be between 0 and 100.");a=e}},viewportAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!Jn(e))throw new Error("ViewportAnchorX must be between 0 and 100.");r=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){var t=function(e){return"string"==typeof e&&!!Qn[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");s=t}}})}var er=xt(function(t){var i=t.exports={WebVTT:Vn,VTTCue:Kn,VTTRegion:Zn};e.vttjs=i,e.WebVTT=i.WebVTT;var n=i.VTTCue,r=i.VTTRegion,a=e.VTTCue,s=e.VTTRegion;i.shim=function(){e.VTTCue=n,e.VTTRegion=r},i.restore=function(){e.VTTCue=a,e.VTTRegion=s},e.VTTCue||i.shim()}),tr=function(i){function r(e,t){var n;return void 0===e&&(e={}),void 0===t&&(t=function(){}),e.reportTouchActivity=!1,(n=i.call(this,null,e,t)||this).hasStarted_=!1,n.on("playing",function(){this.hasStarted_=!0}),n.on("loadstart",function(){this.hasStarted_=!1}),Cn.names.forEach(function(t){var i=Cn[t];e&&e[i.getterName]&&(n[i.privateName]=e[i.getterName])}),n.featuresProgressEvents||n.manualProgressOn(),n.featuresTimeupdateEvents||n.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===e["native"+t+"Tracks"]&&(n["featuresNative"+t+"Tracks"]=!1)}),!1===e.nativeCaptions||!1===e.nativeTextTracks?n.featuresNativeTextTracks=!1:!0!==e.nativeCaptions&&!0!==e.nativeTextTracks||(n.featuresNativeTextTracks=!0),n.featuresNativeTextTracks||n.emulateTextTracks(),n.autoRemoteTextTracks_=new Cn.text.ListClass,n.initTrackListeners(),e.nativeControlsForTouch||n.emitTapEvents(),n.constructor&&(n.name_=n.constructor.name||"Unknown Tech"),n}n(r,i);var a=r.prototype;return a.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},a.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},a.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},a.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(ke(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()}),500)},a.onDurationChange=function(e){this.duration_=this.duration()},a.buffered=function(){return ft(0,0)},a.bufferedPercent=function(){return pt(this.buffered(),this.duration_)},a.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},a.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},a.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},a.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},a.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.dispose=function(){this.clearTracks(kn.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),i.prototype.dispose.call(this)},a.clearTracks=function(e){var t=this;(e=[].concat(e)).forEach(function(e){for(var i=t[e+"Tracks"]()||[],n=i.length;n--;){var r=i[n];"text"===e&&t.removeRemoteTextTrack(r),i.removeTrack(r)}})},a.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;)this.removeRemoteTextTrack(e[t])},a.reset=function(){},a.error=function(e){return void 0!==e&&(this.error_=new Tt(e),this.trigger("error")),this.error_},a.played=function(){return this.hasStarted_?ft(0,0):ft()},a.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},a.initTrackListeners=function(){var e=this;kn.names.forEach(function(t){function i(){e.trigger(t+"trackchange")}var n=e[kn[t].getterName]();n.addEventListener("removetrack",i),n.addEventListener("addtrack",i),e.on("dispose",function(){n.removeEventListener("removetrack",i),n.removeEventListener("addtrack",i)})})},a.addWebVttScript_=function(){var i=this;if(!e.WebVTT)if(t.body.contains(this.el())){if(!this.options_["vtt.js"]&&v(er)&&0<Object.keys(er).length)return void this.trigger("vttjsloaded");var n=t.createElement("script");n.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",n.onload=function(){i.trigger("vttjsloaded")},n.onerror=function(){i.trigger("vttjserror")},this.on("dispose",function(){n.onload=null,n.onerror=null}),e.WebVTT=!0,this.el().parentNode.appendChild(n)}else this.ready(this.addWebVttScript_)},a.emulateTextTracks=function(){function e(e){return n.addTrack(e.track)}function t(e){return n.removeTrack(e.track)}var i=this,n=this.textTracks(),r=this.remoteTextTracks();function a(){return i.trigger("texttrackchange")}function s(){a();for(var e=0;e<n.length;e++){var t=n[e];t.removeEventListener("cuechange",a),"showing"===t.mode&&t.addEventListener("cuechange",a)}}r.on("addtrack",e),r.on("removetrack",t),this.addWebVttScript_(),s(),n.addEventListener("change",s),n.addEventListener("addtrack",s),n.addEventListener("removetrack",s),this.on("dispose",function(){r.off("addtrack",e),r.off("removetrack",t),n.removeEventListener("change",s),n.removeEventListener("addtrack",s),n.removeEventListener("removetrack",s);for(var i=0;i<n.length;i++)n[i].removeEventListener("cuechange",a)})},a.addTextTrack=function(e,t,i){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,i,n,r){void 0===r&&(r={});var a=e.textTracks();r.kind=t,i&&(r.label=i),n&&(r.language=n),r.tech=e;var s=new Cn.text.TrackClass(r);return a.addTrack(s),s}(this,e,t,i)},a.createRemoteTextTrack=function(e){var t=Be(e,{tech:this});return new wn.remoteTextEl.TrackClass(t)},a.addRemoteTextTrack=function(e,t){var i=this;void 0===e&&(e={});var n=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(u.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(n),this.remoteTextTracks().addTrack(n.track),!0!==t&&this.ready(function(){return i.autoRemoteTextTracks_.addTrack(n.track)}),n},a.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},a.getVideoPlaybackQuality=function(){return{}},a.requestPictureInPicture=function(){var t=this.options_.Promise||e.Promise;if(t)return t.reject()},a.setPoster=function(){},a.playsinline=function(){},a.setPlaysinline=function(){},a.overrideNativeAudioTracks=function(){},a.overrideNativeVideoTracks=function(){},a.canPlayType=function(){return""},r.canPlayType=function(){return""},r.canPlaySource=function(e,t){return r.canPlayType(e.type)},r.isTech=function(e){return e.prototype instanceof r||e instanceof r||e===r},r.registerTech=function(e,t){if(r.techs_||(r.techs_={}),!r.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!r.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!r.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Ne(e),r.techs_[e]=t,"Tech"!==e&&r.defaultTechOrder_.push(e),t},r.getTech=function(t){if(t)return t=Ne(t),r.techs_&&r.techs_[t]?r.techs_[t]:e&&e.videojs&&e.videojs[t]?(u.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),e.videojs[t]):void 0},r}(je);Cn.names.forEach(function(e){var t=Cn[e];tr.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),tr.prototype.featuresVolumeControl=!0,tr.prototype.featuresMuteControl=!0,tr.prototype.featuresFullscreenResize=!1,tr.prototype.featuresPlaybackRate=!1,tr.prototype.featuresProgressEvents=!1,tr.prototype.featuresSourceset=!1,tr.prototype.featuresTimeupdateEvents=!1,tr.prototype.featuresNativeTextTracks=!1,tr.withSourceHandlers=function(e){e.registerSourceHandler=function(t,i){var n=e.sourceHandlers;n=n||(e.sourceHandlers=[]),void 0===i&&(i=n.length),n.splice(i,0,t)},e.canPlayType=function(t){for(var i,n=e.sourceHandlers||[],r=0;r<n.length;r++)if(i=n[r].canPlayType(t))return i;return""},e.selectSourceHandler=function(t,i){for(var n=e.sourceHandlers||[],r=0;r<n.length;r++)if(n[r].canHandleSource(t,i))return n[r];return null},e.canPlaySource=function(t,i){var n=e.selectSourceHandler(t,i);return n?n.canHandleSource(t,i):""},["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},e.prototype),e.prototype.setSource=function(t){var i=e.selectSourceHandler(t,this.options_);i||(e.nativeSourceHandler?i=e.nativeSourceHandler:u.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),i!==e.nativeSourceHandler&&(this.currentSource_=t),this.sourceHandler_=i.handleSource(t,this,this.options_),this.one("dispose",this.disposeSourceHandler)},e.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},je.registerComponent("Tech",tr),tr.registerTech("Tech",tr),tr.defaultTechOrder_=[];var ir={},nr={},rr={};function ar(e,t,i,n){void 0===n&&(n=null);var r="call"+Ne(i),a=e.reduce(ur(r),n),s=a===rr,o=s?null:t[i](a);return function(e,t,i,n){for(var r=e.length-1;0<=r;r--){var a=e[r];a[t]&&a[t](n,i)}}(e,i,o,s),o}var sr={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1,volume:1},or={setCurrentTime:1,setVolume:1},lr={play:1,pause:1};function ur(e){return function(t,i){return t===rr?rr:i[e]?i[e](t):t}}function cr(e){void 0===e&&(e="");var t=Rt(e);return hr[t.toLowerCase()]||""}var hr={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};function dr(e){var t=cr(e.src);return!e.type&&t&&(e.type=t),e}var fr=function(e){function t(t,i,n){var r,a=Be({createEl:!1},i);if(r=e.call(this,t,a,n)||this,i.playerOptions.sources&&0!==i.playerOptions.sources.length)t.src(i.playerOptions.sources);else for(var s=0,o=i.playerOptions.techOrder;s<o.length;s++){var l=Ne(o[s]),u=tr.getTech(l);if(l||(u=je.getComponent(l)),u&&u.isSupported()){t.loadTech_(l);break}}return r}return n(t,e),t}(je);je.registerComponent("MediaLoader",fr);var pr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).emitTapEvents(),n.enable(),n}n(t,e);var i=t.prototype;return i.createEl=function(t,i,n){void 0===t&&(t="div"),void 0===i&&(i={}),void 0===n&&(n={}),i=m({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},i),"button"===t&&u.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead."),n=m({role:"button"},n),this.tabIndex_=i.tabIndex;var r=e.prototype.createEl.call(this,t,i,n);return this.createControlTextEl(r),r},i.dispose=function(){this.controlTextEl_=null,e.prototype.dispose.call(this)},i.createControlTextEl=function(e){return this.controlTextEl_=x("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},i.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var i=this.localize(e);this.controlText_=e,E(this.controlTextEl_,i),this.nonIconControl||t.setAttribute("title",i)},i.buildCSSClass=function(){return"vjs-control vjs-button "+e.prototype.buildCSSClass.call(this)},i.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},i.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},i.handleClick=function(e){},i.handleKeyDown=function(t){Et.isEventKey(t,"Space")||Et.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(je);je.registerComponent("ClickableComponent",pr);var mr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).update(),t.on("posterchange",ke(s(n),n.update)),n}n(t,e);var i=t.prototype;return i.dispose=function(){this.player().off("posterchange",this.update),e.prototype.dispose.call(this)},i.createEl=function(){return x("div",{className:"vjs-poster",tabIndex:-1})},i.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},i.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},i.handleClick=function(e){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?wt(this.player_.play()):this.player_.pause())},t}(pr);je.registerComponent("PosterImage",mr);var gr="#222",vr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function yr(e,t){var i;if(4===e.length)i=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");i=e.slice(1)}return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function br(e,t,i){try{e.style[t]=i}catch(e){return}}var _r=function(t){function i(i,n,r){var a,o=ke(s(a=t.call(this,i,n,r)||this),a.updateDisplay);return i.on("loadstart",ke(s(a),a.toggleDisplay)),i.on("texttrackchange",o),i.on("loadedmetadata",ke(s(a),a.preselectTrack)),i.ready(ke(s(a),function(){if(i.tech_&&i.tech_.featuresNativeTextTracks)this.hide();else{i.on("fullscreenchange",o),i.on("playerresize",o),e.addEventListener("orientationchange",o),i.on("dispose",function(){return e.removeEventListener("orientationchange",o)});for(var t=this.options_.playerOptions.tracks||[],n=0;n<t.length;n++)this.player_.addRemoteTextTrack(t[n],!0);this.preselectTrack()}})),a}n(i,t);var r=i.prototype;return r.preselectTrack=function(){for(var e,t,i,n={captions:1,subtitles:1},r=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,s=0;s<r.length;s++){var o=r[s];a&&a.enabled&&a.language&&a.language===o.language&&o.kind in n?i=o.kind===a.kind?o:i||o:a&&!a.enabled?t=e=i=null:o.default&&("descriptions"!==o.kind||e?o.kind in n&&!t&&(t=o):e=o)}i?i.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},r.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},r.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},r.clearDisplay=function(){"function"==typeof e.WebVTT&&e.WebVTT.processCues(e,[],this.el_)},r.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var i=[],n=0;n<e.length;++n){var r=e[n];"showing"===r.mode&&i.push(r)}this.updateForTrack(i)}else{for(var a=null,s=null,o=e.length;o--;){var l=e[o];"showing"===l.mode&&("descriptions"===l.kind?a=l:s=l)}s?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(s)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},r.updateDisplayState=function(t){for(var i=this.player_.textTrackSettings.getValues(),n=t.activeCues,r=n.length;r--;){var a=n[r];if(a){var s=a.displayState;if(i.color&&(s.firstChild.style.color=i.color),i.textOpacity&&br(s.firstChild,"color",yr(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(s.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&br(s.firstChild,"backgroundColor",yr(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?br(s,"backgroundColor",yr(i.windowColor,i.windowOpacity)):s.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?s.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+gr:"raised"===i.edgeStyle?s.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+gr:"depressed"===i.edgeStyle?s.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+gr:"uniform"===i.edgeStyle&&(s.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+gr)),i.fontPercent&&1!==i.fontPercent){var o=e.parseFloat(s.style.fontSize);s.style.fontSize=o*i.fontPercent+"px",s.style.height="auto",s.style.top="auto",s.style.bottom="2px"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?s.firstChild.style.fontVariant="small-caps":s.firstChild.style.fontFamily=vr[i.fontFamily])}}},r.updateForTrack=function(t){if(Array.isArray(t)||(t=[t]),"function"==typeof e.WebVTT&&!t.every(function(e){return!e.activeCues})){for(var i=[],n=0;n<t.length;++n)for(var r=t[n],a=0;a<r.activeCues.length;++a)i.push(r.activeCues[a]);e.WebVTT.processCues(e,i,this.el_);for(var s=0;s<t.length;++s){for(var o=t[s],l=0;l<o.activeCues.length;++l){var u=o.activeCues[l].displayState;P(u,"vjs-text-track-cue"),P(u,"vjs-text-track-cue-"+(o.language?o.language:s))}this.player_.textTrackSettings&&this.updateDisplayState(o)}}},i}(je);je.registerComponent("TextTrackDisplay",_r);var Tr=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.createEl=function(){var t=this.player_.isAudio(),i=this.localize(t?"Audio Player":"Video Player"),n=x("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[i])}),r=e.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(n),r},t}(je);je.registerComponent("LoadingSpinner",Tr);var Sr=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.createEl=function(e,t,i){void 0===t&&(t={}),void 0===i&&(i={}),t=m({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),i=m({type:"button"},i);var n=je.prototype.createEl.call(this,"button",t,i);return this.createControlTextEl(n),n},i.addChild=function(e,t){return void 0===t&&(t={}),u.warn("Adding an actionable (user controllable) child to a Button ("+this.constructor.name+") is not supported; use a ClickableComponent instead."),je.prototype.addChild.call(this,e,t)},i.enable=function(){e.prototype.enable.call(this),this.el_.removeAttribute("disabled")},i.disable=function(){e.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},i.handleKeyDown=function(t){Et.isEventKey(t,"Space")||Et.isEventKey(t,"Enter")?t.stopPropagation():e.prototype.handleKeyDown.call(this,t)},t}(pr);je.registerComponent("Button",Sr);var kr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).mouseused_=!1,n.on("mousedown",n.handleMouseDown),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-big-play-button"},i.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)return wt(t),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());var i=this.player_.getChild("controlBar"),n=i&&i.getChild("playToggle");if(n){function r(){return n.focus()}kt(t)?t.then(r,function(){}):this.setTimeout(r,1)}else this.player_.tech(!0).focus()},i.handleKeyDown=function(t){this.mouseused_=!1,e.prototype.handleKeyDown.call(this,t)},i.handleMouseDown=function(e){this.mouseused_=!0},t}(Sr);kr.prototype.controlText_="Play Video",je.registerComponent("BigPlayButton",kr);var wr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).controlText(i&&i.controlText||n.localize("Close")),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-close-button "+e.prototype.buildCSSClass.call(this)},i.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},i.handleKeyDown=function(t){Et.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):e.prototype.handleKeyDown.call(this,t)},t}(Sr);je.registerComponent("CloseButton",wr);var Cr=function(e){function t(t,i){var n;return void 0===i&&(i={}),n=e.call(this,t,i)||this,i.replay=void 0===i.replay||i.replay,n.on(t,"play",n.handlePlay),n.on(t,"pause",n.handlePause),i.replay&&n.on(t,"ended",n.handleEnded),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-play-control "+e.prototype.buildCSSClass.call(this)},i.handleClick=function(e){this.player_.paused()?this.player_.play():this.player_.pause(),e.stopPropagation()},i.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},i.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},i.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},i.handleEnded=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},t}(Sr);function xr(e,t){e=e<0?0:e;var i=Math.floor(e%60),n=Math.floor(e/60%60),r=Math.floor(e/3600),a=Math.floor(t/60%60),s=Math.floor(t/3600);return!isNaN(e)&&e!==1/0||(r=n=i="-"),(r=0<r||0<s?r+":":"")+(n=((r||10<=a)&&n<10?"0"+n:n)+":")+(i<10?"0"+i:i)}Cr.prototype.controlText_="Play",je.registerComponent("PlayToggle",Cr);var Er=xr;function Lr(e,t){return void 0===t&&(t=e),Er(e,t)}var Ar=function(e){function i(t,i){var n;return(n=e.call(this,t,i)||this).throttledUpdateContent=we(ke(s(n),n.updateContent),25),n.on(t,"timeupdate",n.throttledUpdateContent),n}n(i,e);var r=i.prototype;return r.createEl=function(){var t=this.buildCSSClass(),i=e.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+"\xa0</span>"});return this.contentEl_=x("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),i.appendChild(this.contentEl_),i},r.dispose=function(){this.contentEl_=null,this.textNode_=null,e.prototype.dispose.call(this)},r.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=t.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},r.formatTime_=function(e){return Lr(e)},r.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},r.updateContent=function(e){},i}(je);Ar.prototype.labelText_="Time",Ar.prototype.controlText_="Time",je.registerComponent("TimeDisplay",Ar);var Pr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).on(t,"ended",n.handleEnded),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(e){var t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(t)},i.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},t}(Ar);Pr.prototype.labelText_="Current Time",Pr.prototype.controlText_="Current Time",je.registerComponent("CurrentTimeDisplay",Pr);var Or=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).on(t,"durationchange",n.updateContent),n.on(t,"loadstart",n.updateContent),n.on(t,"loadedmetadata",n.throttledUpdateContent),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-duration"},i.updateContent=function(e){var t=this.player_.duration();this.duration_!==t&&(this.duration_=t,this.updateFormattedTime_(t))},t}(Ar);Or.prototype.labelText_="Duration",Or.prototype.controlText_="Duration",je.registerComponent("DurationDisplay",Or);var Ir=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(je);je.registerComponent("TimeDivider",Ir);var Mr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).on(t,"durationchange",n.throttledUpdateContent),n.on(t,"ended",n.handleEnded),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-remaining-time"},i.createEl=function(){var t=e.prototype.createEl.call(this);return t.insertBefore(x("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},i.updateContent=function(e){"number"==typeof this.player_.duration()&&this.updateFormattedTime_(this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime())},i.handleEnded=function(e){this.player_.duration()&&this.updateFormattedTime_(0)},t}(Ar);Mr.prototype.labelText_="Remaining Time",Mr.prototype.controlText_="Remaining Time",je.registerComponent("RemainingTimeDisplay",Mr);var Dr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).updateShowing(),n.on(n.player(),"durationchange",n.updateShowing),n}n(t,e);var i=t.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=x("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+"\xa0</span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},i.dispose=function(){this.contentEl_=null,e.prototype.dispose.call(this)},i.updateShowing=function(e){this.player().duration()===1/0?this.show():this.hide()},t}(je);je.registerComponent("LiveDisplay",Dr);var Ur=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).updateLiveEdgeStatus(),n.player_.liveTracker&&n.on(n.player_.liveTracker,"liveedgechange",n.updateLiveEdgeStatus),n}n(t,e);var i=t.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=x("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},i.updateLiveEdgeStatus=function(e){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},i.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},i.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,e.prototype.dispose.call(this)},t}(Sr);Ur.prototype.controlText_="Seek to live, currently playing live",je.registerComponent("SeekToLive",Ur);var Rr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).bar=n.getChild(n.options_.barName),n.vertical(!!n.options_.vertical),n.enable(),n}n(t,e);var i=t.prototype;return i.enabled=function(){return this.enabled_},i.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},i.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},i.createEl=function(t,i,n){return void 0===i&&(i={}),void 0===n&&(n={}),i.className=i.className+" vjs-slider",i=m({tabIndex:0},i),n=m({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n),e.prototype.createEl.call(this,t,i,n)},i.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||nt||e.preventDefault(),B(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},i.handleMouseMove=function(e){},i.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;j(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},i.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var i=(100*e).toFixed(2)+"%",n=t.el().style;return this.vertical()?n.height=i:n.width=i,e}}},i.calculateDistance=function(e){var t=W(this.el_,e);return this.vertical()?t.y:t.x},i.handleKeyDown=function(t){Et.isEventKey(t,"Left")||Et.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):Et.isEventKey(t,"Right")||Et.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):e.prototype.handleKeyDown.call(this,t)},i.handleClick=function(e){e.stopPropagation(),e.preventDefault()},i.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.addClass(this.vertical_?"vjs-slider-vertical":"vjs-slider-horizontal")},t}(je);je.registerComponent("Slider",Rr);var Nr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).partEls_=[],n.on(t,"progress",n.update),n}n(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},i.dispose=function(){this.partEls_=null,e.prototype.dispose.call(this)},i.update=function(e){function t(e,t,i){var n=e/t||0;return n=100*(1<=n?1:n),i&&(n=n.toFixed(2)),n+"%"}var i=this.player_.liveTracker,n=this.player_.buffered(),r=i&&i.isLive()?i.seekableEnd():this.player_.duration(),a=this.player_.bufferedEnd(),s=this.partEls_,o=this.$(".vjs-control-text-loaded-percentage");this.el_.style.width=t(a,r),E(o,t(a,r,!0));for(var l=0;l<n.length;l++){var u=n.start(l),c=n.end(l),h=s[l];h||(h=this.el_.appendChild(x()),s[l]=h),h.style.left=t(u,a),h.style.width=t(c-u,a)}for(var d=s.length;d>n.length;d--)this.el_.removeChild(s[d-1]);s.length=n.length},t}(je);je.registerComponent("LoadProgressBar",Nr);var Br=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},i.update=function(e,t,i){var n=F(this.el_),r=F(this.player_.el()),a=e.width*t;if(r&&n){var s=e.left-r.left+a,o=e.width-a+(r.right-e.right),l=n.width/2;s<l?l+=l-s:o<l&&(l=o),l<0?l=0:l>n.width&&(l=n.width),this.el_.style.right="-"+l+"px",this.write(i)}},i.write=function(e){E(this.el_,e)},i.updateTime=function(e,t,i,n){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var a,s=r.player_.duration();if(r.player_.liveTracker&&r.player_.liveTracker.isLive()){var o=r.player_.liveTracker.liveWindow(),l=o-t*o;a=(l<1?"":"-")+Lr(l,o)}else a=Lr(i,s);r.update(e,t,a),n&&n()})},t}(je);je.registerComponent("TimeTooltip",Br);var jr=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function(e,t){var i=this.getChild("timeTooltip");if(i){var n=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();i.updateTime(e,t,n)}},t}(je);jr.prototype.options_={children:[]},Ke||Je||jr.prototype.options_.children.push("timeTooltip"),je.registerComponent("PlayProgressBar",jr);var Fr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).update=we(ke(s(n),n.update),25),n}n(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},i.update=function(e,t){var i=this,n=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,n,function(){i.el_.style.left=e.width*t+"px"})},t}(je);Fr.prototype.options_={children:["timeTooltip"]},je.registerComponent("MouseTimeDisplay",Fr);var Hr=function(e){function i(t,i){var n;return(n=e.call(this,t,i)||this).setEventHandlers_(),n}n(i,e);var r=i.prototype;return r.setEventHandlers_=function(){this.update=we(ke(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in t&&"visibilityState"in t&&this.on(t,"visibilitychange",this.toggleVisibility_)},r.toggleVisibility_=function(e){t.hidden?this.disableInterval_(e):(this.enableInterval_(),this.requestAnimationFrame(this.update))},r.enableInterval_=function(){var e=this;this.clearInterval(this.updateInterval),this.updateInterval=this.setInterval(function(){e.requestAnimationFrame(e.update)},30)},r.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&"ended"!==e.type||this.clearInterval(this.updateInterval)},r.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},r.update_=function(e,t){var i=this.player_.liveTracker,n=this.player_.duration();i&&i.isLive()&&(n=this.player_.liveTracker.liveCurrentTime()),this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Lr(e,n),Lr(n,n)],"{1} of {2}")),this.bar&&this.bar.update(F(this.el_),t)},r.update=function(t){if(null!==this.el().offsetParent){var i=e.prototype.update.call(this);return this.update_(this.getCurrentTime_(),i),i}},r.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},r.handleEnded=function(e){this.update_(this.player_.duration(),1)},r.getPercent=function(){var e,t=this.getCurrentTime_(),i=this.player_.liveTracker;return i&&i.isLive()?(e=(t-i.seekableStart())/i.liveWindow(),i.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),1<=e?1:e||0},r.handleMouseDown=function(t){Y(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),e.prototype.handleMouseDown.call(this,t))},r.handleMouseMove=function(e){if(Y(e)){var t,i=this.calculateDistance(e),n=this.player_.liveTracker;if(n&&n.isLive()){var r=n.seekableStart(),a=n.liveCurrentTime();if(a<=(t=r+i*n.liveWindow())&&(t=a),t<=r&&(t=r+.1),t===1/0)return}else(t=i*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},r.enable=function(){e.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},r.disable=function(){e.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},r.handleMouseUp=function(t){e.prototype.handleMouseUp.call(this,t),t&&t.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&wt(this.player_.play())},r.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},r.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},r.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},r.handleKeyDown=function(t){if(Et.isEventKey(t,"Space")||Et.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(Et.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(Et.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(Et(t))){t.preventDefault(),t.stopPropagation();var i=10*(Et.codes[Et(t)]-Et.codes[0])/100;this.player_.currentTime(this.player_.duration()*i)}else Et.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):Et.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):e.prototype.handleKeyDown.call(this,t)},i}(Rr);Hr.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Ke||Je||Hr.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),je.registerComponent("SeekBar",Hr);var Wr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).handleMouseMove=we(ke(s(n),n.handleMouseMove),25),n.throttledHandleMouseSeek=we(ke(s(n),n.handleMouseSeek),25),n.enable(),n}n(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},i.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var i=t.getChild("mouseTimeDisplay"),n=t.el(),r=F(n),a=W(n,e).x;1<a?a=1:a<0&&(a=0),i&&i.update(r,a)}},i.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},i.enabled=function(){return this.enabled_},i.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},i.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},i.handleMouseDown=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},i.handleMouseUp=function(e){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},t}(je);Wr.prototype.options_={children:["seekBar"]},je.registerComponent("ProgressControl",Wr);var zr=function(e){function i(i,n){var r;return(r=e.call(this,i,n)||this).on(i,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange),t.pictureInPictureEnabled||r.disable(),r}n(i,e);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-picture-in-picture-control "+e.prototype.buildCSSClass.call(this)},r.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},r.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},i}(Sr);zr.prototype.controlText_="Picture-in-Picture",je.registerComponent("PictureInPictureToggle",zr);var qr=function(e){function i(i,n){var r;return(r=e.call(this,i,n)||this).on(i,"fullscreenchange",r.handleFullscreenChange),!1===t[i.fsApi_.fullscreenEnabled]&&r.disable(),r}n(i,e);var r=i.prototype;return r.buildCSSClass=function(){return"vjs-fullscreen-control "+e.prototype.buildCSSClass.call(this)},r.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},r.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},i}(Sr);qr.prototype.controlText_="Fullscreen",je.registerComponent("FullscreenToggle",qr);var Vr=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(je);je.registerComponent("VolumeLevel",Vr);var Gr=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).on("slideractive",n.updateLastVolume_),n.on(t,"volumechange",n.updateARIAAttributes),t.ready(function(){return n.updateARIAAttributes()}),n}n(t,e);var i=t.prototype;return i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},i.handleMouseDown=function(t){Y(t)&&e.prototype.handleMouseDown.call(this,t)},i.handleMouseMove=function(e){Y(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},i.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},i.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},i.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},i.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},i.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},i.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},i.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},t}(Rr);Gr.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Gr.prototype.playerEvent="volumechange",je.registerComponent("VolumeBar",Gr);var $r=function(e){function t(t,i){var n;return void 0===i&&(i={}),i.vertical=i.vertical||!1,void 0!==i.volumeBar&&!v(i.volumeBar)||(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical),function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})}(s(n=e.call(this,t,i)||this),t),n.throttledHandleMouseMove=we(ke(s(n),n.handleMouseMove),25),n.on("mousedown",n.handleMouseDown),n.on("touchstart",n.handleMouseDown),n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active"),n.addClass("vjs-slider-active"),n.trigger("slideractive")}),n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active"),n.removeClass("vjs-slider-active"),n.trigger("sliderinactive")}),n}n(t,e);var i=t.prototype;return i.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},i.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},i.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},i.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},t}(je);$r.prototype.options_={children:["volumeBar"]},je.registerComponent("VolumeControl",$r);var Yr=function(e){function t(t,i){var n;return function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})}(s(n=e.call(this,t,i)||this),t),n.on(t,["loadstart","volumechange"],n.update),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-mute-control "+e.prototype.buildCSSClass.call(this)},i.handleClick=function(e){var t=this.player_.volume(),i=this.player_.lastVolume_();0===t?(this.player_.volume(i<.1?.1:i),this.player_.muted(!1)):this.player_.muted(!this.player_.muted())},i.update=function(e){this.updateIcon_(),this.updateControlText_()},i.updateIcon_=function(){var e=this.player_.volume(),t=3;Ke&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var i=0;i<4;i++)O(this.el_,"vjs-vol-"+i);P(this.el_,"vjs-vol-"+t)},i.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},t}(Sr);Yr.prototype.controlText_="Mute",je.registerComponent("MuteToggle",Yr);var Xr=function(e){function t(t,i){var n;return void 0===i&&(i={}),i.inline=void 0===i.inline||i.inline,void 0!==i.volumeControl&&!v(i.volumeControl)||(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline),(n=e.call(this,t,i)||this).on(t,["loadstart"],n.volumePanelState_),n.on(n.volumeControl,["slideractive"],n.sliderActive_),n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_),n}n(t,e);var i=t.prototype;return i.sliderActive_=function(){this.addClass("vjs-slider-active")},i.sliderInactive_=function(){this.removeClass("vjs-slider-active")},i.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},i.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),e.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},t}(je);Xr.prototype.options_={children:["muteToggle","volumeControl"]},je.registerComponent("VolumePanel",Xr);var Kr=function(e){function i(t,i){var n;return n=e.call(this,t,i)||this,i&&(n.menuButton_=i.menuButton),n.focusedChild_=-1,n.on("keydown",n.handleKeyDown),n.boundHandleBlur_=ke(s(n),n.handleBlur),n.boundHandleTapClick_=ke(s(n),n.handleTapClick),n}n(i,e);var r=i.prototype;return r.addEventListenerForItem=function(e){e instanceof je&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},r.removeEventListenerForItem=function(e){e instanceof je&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},r.removeChild=function(t){"string"==typeof t&&(t=this.getChild(t)),this.removeEventListenerForItem(t),e.prototype.removeChild.call(this,t)},r.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},r.createEl=function(){this.contentEl_=x(this.options_.contentElType||"ul",{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=e.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),ce(t,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),t},r.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,e.prototype.dispose.call(this)},r.handleBlur=function(e){var i=e.relatedTarget||t.activeElement;if(!this.children().some(function(e){return e.el()===i})){var n=this.menuButton_;n&&n.buttonPressed_&&i!==n.el().firstChild&&n.unpressButton()}},r.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var i=t.filter(function(t){return t.el()===e.target})[0];if(!i)return;"CaptionSettingsMenuItem"!==i.name()&&this.menuButton_.focus()}},r.handleKeyDown=function(e){Et.isEventKey(e,"Left")||Et.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(Et.isEventKey(e,"Right")||Et.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},r.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},r.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},r.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),0<t.length&&(e<0?e=0:e>=t.length&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())},i}(je);je.registerComponent("Menu",Kr);var Qr=function(e){function t(t,i){var n;void 0===i&&(i={}),(n=e.call(this,t,i)||this).menuButton_=new Sr(t,i),n.menuButton_.controlText(n.controlText_),n.menuButton_.el_.setAttribute("aria-haspopup","true");var r=Sr.prototype.buildCSSClass();return n.menuButton_.el_.className=n.buildCSSClass()+" "+r,n.menuButton_.removeClass("vjs-control"),n.addChild(n.menuButton_),n.update(),n.enabled_=!0,n.on(n.menuButton_,"tap",n.handleClick),n.on(n.menuButton_,"click",n.handleClick),n.on(n.menuButton_,"keydown",n.handleKeyDown),n.on(n.menuButton_,"mouseenter",function(){n.menu.show()}),n.on("keydown",n.handleSubmenuKeyDown),n}n(t,e);var i=t.prototype;return i.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},i.createMenu=function(){var e=new Kr(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=x("li",{className:"vjs-menu-title",innerHTML:Ne(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var i=new je(this.player_,{el:t});e.addItem(i)}if(this.items=this.createItems(),this.items)for(var n=0;n<this.items.length;n++)e.addItem(this.items[n]);return e},i.createItems=function(){},i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},i.buildWrapperCSSClass=function(){var t="vjs-menu-button";return"vjs-menu-button "+(t+=!0===this.options_.inline?"-inline":"-popup")+" "+Sr.prototype.buildCSSClass()+" "+e.prototype.buildCSSClass.call(this)},i.buildCSSClass=function(){var t="vjs-menu-button";return"vjs-menu-button "+(t+=!0===this.options_.inline?"-inline":"-popup")+" "+e.prototype.buildCSSClass.call(this)},i.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},i.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},i.focus=function(){this.menuButton_.focus()},i.blur=function(){this.menuButton_.blur()},i.handleKeyDown=function(e){Et.isEventKey(e,"Esc")||Et.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),Et.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(Et.isEventKey(e,"Up")||Et.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},i.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},i.handleSubmenuKeyDown=function(e){(Et.isEventKey(e,"Esc")||Et.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),Et.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},i.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Ke&&w())return;this.menu.focus()}},i.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},i.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},i.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},t}(je);je.registerComponent("MenuButton",Qr);var Jr=function(e){function t(t,i){var n,r=i.tracks;if((n=e.call(this,t,i)||this).items.length<=1&&n.hide(),!r)return s(n);var a=ke(s(n),n.update);return r.addEventListener("removetrack",a),r.addEventListener("addtrack",a),n.player_.on("ready",a),n.player_.on("dispose",function(){r.removeEventListener("removetrack",a),r.removeEventListener("addtrack",a)}),n}return n(t,e),t}(Qr);je.registerComponent("TrackButton",Jr);var Zr=["Tab","Esc","Up","Down","Right","Left"],ea=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).selectable=i.selectable,n.isSelected_=i.selected||!1,n.multiSelectable=i.multiSelectable,n.selected(n.isSelected_),n.el_.setAttribute("role",n.selectable?n.multiSelectable?"menuitemcheckbox":"menuitemradio":"menuitem"),n}n(t,e);var i=t.prototype;return i.createEl=function(t,i,n){return this.nonIconControl=!0,e.prototype.createEl.call(this,"li",m({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},i),n)},i.handleKeyDown=function(t){Zr.some(function(e){return Et.isEventKey(t,e)})||e.prototype.handleKeyDown.call(this,t)},i.handleClick=function(e){this.selected(!0)},i.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},t}(pr);je.registerComponent("MenuItem",ea);var ta=function(i){function r(n,r){var a,o,l=r.track,u=n.textTracks();function c(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a.handleTracksChange.apply(s(a),t)}function h(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a.handleSelectedLanguageChange.apply(s(a),t)}return r.label=l.label||l.language||"Unknown",r.selected="showing"===l.mode,(a=i.call(this,n,r)||this).track=l,a.kinds=(r.kinds||[r.kind||a.track.kind]).filter(Boolean),n.on(["loadstart","texttrackchange"],c),u.addEventListener("change",c),u.addEventListener("selectedlanguagechange",h),a.on("dispose",function(){n.off(["loadstart","texttrackchange"],c),u.removeEventListener("change",c),u.removeEventListener("selectedlanguagechange",h)}),void 0===u.onchange&&a.on(["tap","click"],function(){if("object"!=typeof e.Event)try{o=new e.Event("change")}catch(n){}o||(o=t.createEvent("Event")).initEvent("change",!0,!0),u.dispatchEvent(o)}),a.handleTracksChange(),a}n(r,i);var a=r.prototype;return a.handleClick=function(e){var t=this.track,n=this.player_.textTracks();if(i.prototype.handleClick.call(this,e),n)for(var r=0;r<n.length;r++){var a=n[r];-1!==this.kinds.indexOf(a.kind)&&(a===t?"showing"!==a.mode&&(a.mode="showing"):"disabled"!==a.mode&&(a.mode="disabled"))}},a.handleTracksChange=function(e){var t="showing"===this.track.mode;t!==this.isSelected_&&this.selected(t)},a.handleSelectedLanguageChange=function(e){if("showing"===this.track.mode){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},a.dispose=function(){this.track=null,i.prototype.dispose.call(this)},r}(ea);je.registerComponent("TextTrackMenuItem",ta);var ia=function(e){function t(t,i){return i.track={player:t,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.track.label=i.label?i.label:i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,e.call(this,t,i)||this}n(t,e);var i=t.prototype;return i.handleTracksChange=function(e){for(var t=this.player().textTracks(),i=!0,n=0,r=t.length;n<r;n++){var a=t[n];if(-1<this.options_.kinds.indexOf(a.kind)&&"showing"===a.mode){i=!1;break}}i!==this.isSelected_&&this.selected(i)},i.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),i=!0,n=0,r=t.length;n<r;n++){var a=t[n];if(-1<["captions","descriptions","subtitles"].indexOf(a.kind)&&"showing"===a.mode){i=!1;break}}i&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(ta);je.registerComponent("OffTextTrackMenuItem",ia);var na=function(e){function t(t,i){return void 0===i&&(i={}),i.tracks=t.textTracks(),e.call(this,t,i)||this}return n(t,e),t.prototype.createItems=function(e,t){var i;void 0===e&&(e=[]),void 0===t&&(t=ta),this.label_&&(i=this.label_+" off"),e.push(new ia(this.player_,{kinds:this.kinds_,kind:this.kind_,label:i})),this.hideThreshold_+=1;var n=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var r=0;r<n.length;r++){var a=n[r];if(-1<this.kinds_.indexOf(a.kind)){var s=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});s.addClass("vjs-"+a.kind+"-menu-item"),e.push(s)}}return e},t}(Jr);je.registerComponent("TextTrackButton",na);var ra=function(e){function t(t,i){var n,r=i.track,a=i.cue,o=t.currentTime();return i.selectable=!0,i.multiSelectable=!1,i.label=a.text,i.selected=a.startTime<=o&&o<a.endTime,(n=e.call(this,t,i)||this).track=r,n.cue=a,r.addEventListener("cuechange",ke(s(n),n.update)),n}n(t,e);var i=t.prototype;return i.handleClick=function(t){e.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},i.update=function(e){var t=this.cue,i=this.player_.currentTime();this.selected(t.startTime<=i&&i<t.endTime)},t}(ea);je.registerComponent("ChaptersTrackMenuItem",ra);var aa=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-chapters-button "+e.prototype.buildWrapperCSSClass.call(this)},i.update=function(t){this.track_&&(!t||"addtrack"!==t.type&&"removetrack"!==t.type)||this.setTrack(this.findChaptersTrack()),e.prototype.update.call(this)},i.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);i&&i.addEventListener("load",this.updateHandler_)}}},i.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;0<=t;t--){var i=e[t];if(i.kind===this.kind_)return i}},i.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Ne(this.kind_))},i.createMenu=function(){return this.options_.title=this.getMenuCaption(),e.prototype.createMenu.call(this)},i.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var i=0,n=t.length;i<n;i++){var r=new ra(this.player_,{track:this.track_,cue:t[i]});e.push(r)}return e},t}(na);aa.prototype.kind_="chapters",aa.prototype.controlText_="Chapters",je.registerComponent("ChaptersButton",aa);var sa=function(e){function t(t,i,n){var r;r=e.call(this,t,i,n)||this;var a=t.textTracks(),o=ke(s(r),r.handleTracksChange);return a.addEventListener("change",o),r.on("dispose",function(){a.removeEventListener("change",o)}),r}n(t,e);var i=t.prototype;return i.handleTracksChange=function(e){for(var t=this.player().textTracks(),i=!1,n=0,r=t.length;n<r;n++){var a=t[n];if(a.kind!==this.kind_&&"showing"===a.mode){i=!0;break}}i?this.disable():this.enable()},i.buildCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(na);sa.prototype.kind_="descriptions",sa.prototype.controlText_="Descriptions",je.registerComponent("DescriptionsButton",sa);var oa=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+e.prototype.buildWrapperCSSClass.call(this)},t}(na);oa.prototype.kind_="subtitles",oa.prototype.controlText_="Subtitles",je.registerComponent("SubtitlesButton",oa);var la=function(e){function t(t,i){var n;return i.track={player:t,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",(n=e.call(this,t,i)||this).addClass("vjs-texttrack-settings"),n.controlText(", opens "+i.kind+" settings dialog"),n}return n(t,e),t.prototype.handleClick=function(e){this.player().getChild("textTrackSettings").open()},t}(ta);je.registerComponent("CaptionSettingsMenuItem",la);var ua=function(e){function t(t,i,n){return e.call(this,t,i,n)||this}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-captions-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-captions-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new la(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t)},t}(na);ua.prototype.kind_="captions",ua.prototype.controlText_="Captions",je.registerComponent("CaptionsButton",ua);var ca=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.createEl=function(t,i,n){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),e.prototype.createEl.call(this,t,m({innerHTML:r+="</span>"},i),n)},t}(ta);je.registerComponent("SubsCapsMenuItem",ca);var ha=function(e){function t(t,i){var n;return void 0===i&&(i={}),(n=e.call(this,t,i)||this).label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)&&(n.label_="captions"),n.menuButton_.controlText(Ne(n.label_)),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new la(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e.prototype.createItems.call(this,t,ca)},t}(na);ha.prototype.kinds_=["captions","subtitles"],ha.prototype.controlText_="Subtitles",je.registerComponent("SubsCapsButton",ha);var da=function(e){function t(t,i){var n,r=i.track,a=t.audioTracks();function o(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];n.handleTracksChange.apply(s(n),t)}return i.label=r.label||r.language||"Unknown",i.selected=r.enabled,(n=e.call(this,t,i)||this).track=r,n.addClass("vjs-"+r.kind+"-menu-item"),a.addEventListener("change",o),n.on("dispose",function(){a.removeEventListener("change",o)}),n}n(t,e);var i=t.prototype;return i.createEl=function(t,i,n){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),e.prototype.createEl.call(this,t,m({innerHTML:r+="</span>"},i),n)},i.handleClick=function(t){var i=this.player_.audioTracks();e.prototype.handleClick.call(this,t);for(var n=0;n<i.length;n++){var r=i[n];r.enabled=r===this.track}},i.handleTracksChange=function(e){this.selected(this.track.enabled)},t}(ea);je.registerComponent("AudioTrackMenuItem",da);var fa=function(e){function t(t,i){return void 0===i&&(i={}),i.tracks=t.audioTracks(),e.call(this,t,i)||this}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-audio-button "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-audio-button "+e.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),i=0;i<t.length;i++)e.push(new da(this.player_,{track:t[i],selectable:!0,multiSelectable:!1}));return e},t}(Jr);fa.prototype.controlText_="Audio Track",je.registerComponent("AudioTrackButton",fa);var pa=function(e){function t(t,i){var n,r=i.rate,a=parseFloat(r,10);return i.label=r,i.selected=1===a,i.selectable=!0,i.multiSelectable=!1,(n=e.call(this,t,i)||this).label=r,n.rate=a,n.on(t,"ratechange",n.update),n}n(t,e);var i=t.prototype;return i.handleClick=function(t){e.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},i.update=function(e){this.selected(this.player().playbackRate()===this.rate)},t}(ea);pa.prototype.contentElType="button",je.registerComponent("PlaybackRateMenuItem",pa);var ma=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).updateVisibility(),n.updateLabel(),n.on(t,"loadstart",n.updateVisibility),n.on(t,"ratechange",n.updateLabel),n}n(t,e);var i=t.prototype;return i.createEl=function(){var t=e.prototype.createEl.call(this);return this.labelEl_=x("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},i.dispose=function(){this.labelEl_=null,e.prototype.dispose.call(this)},i.buildCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-playback-rate "+e.prototype.buildWrapperCSSClass.call(this)},i.createMenu=function(){var e=new Kr(this.player()),t=this.playbackRates();if(t)for(var i=t.length-1;0<=i;i--)e.addChild(new pa(this.player(),{rate:t[i]+"x"}));return e},i.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},i.handleClick=function(e){for(var t=this.player().playbackRate(),i=this.playbackRates(),n=i[0],r=0;r<i.length;r++)if(i[r]>t){n=i[r];break}this.player().playbackRate(n)},i.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},i.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length},i.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},i.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},t}(Qr);ma.prototype.controlText_="Playback Rate",je.registerComponent("PlaybackRateMenuButton",ma);var ga=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(je);je.registerComponent("Spacer",ga);var va=function(e){function t(){return e.apply(this,arguments)||this}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+e.prototype.buildCSSClass.call(this)},i.createEl=function(){var t=e.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML="\xa0",t},t}(ga);je.registerComponent("CustomControlSpacer",va);var ya=function(e){function t(){return e.apply(this,arguments)||this}return n(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(je);ya.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","pictureInPictureToggle","fullscreenToggle"]},je.registerComponent("ControlBar",ya);var ba=function(e){function t(t,i){var n;return(n=e.call(this,t,i)||this).on(t,"error",n.open),n}n(t,e);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-error-display "+e.prototype.buildCSSClass.call(this)},i.content=function(){var e=this.player().error();return e?this.localize(e.message):""},t}(At);ba.prototype.options_=Be(At.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),je.registerComponent("ErrorDisplay",ba);var _a="vjs-text-track-settings",Ta=["#000","Black"],Sa=["#00F","Blue"],ka=["#0FF","Cyan"],wa=["#0F0","Green"],Ca=["#F0F","Magenta"],xa=["#F00","Red"],Ea=["#FFF","White"],La=["#FF0","Yellow"],Aa=["1","Opaque"],Pa=["0.5","Semi-Transparent"],Oa=["0","Transparent"],Ia={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Ta,Ea,xa,wa,Sa,La,Ca,ka]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Aa,Pa,Oa]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Ea,Ta,xa,wa,Sa,La,Ca,ka]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Aa,Pa]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Oa,Pa,Aa]}};function Ma(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}Ia.windowColor.options=Ia.backgroundColor.options;var Da=function(t){function i(e,i){var n;return i.temporary=!1,(n=t.call(this,e,i)||this).updateDisplay=ke(s(n),n.updateDisplay),n.fill(),n.hasBeenOpened_=n.hasBeenFilled_=!0,n.endDialog=x("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")}),n.el().appendChild(n.endDialog),n.setDefaults(),void 0===i.persistTextTrackSettings&&(n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings),n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings(),n.close()}),n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults(),n.updateDisplay()}),p(Ia,function(e){n.on(n.$(e.selector),"change",n.updateDisplay)}),n.options_.persistTextTrackSettings&&n.restoreSettings(),n}n(i,t);var r=i.prototype;return r.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},r.createElSelect_=function(e,t,i){var n=this;void 0===t&&(t=""),void 0===i&&(i="label");var r=Ia[e],a=r.id.replace("%s",this.id_),s=[t,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(r.label),"</"+i+">",'<select aria-labelledby="'+s+'">'].concat(r.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+s+" "+t+'">',n.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},r.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},r.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},r.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},r.createElColors_=function(){return x("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},r.createElFont_=function(){return x("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},r.createElControls_=function(){var e=this.localize("restore all settings to the default values");return x("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},r.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},r.label=function(){return this.localize("Caption Settings Dialog")},r.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},r.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},r.getValues=function(){var e,t,i=this;return void 0===(t={})&&(t=0),f(e=Ia).reduce(function(t,n){return function(e,t,n){var r=function(e,t){return Ma(e.options[e.options.selectedIndex].value,t)}(i.$(t.selector),t.parser);return void 0!==r&&(e[n]=r),e}(t,e[n],n)},t)},r.setValues=function(e){var t=this;p(Ia,function(i,n){!function(e,t,i){if(t)for(var n=0;n<e.options.length;n++)if(Ma(e.options[n].value,i)===t){e.selectedIndex=n;break}}(t.$(i.selector),e[n],i.parser)})},r.setDefaults=function(){var e=this;p(Ia,function(t){var i=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=i})},r.restoreSettings=function(){var t;try{t=JSON.parse(e.localStorage.getItem(_a))}catch(t){u.warn(t)}t&&this.setValues(t)},r.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?e.localStorage.setItem(_a,JSON.stringify(t)):e.localStorage.removeItem(_a)}catch(t){u.warn(t)}}},r.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},r.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,i=e&&e.captionsButton;t?t.focus():i&&i.focus()},i}(At);je.registerComponent("TextTrackSettings",Da);var Ua=function(t){function i(i,n){var r,a=n.ResizeObserver||e.ResizeObserver;null===n.ResizeObserver&&(a=!1);var o=Be({createEl:!a,reportTouchActivity:!1},n);return(r=t.call(this,i,o)||this).ResizeObserver=n.ResizeObserver||e.ResizeObserver,r.loadListener_=null,r.resizeObserver_=null,r.debouncedHandler_=function(t,i,n,r){var a;function s(){var e=this,s=arguments,o=function(){o=a=null,n||t.apply(e,s)};!a&&n&&t.apply(e,s),r.clearTimeout(a),a=r.setTimeout(o,i)}return void 0===r&&(r=e),s.cancel=function(){r.clearTimeout(a),a=null},s}(function(){r.resizeHandler()},100,!1,s(r)),a?(r.resizeObserver_=new r.ResizeObserver(r.debouncedHandler_),r.resizeObserver_.observe(i.el())):(r.loadListener_=function(){if(r.el_&&r.el_.contentWindow){var e=r.debouncedHandler_,t=r.unloadListener_=function(){he(this,"resize",e),he(this,"unload",t),t=null};ce(r.el_.contentWindow,"unload",t),ce(r.el_.contentWindow,"resize",e)}},r.one("load",r.loadListener_)),r}n(i,t);var r=i.prototype;return r.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,t.prototype.dispose.call(this)},i}(je);je.registerComponent("ResizeManager",Ua);var Ra=function(e){function i(i,n){var r,a=Be({createEl:!1},n);return(r=e.call(this,i,a)||this).reset_(),r.on(r.player_,"durationchange",r.handleDurationchange),at&&"hidden"in t&&"visibilityState"in t&&r.on(t,"visibilitychange",r.handleVisibilityChange),r}n(i,e);var r=i.prototype;return r.handleVisibilityChange=function(){this.player_.duration()===1/0&&(t.hidden?this.stopTracking():this.startTracking())},r.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var e=this.liveCurrentTime(),t=this.player_.currentTime();return e!==1/0&&t<=e-(2*this.seekableIncrement_+.07)},r.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(e&&e.length){var t=this.seekableEnd();t!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrement_=Math.abs(t-this.lastSeekEnd_)),this.pastSeekEnd_=0,this.lastSeekEnd_=t,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},r.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},r.startTracking=function(){var e=this;this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.timeupdateSeen_||(this.one(this.player_,"play",this.handlePlay),this.handleTimeupdate=function(){e.timeupdateSeen_=!0,e.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},r.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},r.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},r.stopTracking=function(){this.isTracking()&&this.reset_()},r.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.end(i));return t.length?t.sort()[t.length-1]:1/0},r.seekableStart=function(){for(var e=this.player_.seekable(),t=[],i=e?e.length:0;i--;)t.push(e.start(i));return t.length?t.sort()[0]:0},r.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},r.isLive=function(){return this.isTracking()},r.atLiveEdge=function(){return!this.behindLiveEdge()},r.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},r.pastSeekEnd=function(){return this.pastSeekEnd_},r.behindLiveEdge=function(){return this.behindLiveEdge_},r.isTracking=function(){return"number"==typeof this.trackingInterval_},r.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},r.dispose=function(){this.stopTracking(),e.prototype.dispose.call(this)},i}(je);function Na(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var i=e.$$("source"),n=[],r="";if(!i.length)return!1;for(var a=0;a<i.length;a++){var s=i[a].src;s&&-1===n.indexOf(s)&&n.push(s)}return!!n.length&&(1===n.length&&(r=n[0]),e.triggerSourceset(r),!0)}function Ba(e,t){for(var i={},n=0;n<e.length&&!((i=Object.getOwnPropertyDescriptor(e[n],t))&&i.set&&i.get);n++);return i.enumerable=!0,i.configurable=!0,i}function ja(t){var i=t.el();if(!i.resetSourceWatch_){function n(e){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var s=e.apply(i,r);return Na(t),s}}var r={},a=Ba([t.el(),e.HTMLMediaElement.prototype,e.Element.prototype,Fa],"innerHTML");["append","appendChild","insertAdjacentHTML"].forEach(function(e){i[e]&&(r[e]=i[e],i[e]=n(r[e]))}),Object.defineProperty(i,"innerHTML",Be(a,{set:n(a.set)})),i.resetSourceWatch_=function(){i.resetSourceWatch_=null,Object.keys(r).forEach(function(e){i[e]=r[e]}),Object.defineProperty(i,"innerHTML",a)},t.one("sourceset",i.resetSourceWatch_)}}je.registerComponent("LiveTracker",Ra);var Fa=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(i){var n=t.createElement(this.nodeName.toLowerCase());n.innerHTML=i;for(var r=t.createDocumentFragment();n.childNodes.length;)r.appendChild(n.childNodes[0]);return this.innerText="",e.Element.prototype.appendChild.call(this,r),this.innerHTML}}),Ha=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Ut(e.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return e.Element.prototype.setAttribute.call(this,"src",t),t}});function Wa(){var e=o(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]);return Wa=function(){return e},e}var za=function(i){function r(e,t){var n;n=i.call(this,e,t)||this;var r=e.source,a=!1;if(r&&(n.el_.currentSrc!==r.src||e.tag&&3===e.tag.initNetworkState_)?n.setSource(r):n.handleLateInit_(n.el_),e.enableSourceset&&n.setupSourcesetHandling_(),n.el_.hasChildNodes()){for(var s=n.el_.childNodes,o=s.length,l=[];o--;){var c=s[o];"track"===c.nodeName.toLowerCase()&&(n.featuresNativeTextTracks?(n.remoteTextTrackEls().addTrackElement_(c),n.remoteTextTracks().addTrack(c.track),n.textTracks().addTrack(c.track),a||n.el_.hasAttribute("crossorigin")||!Nt(c.src)||(a=!0)):l.push(c))}for(var d=0;d<l.length;d++)n.el_.removeChild(l[d])}return n.proxyNativeTracks_(),n.featuresNativeTextTracks&&a&&u.warn(h(Wa())),n.restoreMetadataTracksInIOSNativePlayer_(),(ut||Ye||et)&&!0===e.nativeControlsForTouch&&n.setControls(!0),n.proxyWebkitFullscreen_(),n.triggerReady(),n}n(r,i);var a=r.prototype;return a.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),r.disposeMediaElement(this.el_),this.options_=null,i.prototype.dispose.call(this)},a.setupSourcesetHandling_=function(){!function(t){if(t.featuresSourceset){var i=t.el();if(!i.resetSourceset_){var n=Ba([t.el(),e.HTMLMediaElement.prototype,Ha],"src"),r=i.setAttribute,a=i.load;Object.defineProperty(i,"src",Be(n,{set:function(e){var r=n.set.call(i,e);return t.triggerSourceset(i.src),r}})),i.setAttribute=function(e,n){var a=r.call(i,e,n);return/src/i.test(e)&&t.triggerSourceset(i.src),a},i.load=function(){var e=a.call(i);return Na(t)||(t.triggerSourceset(""),ja(t)),e},i.currentSrc?t.triggerSourceset(i.currentSrc):Na(t)||ja(t),i.resetSourceset_=function(){i.resetSourceset_=null,i.load=a,i.setAttribute=r,Object.defineProperty(i,"src",n),i.resetSourceWatch_&&i.resetSourceWatch_()}}}}(this)},a.restoreMetadataTracksInIOSNativePlayer_=function(){function e(){t=[];for(var e=0;e<i.length;e++){var n=i[e];"metadata"===n.kind&&t.push({track:n,storedMode:n.mode})}}var t,i=this.textTracks();function n(){for(var e=0;e<t.length;e++){var r=t[e];"disabled"===r.track.mode&&r.track.mode!==r.storedMode&&(r.track.mode=r.storedMode)}i.removeEventListener("change",n)}e(),i.addEventListener("change",e),this.on("dispose",function(){return i.removeEventListener("change",e)}),this.on("webkitbeginfullscreen",function(){i.removeEventListener("change",e),i.removeEventListener("change",n),i.addEventListener("change",n)}),this.on("webkitendfullscreen",function(){i.removeEventListener("change",e),i.addEventListener("change",e),i.removeEventListener("change",n)})},a.overrideNative_=function(e,t){var i=this;if(t===this["featuresNative"+e+"Tracks"]){var n=e.toLowerCase();this[n+"TracksListeners_"]&&Object.keys(this[n+"TracksListeners_"]).forEach(function(e){i.el()[n+"Tracks"].removeEventListener(e,i[n+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[n+"TracksListeners_"]=null,this.proxyNativeTracksForType_(n)}},a.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},a.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},a.proxyNativeTracksForType_=function(e){var t=this,i=kn[e],n=this.el()[i.getterName],r=this[i.getterName]();if(this["featuresNative"+i.capitalName+"Tracks"]&&n&&n.addEventListener){function a(){for(var e=[],t=0;t<r.length;t++){for(var i=!1,a=0;a<n.length;a++)if(n[a]===r[t]){i=!0;break}i||e.push(r[t])}for(;e.length;)r.removeTrack(e.shift())}var s={change:function(e){r.trigger({type:"change",target:r,currentTarget:r,srcElement:r})},addtrack:function(e){r.addTrack(e.track)},removetrack:function(e){r.removeTrack(e.track)}};this[i.getterName+"Listeners_"]=s,Object.keys(s).forEach(function(e){var i=s[e];n.addEventListener(e,i),t.on("dispose",function(t){return n.removeEventListener(e,i)})}),this.on("loadstart",a),this.on("dispose",function(e){return t.off("loadstart",a)})}},a.proxyNativeTracks_=function(){var e=this;kn.names.forEach(function(t){e.proxyNativeTracksForType_(t)})},a.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var i=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(i,e),r.disposeMediaElement(e),e=i}else{e=t.createElement("video");var n=Be({},this.options_.tag&&D(this.options_.tag));ut&&!0===this.options_.nativeControlsForTouch||delete n.controls,M(e,m(n,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&R(e,"preload",this.options_.preload);for(var a=["loop","muted","playsinline","autoplay"],s=0;s<a.length;s++){var o=a[s],l=this.options_[o];void 0!==l&&(l?R(e,o,o):N(e,o),e[o]=l)}return e},a.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){function t(){i=!0}var i=!1;function n(){i||this.trigger("loadstart")}return this.on("loadstart",t),this.on("loadedmetadata",n),void this.ready(function(){this.off("loadstart",t),this.off("loadedmetadata",n),i||this.trigger("loadstart")})}var r=["loadstart"];r.push("loadedmetadata"),2<=e.readyState&&r.push("loadeddata"),3<=e.readyState&&r.push("canplay"),4<=e.readyState&&r.push("canplaythrough"),this.ready(function(){r.forEach(function(e){this.trigger(e)},this)})}},a.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){u(e,"Video is not ready. (Video.js)")}},a.duration=function(){var e=this;return this.el_.duration===1/0&&Je&&nt&&0===this.el_.currentTime?(this.on("timeupdate",function t(){0<e.el_.currentTime&&(e.el_.duration===1/0&&e.trigger("durationchange"),e.off("timeupdate",t))}),NaN):this.el_.duration||NaN},a.width=function(){return this.el_.offsetWidth},a.height=function(){return this.el_.offsetHeight},a.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){function t(){this.trigger("fullscreenchange",{isFullscreen:!1})}function i(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))}this.on("webkitbeginfullscreen",i),this.on("dispose",function(){e.off("webkitbeginfullscreen",i),e.off("webkitendfullscreen",t)})}},a.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=e.navigator&&e.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},a.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},a.exitFullScreen=function(){this.el_.webkitExitFullScreen()},a.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},a.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},a.reset=function(){r.resetMediaElement(this.el_)},a.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},a.setControls=function(e){this.el_.controls=!!e},a.addTextTrack=function(e,t,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,n):i.prototype.addTextTrack.call(this,e,t,n)},a.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return i.prototype.createRemoteTextTrack.call(this,e);var n=t.createElement("track");return e.kind&&(n.kind=e.kind),e.label&&(n.label=e.label),(e.language||e.srclang)&&(n.srclang=e.language||e.srclang),e.default&&(n.default=e.default),e.id&&(n.id=e.id),e.src&&(n.src=e.src),n},a.addRemoteTextTrack=function(e,t){var n=i.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(n),n},a.removeRemoteTextTrack=function(e){if(i.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),n=t.length;n--;)e!==t[n]&&e!==t[n].track||this.el().removeChild(t[n])},a.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),e.performance&&"function"==typeof e.performance.now?t.creationTime=e.performance.now():e.performance&&e.performance.timing&&"number"==typeof e.performance.timing.navigationStart&&(t.creationTime=e.Date.now()-e.performance.timing.navigationStart),t},r}(tr);if(S()){za.TEST_VID=t.createElement("video");var qa=t.createElement("track");qa.kind="captions",qa.srclang="en",qa.label="English",za.TEST_VID.appendChild(qa)}za.isSupported=function(){try{za.TEST_VID.volume=.5}catch(e){return!1}return!(!za.TEST_VID||!za.TEST_VID.canPlayType)},za.canPlayType=function(e){return za.TEST_VID.canPlayType(e)},za.canPlaySource=function(e,t){return za.canPlayType(e.type)},za.canControlVolume=function(){try{var e=za.TEST_VID.volume;return za.TEST_VID.volume=e/2+.1,e!==za.TEST_VID.volume}catch(e){return!1}},za.canMuteVolume=function(){try{var e=za.TEST_VID.muted;return za.TEST_VID.muted=!e,za.TEST_VID.muted?R(za.TEST_VID,"muted","muted"):N(za.TEST_VID,"muted"),e!==za.TEST_VID.muted}catch(e){return!1}},za.canControlPlaybackRate=function(){if(Je&&nt&&rt<58)return!1;try{var e=za.TEST_VID.playbackRate;return za.TEST_VID.playbackRate=e/2+.1,e!==za.TEST_VID.playbackRate}catch(e){return!1}},za.canOverrideAttributes=function(){try{function e(){}Object.defineProperty(t.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(t.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(t.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},za.supportsNativeTextTracks=function(){return ot||Ke&&nt},za.supportsNativeVideoTracks=function(){return!(!za.TEST_VID||!za.TEST_VID.videoTracks)},za.supportsNativeAudioTracks=function(){return!(!za.TEST_VID||!za.TEST_VID.audioTracks)},za.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],za.prototype.featuresVolumeControl=za.canControlVolume(),za.prototype.featuresMuteControl=za.canMuteVolume(),za.prototype.featuresPlaybackRate=za.canControlPlaybackRate(),za.prototype.featuresSourceset=za.canOverrideAttributes(),za.prototype.movingMediaElementInDOM=!Ke,za.prototype.featuresFullscreenResize=!0,za.prototype.featuresProgressEvents=!0,za.prototype.featuresTimeupdateEvents=!0,za.prototype.featuresNativeTextTracks=za.supportsNativeTextTracks(),za.prototype.featuresNativeVideoTracks=za.supportsNativeVideoTracks(),za.prototype.featuresNativeAudioTracks=za.supportsNativeAudioTracks();var Va=za.TEST_VID&&za.TEST_VID.constructor.prototype.canPlayType,Ga=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;function $a(){var e=o(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]);return $a=function(){return e},e}za.patchCanPlayType=function(){4<=Ze&&!tt&&!nt&&(za.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&Ga.test(e)?"maybe":Va.call(this,e)})},za.unpatchCanPlayType=function(){var e=za.TEST_VID.constructor.prototype.canPlayType;return za.TEST_VID.constructor.prototype.canPlayType=Va,e},za.patchCanPlayType(),za.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},za.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),i=t.length;i--;)e.removeChild(t[i]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){za.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(e){za.prototype["set"+Ne(e)]=function(t){(this.el_[e]=t)?this.el_.setAttribute(e,e):this.el_.removeAttribute(e)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){za.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(e){za.prototype["set"+Ne(e)]=function(t){this.el_[e]=t}}),["pause","load","play"].forEach(function(e){za.prototype[e]=function(){return this.el_[e]()}}),tr.withSourceHandlers(za),za.nativeSourceHandler={},za.nativeSourceHandler.canPlayType=function(e){try{return za.TEST_VID.canPlayType(e)}catch(e){return""}},za.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return za.nativeSourceHandler.canPlayType(e.type);if(e.src){var i=Rt(e.src);return za.nativeSourceHandler.canPlayType("video/"+i)}return""},za.nativeSourceHandler.handleSource=function(e,t,i){t.setSrc(e.src)},za.nativeSourceHandler.dispose=function(){},za.registerSourceHandler(za.nativeSourceHandler),tr.registerTech("Html5",za);var Ya=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Xa={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},Ka=["tiny","xsmall","small","medium","large","xlarge","huge"],Qa={};Ka.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;Qa[e]="vjs-layout-"+t});var Ja={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},Za=function(r){function a(e,t,n){var o;if(e.id=e.id||t.id||"vjs_video_"+Z(),(t=m(a.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var l=e.closest("[lang]");l&&l.getAttribute&&(t.language=l.getAttribute("lang"))}else for(var u=e;u&&1===u.nodeType;){if(D(u).hasOwnProperty("lang")){t.language=u.getAttribute("lang");break}u=u.parentNode}if((o=r.call(this,null,t,n)||this).boundDocumentFullscreenChange_=ke(s(o),o.documentFullscreenChange_),o.boundFullWindowOnEscKey_=ke(s(o),o.fullWindowOnEscKey),o.log=c(o.id_),o.fsApi_=gt,o.isPosterFromTech_=!1,o.queuedCallbacks_=[],o.isReady_=!1,o.hasStarted_=!1,o.userActive_=!1,!o.options_||!o.options_.techOrder||!o.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(o.tag=e,o.tagAttributes=e&&D(e),o.language(o.options_.language),t.languages){var h={};Object.getOwnPropertyNames(t.languages).forEach(function(e){h[e.toLowerCase()]=t.languages[e]}),o.languages_=h}else o.languages_=a.prototype.options_.languages;o.resetCache_(),o.poster_=t.poster||"",o.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),o.changingSrc_=!1,o.playCallbacks_=[],o.playTerminatedQueue_=[],e.hasAttribute("autoplay")?o.autoplay(!0):o.autoplay(o.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(function(e){if("function"!=typeof o[e])throw new Error('plugin "'+e+'" does not exist')}),o.scrubbing_=!1,o.el_=o.createEl(),De(s(o),{eventBusKey:"el_"}),o.fluid_&&o.on("playerreset",o.updateStyleEl_);var d=Be(o.options_);t.plugins&&Object.keys(t.plugins).forEach(function(e){o[e](t.plugins[e])}),o.options_.playerOptions=d,o.middleware_=[],o.initChildren(),o.isAudio("audio"===e.nodeName.toLowerCase()),o.controls()?o.addClass("vjs-controls-enabled"):o.addClass("vjs-controls-disabled"),o.el_.setAttribute("role","region"),o.isAudio()?o.el_.setAttribute("aria-label",o.localize("Audio Player")):o.el_.setAttribute("aria-label",o.localize("Video Player")),o.isAudio()&&o.addClass("vjs-audio"),o.flexNotSupported_()&&o.addClass("vjs-no-flex"),ut&&o.addClass("vjs-touch-enabled"),Ke||o.addClass("vjs-workinghover"),a.players[o.id_]=s(o);var f=i.split(".")[0];return o.addClass("vjs-v"+f),o.userActive(!0),o.reportUserActivity(),o.one("play",o.listenForUserActivity_),o.on("stageclick",o.handleStageClick_),o.on("keydown",o.handleKeyDown),o.breakpoints(o.options_.breakpoints),o.responsive(o.options_.responsive),o}n(a,r);var o=a.prototype;return o.dispose=function(){var e=this;this.trigger("dispose"),this.off("dispose"),he(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),he(t,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),a.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),nr[this.id()]=null,Cn.names.forEach(function(t){var i=e[Cn[t].getterName]();i&&i.off&&i.off()}),r.prototype.dispose.call(this)},o.createEl=function(){var i,n=this.tag,a=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),s="video-js"===this.tag.tagName.toLowerCase();a?i=this.el_=n.parentNode:s||(i=this.el_=r.prototype.createEl.call(this,"div"));var o=D(n);if(s){for(i=this.el_=n,n=this.tag=t.createElement("video");i.children.length;)n.appendChild(i.firstChild);A(i,"video-js")||P(i,"video-js"),i.appendChild(n),a=this.playerElIngest_=i,Object.keys(i).forEach(function(e){n[e]=i[e]})}if(n.setAttribute("tabindex","-1"),o.tabindex="-1",(at||nt&&lt)&&(n.setAttribute("role","application"),o.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in o&&delete o.width,"height"in o&&delete o.height,Object.getOwnPropertyNames(o).forEach(function(e){s&&"class"===e||i.setAttribute(e,o[e]),s&&n.setAttribute(e,o[e])}),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=i.player=this,this.addClass("vjs-paused"),!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Te("vjs-styles-dimensions");var l=X(".vjs-styles-defaults"),u=X("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var c=n.getElementsByTagName("a"),h=0;h<c.length;h++){var d=c.item(h);P(d,"vjs-hidden"),d.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!a&&n.parentNode.insertBefore(i,n),L(n,i),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=i},o.width=function(e){return this.dimension("width",e)},o.height=function(e){return this.dimension("height",e)},o.dimension=function(e,t){var i=e+"_";if(void 0===t)return this[i]||0;if(""===t)return this[i]=void 0,void this.updateStyleEl_();var n=parseFloat(t);isNaN(n)?u.error('Improper value "'+t+'" supplied for for '+e):(this[i]=n,this.updateStyleEl_())},o.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,Ie(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),function(e,t){Ie(e)?t():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(t))}(function(){this.on("playerreset",this.updateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},o.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},o.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},o.updateStyleEl_=function(){if(!0!==e.VIDEOJS_NO_DYNAMIC_STYLE){var t,i,n,r=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),a=r[1]/r[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/a:this.videoWidth()||300,i=void 0!==this.height_?this.height_:t*a,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),Se(this.styleEl_,"\n      ."+n+" {\n        width: "+t+"px;\n        height: "+i+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*a+"%;\n      }\n    ")}else{var s="number"==typeof this.width_?this.width_:this.options_.width,o="number"==typeof this.height_?this.height_:this.options_.height,l=this.tech_&&this.tech_.el();l&&(0<=s&&(l.width=s),0<=o&&(l.height=o))}},o.loadTech_=function(e,t){var i=this;this.tech_&&this.unloadTech_();var n=Ne(e),r=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==n&&this.tag&&(tr.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=n,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+r+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};Cn.names.forEach(function(e){var t=Cn[e];a[t.getterName]=i[t.privateName]}),m(a,this.options_[n]),m(a,this.options_[r]),m(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(a.startTime=this.cache_.currentTime);var s=tr.getTech(e);if(!s)throw new Error("No Tech named '"+n+"' exists! '"+n+"' should be registered using videojs.registerTech()'");this.tech_=new s(a),this.tech_.ready(ke(this,this.handleTechReady_),!0),function(e,t){e.forEach(function(e){var i=t.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return i.addCue(e)})}),t.textTracks()}(this.textTracksJson_||[],this.tech_),Ya.forEach(function(e){i.on(i.tech_,e,i["handleTech"+Ne(e)+"_"])}),Object.keys(Xa).forEach(function(e){i.on(i.tech_,e,function(t){0===i.tech_.playbackRate()&&i.tech_.seeking()?i.queuedCallbacks_.push({callback:i["handleTech"+Xa[e]+"_"].bind(i),event:t}):i["handleTech"+Xa[e]+"_"](t)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===n&&this.tag||L(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},o.unloadTech_=function(){var e=this;Cn.names.forEach(function(t){var i=Cn[t];e[i.privateName]=e[i.getterName]()}),this.textTracksJson_=function(e){var t=e.$$("track"),i=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=Ct(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===i.indexOf(e)}).map(Ct))}(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},o.tech=function(e){return void 0===e&&u.warn(h($a())),this.tech_},o.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},o.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},o.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},o.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},o.manualAutoplay_=function(e){var t=this;if(this.tech_&&"string"==typeof e){function i(){var e=t.muted();function i(){t.muted(e)}t.muted(!0),t.playTerminatedQueue_.push(i);var n=t.play();if(kt(n))return n.catch(i)}var n;if("any"===e&&!0!==this.muted()?kt(n=this.play())&&(n=n.catch(i)):n="muted"===e&&!0!==this.muted()?i():this.play(),kt(n))return n.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(i){t.trigger({type:"autoplay-failure",autoplay:e})})}},o.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,i="";"string"!=typeof t&&(t=e.src,i=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!i&&(i=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var i=e.cache_.sources.filter(function(e){return e.src===t});if(i.length)return i[0].type;for(var n=e.$$("source"),r=0;r<n.length;r++){var a=n[r];if(a.type&&a.src&&a.src===t)return a.type}return cr(t)}(this,t)),this.cache_.source=Be({},e,{src:t,type:i});for(var n=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),r=[],a=this.$$("source"),s=[],o=0;o<a.length;o++){var l=D(a[o]);r.push(l),l.src&&l.src===t&&s.push(l.src)}s.length&&!n.length?this.cache_.sources=r:n.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},o.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var i=function(e){return t.updateSourceCaches_(e)},n=this.currentSource().src,r=e.src;n&&!/^blob:/.test(n)&&/^blob:/.test(r)&&(this.lastSource_&&(this.lastSource_.tech===r||this.lastSource_.player===n)||(i=function(){})),i(r),e.src||this.tech_.one(["sourceset","loadstart"],function e(i){if("sourceset"!==i.type){var n=t.techGet("currentSrc");t.lastSource_.tech=n,t.updateSourceCaches_(n)}t.tech_.off(["sourceset","loadstart"],e)})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},o.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},o.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},o.handleTechRateChange_=function(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},o.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime();this.on("timeupdate",function i(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",i))})},o.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},o.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},o.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},o.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},o.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},o.handleTechFirstPlay_=function(){this.options_.starttime&&(u.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},o.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},o.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},o.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},o.handleTechClick_=function(e){Y(e)&&this.controls_&&(this.paused()?wt(this.play()):this.pause())},o.handleTechDoubleClick_=function(e){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(e.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},o.handleTechTap_=function(){this.userActive(!this.userActive())},o.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},o.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},o.handleTechTouchEnd_=function(e){e.preventDefault()},o.handleStageClick_=function(){this.reportUserActivity()},o.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},o.documentFullscreenChange_=function(e){var i=this.el(),n=t[this.fsApi_.fullscreenElement]===i;!n&&i.matches?n=i.matches(":"+this.fsApi_.fullscreen):!n&&i.msMatchesSelector&&(n=i.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(n),!1===this.isFullscreen()&&he(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed&&this.trigger("fullscreenchange")},o.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},o.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},o.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},o.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},o.handleTechError_=function(){var e=this.tech_.error();this.error(e)},o.handleTechTextData_=function(e,t){var i=null;1<arguments.length&&(i=t),this.trigger("textdata",i)},o.getCache=function(){return this.cache_},o.resetCache_=function(){this.cache_={currentTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},o.techCall_=function(e,t){this.ready(function(){if(e in or)return function(e,t,i,n){return t[i](e.reduce(ur(i),n))}(this.middleware_,this.tech_,e,t);if(e in lr)return ar(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw u(e),e}},!0)},o.techGet_=function(e){if(this.tech_&&this.tech_.isReady_){if(e in sr)return function(e,t,i){return e.reduceRight(ur(i),t[i]())}(this.middleware_,this.tech_,e);if(e in lr)return ar(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(o){if(void 0===this.tech_[e])throw u("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",o),o;if("TypeError"===o.name)throw u("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",o),this.tech_.isReady_=!1,o;throw u(o),o}}},o.play=function(){var t=this,i=this.options_.Promise||e.Promise;return i?new i(function(e){t.play_(e)}):this.play_()},o.play_=function(e){var t=this;void 0===e&&(e=wt),this.playCallbacks_.push(e);var i=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!i)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(i||!ot&&!Ke||this.load());var n=this.techGet_("play");null===n?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(n)},o.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})},o.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(t){t(e)})},o.pause=function(){this.techCall_("pause")},o.paused=function(){return!1!==this.techGet_("paused")},o.played=function(){return this.techGet_("played")||ft(0,0)},o.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},o.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},o.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&((this.cache_.duration=e)===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(e)||this.trigger("durationchange"))},o.remainingTime=function(){return this.duration()-this.currentTime()},o.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},o.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=ft(0,0)),e},o.bufferedPercent=function(){return pt(this.buffered(),this.duration())},o.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),i=e.end(e.length-1);return t<i&&(i=t),i},o.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},o.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},o.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},o.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},o.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},o.isFullscreen=function(e){return void 0!==e?(this.isFullscreen_=!!e,void this.toggleFullscreenClass_()):!!this.isFullscreen_},o.requestFullscreen=function(e){var i;this.isFullscreen(!0),this.fsApi_.requestFullscreen?(ce(t,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(i=e)),wt(this.el_[this.fsApi_.requestFullscreen](i))):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},o.exitFullscreen=function(){this.isFullscreen(!1),this.fsApi_.requestFullscreen?wt(t[this.fsApi_.exitFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},o.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=t.documentElement.style.overflow,ce(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow="hidden",P(t.body,"vjs-full-window"),this.trigger("enterFullWindow")},o.fullWindowOnEscKey=function(e){Et.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},o.exitFullWindow=function(){this.isFullWindow=!1,he(t,"keydown",this.boundFullWindowOnEscKey_),t.documentElement.style.overflow=this.docOrigOverflow,O(t.body,"vjs-full-window"),this.trigger("exitFullWindow")},o.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},o.requestPictureInPicture=function(){if("pictureInPictureEnabled"in t)return this.techGet_("requestPictureInPicture")},o.exitPictureInPicture=function(){if("pictureInPictureEnabled"in t)return t.exitPictureInPicture()},o.handleKeyDown=function(e){var t,i,n=this.options_.userActions;n&&n.hotkeys&&("input"===(i=(t=this.el_.ownerDocument.activeElement).tagName.toLowerCase())?-1!==["button","checkbox","hidden","radio","reset","submit"].indexOf(t.type):-1===["textarea"].indexOf(i))&&("function"==typeof n.hotkeys?n.hotkeys.call(this,e):this.handleHotkeys(e))},o.handleHotkeys=function(e){var i=this.options_.userActions?this.options_.userActions.hotkeys:{},n=i.fullscreenKey,r=i.muteKey,a=void 0===r?function(e){return Et.isEventKey(e,"m")}:r,s=i.playPauseKey,o=void 0===s?function(e){return Et.isEventKey(e,"k")||Et.isEventKey(e,"Space")}:s;if((void 0===n?function(e){return Et.isEventKey(e,"f")}:n).call(this,e)){e.preventDefault(),e.stopPropagation();var l=je.getComponent("FullscreenToggle");!1!==t[this.fsApi_.fullscreenEnabled]&&l.prototype.handleClick.call(this,e)}else a.call(this,e)?(e.preventDefault(),e.stopPropagation(),je.getComponent("MuteToggle").prototype.handleClick.call(this,e)):o.call(this,e)&&(e.preventDefault(),e.stopPropagation(),je.getComponent("PlayToggle").prototype.handleClick.call(this,e))},o.canPlayType=function(e){for(var t,i=0,n=this.options_.techOrder;i<n.length;i++){var r=n[i],a=tr.getTech(r);if(a=a||je.getComponent(r)){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else u.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.')}return""},o.selectSource=function(e){function t(e,t,i){var n;return e.some(function(e){return t.some(function(t){if(n=i(e,t))return!0})}),n}function i(e,t){var i=e[0];if(e[1].canPlaySource(t,r.options_[i.toLowerCase()]))return{source:t,tech:i}}var n,r=this,a=this.options_.techOrder.map(function(e){return[e,tr.getTech(e)]}).filter(function(e){var t=e[0],i=e[1];return i?i.isSupported():(u.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)});return(this.options_.sourceOrder?t(e,a,(n=i,function(e,t){return n(t,e)})):t(a,e,i))||!1},o.src=function(e){var t=this;if(void 0===e)return this.cache_.src||"";var i=function e(t){if(Array.isArray(t)){var i=[];t.forEach(function(t){t=e(t),Array.isArray(t)?i=i.concat(t):g(t)&&i.push(t)}),t=i}else t="string"==typeof t&&t.trim()?[dr({src:t})]:g(t)&&"string"==typeof t.src&&t.src&&t.src.trim()?[dr(t)]:[];return t}(e);i.length?(this.changingSrc_=!0,this.cache_.sources=i,this.updateSourceCaches_(i[0]),function(e,t,i){e.setTimeout(function(){return function e(t,i,n,r,a,s){void 0===t&&(t={}),void 0===i&&(i=[]),void 0===a&&(a=[]),void 0===s&&(s=!1);var o=i[0],l=i.slice(1);if("string"==typeof o)e(t,ir[o],n,r,a,s);else if(o){var u=function(e,t){var i=nr[e.id()],n=null;if(null==i)return n=t(e),nr[e.id()]=[[t,n]],n;for(var r=0;r<i.length;r++){var a=i[r];a[0]===t&&(n=a[1])}return null===n&&(n=t(e),i.push([t,n])),n}(r,o);if(!u.setSource)return a.push(u),e(t,l,n,r,a,s);u.setSource(m({},t),function(i,o){if(i)return e(t,l,n,r,a,s);a.push(u),e(o,t.type===o.type?l:ir[o.type],n,r,a,s)})}else l.length?e(t,l,n,r,a,s):s?n(t,a):e(t,ir["*"],n,r,a,!0)}(t,ir[t.type],i,e)},1)}(this,i[0],function(e,n){if(t.middleware_=n,t.cache_.sources=i,t.updateSourceCaches_(e),t.src_(e))return 1<i.length?t.src(i.slice(1)):(t.changingSrc_=!1,t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void t.triggerReady());!function(e,t){e.forEach(function(e){return e.setTech&&e.setTech(t)})}(n,t.tech_)})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},o.src_=function(e){var t=this,i=this.selectSource([e]);return!i||(function(e,t){return Ne(i.tech)===Ne(t)}(0,this.techName_)?this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0):(this.changingSrc_=!0,this.loadTech_(i.tech,i.source),this.tech_.ready(function(){t.changingSrc_=!1})),!1)},o.load=function(){this.techCall_("load")},o.reset=function(){var t=this,i=this.options_.Promise||e.Promise;this.paused()||!i?this.doReset_():wt(this.play().then(function(){return t.doReset_()}))},o.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),Ie(this)&&this.trigger("playerreset")},o.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},o.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,i=e.remainingTimeDisplay;t&&t.updateContent(),i&&i.updateContent()},o.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},o.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},o.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},o.currentSource=function(){return this.cache_.source||{}},o.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},o.currentType=function(){return this.currentSource()&&this.currentSource().type||""},o.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},o.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},o.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},o.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},o.poster=function(e){if(void 0===e)return this.poster_;(e=e||"")!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},o.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},o.controls=function(e){if(void 0===e)return!!this.controls_;this.controls_!==(e=!!e)&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},o.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;this.usingNativeControls_!==(e=!!e)&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},o.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&e.message&&e.message===this.localize(this.options_.notSupportedMessage)){function t(){this.error(e)}return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",function(){this.off(["click","touchstart"],t)})}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new Tt(e),this.addClass("vjs-error"),u.error("(CODE:"+this.error_.code+" "+Tt.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},o.reportUserActivity=function(e){this.userActivity_=!0},o.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},o.listenForUserActivity_=function(){var e,t,i,n=ke(this,this.reportUserActivity);this.on("mousedown",function(){n(),this.clearInterval(e),e=this.setInterval(n,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===i||(t=e.screenX,i=e.screenY,n())}),this.on("mouseup",function(t){n(),this.clearInterval(e)});var r,a=this.getChild("controlBar");!a||Ke||Je||(a.on("mouseenter",function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),a.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",n),this.on("keyup",n),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(r);var e=this.options_.inactivityTimeout;e<=0||(r=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},o.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},o.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},o.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},o.addTextTrack=function(e,t,i){if(this.tech_)return this.tech_.addTextTrack(e,t,i)},o.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},o.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t=t||e,this.tech_)return this.tech_.removeRemoteTextTrack(t)},o.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},o.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},o.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},o.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},o.languages=function(){return Be(a.prototype.options_.languages,this.languages_)},o.toJSON=function(){var e=Be(this.options_),t=e.tracks;e.tracks=[];for(var i=0;i<t.length;i++){var n=t[i];(n=Be(n)).player=void 0,e.tracks[i]=n}return e},o.createModal=function(e,t){var i=this;(t=t||{}).content=e||"";var n=new At(this,t);return this.addChild(n),n.on("dispose",function(){i.removeChild(n)}),n.open(),n},o.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),i=0;i<Ka.length;i++){var n=Ka[i];if(t<=this.breakpoints_[n]){if(e===n)return;e&&this.removeClass(Qa[e]),this.addClass(Qa[n]),this.breakpoint_=n;break}}},o.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},o.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=m({},Ja,e),this.updateCurrentBreakpoint_()),m(this.breakpoints_)},o.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?((this.responsive_=e)?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},o.currentBreakpoint=function(){return this.breakpoint_},o.currentBreakpointClass=function(){return Qa[this.breakpoint_]||""},o.loadMedia=function(e,t){var i=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=Be(e);var n=this.cache_.media,r=n.poster,a=n.src,s=n.textTracks;!n.artwork&&r&&(this.cache_.media.artwork=[{src:r,type:cr(r)}]),a&&this.src(a),r&&this.poster(r),Array.isArray(s)&&s.forEach(function(e){return i.addRemoteTextTrack(e,!1)}),this.ready(t)}},o.getMedia=function(){if(this.cache_.media)return Be(this.cache_.media);var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:cr(t.poster)}]),t},a.getTagSettings=function(e){var t={sources:[],tracks:[]},i=D(e),n=i["data-setup"];if(A(e,"vjs-fill")&&(i.fill=!0),A(e,"vjs-fluid")&&(i.fluid=!0),null!==n){var r=function(e,t){var i,n=null;try{i=JSON.parse(e,void 0)}catch(e){n=e}return[n,i]}(n||"{}"),a=r[0],s=r[1];a&&u.error(a),m(i,s)}if(m(t,i),e.hasChildNodes())for(var o=e.childNodes,l=0,c=o.length;l<c;l++){var h=o[l],d=h.nodeName.toLowerCase();"source"===d?t.sources.push(D(h)):"track"===d&&t.tracks.push(D(h))}return t},o.flexNotSupported_=function(){var e=t.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},a}(je);Cn.names.forEach(function(e){var t=Cn[e];Za.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),Za.players={};var es=e.navigator;function ts(e){return ls.hasOwnProperty(e)}function is(e){return ts(e)?ls[e]:void 0}function ns(e,t){e[os]=e[os]||{},e[os][t]=!0}function rs(e,t,i){var n=(i?"before":"")+"pluginsetup";e.trigger(n,t),e.trigger(n+":"+t.name,t)}function as(e,t){return t.prototype.name=e,function(){rs(this,{name:e,plugin:t,instance:null},!0);for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=a(t,[this].concat(n));return this[e]=function(){return s},rs(this,s.getEventHash()),s}}Za.prototype.options_={techOrder:tr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:es&&(es.languages&&es.languages[0]||es.userLanguage||es.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){Za.prototype[e]=function(){return this.techGet_(e)}}),Ya.forEach(function(e){Za.prototype["handleTech"+Ne(e)+"_"]=function(){return this.trigger(e)}}),je.registerComponent("Player",Za);var ss="plugin",os="activePlugins_",ls={},us=function(){function e(t){if(this.constructor===e)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t,De(this),delete this.trigger,Re(this,this.constructor.defaultState),ns(t,this.name),this.dispose=ke(this,this.dispose),t.on("dispose",this.dispose)}var t=e.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},t.trigger=function(e,t){return void 0===t&&(t={}),de(this.eventBusEl_,e,this.getEventHash(t))},t.handleStateChanged=function(e){},t.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[os][e]=!1,this.player=this.state=null,t[e]=as(e,ls[e])},e.isBasic=function(t){var i="string"==typeof t?is(t):t;return"function"==typeof i&&!e.prototype.isPrototypeOf(i.prototype)},e.registerPlugin=function(t,i){if("string"!=typeof t)throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(ts(t))u.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(Za.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if("function"!=typeof i)throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof i+".");return ls[t]=i,t!==ss&&(Za.prototype[t]=e.isBasic(i)?function(e,t){function i(){rs(this,{name:e,plugin:t,instance:null},!0);var i=t.apply(this,arguments);return ns(this,e),rs(this,{name:e,plugin:t,instance:i}),i}return Object.keys(t).forEach(function(e){i[e]=t[e]}),i}(t,i):as(t,i)),i},e.deregisterPlugin=function(e){if(e===ss)throw new Error("Cannot de-register base plugin.");ts(e)&&(delete ls[e],delete Za.prototype[e])},e.getPlugins=function(e){var t;return void 0===e&&(e=Object.keys(ls)),e.forEach(function(e){var i=is(e);i&&((t=t||{})[e]=i)}),t},e.getPluginVersion=function(e){var t=is(e);return t&&t.VERSION||""},e}();us.getPlugin=is,us.BASE_PLUGIN_NAME=ss,us.registerPlugin(ss,us),Za.prototype.usingPlugin=function(e){return!!this[os]&&!0===this[os][e]},Za.prototype.hasPlugin=function(e){return!!ts(e)};var cs=function(e){return 0===e.indexOf("#")?e.slice(1):e};function hs(e,t,i){var n=hs.getPlayer(e);if(n)return t&&u.warn('Player "'+e+'" is already initialised. Options will not be applied.'),i&&n.ready(i),n;var r="string"==typeof e?X("#"+cs(e)):e;if(!k(r))throw new TypeError("The element or ID supplied is not valid. (videojs)");r.ownerDocument.defaultView&&r.ownerDocument.body.contains(r)||u.warn("The element supplied is not included in the DOM"),t=t||{},hs.hooks("beforesetup").forEach(function(e){var i=e(r,Be(t));g(i)&&!Array.isArray(i)?t=Be(t,i):u.error("please return an object in beforesetup hooks")});var a=je.getComponent("Player");return n=new a(r,t,i),hs.hooks("setup").forEach(function(e){return e(n)}),n}if(hs.hooks_={},hs.hooks=function(e,t){return hs.hooks_[e]=hs.hooks_[e]||[],t&&(hs.hooks_[e]=hs.hooks_[e].concat(t)),hs.hooks_[e]},hs.hook=function(e,t){hs.hooks(e,t)},hs.hookOnce=function(e,t){hs.hooks(e,[].concat(t).map(function(t){return function i(){return hs.removeHook(e,i),t.apply(void 0,arguments)}}))},hs.removeHook=function(e,t){var i=hs.hooks(e).indexOf(t);return!(i<=-1||(hs.hooks_[e]=hs.hooks_[e].slice(),hs.hooks_[e].splice(i,1),0))},!0!==e.VIDEOJS_NO_DYNAMIC_STYLE&&S()){var ds=X(".vjs-styles-defaults");if(!ds){ds=Te("vjs-styles-defaults");var fs=X("head");fs&&fs.insertBefore(ds,fs.firstChild),Se(ds,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}_e(1,hs),hs.VERSION=i,hs.options=Za.prototype.options_,hs.getPlayers=function(){return Za.players},hs.getPlayer=function(e){var t,i=Za.players;if("string"==typeof e){var n=cs(e),r=i[n];if(r)return r;t=X("#"+n)}else t=e;if(k(t)){var a=t.player,s=t.playerId;if(a||i[s])return a||i[s]}},hs.getAllPlayers=function(){return Object.keys(Za.players).map(function(e){return Za.players[e]}).filter(Boolean)},hs.players=Za.players,hs.getComponent=je.getComponent,hs.registerComponent=function(e,t){tr.isTech(t)&&u.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),je.registerComponent.call(je,e,t)},hs.getTech=tr.getTech,hs.registerTech=tr.registerTech,hs.use=function(e,t){ir[e]=ir[e]||[],ir[e].push(t)},Object.defineProperty(hs,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(hs.middleware,"TERMINATOR",{value:rr,writeable:!1,enumerable:!0}),hs.browser=ct,hs.TOUCH_ENABLED=ut,hs.extend=function(e,t){void 0===t&&(t={});var i=function(){e.apply(this,arguments)},n={};for(var r in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),n=t):"function"==typeof t&&(i=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(i,e),n)n.hasOwnProperty(r)&&(i.prototype[r]=n[r]);return i},hs.mergeOptions=Be,hs.bind=ke,hs.registerPlugin=us.registerPlugin,hs.deregisterPlugin=us.deregisterPlugin,hs.plugin=function(e,t){return u.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),us.registerPlugin(e,t)},hs.getPlugins=us.getPlugins,hs.getPlugin=us.getPlugin,hs.getPluginVersion=us.getPluginVersion,hs.addLanguage=function(e,t){var i;return e=(""+e).toLowerCase(),(hs.options.languages=Be(hs.options.languages,((i={})[e]=t,i)))[e]},hs.log=u,hs.createLogger=c,hs.createTimeRange=hs.createTimeRanges=ft,hs.formatTime=Lr,hs.setFormatTime=function(e){Er=e},hs.resetFormatTime=function(){Er=xr},hs.parseUrl=Dt,hs.isCrossOrigin=Nt,hs.EventTarget=Ce,hs.on=ce,hs.one=fe,hs.off=he,hs.trigger=de,hs.xhr=pn,hs.TextTrack=bn,hs.AudioTrack=_n,hs.VideoTrack=Tn,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){hs[e]=function(){return u.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),Q[e].apply(null,arguments)}}),hs.computedStyle=y,hs.dom=Q,hs.url=Yt;var ps=xt(function(e,t){var i,n,r,a,s;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,h=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(h)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s});function ms(){return(ms=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}function gs(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function vs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ys(e){for(var t,i=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n={},r=i.length;r--;)""!==i[r]&&((t=/([^=]*)=(.*)/.exec(i[r]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),n[t[0]]=t[1]);return n}function bs(e){return!!e&&"object"==typeof e}function _s(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce(function(e,t){return Object.keys(t).forEach(function(i){e[i]=Array.isArray(e[i])&&Array.isArray(t[i])?e[i].concat(t[i]):bs(e[i])&&bs(t[i])?_s(e[i],t[i]):t[i]}),e},{})}function Ts(e){return e.reduce(function(e,t){return e.concat(t)},[])}function Ss(e){if(!e.length)return[];for(var t=[],i=0;i<e.length;i++)t.push(e[i]);return t}var ks=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e].splice(i,1),-1<i},t.trigger=function(e,t){var i,n,r,a=this.listeners[e];if(a)if(2===arguments.length)for(n=a.length,i=0;i<n;++i)a[i].call(this,t);else for(r=Array.prototype.slice.call(arguments,1),n=a.length,i=0;i<n;++i)a[i].apply(this,r)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},e}(),ws=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return gs(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(ks),Cs=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}gs(t,e);var i=t.prototype;return i.push=function(e){var t,i,n=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce(function(t,i){var n=i(e);return n===e?t:t.concat([n])},[e]).forEach(function(e){for(var r=0;r<n.customParsers.length;r++)if(n.customParsers[r].call(n,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))n.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),void n.trigger("data",i);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"totalduration"},t[1]&&(i.duration=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),void n.trigger("data",i);if(t=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"byterange"},t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),void n.trigger("data",i);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),void n.trigger("data",i);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"map"},t[1]){var a=ys(t[1]);if(a.URI&&(i.uri=a.URI),a.BYTERANGE){var s=a.BYTERANGE.split("@"),o=s[0],l=s[1];i.byterange={},o&&(i.byterange.length=parseInt(o,10)),l&&(i.byterange.offset=parseInt(l,10))}}n.trigger("data",i)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"stream-inf"},t[1]){if(i.attributes=ys(t[1]),i.attributes.RESOLUTION){var u=i.attributes.RESOLUTION.split("x"),c={};u[0]&&(c.width=parseInt(u[0],10)),u[1]&&(c.height=parseInt(u[1],10)),i.attributes.RESOLUTION=c}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}n.trigger("data",i)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return i={type:"tag",tagType:"media"},t[1]&&(i.attributes=ys(t[1])),void n.trigger("data",i);if(t=/^#EXT-X-ENDLIST/.exec(e))n.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))n.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),void n.trigger("data",i);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return i={type:"tag",tagType:"key"},t[1]&&(i.attributes=ys(t[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void n.trigger("data",i);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return i={type:"tag",tagType:"start"},t[1]&&(i.attributes=ys(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void n.trigger("data",i);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return(i={type:"tag",tagType:"cue-out-cont"}).data=t[1]?t[1]:"",void n.trigger("data",i);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return(i={type:"tag",tagType:"cue-out"}).data=t[1]?t[1]:"",void n.trigger("data",i);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return(i={type:"tag",tagType:"cue-in"}).data=t[1]?t[1]:"",void n.trigger("data",i);n.trigger("data",{type:"tag",data:e.slice(4)})}}}else n.trigger("data",{type:"comment",text:e.slice(1)})}):this.trigger("data",{type:"uri",uri:e}))},i.addParser=function(e){var t=this,i=e.expression,n=e.customType,r=e.dataParser,a=e.segment;"function"!=typeof r&&(r=function(e){return e}),this.customParsers.push(function(e){if(i.exec(e))return t.trigger("data",{type:"custom",data:r(e),customType:n,segment:a}),!0})},i.addTagMapper=function(e){var t=e.expression,i=e.map;this.tagMappers.push(function(e){return t.test(e)?i(e):e})},t}(ks),xs=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new ws,t.parseStream=new Cs,t.lineStream.pipe(t.parseStream);var i,n,r=vs(vs(t)),a=[],s={},o={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},l=0;return t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},t.parseStream.on("data",function(e){var t,u;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&((s.byterange=t).length=e.length,"offset"in e||(this.trigger("info",{message:"defaulting offset to zero"}),e.offset=0)),"offset"in e&&((s.byterange=t).offset=e.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<e.duration&&(s.duration=e.duration),0===e.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=a},key:function(){e.attributes?"NONE"!==e.attributes.METHOD?e.attributes.URI?(e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(n.iv=e.attributes.IV)):this.trigger("warn",{message:"ignoring key declaration without URI"}):n=null:this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,l=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){i={},e.uri&&(i.uri=e.uri),e.byterange&&(i.byterange=e.byterange)},"stream-inf":function(){this.manifest.playlists=a,this.manifest.mediaGroups=this.manifest.mediaGroups||o,e.attributes?(s.attributes||(s.attributes={}),ms(s.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||o,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var i=this.manifest.mediaGroups[e.attributes.TYPE];i[e.attributes["GROUP-ID"]]=i[e.attributes["GROUP-ID"]]||{},t=i[e.attributes["GROUP-ID"]],u.autoselect=!!(u={default:/yes/i.test(e.attributes.DEFAULT)}).default||/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(u.language=e.attributes.LANGUAGE),e.attributes.URI&&(u.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(u.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(u.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(u.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=u}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){l+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(a.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),s.dateTimeString=e.dateTimeString,s.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):this.manifest.targetDuration=e.duration},totalduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+e.duration}):this.manifest.totalDuration=e.duration},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){s.cueOut=e.data},"cue-out-cont":function(){s.cueOutCont=e.data},"cue-in":function(){s.cueIn=e.data}}[e.tagType]||function(){}).call(r)},uri:function(){s.uri=e.uri,a.push(s),!this.manifest.targetDuration||"duration"in s||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),n&&(s.key=n),s.timeline=l,i&&(s.map=i),s={}},comment:function(){},custom:function(){e.segment?(s.custom=s.custom||{},s.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(r)}),t}gs(t,e);var i=t.prototype;return i.push=function(e){this.lineStream.push(e)},i.end=function(){this.lineStream.push("\n")},i.addParser=function(e){this.parseStream.addParser(e)},i.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(ks),Es="INVALID_NUMBER_OF_PERIOD",Ls="DASH_EMPTY_MANIFEST",As="DASH_INVALID_XML",Ps="NO_BASE_URL",Os="SEGMENT_TIME_UNSPECIFIED";function Is(t,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(t)||(t=Ks.buildAbsoluteURL(e.location.href,t)),Ks.buildAbsoluteURL(t,i))}function Ms(e){var t=e.baseUrl,i=e.source,n=void 0===i?"":i,r=e.range,a=void 0===r?"":r,s=e.indexRange,o=void 0===s?"":s,l={uri:n,resolvedUri:Is((void 0===t?"":t)||"",n)};if(a||o){var u=(a||o).split("-"),c=parseInt(u[0],10),h=parseInt(u[1],10);l.byterange={length:h-c+1,offset:c}}return l}function Ds(e){var t=e.type,i=void 0===t?"static":t,n=e.duration,r=e.timescale,a=void 0===r?1:r,s=e.sourceDuration,o=Qs[i](e),l=function(e,t){for(var i=[],n=o.start;n<t;n++)i.push(n);return i}(0,o.end).map(function(e){return function(t,i){var n=e.duration,r=e.timescale,a=e.startNumber;return{number:(void 0===a?1:a)+t,duration:n/(void 0===r?1:r),timeline:e.periodIndex,time:i*n}}}(e));if("static"===i){var u=l.length-1;l[u].duration=s-n/a*u}return l}function Us(e){var t=e.baseUrl,i=e.initialization,n=void 0===i?{}:i,r=e.sourceDuration,a=e.timescale,s=void 0===a?1:a,o=e.indexRange,l=void 0===o?"":o,u=e.duration;if(!t)throw new Error(Ps);var c=Ms({baseUrl:t,source:n.sourceURL,range:n.range}),h=Ms({baseUrl:t,source:t,indexRange:l});if(h.map=c,u){var d=Ds(e);d.length&&(h.duration=d[0].duration,h.timeline=d[0].timeline)}else r&&(h.duration=r/s,h.timeline=0);return h.number=0,[h]}function Rs(e,t,i){for(var n=e.sidx.map?e.sidx.map:null,r=e.sidx.duration,a=e.timeline||0,s=e.sidx.byterange,o=s.offset+s.length,l=t.timescale,u=t.references.filter(function(e){return 1!==e.referenceType}),c=[],h=o+t.firstOffset,d=0;d<u.length;d++){var f=t.references[d],p=f.referencedSize,m=Us({baseUrl:i,timescale:l,timeline:a,periodIndex:a,duration:f.subsegmentDuration,sourceDuration:r,indexRange:h+"-"+(h+p-1)})[0];n&&(m.map=n),c.push(m),h+=p}return e.segments=c,e}function Ns(e){return(t=e.reduce(function(e,t){var i,n=t.attributes.id+(t.attributes.lang||"");return e[n]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(i=e[n].segments).push.apply(i,t.segments),t.attributes.contentProtection&&(e[n].attributes.contentProtection=t.attributes.contentProtection)):e[n]=t,e},{}),Object.keys(t).map(function(e){return t[e]})).map(function(e){return e.discontinuityStarts=function(e,t){return e.reduce(function(e,t,i){return t.discontinuity&&e.push(i),e},[])}(e.segments),e});var t}function Bs(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var i in e){var n=e[i];if(n.sidx){var r=n.sidx.uri+"-"+(s=n.sidx.byterange).offset+"-"+(s.offset+s.length-1),a=t[r]&&t[r].sidx;n.sidx&&a&&Rs(n,a,n.sidx.resolvedUri)}}var s;return e}function js(e){var t,i=e.attributes,n=e.segments,r=e.sidx,a={attributes:(t={NAME:i.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:i.width,height:i.height},CODECS:i.codecs,BANDWIDTH:i.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};return i.contentProtection&&(a.contentProtection=i.contentProtection),r&&(a.sidx=r),a}function Fs(e,t){for(var i,n,r,a,s,o=e.type,l=void 0===o?"static":o,u=e.minimumUpdatePeriod,c=void 0===u?0:u,h=e.media,d=void 0===h?"":h,f=e.sourceDuration,p=e.timescale,m=void 0===p?1:p,g=e.startNumber,v=void 0===g?1:g,y=e.periodIndex,b=[],_=-1,T=0;T<t.length;T++){var S=t[T],k=S.d,w=S.r||0,C=S.t||0;_<0&&(_=C),C&&_<C&&(_=C);var x=void 0;if(w<0){var E=T+1;x=E===t.length?"dynamic"===l&&0<c&&0<d.indexOf("$Number$")?(n=(i=e).NOW,r=i.timescale,a=i.start,s=i.minimumUpdatePeriod,Math.ceil((((n+i.clientOffset)/1e3+(void 0===s?0:s)-(i.availabilityStartTime+(void 0===a?0:a)))*(void 0===r?1:r)-_)/k)):(f*m-_)/k:(t[E].t-_)/k}else x=w+1;for(var L=v+b.length+x,A=v+b.length;A<L;)b.push({number:A,duration:k/m,time:_,timeline:y}),_+=k,A++}return b}function Hs(e,t){return e.replace(Js,(i=t,function(e,t,n,r){if("$$"===e)return"$";if(void 0===i[t])return e;var a=""+i[t];return"RepresentationID"===t?a:(r=n?parseInt(r,10):1)<=a.length?a:new Array(r-a.length+1).join("0")+a}));var i}function Ws(e,t){var i={RepresentationID:e.id,Bandwidth:e.bandwidth||0},n=e.initialization,r=void 0===n?{sourceURL:"",range:""}:n,a=Ms({baseUrl:e.baseUrl,source:Hs(r.sourceURL,i),range:r.range});return function(e,t){return e.duration||t?e.duration?Ds(e):Fs(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(e,t).map(function(t){i.Number=t.number,i.Time=t.time;var n=Hs(e.media||"",i);return{uri:n,timeline:t.timeline,duration:t.duration,resolvedUri:Is(e.baseUrl||"",n),map:a,number:t.number}})}function zs(e,t){var i=e.duration,n=e.segmentUrls,r=void 0===n?[]:n;if(!i&&!t||i&&t)throw new Error(Os);var a,s=r.map(function(t){return function(e,t){var i=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,a=Ms({baseUrl:i,source:r.sourceURL,range:r.range}),s=Ms({baseUrl:i,source:t.media,range:t.mediaRange});return s.map=a,s}(e,t)});return i&&(a=Ds(e)),t&&(a=Fs(e,t)),a.map(function(e,t){if(s[t]){var i=s[t];return i.timeline=e.timeline,i.duration=e.duration,i.number=e.number,i}}).filter(function(e){return e})}function qs(e){var t,i,n=e.attributes,r=e.segmentInfo;r.template?(i=Ws,t=_s(n,r.template)):r.base?(i=Us,t=_s(n,r.base)):r.list&&(i=zs,t=_s(n,r.list));var a={attributes:n};if(!i)return a;var s=i(t,r.timeline);if(t.duration){var o=t.timescale;t.duration=t.duration/(void 0===o?1:o)}else t.duration=s.length?s.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):0;return a.attributes=t,a.segments=s,r.base&&t.indexRange&&(a.sidx=s[0],a.segments=[]),a}function Vs(e,t){return Ss(e.childNodes).filter(function(e){return e.tagName===t})}function Gs(e){return e.textContent.trim()}function $s(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var i=t.slice(1),n=i[1],r=i[2],a=i[3],s=i[4],o=i[5];return 31536e3*parseFloat(i[0]||0)+2592e3*parseFloat(n||0)+86400*parseFloat(r||0)+3600*parseFloat(a||0)+60*parseFloat(s||0)+parseFloat(o||0)}function Ys(e){return e&&e.attributes?Ss(e.attributes).reduce(function(e,t){return e[t.name]=(Zs[t.name]||Zs.DEFAULT)(t.value),e},{}):{}}var Xs,Ks=(function(e,t){var i,n,r,a,s;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,n=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=s.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=s.normalizePath(r.path),s.buildURLFromParts(r)}var a=s.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return i.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=s.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,h=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(h)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=i.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(e){var t=i.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=s}(Xs={exports:{}}),Xs.exports),Qs={static:function(e){var t=e.timescale;return{start:0,end:Math.ceil(e.sourceDuration/(e.duration/(void 0===t?1:t)))}},dynamic:function(e){var t=e.timescale,i=void 0===t?1:t,n=e.duration,r=e.start,a=e.minimumUpdatePeriod,s=e.timeShiftBufferDepth,o=void 0===s?1/0:s,l=(e.NOW+e.clientOffset)/1e3,u=e.availabilityStartTime+(void 0===r?0:r),c=Math.ceil((l+(void 0===a?0:a)-u)*i/n),h=Math.floor((l-u-o)*i/n),d=Math.floor((l-u)*i/n);return{start:Math.max(0,h),end:Math.min(c,d)}}},Js=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,Zs={mediaPresentationDuration:function(e){return $s(e)},availabilityStartTime:function(e){return function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),Date.parse(e)}(e)/1e3},minimumUpdatePeriod:function(e){return $s(e)},timeShiftBufferDepth:function(e){return $s(e)},start:function(e){return $s(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?$s(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}};function eo(e,t){return t.length?Ts(e.map(function(e){return t.map(function(t){return Is(e,Gs(t))})})):e}function to(e){var t=Vs(e,"SegmentTemplate")[0],i=Vs(e,"SegmentList")[0],n=i&&Vs(i,"SegmentURL").map(function(e){return _s({tag:"SegmentURL"},Ys(e))}),r=Vs(e,"SegmentBase")[0],a=i||t,s=a&&Vs(a,"SegmentTimeline")[0],o=i||r||t,l=o&&Vs(o,"Initialization")[0],u=t&&Ys(t);u&&l?u.initialization=l&&Ys(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var c={template:u,timeline:s&&Vs(s,"S").map(function(e){return Ys(e)}),list:i&&_s(Ys(i),{segmentUrls:n,initialization:Ys(l)}),base:r&&_s(Ys(r),{initialization:Ys(l)})};return Object.keys(c).forEach(function(e){c[e]||delete c[e]}),c}function io(t){if(""===t)throw new Error(Ls);var i=(new e.DOMParser).parseFromString(t,"application/xml"),n=i&&"MPD"===i.documentElement.tagName?i.documentElement:null;if(!n||n&&0<n.getElementsByTagName("parsererror").length)throw new Error(As);return n}function no(t,i){return void 0===i&&(i={}),function(e,t){var i;if(void 0===t&&(t={}),!e.length)return{};var n=e[0].attributes,r=n.sourceDuration,a=n.minimumUpdatePeriod,s=void 0===a?0:a,o=Ns(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(js),l=Ns(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),u=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),c={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(i={AUDIO:{},VIDEO:{}},i["CLOSED-CAPTIONS"]={},i.SUBTITLES={},i),uri:"",duration:r,playlists:Bs(o,t),minimumUpdatePeriod:1e3*s};return l.length&&(c.mediaGroups.AUDIO.audio=function(e,t){var i;void 0===t&&(t={});var n=l.reduce(function(e,n){var r=n.attributes.role&&n.attributes.role.value||"",a=n.attributes.lang||"",s="main";return a&&(s=n.attributes.lang+(r?" ("+r+")":"")),e[s]&&e[s].playlists[0].attributes.BANDWIDTH>n.attributes.bandwidth||(e[s]={language:a,autoselect:!0,default:"main"===r,playlists:Bs([function(e){var t,i=e.attributes,n=e.segments,r=e.sidx,a={attributes:(t={NAME:i.id,BANDWIDTH:i.bandwidth,CODECS:i.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1};return i.contentProtection&&(a.contentProtection=i.contentProtection),r&&(a.sidx=r),a}(n)],t),uri:""},void 0===i&&"main"===r&&((i=n).default=!0)),e},{});return i||(n[Object.keys(n)[0]].default=!0),n}(0,t)),u.length&&(c.mediaGroups.SUBTITLES.subs=function(e,t){return void 0===t&&(t={}),u.reduce(function(e,i){var n=i.attributes.lang||"text";return e[n]||(e[n]={language:n,default:!1,autoselect:!1,playlists:Bs([function(e){var t,i=e.attributes,n=e.segments;return void 0===n&&(n=[{uri:i.baseUrl,timeline:i.periodIndex,resolvedUri:i.baseUrl||"",duration:i.sourceDuration,number:0}],i.duration=i.sourceDuration),{attributes:(t={NAME:i.id,BANDWIDTH:i.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(i.type||"static"),timeline:i.periodIndex,resolvedUri:i.baseUrl||"",targetDuration:i.duration,segments:n,mediaSequence:n.length?n[0].number:1}}(i)],t),uri:""}),e},{})}(0,t)),c}(function(e){return e.map(qs)}(function(t,i){void 0===i&&(i={});var n=i,r=n.manifestUri,a=void 0===r?"":r,s=n.NOW,o=void 0===s?Date.now():s,l=n.clientOffset,u=void 0===l?0:l,c=Vs(t,"Period");if(!c.length)throw new Error(Es);var h=Ys(t),d=eo([a],Vs(t,"BaseURL"));return h.sourceDuration=h.mediaPresentationDuration||0,h.NOW=o,h.clientOffset=u,Ts(c.map(function(t,i){return function(n,r){var a=eo(i,Vs(n,"BaseURL")),s=Ys(n),o=parseInt(s.id,10),l=e.isNaN(o)?r:o,u=_s(t,{periodIndex:l}),c=Vs(n,"AdaptationSet"),h=to(n);return Ts(c.map(function(t,i,n){return function(r){var a=Ys(r),s=eo(i,Vs(r,"BaseURL")),o={role:Ys(Vs(r,"Role")[0])},l=_s(t,a,o),u=function(t){return t.reduce(function(t,i){var n=Ys(i),r=uo[n.schemeIdUri];if(r){t[r]={attributes:n};var a=Vs(i,"cenc:pssh")[0];if(a){var s=Gs(a),o=s&&function(t){for(var i=e.atob(s),n=new Uint8Array(i.length),r=0;r<i.length;r++)n[r]=i.charCodeAt(r);return n}();t[r].pssh=o}}return t},{})}(Vs(r,"ContentProtection"));Object.keys(u).length&&(l=_s(l,{contentProtection:u}));var c=to(r),h=Vs(r,"Representation"),d=_s(n,c);return Ts(h.map(function(e,t,i){return function(n){var r=Vs(n,"BaseURL"),a=eo(t,r),s=_s(e,Ys(n)),o=to(n);return a.map(function(e){return{segmentInfo:_s(i,o),attributes:_s(s,{baseUrl:e})}})}}(l,s,d)))}}(u,a,h)))}}(h,d)))}(io(t),i)),i.sidxMapping)}var ro,ao,so,oo,lo,uo={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},co=function(e){return e>>>0};function ho(e){return new Date(1e3*e-20828448e5)}function fo(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}so=function(e){return ro(e,["moov","trak"]).reduce(function(e,t){var i,n,r,a;return(i=ro(t,["tkhd"])[0])?(r=co(i[n=0===i[0]?12:20]<<24|i[n+1]<<16|i[n+2]<<8|i[n+3]),(a=ro(t,["mdia","mdhd"])[0])?(e[r]=co(a[n=0===a[0]?12:20]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3]),e):null):null},{})},oo=function(e,t){var i,n,r;return i=ro(t,["moof","traf"]),n=[].concat.apply([],i.map(function(t){return ro(t,["tfhd"]).map(function(i){var n,r;return n=co(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),r=e[n]||9e4,(ro(t,["tfdt"]).map(function(e){var t,i;return t=e[0],i=co(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(i*=Math.pow(2,32),i+=co(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i})[0]||1/0)/r})})),r=Math.min.apply(null,n),isFinite(r)?r:0},lo=function(e){var t=ro(e,["moov","trak"]),i=[];return t.forEach(function(e){var t=ro(e,["mdia","hdlr"]),n=ro(e,["tkhd"]);t.forEach(function(e,t){var r,a,s=ao(e.subarray(8,12)),o=n[t];"vide"===s&&(a=0===(r=new DataView(o.buffer,o.byteOffset,o.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),i.push(a))})}),i};var po,mo,go,vo,yo,bo,_o,To,So,ko,wo,Co,xo,Eo,Lo,Ao,Po,Oo,Io,Mo,Do,Uo,Ro,No,Bo,jo,Fo,Ho,Wo,zo,qo,Vo,Go,$o,Yo,Xo,Ko,Qo,Jo,Zo,el,tl,il={findBox:ro=function(e,t){var i,n,r,a,s,o=[];if(!t.length)return null;for(i=0;i<e.byteLength;)n=co(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]),r=ao(e.subarray(i+4,i+8)),a=1<n?i+n:e.byteLength,r===t[0]&&(1===t.length?o.push(e.subarray(i+8,a)):(s=ro(e.subarray(i+8,a),t.slice(1))).length&&(o=o.concat(s))),i=a;return o},parseType:ao=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},timescale:so,startTime:oo,videoTrackIds:lo},nl=il.parseType,rl={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:po(e.subarray(78,e.byteLength))}},avcC:function(e){var t,i,n,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),s={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},o=31&e[5];for(n=6,r=0;r<o;r++)i=a.getUint16(n),n+=2,s.sps.push(new Uint8Array(e.subarray(n,n+i))),n+=i;for(t=e[n],n++,r=0;r<t;r++)i=a.getUint16(n),n+=2,s.pps.push(new Uint8Array(e.subarray(n,n+i))),n+=i;return s},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={majorBrand:nl(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},n=8;n<e.byteLength;)i.compatibleBrands.push(nl(e.subarray(n,n+4))),n+=4;return i},dinf:function(e){return{boxes:po(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:po(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:nl(e.subarray(8,12)),name:""},i=8;for(i=24;i<e.byteLength;i++){if(0===e[i]){i++;break}t.name+=String.fromCharCode(e[i])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,i,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=i)if(i=n.getUint32(t),t+=4,i<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r}(e)}},mdhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(r.creationTime=ho(i.getUint32(n+=4)),r.modificationTime=ho(i.getUint32(n+=8)),r.timescale=i.getUint32(n+=4),n+=8):(r.creationTime=ho(i.getUint32(n)),r.modificationTime=ho(i.getUint32(n+=4)),r.timescale=i.getUint32(n+=4),n+=4),r.duration=i.getUint32(n),t=i.getUint16(n+=4),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:po(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:po(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return 28<e.byteLength&&(i.streamDescriptor=po(e.subarray(28))[0]),i},moof:function(e){return{boxes:po(e)}},moov:function(e){return{boxes:po(e)}},mvex:function(e){return{boxes:po(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===n.version?(n.creationTime=ho(t.getUint32(i+=4)),n.modificationTime=ho(t.getUint32(i+=8)),n.timescale=t.getUint32(i+=4),i+=8):(n.creationTime=ho(t.getUint32(i)),n.modificationTime=ho(t.getUint32(i+=4)),n.timescale=t.getUint32(i+=4),i+=4),n.duration=t.getUint32(i),n.rate=t.getUint16(i+=4)+t.getUint16(i+2)/16,n.volume=t.getUint8(i+=4)+t.getUint8(i+1)/8,i+=2,i+=2,i+=8,n.matrix=new Uint32Array(e.subarray(i,i+36)),i+=36,n.nextTrackId=t.getUint32(i+=24),n},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)i.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return i},sidx:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},r=i.getUint16(22);for(t=24;r;t+=12,r--)n.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&i.getUint32(t),subsegmentDuration:i.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&i.getUint32(t+8)});return n},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:po(e)}},stco:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=i.getUint32(4);for(t=8;r;t+=4,r--)n.chunkOffsets.push(i.getUint32(t));return n},stsc:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=i.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;n;t+=12,n--)r.sampleToChunks.push({firstChunk:i.getUint32(t),samplesPerChunk:i.getUint32(t+4),sampleDescriptionIndex:i.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:po(e.subarray(8))}},stsz:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)n.entries.push(i.getUint32(t));return n},stts:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=i.getUint32(4);for(t=8;r;t+=8,r--)n.timeToSamples.push({sampleCount:i.getUint32(t),sampleDelta:i.getUint32(t+4)});return n},styp:function(e){return rl.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},r=1&n.flags[2],a=2&n.flags[2],s=8&n.flags[2],o=16&n.flags[2],l=32&n.flags[2],u=65536&n.flags[0],c=131072&n.flags[0];return t=8,r&&(t+=4,n.baseDataOffset=i.getUint32(12),t+=4),a&&(n.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(n.defaultSampleDuration=i.getUint32(t),t+=4),o&&(n.defaultSampleSize=i.getUint32(t),t+=4),l&&(n.defaultSampleFlags=i.getUint32(t)),u&&(n.durationIsEmpty=!0),!r&&c&&(n.baseDataOffsetIsMoof=!0),n},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===n.version?(n.creationTime=ho(t.getUint32(i+=4)),n.modificationTime=ho(t.getUint32(i+=8)),n.trackId=t.getUint32(i+=4),i+=4,i+=8):(n.creationTime=ho(t.getUint32(i)),n.modificationTime=ho(t.getUint32(i+=4)),n.trackId=t.getUint32(i+=4),i+=4,i+=4),n.duration=t.getUint32(i),i+=4,n.layer=t.getUint16(i+=8),n.alternateGroup=t.getUint16(i+=2),n.volume=t.getUint8(i+=2)+t.getUint8(i+1)/8,i+=2,i+=2,n.matrix=new Uint32Array(e.subarray(i,i+36)),n.width=t.getUint16(i+=36)+t.getUint16(i+2)/16,n.height=t.getUint16(i+=4)+t.getUint16(i+2)/16,n},traf:function(e){return{boxes:po(e)}},trak:function(e){return{boxes:po(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],l=4&i.flags[1],u=8&i.flags[1],c=n.getUint32(4),h=8;for(r&&(i.dataOffset=n.getInt32(h),h+=4),a&&c&&(t={flags:fo(e.subarray(h,h+4))},h+=4,s&&(t.duration=n.getUint32(h),h+=4),o&&(t.size=n.getUint32(h),h+=4),u&&(t.compositionTimeOffset=n.getUint32(h),h+=4),i.samples.push(t),c--);c--;)t={},s&&(t.duration=n.getUint32(h),h+=4),o&&(t.size=n.getUint32(h),h+=4),l&&(t.flags=fo(e.subarray(h,h+4)),h+=4),u&&(t.compositionTimeOffset=n.getUint32(h),h+=4),i.samples.push(t);return i},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},al={inspect:po=function(e){for(var t,i,n,r,a,s=0,o=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);s<e.byteLength;)i=t.getUint32(s),n=nl(e.subarray(s+4,s+8)),(a=(rl[n]||function(e){return{data:e}})(e.subarray(s+8,r=1<i?s+i:e.byteLength))).size=i,a.type=n,o.push(a),s=r;return o},textify:mo=function(e,t){var i;return t=t||0,i=new Array(2*t+1).join(" "),e.map(function(e,n){return i+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var n=i+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?n+"<"+a.join("").slice(1)+">":n+"<\n"+a.map(function(e){return i+"  "+e}).join("\n")+"\n"+i+"  >":n+"<>"}return n+JSON.stringify(r,null,2).split("\n").map(function(e,t){return 0===t?e:i+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+mo(e.boxes,t+1):"")}).join("\n")},parseTfdt:rl.tfdt,parseHdlr:rl.hdlr,parseTfhd:rl.tfhd,parseTrun:rl.trun,parseSidx:rl.sidx},sl=Math.pow(2,32)-1;function ol(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t]=e[t].concat(i)},this.off=function(t,i){var n;return!!e[t]&&(n=e[t].indexOf(i),e[t]=e[t].slice(),e[t].splice(n,1),-1<n)},this.trigger=function(t){var i,n,r,a;if(i=e[t])if(2===arguments.length)for(r=i.length,n=0;n<r;++n)i[n].call(this,arguments[1]);else{for(a=[],n=arguments.length,n=1;n<arguments.length;++n)a.push(arguments[n]);for(r=i.length,n=0;n<r;++n)i[n].apply(this,a)}},this.dispose=function(){e={}}}}!function(){var e;if(No={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in No)No.hasOwnProperty(e)&&(No[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);Bo=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),Fo=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),jo=new Uint8Array([0,0,0,1]),Ho=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Wo=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),zo={video:Ho,audio:Wo},Go=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Vo=new Uint8Array([0,0,0,0,0,0,0,0]),$o=new Uint8Array([0,0,0,0,0,0,0,0]),Yo=$o,Xo=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ko=$o,qo=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),go=function(e){var t,i,n=[],r=0;for(t=1;t<arguments.length;t++)n.push(arguments[t]);for(t=n.length;t--;)r+=n[t].byteLength;for(i=new Uint8Array(r+8),new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,i.byteLength),i.set(e,4),t=0,r=8;t<n.length;t++)i.set(n[t],r),r+=n[t].byteLength;return i},vo=function(){return go(No.dinf,go(No.dref,Go))},yo=function(e){return go(No.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},Po=function(e){return go(No.hdlr,zo[e])},Ao=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),go(No.mdhd,t)},Lo=function(e){return go(No.mdia,Ao(e),Po(e.type),To(e))},_o=function(e){return go(No.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},To=function(e){return go(No.minf,"video"===e.type?go(No.vmhd,qo):go(No.smhd,Vo),vo(),Io(e))},So=function(e,t){for(var i=[],n=t.length;n--;)i[n]=Do(t[n]);return go.apply(null,[No.moof,_o(e)].concat(i))},ko=function(e){for(var t=e.length,i=[];t--;)i[t]=xo(e[t]);return go.apply(null,[No.moov,Co(4294967295)].concat(i).concat(wo(e)))},wo=function(e){for(var t=e.length,i=[];t--;)i[t]=Uo(e[t]);return go.apply(null,[No.mvex].concat(i))},Co=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return go(No.mvhd,t)},Oo=function(e){var t,i,n=e.samples||[],r=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)r[i+4]=(t=n[i].flags).dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return go(No.sdtp,r)},Io=function(e){return go(No.stbl,Mo(e),go(No.stts,Ko),go(No.stsc,Yo),go(No.stsz,Xo),go(No.stco,$o))},Mo=function(e){return go(No.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?Qo(e):Jo(e))},Qo=function(e){var t,i=e.sps||[],n=e.pps||[],r=[],a=[];for(t=0;t<i.length;t++)r.push((65280&i[t].byteLength)>>>8),r.push(255&i[t].byteLength),r=r.concat(Array.prototype.slice.call(i[t]));for(t=0;t<n.length;t++)a.push((65280&n[t].byteLength)>>>8),a.push(255&n[t].byteLength),a=a.concat(Array.prototype.slice.call(n[t]));return go(No.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),go(No.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([i.length]).concat(r).concat([n.length]).concat(a))),go(No.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},Jo=function(e){return go(No.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),yo(e))},Eo=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return go(No.tkhd,t)},Do=function(e){var t,i,n,r,a,s;return t=go(No.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/(1+sl)),s=Math.floor(e.baseMediaDecodeTime%(1+sl)),i=go(No.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),"audio"===e.type?(n=Ro(e,92),go(No.traf,t,i,n)):(r=Oo(e),n=Ro(e,r.length+92),go(No.traf,t,i,n,r))},xo=function(e){return e.duration=e.duration||4294967295,go(No.trak,Eo(e),Lo(e))},Uo=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),go(No.trex,t)},tl=function(e,t){var i=0,n=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(n=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,i|n|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},el=function(e,t){var i,n,r,a;for(t+=20+16*(n=e.samples||[]).length,i=tl(n,t),a=0;a<n.length;a++)i=i.concat([(4278190080&(r=n[a]).duration)>>>24,(16711680&r.duration)>>>16,(65280&r.duration)>>>8,255&r.duration,(4278190080&r.size)>>>24,(16711680&r.size)>>>16,(65280&r.size)>>>8,255&r.size,r.flags.isLeading<<2|r.flags.dependsOn,r.flags.isDependedOn<<6|r.flags.hasRedundancy<<4|r.flags.paddingValue<<1|r.flags.isNonSyncSample,61440&r.flags.degradationPriority,15&r.flags.degradationPriority,(4278190080&r.compositionTimeOffset)>>>24,(16711680&r.compositionTimeOffset)>>>16,(65280&r.compositionTimeOffset)>>>8,255&r.compositionTimeOffset]);return go(No.trun,new Uint8Array(i))},Zo=function(e,t){var i,n,r,a;for(t+=20+8*(n=e.samples||[]).length,i=tl(n,t),a=0;a<n.length;a++)i=i.concat([(4278190080&(r=n[a]).duration)>>>24,(16711680&r.duration)>>>16,(65280&r.duration)>>>8,255&r.duration,(4278190080&r.size)>>>24,(16711680&r.size)>>>16,(65280&r.size)>>>8,255&r.size]);return go(No.trun,new Uint8Array(i))},Ro=function(e,t){return"audio"===e.type?Zo(e,t):el(e,t)};var ll={ftyp:bo=function(){return go(No.ftyp,Bo,jo,Bo,Fo)},mdat:function(e){return go(No.mdat,e)},moof:So,moov:ko,initSegment:function(e){var t,i=bo(),n=ko(e);return(t=new Uint8Array(i.byteLength+n.byteLength)).set(i),t.set(n,i.byteLength),t}};function ul(e){for(var t=[];e--;)t.push(0);return t}function cl(){cl.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Al(0,0),new Al(0,1),new Al(1,0),new Al(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)}ol.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),e},ol.prototype.push=function(e){this.trigger("data",e)},ol.prototype.flush=function(e){this.trigger("done",e)};var hl,dl,fl,pl,ml,gl=ol,vl=[33,16,5,32,164,27],yl=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],bl={96000:[vl,[227,64],ul(154),[56]],88200:[vl,[231],ul(170),[56]],64000:[vl,[248,192],ul(240),[56]],48000:[vl,[255,192],ul(268),[55,148,128],ul(54),[112]],44100:[vl,[255,192],ul(268),[55,163,128],ul(84),[112]],32000:[vl,[255,192],ul(268),[55,234],ul(226),[112]],24000:[vl,[255,192],ul(268),[55,255,128],ul(268),[111,112],ul(126),[224]],16000:[vl,[255,192],ul(268),[55,255,128],ul(268),[111,255],ul(269),[223,108],ul(195),[1,192]],12000:[yl,ul(268),[3,127,248],ul(268),[6,255,240],ul(268),[13,255,224],ul(268),[27,253,128],ul(259),[56]],11025:[yl,ul(268),[3,127,248],ul(268),[6,255,240],ul(268),[13,255,224],ul(268),[27,255,192],ul(268),[55,175,128],ul(108),[112]],8000:[yl,ul(268),[3,121,16],ul(47),[7]]},_l=(hl=bl,Object.keys(hl).reduce(function(e,t){return e[t]=new Uint8Array(hl[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),Tl=(dl=function(e){return 9e4*e},fl=function(e,t){return e*t},pl=function(e){return e/9e4},ml=function(e,t){return e/t},function(e,t){return dl(ml(e,t))}),Sl=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},kl=function(e,t){var i,n=e.minSegmentDts;return t||(n-=e.timelineStartInfo.dts),i=e.timelineStartInfo.baseMediaDecodeTime,i+=n,i=Math.max(0,i),"audio"===e.type&&(i*=e.samplerate/9e4,i=Math.floor(i)),i},wl=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),e.minSegmentPts=void 0===e.minSegmentPts?t.pts:Math.min(e.minSegmentPts,t.pts),e.maxSegmentPts=void 0===e.maxSegmentPts?t.pts:Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),e.minSegmentDts=void 0===e.minSegmentDts?t.dts:Math.min(e.minSegmentDts,t.dts),e.maxSegmentDts=void 0===e.maxSegmentDts?t.dts:Math.max(e.maxSegmentDts,t.dts))};function Cl(e){return null===e?"":(e=El[e]||e,String.fromCharCode(e))}function xl(){for(var e=[],t=15;t--;)e.push("");return e}(cl.prototype=new gl).push=function(e){var t,i,n;if("sei_rbsp"===e.nalUnitType&&4===(t=function(e){for(var t=0,i={payloadType:-1,payloadSize:0},n=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)n+=255,t++;for(n+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!i.payload&&4===n){i.payloadType=n,i.payloadSize=r,i.payload=e.subarray(t,t+r);break}t+=r,r=n=0}return i}(e.escapedRBSP)).payloadType&&(i=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)}(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));n=function(e,t){var i,n,r,a,s=[];if(!(64&t[0]))return s;for(n=31&t[0],i=0;i<n;i++)a={type:3&t[2+(r=3*i)],pts:e},4&t[2+r]&&(a.ccData=t[3+r]<<8|t[4+r],s.push(a));return s}(e.pts,i),this.captionPackets_=this.captionPackets_.concat(n),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},cl.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},cl.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},cl.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},cl.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},cl.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},cl.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var El={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Ll=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Al=function e(t,i){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,n,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),n=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=xl();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=xl();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=xl()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(n,r))a=Cl((n=(3&n)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(n,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Cl((n=(3&n)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(n,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(n,r))this.column_+=3&r;else if(this.isPAC(n,r)){var s=Ll.indexOf(7968&t);"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(e.pts,s)),s!==this.row_&&(this.clearFormatting(e.pts),this.row_=s),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(n)&&(0===r&&(r=null),a=Cl(n),a+=Cl(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};function Pl(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e}function Ol(e){var t,i;Ol.prototype.init.call(this),this.type_=e,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=Pl(e.dts,i),e.pts=Pl(e.pts,i),t=e.dts,this.trigger("data",e))},this.flush=function(){i=t,this.trigger("done")},this.discontinuity=function(){t=i=void 0}}Al.prototype=new gl,Al.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Al.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=xl(),this.nonDisplayed_=xl(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Al.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Al.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},Al.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},Al.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},Al.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},Al.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},Al.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},Al.prototype.isNormalChar=function(e){return 32<=e&&e<=127},Al.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=xl(),this.displayed_=xl()),void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Al.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,i)},Al.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Al.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=i+=t},Al.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t},Al.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Al.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t};var Il={CaptionStream:cl,Cea608Stream:Al},Ml={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};function Dl(e,t,i){var n,r="";for(n=t;n<i;n++)r+="%"+("00"+e[n].toString(16)).slice(-2);return r}function Ul(e,t,i){return decodeURIComponent(Dl(e,t,i))}function Rl(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}Ol.prototype=new gl;var Nl,Bl=Ol,jl=Pl,Fl={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ul(e.data,1,t),e.value=Ul(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ul(e.data,1,t),e.url=Ul(e.data,t+1,e.data.length);break}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=unescape(Dl(e.data,0,t));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Nl=function(e){var t,i={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},n=0,r=[],a=0;if(Nl.prototype.init.call(this),this.dispatchType=Ml.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(t=0;t<i.descriptor.length;t++)this.dispatchType+=("00"+i.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,s,o,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)));else if(r.push(e),a+=e.data.byteLength,1===r.length&&(n=Rl(e.data.subarray(6,10)),n+=10),!(a<n)){for(t={data:new Uint8Array(n),frames:[],pts:r[0].pts,dts:r[0].dts},l=0;l<n;)t.data.set(r[0].data.subarray(0,n-l),l),l+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();i=10,64&t.data[5]&&(i+=4,i+=Rl(t.data.subarray(10,14)),n-=Rl(t.data.subarray(16,20)));do{if((s=Rl(t.data.subarray(i+4,i+8)))<1)return;if((o={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+s+10)}).key=o.id,Fl[o.id]&&(Fl[o.id](o),"com.apple.streaming.transportStreamTimestamp"===o.owner)){var u=o.data,c=(1&u[3])<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;c*=4,o.timeStamp=c+=3&u[7],void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o)}t.frames.push(o),i+=10,i+=s}while(i<n);this.trigger("data",t)}}}).prototype=new gl;var Hl,Wl,zl,ql=Nl,Vl=Bl;(Hl=function(){var e=new Uint8Array(188),t=0;Hl.prototype.init.call(this),this.push=function(i){var n,r=0,a=188;for(t?((n=new Uint8Array(i.byteLength+t)).set(e.subarray(0,t)),n.set(i,t),t=0):n=i;a<n.byteLength;)71!==n[r]||71!==n[a]?(r++,a++):(this.trigger("data",n.subarray(r,a)),r+=188,a+=188);r<n.byteLength&&(e.set(n.subarray(r),0),t=n.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")}}).prototype=new gl,(Wl=function(){var e,t,i,n;Wl.prototype.init.call(this),(n=this).packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,n){var r=0;n.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===n.type?t(e.subarray(r),n):i(e.subarray(r),n)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],n.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=n.pmtPid},i=function(e,t){var i,r;if(1&e[5]){for(n.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<i;){var a=e[r],s=(31&e[r+1])<<8|e[r+2];a===Ml.H264_STREAM_TYPE&&null===n.programMapTable.video?n.programMapTable.video=s:a===Ml.ADTS_STREAM_TYPE&&null===n.programMapTable.audio?n.programMapTable.audio=s:a===Ml.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][s]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=n.programMapTable}},this.push=function(t){var i={},n=4;if(i.payloadUnitStartIndicator=!!(64&t[1]),i.pid=31&t[1],i.pid<<=8,i.pid|=t[2],1<(48&t[3])>>>4&&(n+=t[n]+1),0===i.pid)i.type="pat",e(t.subarray(n),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",e(t.subarray(n),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,n,i]):this.processPes_(t,n,i)},this.processPes_=function(e,t,i){i.streamType=i.pid===this.programMapTable.video?Ml.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?Ml.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new gl,Wl.STREAM_TYPES={h264:27,adts:15},(zl=function(){function e(e,i,n){var r,a,s=new Uint8Array(e.size),o={type:i},l=0,u=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,l=0;l<e.data.length;l++)s.set((a=e.data[l]).data,u),u+=a.data.byteLength;!function(e,t){var i;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!=(4&e[6]),192&(i=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&i&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])}(s,o),r="video"===i||o.packetLength<=e.size,(n||r)&&(e.size=0,e.data.length=0),r&&t.trigger("data",o)}}var t=this,i={data:[],size:0},n={data:[],size:0},r={data:[],size:0};zl.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var t,s;switch(a.streamType){case Ml.H264_STREAM_TYPE:case Ml.H264_STREAM_TYPE:t=i,s="video";break;case Ml.ADTS_STREAM_TYPE:t=n,s="audio";break;case Ml.METADATA_STREAM_TYPE:t=r,s="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&e(t,s,!0),t.data.push(a),t.size+=a.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]},i=a.programMapTable;null!==i.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"}),null!==i.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"}),t.trigger("data",e)}})[a.type]()},this.flush=function(){e(i,"video"),e(n,"audio"),e(r,"timed-metadata"),this.trigger("done")}}).prototype=new gl;var Gl={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Hl,TransportParseStream:Wl,ElementaryStream:zl,TimestampRolloverStream:Vl,CaptionStream:Il.CaptionStream,Cea608Stream:Il.Cea608Stream,MetadataStream:ql};for(var $l in Ml)Ml.hasOwnProperty($l)&&(Gl[$l]=Ml[$l]);var Yl,Xl=Gl,Kl=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Yl=function(){var e;Yl.prototype.init.call(this),this.push=function(t){var i,n,r,a,s=0,o=0;if("audio"===t.type)for(e?(n=e,(e=new Uint8Array(n.byteLength+t.data.byteLength)).set(n),e.set(t.data,n.byteLength)):e=t.data;s+5<e.length;)if(255===e[s]&&240==(246&e[s+1])){if(a=9e4*(r=1024*(1+(3&e[s+6])))/Kl[(60&e[s+2])>>>2],e.byteLength<(i=s+((3&e[s+3])<<11|e[s+4]<<3|(224&e[s+5])>>5)))return;if(this.trigger("data",{pts:t.pts+o*a,dts:t.dts+o*a,sampleCount:r,audioobjecttype:1+(e[s+2]>>>6&3),channelcount:(1&e[s+2])<<2|(192&e[s+3])>>>6,samplerate:Kl[(60&e[s+2])>>>2],samplingfrequencyindex:(60&e[s+2])>>>2,samplesize:16,data:e.subarray(s+7+2*(1&~e[s+1]),i)}),e.byteLength===i)return void(e=void 0);o++,e=e.subarray(i)}else s++},this.flush=function(){this.trigger("done")}}).prototype=new gl;var Ql,Jl,Zl,eu=Yl,tu=function(e){var t=e.byteLength,i=0,n=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+n},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");a.set(e.subarray(r,r+s)),i=new DataView(a.buffer).getUint32(0),n=8*s,t-=s},this.skipBits=function(e){var r;e<n||(e-=n,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord()),i<<=e,n-=e},this.readBits=function(e){var r=Math.min(n,e),a=i>>>32-r;return 0<(n-=r)?i<<=r:0<t&&this.loadWord(),0<(r=e-r)?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e)if(0!=(i&2147483648>>>e))return i<<=e,n-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};function iu(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}(Jl=function(){var e,t,i=0;Jl.prototype.init.call(this),this.push=function(n){var r;for(t=t?((r=new Uint8Array(t.byteLength+n.data.byteLength)).set(t),r.set(n.data,t.byteLength),r):n.data;i<t.byteLength-3;i++)if(1===t[i+2]){e=i+5;break}for(;e<t.byteLength;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}for(i+3!==e-2&&this.trigger("data",t.subarray(i+3,e-2));1!==t[++e]&&e<t.length;);i=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(i+3,e-2)),i=e-2,e+=3;break;default:e+=3}t=t.subarray(i),e-=i,i=0},this.flush=function(){t&&3<t.byteLength&&this.trigger("data",t.subarray(i+3)),t=null,i=0,this.trigger("done")}}).prototype=new gl,Zl={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Ql=function(){var e,t,i,n,r,a,s,o=new Jl;Ql.prototype.init.call(this),(e=this).push=function(e){"video"===e.type&&(t=e.trackId,i=e.pts,n=e.dts,o.push(e))},o.on("data",function(s){var o={trackId:t,pts:i,dts:n,data:s};switch(31&s[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=r(s.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=r(s.subarray(1)),o.config=a(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",o)}),o.on("done",function(){e.trigger("done")}),this.flush=function(){o.flush()},s=function(e,t){var i,n=8,r=8;for(i=0;i<e;i++)0!==r&&(r=(n+t.readExpGolomb()+256)%256),n=0===r?n:r},r=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},a=function(e){var t,i,n,r,a,o,l,u,c,h,d,f,p,m=0,g=0,v=0,y=0,b=1;if(i=(t=new tu(e)).readUnsignedByte(),r=t.readUnsignedByte(),n=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),Zl[i]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=3!==a?8:12,p=0;p<d;p++)t.readBoolean()&&s(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),p=0;p<l;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(h=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(m=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}f&&(b=f[0]/f[1])}return{profileIdc:i,levelIdc:n,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*m-2*g)*b),height:(2-h)*(c+1)*16-2*v-2*y}}}).prototype=new gl;var nu,ru={H264Stream:Ql,NalByteStream:Jl},au=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],su={isLikelyAacData:function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parseId3TagSize:function(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+i:10+i},parseAdtsSize:function(e,t){return 6144&e[t+3]|e[t+4]<<3|(224&e[t+5])>>5},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return au[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,i,n;t=10,64&e[5]&&(t+=4,t+=iu(e.subarray(10,14)));do{if((i=iu(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){n=e.subarray(t+10,t+i+10);for(var r=0;r<n.byteLength;r++)if(0===n[r]){if("com.apple.streaming.transportStreamTimestamp"!==unescape(function(e,t,i){var n,r="";for(n=0;n<i;n++)r+="%"+("00"+e[n].toString(16)).slice(-2);return r}(n,0,r)))break;var a=n.subarray(r+1),s=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return(s*=4)+(3&a[7])}}t+=10,t+=i}while(t<e.byteLength);return null}};function ou(e,t){var i;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}(nu=function(){var e=new Uint8Array,t=0;nu.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(i){var n,r,a,s=0,o=0;for(e.length?(a=e.length,(e=new Uint8Array(i.byteLength+a)).set(e.subarray(0,a)),e.set(i,a)):e=i;3<=e.length-o;)if(e[o]!=="I".charCodeAt(0)||e[o+1]!=="D".charCodeAt(0)||e[o+2]!=="3".charCodeAt(0))if(255!=(255&e[o])||240!=(240&e[o+1]))o++;else{if(e.length-o<7)break;if(o+(s=su.parseAdtsSize(e,o))>e.length)break;r={type:"audio",data:e.subarray(o,o+s),pts:t,dts:t},this.trigger("data",r),o+=s}else{if(e.length-o<10)break;if(o+(s=su.parseId3TagSize(e,o))>e.length)break;n={type:"timed-metadata",data:e.subarray(o,o+s)},this.trigger("data",n),o+=s}e=0<e.length-o?e.subarray(o):new Uint8Array}}).prototype=new gl;var lu,uu,cu,hu,du=nu,fu=ru.H264Stream,pu=su.isLikelyAacData,mu=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],gu=["width","height","profileIdc","levelIdc","profileCompatibility"];function vu(e,t){for(var i=e,n=0;n<t.length;n++){var r=t[n];if(i<r.size)return r;i-=r.size}return null}function yu(e,t){var i=il.findBox(e,["moof","traf"]),n=il.findBox(e,["mdat"]),r={},a=[];return n.forEach(function(e,t){a.push({mdat:e,traf:i[t]})}),a.forEach(function(e){var i,n=e.mdat,a=e.traf,s=il.findBox(a,["tfhd"]),o=al.parseTfhd(s[0]),l=o.trackId,u=il.findBox(a,["tfdt"]),c=0<u.length?al.parseTfdt(u[0]).baseMediaDecodeTime:0,h=il.findBox(a,["trun"]);t===l&&0<h.length&&(i=function(e,t,i){var n,r,a,s,o=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(r=0;r+4<e.length;r+=a)if(a=o.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+a),c=vu(r,t);n={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:ku(u),trackId:i},c?(n.pts=c.pts,n.dts=c.dts,s=c):(n.pts=s.pts,n.dts=s.dts),l.push(n)}return l}(n,function(e,t,i){var n=c,r=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,s=i.trackId,o=[];return h.forEach(function(e){var t=al.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=n,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=n+e.compositionTimeOffset,n+=e.duration}),o=o.concat(t)}),o}(0,0,o),l),r[l]||(r[l]=[]),r[l]=r[l].concat(i))}),r}function bu(e){var t=31&e[1];return(t<<=8)|e[2]}function _u(e){return!!(64&e[1])}function Tu(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t}function Su(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}(uu=function(e,t){var i=[],n=0,r=0,a=0,s=1/0;t=t||{},uu.prototype.init.call(this),this.push=function(t){wl(e,t),e&&mu.forEach(function(i){e[i]=t[i]}),i.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){s=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var o,l,u,c;0!==i.length&&(o=function(e,t,i){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))}(i,e,r),e.baseMediaDecodeTime=kl(e,t.keepOriginalTimestamps),function(e,t,i,n){var r,a,s,o,l=0,u=0,c=0;if(t.length&&(r=Tl(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(9e4/(e.samplerate/1024)),i&&n&&(l=r-Math.max(i,n),c=(u=Math.floor(l/a))*a),!(u<1||45e3<c))){for(s=(s=_l[e.samplerate])||t[0].data,o=0;o<u;o++)t.splice(o,0,{data:s});e.baseMediaDecodeTime-=Math.floor(function(e,t){return fl(pl(c),t)}(0,e.samplerate))}}(e,o,a,s),e.samples=function(e){var t,i=[];for(t=0;t<e.length;t++)i.push({size:e[t].data.byteLength,duration:1024});return i}(o),u=ll.mdat(function(e){var t,i,n=0,r=new Uint8Array(function(e){var t,i=0;for(t=0;t<e.length;t++)i+=e[t].data.byteLength;return i}(e));for(t=0;t<e.length;t++)r.set((i=e[t]).data,n),n+=i.data.byteLength;return r}(o)),i=[],l=ll.moof(n,[e]),c=new Uint8Array(l.byteLength+u.byteLength),n++,c.set(l),c.set(u,l.byteLength),Sl(e),this.trigger("data",{track:e,boxes:c})),this.trigger("done","AudioSegmentStream")}}).prototype=new gl,(lu=function(e,t){var i,n,r=0,a=[],s=[];t=t||{},lu.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){wl(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.config,e.sps=[t.data],gu.forEach(function(t){e[t]=i[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var i,n,o,l,u,c,h,d,f=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(i=function(e){var t,i,n=[],r=[];for(t=n.byteLength=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(i=e[t]).nalUnitType?(n.length&&(n.duration=i.dts-n.dts,r.push(n)),(n=[i]).byteLength=i.data.byteLength,n.pts=i.pts,n.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(n.keyFrame=!0),n.duration=i.dts-n.dts,n.byteLength+=i.data.byteLength,n.push(i));return r.length&&(!n.duration||n.duration<=0)&&(n.duration=r[r.length-1].duration),r.push(n),r}(a),(o=function(e){var t,i,n=[],r=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(n.length&&(r.push(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration),(n=[i]).nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration):(n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i));return r.length&&n.duration<=0&&(n.duration=r[r.length-1].duration),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration,r.push(n),r}(i))[0][0].keyFrame||((n=this.getGopForFusion_(a[0],e))?(f=n.duration,o.unshift(n),o.byteLength+=n.byteLength,o.nalCount+=n.nalCount,o.pts=n.pts,o.dts=n.dts,o.duration+=n.duration):o=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e}(o)),s.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(o):this.alignGopsAtStart_(o)))return this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");Sl(e),o=p}wl(e,o),e.samples=function(e,t){var i,n,r,a,s,o,l=0,u=[];for(i=0;i<e.length;i++)for(a=e[i],n=0;n<a.length;n++)s=a[n],o=void 0,(o={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}).dataOffset=l,o.compositionTimeOffset=s.pts-s.dts,o.duration=s.duration,o.size=4*s.length,o.size+=s.byteLength,s.keyFrame&&(o.flags.dependsOn=2,o.flags.isNonSyncSample=0),l+=(r=o).size,u.push(r);return u}(o),u=ll.mdat(function(e){var t,i,n,r,a,s,o=0,l=new Uint8Array(e.byteLength+4*e.nalCount),u=new DataView(l.buffer);for(t=0;t<e.length;t++)for(r=e[t],i=0;i<r.length;i++)for(a=r[i],n=0;n<a.length;n++)u.setUint32(o,(s=a[n]).data.byteLength),l.set(s.data,o+=4),o+=s.data.byteLength;return l}(o)),e.baseMediaDecodeTime=kl(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",o.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),this.trigger("segmentTimingInfo",function(e,t,i,n,r,a){return{start:{dts:e,pts:e+(i-t)},end:{dts:e+(n-t),pts:e+(d.pts+d.duration-i)},prependedContentDuration:f,baseMediaDecodeTime:e}}(e.baseMediaDecodeTime,(h=o[0]).dts,h.pts,(d=o[o.length-1]).dts+d.duration)),this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=ll.moof(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){Sl(e),n=i=void 0},this.getGopForFusion_=function(t){var i,n,r,a,s,o=1/0;for(s=0;s<this.gopCache_.length;s++)r=(a=this.gopCache_[s]).gop,e.pps&&ou(e.pps[0],a.pps[0])&&e.sps&&ou(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||-1e4<=(i=t.dts-r.dts-r.duration)&&i<=45e3&&(!n||i<o)&&(n=a,o=i));return n?n.gop:null},this.alignGopsAtStart_=function(e){var t,i,n,r,a,o,l,u;for(a=e.byteLength,o=e.nalCount,l=e.duration,t=i=0;t<s.length&&i<e.length&&(n=s[t]).pts!==(r=e[i]).pts;)r.pts>n.pts?t++:(i++,a-=r.byteLength,o-=r.nalCount,l-=r.duration);return 0===i?e:i===e.length?null:((u=e.slice(i)).byteLength=a,u.duration=l,u.nalCount=o,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,i,n,r,a,o,l;for(t=s.length-1,i=e.length-1,a=null,o=!1;0<=t&&0<=i;){if((n=s[t]).pts===(r=e[i]).pts){o=!0;break}n.pts>r.pts?t--:(t===s.length-1&&(a=i),i--)}if(!o&&null===a)return null;if(0===(l=o?i:a))return e;var u=e.slice(l),c=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){s=e}}).prototype=new gl,(hu=function(e,t){this.numberOfTracks=0,this.metadataStream=t,this.remuxTracks=void 0===(e=e||{}).remux||!!e.remux,"boolean"==typeof e.keepOriginalTimestamps&&(this.keepOriginalTimestamps=e.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,hu.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new gl,hu.prototype.flush=function(e){var t,i,n,r,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,gu.forEach(function(e){s.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,mu.forEach(function(e){s.info[e]=this.audioTrack[e]},this)),s.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,n=ll.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(n.byteLength),s.initSegment.set(n),s.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)s.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=t.startPts,this.keepOriginalTimestamps||(t.startTime-=o),t.startTime/=9e4,t.endTime=t.endPts,this.keepOriginalTimestamps||(t.endTime-=o),t.endTime/=9e4,s.captionStreams[t.stream]=!0,s.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(i=this.pendingMetadata[r]).cueTime=i.pts,this.keepOriginalTimestamps||(i.cueTime-=o),i.cueTime/=9e4,s.metadata.push(i);s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(cu=function(e){var t,i,n=this,r=!0;cu.prototype.init.call(this),this.baseMediaDecodeTime=(e=e||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new Xl.MetadataStream,t.aacStream=new du,t.audioTimestampRolloverStream=new Xl.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new Xl.TimestampRolloverStream("timed-metadata"),t.adtsStream=new eu,t.coalesceStream=new hu(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(r){"timed-metadata"!==r.type||t.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new uu(i,e),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};(this.transmuxPipeline_=r).type="ts",r.metadataStream=new Xl.MetadataStream,r.packetStream=new Xl.TransportPacketStream,r.parseStream=new Xl.TransportParseStream,r.elementaryStream=new Xl.ElementaryStream,r.videoTimestampRolloverStream=new Xl.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new Xl.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new Xl.TimestampRolloverStream("timed-metadata"),r.adtsStream=new eu,r.h264Stream=new fu,r.captionStream=new Xl.CaptionStream,r.coalesceStream=new hu(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var s;if("metadata"===a.type){for(s=a.tracks.length;s--;)t||"video"!==a.tracks[s].type?i||"audio"!==a.tracks[s].type||((i=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime):(t=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new lu(t,e),r.videoSegmentStream.on("timelineStartInfo",function(e){i&&(i.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))}),r.videoSegmentStream.on("processedGopsInfo",n.trigger.bind(n,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",n.trigger.bind(n,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){i&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),i&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new uu(i,e),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(n){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=n),i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,Sl(i),e.keepOriginalTimestamps||(i.timelineStartInfo.baseMediaDecodeTime=n),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,Sl(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=n)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=pu(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new gl;var ku=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},wu=Il.CaptionStream,Cu={generator:ll,probe:il,Transmuxer:cu,AudioSegmentStream:uu,VideoSegmentStream:lu,CaptionParser:function(){var e,t,i,n,r,a=!1;this.isInitialized=function(){return a},this.init=function(){e=new wu,a=!0,e.on("data",function(e){e.startTime=e.startPts/n,e.endTime=e.endPts/n,r.captions.push(e),r.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||i===e[0]&&n===t[i])},this.parse=function(e,a,s){var o;if(!this.isInitialized())return null;if(!a||!s)return null;if(this.isNewInit(a,s))n=s[i=a[0]];else if(!i||!n)return t.push(e),null;for(;0<t.length;){var l=t.shift();this.parse(l,a,s)}return null!==(o=function(e,t,i){return t?{seiNals:yu(e,t)[t],timescale:i}:null}(e,i,n))&&o.seiNals?(this.pushNals(o.seiNals),this.flushStream(),r):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}}.CaptionParser,xu=jl,Eu={};function Lu(e,t,i){for(var n,r,a,s,o=0,l=Pu,u=!1;l<=e.byteLength;)if(71!==e[o]||71!==e[l]&&l!==e.byteLength)o++,l++;else{switch(n=e.subarray(o,l),Eu.ts.parseType(n,t.pid)){case"pes":r=Eu.ts.parsePesType(n,t.table),a=Eu.ts.parsePayloadUnitStartIndicator(n),"audio"===r&&a&&(s=Eu.ts.parsePesTime(n))&&(s.type="audio",i.audio.push(s),u=!0)}if(u)break;o+=Pu,l+=Pu}for(o=(l=e.byteLength)-Pu,u=!1;0<=o;)if(71!==e[o]||71!==e[l]&&l!==e.byteLength)o--,l--;else{switch(n=e.subarray(o,l),Eu.ts.parseType(n,t.pid)){case"pes":r=Eu.ts.parsePesType(n,t.table),a=Eu.ts.parsePayloadUnitStartIndicator(n),"audio"===r&&a&&(s=Eu.ts.parsePesTime(n))&&(s.type="audio",i.audio.push(s),u=!0)}if(u)break;o-=Pu,l-=Pu}}function Au(e,t,i){for(var n,r,a,s,o,l,u,c=0,h=Pu,d=!1,f={data:[],size:0};h<e.byteLength;)if(71!==e[c]||71!==e[h])c++,h++;else{switch(n=e.subarray(c,h),Eu.ts.parseType(n,t.pid)){case"pes":if(r=Eu.ts.parsePesType(n,t.table),a=Eu.ts.parsePayloadUnitStartIndicator(n),"video"===r&&(a&&!d&&(s=Eu.ts.parsePesTime(n))&&(s.type="video",i.video.push(s),d=!0),!i.firstKeyFrame)){if(a&&0!==f.size){for(o=new Uint8Array(f.size),l=0;f.data.length;)u=f.data.shift(),o.set(u,l),l+=u.byteLength;if(Eu.ts.videoPacketContainsKeyFrame(o)){var p=Eu.ts.parsePesTime(o);p&&(i.firstKeyFrame=p,i.firstKeyFrame.type="video")}f.size=0}f.data.push(n),f.size+=n.byteLength}}if(d&&i.firstKeyFrame)break;c+=Pu,h+=Pu}for(c=(h=e.byteLength)-Pu,d=!1;0<=c;)if(71!==e[c]||71!==e[h])c--,h--;else{switch(n=e.subarray(c,h),Eu.ts.parseType(n,t.pid)){case"pes":r=Eu.ts.parsePesType(n,t.table),a=Eu.ts.parsePayloadUnitStartIndicator(n),"video"===r&&a&&(s=Eu.ts.parsePesTime(n))&&(s.type="video",i.video.push(s),d=!0)}if(d)break;c-=Pu,h-=Pu}}Eu.ts={parseType:function(e,t){var i=bu(e);return 0===i?"pat":i===t?"pmt":t?"pes":null},parsePat:function(e){var t=_u(e),i=4+Tu(e);return t&&(i+=e[i]+1),(31&e[i+10])<<8|e[i+11]},parsePmt:function(e){var t={},i=_u(e),n=4+Tu(e);if(i&&(n+=e[n]+1),1&e[n+5]){var r;r=3+((15&e[n+1])<<8|e[n+2])-4;for(var a=12+((15&e[n+10])<<8|e[n+11]);a<r;){var s=n+a;t[(31&e[s+1])<<8|e[s+2]]=e[s],a+=5+((15&e[s+3])<<8|e[s+4])}return t}},parsePayloadUnitStartIndicator:_u,parsePesType:function(e,t){switch(t[bu(e)]){case Ml.H264_STREAM_TYPE:return"video";case Ml.ADTS_STREAM_TYPE:return"audio";case Ml.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!_u(e))return null;var t=4+Tu(e);if(t>=e.byteLength)return null;var i,n=null;return 192&(i=e[t+7])&&((n={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,n.pts*=4,n.pts+=(6&e[t+13])>>>1,n.dts=n.pts,64&i&&(n.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,n.dts*=4,n.dts+=(6&e[t+18])>>>1)),n},videoPacketContainsKeyFrame:function(e){for(var t=4+Tu(e),i=e.subarray(t),n=0,r=0,a=!1;r<i.byteLength-3;r++)if(1===i[r+2]){n=r+5;break}for(;n<i.byteLength;)switch(i[n]){case 0:if(0!==i[n-1]){n+=2;break}if(0!==i[n-2]){n++;break}for(r+3!==n-2&&"slice_layer_without_partitioning_rbsp_idr"===Su(31&i[r+3])&&(a=!0);1!==i[++n]&&n<i.length;);r=n-2,n+=3;break;case 1:if(0!==i[n-1]||0!==i[n-2]){n+=3;break}"slice_layer_without_partitioning_rbsp_idr"===Su(31&i[r+3])&&(a=!0),r=n-2,n+=3;break;default:n+=3}return i=i.subarray(r),n-=r,r=0,i&&3<i.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===Su(31&i[r+3])&&(a=!0),a}},Eu.aac=su;var Pu=188;function Ou(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Iu=null,Mu=(Du.prototype.decrypt=function(e,t,i,n,r,a){var s=this._key[1],o=e^s[0],l=n^s[1],u=i^s[2],c=t^s[3],h=void 0,d=void 0,f=void 0,p=s.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],b=v[1],_=v[2],T=v[3],S=v[4];for(m=0;m<p;m++)h=y[o>>>24]^b[l>>16&255]^_[u>>8&255]^T[255&c]^s[g],d=y[l>>>24]^b[u>>16&255]^_[c>>8&255]^T[255&o]^s[g+1],f=y[u>>>24]^b[c>>16&255]^_[o>>8&255]^T[255&l]^s[g+2],c=y[c>>>24]^b[o>>16&255]^_[l>>8&255]^T[255&u]^s[g+3],g+=4,o=h,l=d,u=f;for(m=0;m<4;m++)r[(3&-m)+a]=S[o>>>24]<<24^S[l>>16&255]<<16^S[u>>8&255]<<8^S[255&c]^s[g++],h=o,o=l,l=u,u=c,c=h},Du);function Du(e){Ou(this,Du),Iu=Iu||function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],i=e[1],n=t[4],r=i[4],a=void 0,s=void 0,o=void 0,l=[],u=[],c=void 0,h=void 0,d=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(s=o=0;!n[s];s^=c||1,o=u[o]||1)for(d=(d=o^o<<1^o<<2^o<<3^o<<4)>>8^255&d^99,p=16843009*l[h=l[c=l[r[n[s]=d]=s]]]^65537*h^257*c^16843008*s,f=257*l[d]^16843008*d,a=0;a<4;a++)t[a][s]=f=f<<24^f>>>8,i[a][d]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),i[a]=i[a].slice(0);return e}(),this._tables=[[Iu[0][0].slice(),Iu[0][1].slice(),Iu[0][2].slice(),Iu[0][3].slice(),Iu[0][4].slice()],[Iu[1][0].slice(),Iu[1][1].slice(),Iu[1][2].slice(),Iu[1][3].slice(),Iu[1][4].slice()]];var t=void 0,i=void 0,n=void 0,r=void 0,a=void 0,s=this._tables[0][4],o=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size");for(r=e.slice(0),this._key=[r,a=[]],t=l;t<4*l+28;t++)n=r[t-1],(t%l==0||8===l&&t%l==4)&&(n=s[n>>>24]<<24^s[n>>16&255]<<16^s[n>>8&255]<<8^s[255&n],t%l==0&&(n=n<<8^n>>>24^u<<24,u=u<<1^283*(u>>7))),r[t]=r[t-l]^n;for(i=0;t;i++,t--)n=r[3&i?t:t-4],a[i]=t<=4||i<4?n:o[0][s[n>>>24]]^o[1][s[n>>16&255]]^o[2][s[n>>8&255]]^o[3][s[255&n]]}var Uu=(Ru.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},Ru.prototype.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e].splice(i,1),-1<i},Ru.prototype.trigger=function(e,t){var i=this.listeners[e];if(i)if(2===arguments.length)for(var n=i.length,r=0;r<n;++r)i[r].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),s=i.length,o=0;o<s;++o)i[o].apply(this,a)},Ru.prototype.dispose=function(){this.listeners={}},Ru.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})},Ru);function Ru(){Ou(this,Ru),this.listeners={}}var Nu,Bu=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ju,Nu=Uu),ju.prototype.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},ju.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},ju);function ju(){Ou(this,ju);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Nu.call(this,Uu));return e.jobs=[],e.delay=1,e.timeout_=null,e}function Fu(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}function Hu(e,t,i){var n=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),r=new Mu(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),s=new Int32Array(a.buffer),o=void 0,l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,p=void 0,m=void 0;for(o=i[0],l=i[1],u=i[2],c=i[3],m=0;m<n.length;m+=4)h=Fu(n[m]),d=Fu(n[m+1]),f=Fu(n[m+2]),p=Fu(n[m+3]),r.decrypt(h,d,f,p,s,m),s[m]=Fu(s[m]^o),s[m+1]=Fu(s[m+1]^l),s[m+2]=Fu(s[m+2]^u),s[m+3]=Fu(s[m+3]^c),o=h,l=d,u=f,c=p;return a}var Wu=(zu.prototype.decryptChunk_=function(e,t,i,n){return function(){var r=Hu(e,t,i);n.set(r,e.byteOffset)}},function(e,t,i){i&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(zu,i)}(0,0,[{key:"STEP",get:function(){return 32e3}}]),zu);function zu(e,t,i,n){Ou(this,zu);var r=zu.STEP,a=new Int32Array(e.buffer),s=new Uint8Array(e.byteLength),o=0;for(this.asyncStream_=new Bu,this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+r),t,i,s)),o=r;o<a.length;o+=r)i=new Uint32Array([Fu(a[o-4]),Fu(a[o-3]),Fu(a[o-2]),Fu(a[o-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(o,o+r),t,i,s));this.asyncStream_.push(function(){n(null,s.subarray(0,s.byteLength-s[s.byteLength-1]))})}function qu(t,i){return/^[a-z]+:/i.test(i)?i:(/\/\//i.test(t)||(t=ps.buildAbsoluteURL(e.location.href,t)),ps.buildAbsoluteURL(t,i))}function Vu(e,t,i){return e&&i.responseURL&&t!==i.responseURL?i.responseURL:t}function Gu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var $u=function(e,t,i){return t&&Yu(e.prototype,t),i&&Yu(e,i),e};function Yu(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xu(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Ku(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Qu(e,t){["AUDIO","SUBTITLES"].forEach(function(i){for(var n in e.mediaGroups[i])for(var r in e.mediaGroups[i][n])t(e.mediaGroups[i][n][r],i,n,r)})}function Ju(e,t){var i=nc(e,{}),n=i.playlists[t.uri];if(!n)return null;if(n.segments&&t.segments&&n.segments.length===t.segments.length&&n.endList===t.endList&&n.mediaSequence===t.mediaSequence)return null;var r=nc(n,t);n.segments&&(r.segments=function(e,t,i){var n=t.slice();i=i||0;for(var r=Math.min(e.length,t.length+i),a=i;a<r;a++)n[a-i]=nc(e[a],n[a-i]);return n}(n.segments,t.segments,t.mediaSequence-n.mediaSequence)),r.segments.forEach(function(e){!function(e,t){e.resolvedUri||(e.resolvedUri=qu(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=qu(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=qu(t,e.map.uri))}(e,r.resolvedUri)});for(var a=0;a<i.playlists.length;a++)i.playlists[a].uri===t.uri&&(i.playlists[a]=r);return i.playlists[t.uri]=r,i}function Zu(e){for(var t=e.playlists.length;t--;){var i=e.playlists[t];(e.playlists[i.uri]=i).resolvedUri=qu(e.uri,i.uri),i.id=t,i.attributes||(i.attributes={},rc.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}}function ec(e){Qu(e,function(t){t.uri&&(t.resolvedUri=qu(e.uri,t.uri))})}function tc(e,t){var i=e.segments[e.segments.length-1];return t&&i&&i.duration?1e3*i.duration:500*(e.targetDuration||10)}var ic=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],n=!0,r=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(i.push(s.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(r)throw a}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},nc=hs.mergeOptions,rc=hs.log,ac=(Xu(sc,hs.EventTarget),$u(sc,[{key:"playlistRequestError",value:function(e,t,i){this.request=null,i&&(this.state=i),this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t+".",responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(t,i){var n=this;this.request=null,this.state="HAVE_METADATA";var r=new xs;this.customTagParsers.forEach(function(e){return r.addParser(e)}),this.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(t.responseText),r.end(),r.manifest.uri=i,r.manifest.attributes=r.manifest.attributes||{};var a=Ju(this.master,r.manifest);this.targetDuration=r.manifest.targetDuration,a?(this.master=a,this.media_=this.master.playlists[r.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(e.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=e.setTimeout(function(){n.trigger("mediaupdatetimeout")},tc(this.media(),!!a))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.finalRenditionTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(t,i){var n=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}if(e.clearTimeout(this.finalRenditionTimeout),i){var r=t.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=e.setTimeout(this.media.bind(this,t,!1),r)}else{var a=this.state,s=!this.media_||t.uri!==this.media_.uri;if(this.master.playlists[t.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=t,void(s&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(s){if(this.state="SWITCHING_MEDIA",this.request){if(t.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:t.resolvedUri,withCredentials:this.withCredentials},function(e,i){if(n.request){if(t.resolvedUri=Vu(n.handleManifestRedirects,t.resolvedUri,i),e)return n.playlistRequestError(n.request,t.uri,a);n.haveMetadata(i,t.uri),n.trigger("HAVE_MASTER"===a?"loadedmetadata":"mediachange")}})}}}},{key:"pause",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(t){var i=this;e.clearTimeout(this.mediaUpdateTimeout);var n=this.media();t?this.mediaUpdateTimeout=e.setTimeout(function(){return i.load()},n?n.targetDuration/2*1e3:5e3):this.started?this.trigger(n&&!n.endList?"mediaupdatetimeout":"loadedplaylist"):this.start()}},{key:"start",value:function(){var t=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(i,n){if(t.request){if(t.request=null,i)return t.error={status:n.status,message:"HLS playlist request error at URL: "+t.srcUrl+".",responseText:n.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");var r=new xs;return t.customTagParsers.forEach(function(e){return r.addParser(e)}),t.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(n.responseText),r.end(),t.state="HAVE_MASTER",t.srcUrl=Vu(t.handleManifestRedirects,t.srcUrl,n),r.manifest.uri=t.srcUrl,r.manifest.playlists?(t.master=r.manifest,Zu(t.master),ec(t.master),t.trigger("loadedplaylist"),void(t.request||t.media(r.manifest.playlists[0]))):(t.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:e.location.href,playlists:[{uri:t.srcUrl,id:0,resolvedUri:t.srcUrl,attributes:{}}]},t.master.playlists[t.srcUrl]=t.master.playlists[0],t.haveMetadata(n,t.srcUrl),t.trigger("loadedmetadata"))}})}}]),sc);function sc(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Gu(this,sc);var n=Ku(this,(sc.__proto__||Object.getPrototypeOf(sc)).call(this)),r=i.withCredentials,a=void 0!==r&&r,s=i.handleManifestRedirects,o=void 0!==s&&s;n.srcUrl=e,n.hls_=t,n.withCredentials=a,n.handleManifestRedirects=o;var l=t.options_;if(n.customTagParsers=l&&l.customTagParsers||[],n.customTagMappers=l&&l.customTagMappers||[],!n.srcUrl)throw new Error("A non-empty playlist URL is required");return n.state="HAVE_NOTHING",n.on("mediaupdatetimeout",function(){"HAVE_METADATA"===n.state&&(n.state="HAVE_CURRENT_METADATA",n.request=n.hls_.xhr({uri:qu(n.master.uri,n.media().uri),withCredentials:n.withCredentials},function(e,t){if(n.request)return e?n.playlistRequestError(n.request,n.media().uri,"HAVE_METADATA"):void n.haveMetadata(n.request,n.media().uri)}))}),n}function oc(e,t,i){var n,r;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(n=function(e,t){var i=0,n=t-e.mediaSequence,r=e.segments[n];if(r){if(void 0!==r.start)return{result:r.start,precise:!0};if(void 0!==r.end)return{result:r.end-r.duration,precise:!0}}for(;n--;){if(void 0!==(r=e.segments[n]).end)return{result:i+r.end,precise:!0};if(i+=r.duration,void 0!==r.start)return{result:i+r.start,precise:!0}}return{result:i,precise:!1}}(e,t)).precise?n.result:(r=function(e,t){for(var i=0,n=void 0,r=t-e.mediaSequence;r<e.segments.length;r++){if(void 0!==(n=e.segments[r]).start)return{result:n.start-i,precise:!0};if(i+=n.duration,void 0!==n.end)return{result:n.end-i,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?r.result:n.result+i}function lc(t,i,n){if(!t)return 0;if("number"!=typeof n&&(n=0),void 0===i){if(t.totalDuration)return t.totalDuration;if(!t.endList)return e.Infinity}return oc(t,i,n)}function uc(e,t,i){var n=0;if(i<t){var r=[i,t];t=r[0],i=r[1]}if(t<0){for(var a=t;a<Math.min(0,i);a++)n+=e.targetDuration;t=0}for(var s=t;s<i;s++)n+=e.segments[s].duration;return n}function cc(e){if(!e.segments.length)return 0;for(var t=e.segments.length-1,i=e.segments[t].duration||e.targetDuration,n=i+2*e.targetDuration;t--&&!(n<=(i+=e.segments[t].duration)););return Math.max(0,t)}function hc(e,t,i){if(!e||!e.segments)return null;if(e.endList)return lc(e);if(null===t)return null;t=t||0;var n=i?cc(e):e.segments.length;return oc(e,e.mediaSequence+n,t)}function dc(e){return e-Math.floor(e)==0}function fc(e,t){if(dc(t))return t+.1*e;for(var i=t.toString().split(".")[1].length,n=1;n<=i;n++){var r=Math.pow(10,n),a=t*r;if(dc(a)||n===i)return(a+e)/r}}function pc(e){return e.excludeUntil&&e.excludeUntil>Date.now()}function mc(e){return e.excludeUntil&&e.excludeUntil===1/0}function gc(e){var t=pc(e);return!e.disabled&&!t}function vc(e,t){return t.attributes&&t.attributes[e]}function yc(e,t){if(1===e.playlists.length)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!gc(e)&&(e.attributes.BANDWIDTH||0)<i}).length}function bc(){return function e(t,i){t=jc({timeout:45e3},t);var n=e.beforeRequest||hs.Hls.xhr.beforeRequest;if(n&&"function"==typeof n){var r=n(t);r&&(t=r)}var a=Bc(t,function(e,t){var n=a.response;!e&&n&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=n.byteLength||n.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(n||a.responseText)))),i(e,a)}),s=a.abort;return a.abort=function(){return a.aborted=!0,s.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}}function _c(e){var t={};return e.byterange&&(t.Range=function(e){return"bytes="+e.offset+"-"+(e.offset+e.length-1)}(e.byterange)),t}function Tc(e,t){var i=e.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")}function Sc(e){return 32<=e&&e<126?String.fromCharCode(e):"."}function kc(e){var t={};return Object.keys(e).forEach(function(i){var n=e[i];t[i]=ArrayBuffer.isView(n)?{bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}:n}),t}function wc(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")}function Cc(e){return e.resolvedUri}function xc(e){for(var t=Array.prototype.slice.call(e),i="",n=0;n<t.length/16;n++)i+=t.slice(16*n,16*n+16).map(Tc).join("")+" "+t.slice(16*n,16*n+16).map(Sc).join("")+"\n";return i}function Ec(e,t){var i=[],n=void 0;if(e&&e.length)for(n=0;n<e.length;n++)t(e.start(n),e.end(n))&&i.push([e.start(n),e.end(n)]);return hs.createTimeRanges(i)}function Lc(e,t){return Ec(e,function(e,i){return e-Hc<=t&&t<=i+Hc})}function Ac(e,t){return Ec(e,function(e){return t<=e-Hc})}function Pc(e){var t=[];if(!e||!e.length)return"";for(var i=0;i<e.length;i++)t.push(e.start(i)+" => "+e.end(i));return t.join(", ")}function Oc(e){for(var t=[],i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}function Ic(e,t,i){var n=void 0,r=void 0;if(i&&i.cues)for(n=i.cues.length;n--;)(r=i.cues[n]).startTime<=t&&r.endTime>=e&&i.removeCue(r)}function Mc(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e}var Dc=hs.createTimeRange,Uc=fc.bind(null,1),Rc=fc.bind(null,-1),Nc={duration:lc,seekable:function(e,t){var i=t||0,n=hc(e,t,!0);return null===n?Dc():Dc(i,n)},safeLiveIndex:cc,getMediaInfoForTime:function(e,t,i,n){var r=void 0,a=e.segments.length,s=t-n;if(s<0){if(0<i)for(r=i-1;0<=r;r--)if(0<(s+=Rc(e.segments[r].duration)))return{mediaIndex:r,startTime:n-uc(e,i,r)};return{mediaIndex:0,startTime:t}}if(i<0){for(r=i;r<0;r++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};i=0}for(r=i;r<a;r++)if((s-=Uc(e.segments[r].duration))<0)return{mediaIndex:r,startTime:n+uc(e,i,r)};return{mediaIndex:a-1,startTime:t}},isEnabled:gc,isDisabled:function(e){return e.disabled},isBlacklisted:pc,isIncompatible:mc,playlistEnd:hc,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:vc,estimateSegmentRequestTime:function(e,t,i,n){var r=3<arguments.length&&void 0!==n?n:0;return vc("BANDWIDTH",i)?(e*i.attributes.BANDWIDTH-8*r)/t:NaN},isLowestEnabledRendition:yc},Bc=hs.xhr,jc=hs.mergeOptions,Fc=Object.freeze({createTransferableMessage:kc,initSegmentId:wc,segmentKeyId:Cc,hexDump:xc,tagDump:function(e){return xc(e.bytes)},textRanges:function(e){var t,i,n="",r=void 0;for(r=0;r<e.length;r++)n+=(t=e).start(i=r)+"-"+t.end(i)+" ";return n}}),Hc=1/30,Wc="undefined"!=typeof window?window:{},zc="undefined"==typeof Symbol?"__target":Symbol(),qc="application/javascript",Vc=Wc.BlobBuilder||Wc.WebKitBlobBuilder||Wc.MozBlobBuilder||Wc.MSBlobBuilder,Gc=Wc.URL||Wc.webkitURL||Gc&&Gc.msURL,$c=Wc.Worker;function Yc(e,t){return function(i){var n=this;if(!t)return new $c(e);if($c&&!i){var r=Jc(t.toString().replace(/^function.+?{/,"").slice(0,-1));return this[zc]=new $c(r),function(e,t){if(e&&t){var i=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&Gc.revokeObjectURL(e.objURL),i.call(e)}}}(this[zc],r),this[zc]}var a={postMessage:function(e){n.onmessage&&setTimeout(function(){n.onmessage({data:e,target:a})})}};t.call(a),this.postMessage=function(e){setTimeout(function(){a.onmessage({data:e,target:n})})},this.isThisThread=!0}}if($c){var Xc,Kc=Jc("self.onmessage = function () {}"),Qc=new Uint8Array(1);try{(Xc=new $c(Kc)).postMessage(Qc,[Qc.buffer])}catch(vd){$c=null}finally{Gc.revokeObjectURL(Kc),Xc&&Xc.terminate()}}function Jc(e){try{return Gc.createObjectURL(new Blob([e],{type:qc}))}catch(vd){var t=new Vc;return t.append(e),Gc.createObjectURL(t.getBlob(type))}}function Zc(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,i){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(i).toString(16)).slice(-2)})})}function eh(e){var t,i=0<arguments.length&&void 0!==e?e:"",n={codecCount:0};return n.codecCount=i.split(",").length,n.codecCount=n.codecCount||2,(t=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(i))&&(n.videoCodec=t[2],n.videoObjectTypeIndicator=t[3]),n.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(i),n.audioProfile=n.audioProfile&&n.audioProfile[2],n}function th(e,t,i){return e+"/"+t+'; codecs="'+i.filter(function(e){return!!e}).join(", ")+'"'}function ih(e){return/mp4a\.\d+.\d+/i.test(e)}function nh(e){return/avc1\.[\da-f]+/i.test(e)}var rh=new Yc("./transmuxer-worker.worker.js",function(e,t){var i=this;!function(){var e,t,n,r,a,s,o,l,u,c,h,d,f,p,m,g,v,y,b,_,T,S,k,w,C,x,E,L,A,P,O,I,M,D,U,R,N,B,j,F,H=Math.pow(2,32)-1;!function(){var e;if(S={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in S)S.hasOwnProperty(e)&&(S[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);k=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),C=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),w=new Uint8Array([0,0,0,1]),x=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),E=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),L={video:x,audio:E},O=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),P=new Uint8Array([0,0,0,0,0,0,0,0]),I=new Uint8Array([0,0,0,0,0,0,0,0]),M=I,D=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),U=I,A=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),e=function(e){var t,i,n=[],r=0;for(t=1;t<arguments.length;t++)n.push(arguments[t]);for(t=n.length;t--;)r+=n[t].byteLength;for(i=new Uint8Array(r+8),new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,i.byteLength),i.set(e,4),t=0,r=8;t<n.length;t++)i.set(n[t],r),r+=n[t].byteLength;return i},t=function(){return e(S.dinf,e(S.dref,O))},n=function(t){return e(S.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,t.audioobjecttype<<3|t.samplingfrequencyindex>>>1,t.samplingfrequencyindex<<7|t.channelcount<<3,6,1,2]))},m=function(t){return e(S.hdlr,L[t])},p=function(t){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.samplerate&&(i[12]=t.samplerate>>>24&255,i[13]=t.samplerate>>>16&255,i[14]=t.samplerate>>>8&255,i[15]=255&t.samplerate),e(S.mdhd,i)},f=function(t){return e(S.mdia,p(t),m(t.type),s(t))},a=function(t){return e(S.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},s=function(i){return e(S.minf,"video"===i.type?e(S.vmhd,A):e(S.smhd,P),t(),v(i))},o=function(t,i){for(var n=[],r=i.length;r--;)n[r]=b(i[r]);return e.apply(null,[S.moof,a(t)].concat(n))},l=function(t){for(var i=t.length,n=[];i--;)n[i]=h(t[i]);return e.apply(null,[S.moov,c(4294967295)].concat(n).concat(u(t)))},u=function(t){for(var i=t.length,n=[];i--;)n[i]=_(t[i]);return e.apply(null,[S.mvex].concat(n))},c=function(t){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e(S.mvhd,i)},g=function(t){var i,n,r=t.samples||[],a=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)a[n+4]=(i=r[n].flags).dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return e(S.sdtp,a)},v=function(t){return e(S.stbl,y(t),e(S.stts,U),e(S.stsc,M),e(S.stsz,D),e(S.stco,I))},y=function(t){return e(S.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===t.type?R(t):N(t))},R=function(t){var i,n=t.sps||[],r=t.pps||[],a=[],s=[];for(i=0;i<n.length;i++)a.push((65280&n[i].byteLength)>>>8),a.push(255&n[i].byteLength),a=a.concat(Array.prototype.slice.call(n[i]));for(i=0;i<r.length;i++)s.push((65280&r[i].byteLength)>>>8),s.push(255&r[i].byteLength),s=s.concat(Array.prototype.slice.call(r[i]));return e(S.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),e(S.avcC,new Uint8Array([1,t.profileIdc,t.profileCompatibility,t.levelIdc,255].concat([n.length]).concat(a).concat([r.length]).concat(s))),e(S.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])))},N=function(t){return e(S.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelcount)>>8,255&t.channelcount,(65280&t.samplesize)>>8,255&t.samplesize,0,0,0,0,(65280&t.samplerate)>>8,255&t.samplerate,0,0]),n(t))},d=function(t){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return e(S.tkhd,i)},b=function(t){var i,n,r,a,s,o;return i=e(S.tfhd,new Uint8Array([0,0,0,58,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),s=Math.floor(t.baseMediaDecodeTime/(1+H)),o=Math.floor(t.baseMediaDecodeTime%(1+H)),n=e(S.tfdt,new Uint8Array([1,0,0,0,s>>>24&255,s>>>16&255,s>>>8&255,255&s,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),"audio"===t.type?(r=T(t,92),e(S.traf,i,n,r)):(a=g(t),r=T(t,a.length+92),e(S.traf,i,n,r,a))},h=function(t){return t.duration=t.duration||4294967295,e(S.trak,d(t),f(t))},_=function(t){var i=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==t.type&&(i[i.length-1]=0),e(S.trex,i)},F=function(e,t){var i=0,n=0,r=0,a=0;return e.length&&(void 0!==e[0].duration&&(i=1),void 0!==e[0].size&&(n=2),void 0!==e[0].flags&&(r=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,i|n|r|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(t,i){var n,r,a,s;for(i+=20+16*(r=t.samples||[]).length,n=F(r,i),s=0;s<r.length;s++)n=n.concat([(4278190080&(a=r[s]).duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size,a.flags.isLeading<<2|a.flags.dependsOn,a.flags.isDependedOn<<6|a.flags.hasRedundancy<<4|a.flags.paddingValue<<1|a.flags.isNonSyncSample,61440&a.flags.degradationPriority,15&a.flags.degradationPriority,(4278190080&a.compositionTimeOffset)>>>24,(16711680&a.compositionTimeOffset)>>>16,(65280&a.compositionTimeOffset)>>>8,255&a.compositionTimeOffset]);return e(S.trun,new Uint8Array(n))},B=function(t,i){var n,r,a,s;for(i+=20+8*(r=t.samples||[]).length,n=F(r,i),s=0;s<r.length;s++)n=n.concat([(4278190080&(a=r[s]).duration)>>>24,(16711680&a.duration)>>>16,(65280&a.duration)>>>8,255&a.duration,(4278190080&a.size)>>>24,(16711680&a.size)>>>16,(65280&a.size)>>>8,255&a.size]);return e(S.trun,new Uint8Array(n))},T=function(e,t){return"audio"===e.type?B(e,t):j(e,t)};var W,z,q,V,G,$={ftyp:r=function(){return e(S.ftyp,k,w,k,C)},mdat:function(t){return e(S.mdat,t)},moof:o,moov:l,initSegment:function(e){var t,i=r(),n=l(e);return(t=new Uint8Array(i.byteLength+n.byteLength)).set(i),t.set(n,i.byteLength),t}},Y=function(e){return e>>>0};function X(){this.init=function(){var e={};this.on=function(t,i){e[t]||(e[t]=[]),e[t]=e[t].concat(i)},this.off=function(t,i){var n;return!!e[t]&&(n=e[t].indexOf(i),e[t]=e[t].slice(),e[t].splice(n,1),-1<n)},this.trigger=function(t){var i,n,r,a;if(i=e[t])if(2===arguments.length)for(r=i.length,n=0;n<r;++n)i[n].call(this,arguments[1]);else{for(a=[],n=arguments.length,n=1;n<arguments.length;++n)a.push(arguments[n]);for(r=i.length,n=0;n<r;++n)i[n].apply(this,a)}},this.dispose=function(){e={}}}}q=function(e){return W(e,["moov","trak"]).reduce(function(e,t){var i,n,r,a;return(i=W(t,["tkhd"])[0])?(r=Y(i[n=0===i[0]?12:20]<<24|i[n+1]<<16|i[n+2]<<8|i[n+3]),(a=W(t,["mdia","mdhd"])[0])?(e[r]=Y(a[n=0===a[0]?12:20]<<24|a[n+1]<<16|a[n+2]<<8|a[n+3]),e):null):null},{})},V=function(e,t){var i,n,r;return i=W(t,["moof","traf"]),n=[].concat.apply([],i.map(function(t){return W(t,["tfhd"]).map(function(i){var n,r;return n=Y(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),r=e[n]||9e4,(W(t,["tfdt"]).map(function(e){var t,i;return t=e[0],i=Y(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(i*=Math.pow(2,32),i+=Y(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),i})[0]||1/0)/r})})),r=Math.min.apply(null,n),isFinite(r)?r:0},G=function(e){var t=W(e,["moov","trak"]),i=[];return t.forEach(function(e){var t=W(e,["mdia","hdlr"]),n=W(e,["tkhd"]);t.forEach(function(e,t){var r,a,s=z(e.subarray(8,12)),o=n[t];"vide"===s&&(a=0===(r=new DataView(o.buffer,o.byteOffset,o.byteLength)).getUint8(0)?r.getUint32(12):r.getUint32(20),i.push(a))})}),i};var K={findBox:W=function(e,t){var i,n,r,a,s,o=[];if(!t.length)return null;for(i=0;i<e.byteLength;)n=Y(e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3]),r=z(e.subarray(i+4,i+8)),a=1<n?i+n:e.byteLength,r===t[0]&&(1===t.length?o.push(e.subarray(i+8,a)):(s=W(e.subarray(i+8,a),t.slice(1))).length&&(o=o.concat(s))),i=a;return o},parseType:z=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),(t+=String.fromCharCode(e[2]))+String.fromCharCode(e[3])},timescale:q,startTime:V,videoTrackIds:G};function Q(e){for(var t=[];e--;)t.push(0);return t}function J(){J.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new ve(0,0),new ve(0,1),new ve(1,0),new ve(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("done",this.trigger.bind(this,"done"))},this)}X.prototype.pipe=function(e){return this.on("data",function(t){e.push(t)}),this.on("done",function(t){e.flush(t)}),e},X.prototype.push=function(e){this.trigger("data",e)},X.prototype.flush=function(e){this.trigger("done",e)};var Z,ee,te,ie,ne,re=X,ae=[33,16,5,32,164,27],se=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],oe={96000:[ae,[227,64],Q(154),[56]],88200:[ae,[231],Q(170),[56]],64000:[ae,[248,192],Q(240),[56]],48000:[ae,[255,192],Q(268),[55,148,128],Q(54),[112]],44100:[ae,[255,192],Q(268),[55,163,128],Q(84),[112]],32000:[ae,[255,192],Q(268),[55,234],Q(226),[112]],24000:[ae,[255,192],Q(268),[55,255,128],Q(268),[111,112],Q(126),[224]],16000:[ae,[255,192],Q(268),[55,255,128],Q(268),[111,255],Q(269),[223,108],Q(195),[1,192]],12000:[se,Q(268),[3,127,248],Q(268),[6,255,240],Q(268),[13,255,224],Q(268),[27,253,128],Q(259),[56]],11025:[se,Q(268),[3,127,248],Q(268),[6,255,240],Q(268),[13,255,224],Q(268),[27,255,192],Q(268),[55,175,128],Q(108),[112]],8000:[se,Q(268),[3,121,16],Q(47),[7]]},le=(Z=oe,Object.keys(Z).reduce(function(e,t){return e[t]=new Uint8Array(Z[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),ue=(ee=function(e){return 9e4*e},te=function(e,t){return e*t},ie=function(e){return e/9e4},ne=function(e,t){return e/t},function(e,t){return ee(ne(e,t))}),ce=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},he=function(e,t){var i,n=e.minSegmentDts;return t||(n-=e.timelineStartInfo.dts),i=e.timelineStartInfo.baseMediaDecodeTime,i+=n,i=Math.max(0,i),"audio"===e.type&&(i*=e.samplerate/9e4,i=Math.floor(i)),i},de=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),e.minSegmentPts=void 0===e.minSegmentPts?t.pts:Math.min(e.minSegmentPts,t.pts),e.maxSegmentPts=void 0===e.maxSegmentPts?t.pts:Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),e.minSegmentDts=void 0===e.minSegmentDts?t.dts:Math.min(e.minSegmentDts,t.dts),e.maxSegmentDts=void 0===e.maxSegmentDts?t.dts:Math.max(e.maxSegmentDts,t.dts))};function fe(e){return null===e?"":(e=me[e]||e,String.fromCharCode(e))}function pe(){for(var e=[],t=15;t--;)e.push("");return e}(J.prototype=new re).push=function(e){var t,i,n;if("sei_rbsp"===e.nalUnitType&&4===(t=function(e){for(var t=0,i={payloadType:-1,payloadSize:0},n=0,r=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)n+=255,t++;for(n+=e[t++];255===e[t];)r+=255,t++;if(r+=e[t++],!i.payload&&4===n){i.payloadType=n,i.payloadSize=r,i.payload=e.subarray(t,t+r);break}t+=r,r=n=0}return i}(e.escapedRBSP)).payloadType&&(i=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)}(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));n=function(e,t){var i,n,r,a,s=[];if(!(64&t[0]))return s;for(n=31&t[0],i=0;i<n;i++)a={type:3&t[2+(r=3*i)],pts:e},4&t[2+r]&&(a.ccData=t[3+r]<<8|t[4+r],s.push(a));return s}(e.pts,i),this.captionPackets_=this.captionPackets_.concat(n),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},J.prototype.flush=function(){this.captionPackets_.length?(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0,this.ccStreams_.forEach(function(e){e.flush()},this)):this.ccStreams_.forEach(function(e){e.flush()},this)},J.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},J.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},J.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},J.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},J.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};var me={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ge=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],ve=function e(t,i){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=i||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,i,n,r,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),n=t>>>8,r=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),i=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=i,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=pe();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=pe();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=pe()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(n,r))a=fe((n=(3&n)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(n,r))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=fe((n=(3&n)<<8)|r),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(n,r))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&r)&&this.addFormatting(e.pts,["i"]),1==(1&r)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(n,r))this.column_+=3&r;else if(this.isPAC(n,r)){var s=ge.indexOf(7968&t);"rollUp"===this.mode_&&(s-this.rollUpRows_+1<0&&(s=this.rollUpRows_-1),this.setRollUp(e.pts,s)),s!==this.row_&&(this.clearFormatting(e.pts),this.row_=s),1&r&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(r)&&14==(14&r)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(n)&&(0===r&&(r=null),a=fe(n),a+=fe(r),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};function ye(e,t){var i=1;for(t<e&&(i=-1);4294967296<Math.abs(t-e);)e+=8589934592*i;return e}function be(e){var t,i;be.prototype.init.call(this),this.type_=e,this.push=function(e){e.type===this.type_&&(void 0===i&&(i=e.dts),e.dts=ye(e.dts,i),e.pts=ye(e.pts,i),t=e.dts,this.trigger("data",e))},this.flush=function(){i=t,this.trigger("done")},this.discontinuity=function(){t=i=void 0}}ve.prototype=new re,ve.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},ve.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=pe(),this.nonDisplayed_=pe(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},ve.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},ve.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},ve.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},ve.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},ve.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},ve.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},ve.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},ve.prototype.isNormalChar=function(e){return 32<=e&&e<=127},ve.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=pe(),this.displayed_=pe()),void 0!==t&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},ve.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,i)},ve.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},ve.prototype.popOn=function(e,t){var i=this.nonDisplayed_[this.row_];this.nonDisplayed_[this.row_]=i+=t},ve.prototype.rollUp=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t},ve.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},ve.prototype.paintOn=function(e,t){var i=this.displayed_[this.row_];this.displayed_[this.row_]=i+=t};var _e={CaptionStream:J,Cea608Stream:ve},Te={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};function Se(e,t,i){var n,r="";for(n=t;n<i;n++)r+="%"+("00"+e[n].toString(16)).slice(-2);return r}function ke(e,t,i){return decodeURIComponent(Se(e,t,i))}function we(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}be.prototype=new re;var Ce,xe=be,Ee={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=ke(e.data,1,t),e.value=ke(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=ke(e.data,1,t),e.url=ke(e.data,t+1,e.data.length);break}},PRIV:function(e){var t;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=unescape(Se(e.data,0,t));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Ce=function(e){var t,i={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},n=0,r=[],a=0;if(Ce.prototype.init.call(this),this.dispatchType=Te.METADATA_STREAM_TYPE.toString(16),i.descriptor)for(t=0;t<i.descriptor.length;t++)this.dispatchType+=("00"+i.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,i,s,o,l;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(a=0,r.length=0),0===r.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)));else if(r.push(e),a+=e.data.byteLength,1===r.length&&(n=we(e.data.subarray(6,10)),n+=10),!(a<n)){for(t={data:new Uint8Array(n),frames:[],pts:r[0].pts,dts:r[0].dts},l=0;l<n;)t.data.set(r[0].data.subarray(0,n-l),l),l+=r[0].data.byteLength,a-=r[0].data.byteLength,r.shift();i=10,64&t.data[5]&&(i+=4,i+=we(t.data.subarray(10,14)),n-=we(t.data.subarray(16,20)));do{if((s=we(t.data.subarray(i+4,i+8)))<1)return;if((o={id:String.fromCharCode(t.data[i],t.data[i+1],t.data[i+2],t.data[i+3]),data:t.data.subarray(i+10,i+s+10)}).key=o.id,Ee[o.id]&&(Ee[o.id](o),"com.apple.streaming.transportStreamTimestamp"===o.owner)){var u=o.data,c=(1&u[3])<<30|u[4]<<22|u[5]<<14|u[6]<<6|u[7]>>>2;c*=4,o.timeStamp=c+=3&u[7],void 0===t.pts&&void 0===t.dts&&(t.pts=o.timeStamp,t.dts=o.timeStamp),this.trigger("timestamp",o)}t.frames.push(o),i+=10,i+=s}while(i<n);this.trigger("data",t)}}}).prototype=new re;var Le,Ae,Pe,Oe=Ce,Ie=xe;(Le=function(){var e=new Uint8Array(188),t=0;Le.prototype.init.call(this),this.push=function(i){var n,r=0,a=188;for(t?((n=new Uint8Array(i.byteLength+t)).set(e.subarray(0,t)),n.set(i,t),t=0):n=i;a<n.byteLength;)71!==n[r]||71!==n[a]?(r++,a++):(this.trigger("data",n.subarray(r,a)),r+=188,a+=188);r<n.byteLength&&(e.set(n.subarray(r),0),t=n.byteLength-r)},this.flush=function(){188===t&&71===e[0]&&(this.trigger("data",e),t=0),this.trigger("done")}}).prototype=new re,(Ae=function(){var e,t,i,n;Ae.prototype.init.call(this),(n=this).packetsWaitingForPmt=[],this.programMapTable=void 0,e=function(e,n){var r=0;n.payloadUnitStartIndicator&&(r+=e[r]+1),"pat"===n.type?t(e.subarray(r),n):i(e.subarray(r),n)},t=function(e,t){t.section_number=e[7],t.last_section_number=e[8],n.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=n.pmtPid},i=function(e,t){var i,r;if(1&e[5]){for(n.programMapTable={video:null,audio:null,"timed-metadata":{}},i=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<i;){var a=e[r],s=(31&e[r+1])<<8|e[r+2];a===Te.H264_STREAM_TYPE&&null===n.programMapTable.video?n.programMapTable.video=s:a===Te.ADTS_STREAM_TYPE&&null===n.programMapTable.audio?n.programMapTable.audio=s:a===Te.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][s]=a),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=n.programMapTable}},this.push=function(t){var i={},n=4;if(i.payloadUnitStartIndicator=!!(64&t[1]),i.pid=31&t[1],i.pid<<=8,i.pid|=t[2],1<(48&t[3])>>>4&&(n+=t[n]+1),0===i.pid)i.type="pat",e(t.subarray(n),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",e(t.subarray(n),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([t,n,i]):this.processPes_(t,n,i)},this.processPes_=function(e,t,i){i.streamType=i.pid===this.programMapTable.video?Te.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?Te.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][i.pid],i.type="pes",i.data=e.subarray(t),this.trigger("data",i)}}).prototype=new re,Ae.STREAM_TYPES={h264:27,adts:15},(Pe=function(){function e(e,i,n){var r,a,s=new Uint8Array(e.size),o={type:i},l=0,u=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,l=0;l<e.data.length;l++)s.set((a=e.data[l]).data,u),u+=a.data.byteLength;!function(e,t){var i;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!=(4&e[6]),192&(i=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&i&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])}(s,o),r="video"===i||o.packetLength<=e.size,(n||r)&&(e.size=0,e.data.length=0),r&&t.trigger("data",o)}}var t=this,i={data:[],size:0},n={data:[],size:0},r={data:[],size:0};Pe.prototype.init.call(this),this.push=function(a){({pat:function(){},pes:function(){var t,s;switch(a.streamType){case Te.H264_STREAM_TYPE:case Te.H264_STREAM_TYPE:t=i,s="video";break;case Te.ADTS_STREAM_TYPE:t=n,s="audio";break;case Te.METADATA_STREAM_TYPE:t=r,s="timed-metadata";break;default:return}a.payloadUnitStartIndicator&&e(t,s,!0),t.data.push(a),t.size+=a.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]},i=a.programMapTable;null!==i.video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.video,codec:"avc",type:"video"}),null!==i.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+i.audio,codec:"adts",type:"audio"}),t.trigger("data",e)}})[a.type]()},this.flush=function(){e(i,"video"),e(n,"audio"),e(r,"timed-metadata"),this.trigger("done")}}).prototype=new re;var Me={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Le,TransportParseStream:Ae,ElementaryStream:Pe,TimestampRolloverStream:Ie,CaptionStream:_e.CaptionStream,Cea608Stream:_e.Cea608Stream,MetadataStream:Oe};for(var De in Te)Te.hasOwnProperty(De)&&(Me[De]=Te[De]);var Ue,Re=Me,Ne=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ue=function(){var e;Ue.prototype.init.call(this),this.push=function(t){var i,n,r,a,s=0,o=0;if("audio"===t.type)for(e?(n=e,(e=new Uint8Array(n.byteLength+t.data.byteLength)).set(n),e.set(t.data,n.byteLength)):e=t.data;s+5<e.length;)if(255===e[s]&&240==(246&e[s+1])){if(a=9e4*(r=1024*(1+(3&e[s+6])))/Ne[(60&e[s+2])>>>2],e.byteLength<(i=s+((3&e[s+3])<<11|e[s+4]<<3|(224&e[s+5])>>5)))return;if(this.trigger("data",{pts:t.pts+o*a,dts:t.dts+o*a,sampleCount:r,audioobjecttype:1+(e[s+2]>>>6&3),channelcount:(1&e[s+2])<<2|(192&e[s+3])>>>6,samplerate:Ne[(60&e[s+2])>>>2],samplingfrequencyindex:(60&e[s+2])>>>2,samplesize:16,data:e.subarray(s+7+2*(1&~e[s+1]),i)}),e.byteLength===i)return void(e=void 0);o++,e=e.subarray(i)}else s++},this.flush=function(){this.trigger("done")}}).prototype=new re;var Be,je,Fe,He=Ue,We=function(e){var t=e.byteLength,i=0,n=0;this.length=function(){return 8*t},this.bitsAvailable=function(){return 8*t+n},this.loadWord=function(){var r=e.byteLength-t,a=new Uint8Array(4),s=Math.min(4,t);if(0===s)throw new Error("no bytes available");a.set(e.subarray(r,r+s)),i=new DataView(a.buffer).getUint32(0),n=8*s,t-=s},this.skipBits=function(e){var r;e<n||(e-=n,e-=8*(r=Math.floor(e/8)),t-=r,this.loadWord()),i<<=e,n-=e},this.readBits=function(e){var r=Math.min(n,e),a=i>>>32-r;return 0<(n-=r)?i<<=r:0<t&&this.loadWord(),0<(r=e-r)?a<<r|this.readBits(r):a},this.skipLeadingZeros=function(){var e;for(e=0;e<n;++e)if(0!=(i&2147483648>>>e))return i<<=e,n-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(je=function(){var e,t,i=0;je.prototype.init.call(this),this.push=function(n){var r;for(t=t?((r=new Uint8Array(t.byteLength+n.data.byteLength)).set(t),r.set(n.data,t.byteLength),r):n.data;i<t.byteLength-3;i++)if(1===t[i+2]){e=i+5;break}for(;e<t.byteLength;)switch(t[e]){case 0:if(0!==t[e-1]){e+=2;break}if(0!==t[e-2]){e++;break}for(i+3!==e-2&&this.trigger("data",t.subarray(i+3,e-2));1!==t[++e]&&e<t.length;);i=e-2,e+=3;break;case 1:if(0!==t[e-1]||0!==t[e-2]){e+=3;break}this.trigger("data",t.subarray(i+3,e-2)),i=e-2,e+=3;break;default:e+=3}t=t.subarray(i),e-=i,i=0},this.flush=function(){t&&3<t.byteLength&&this.trigger("data",t.subarray(i+3)),t=null,i=0,this.trigger("done")}}).prototype=new re,Fe={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Be=function(){var e,t,i,n,r,a,s,o=new je;Be.prototype.init.call(this),(e=this).push=function(e){"video"===e.type&&(t=e.trackId,i=e.pts,n=e.dts,o.push(e))},o.on("data",function(s){var o={trackId:t,pts:i,dts:n,data:s};switch(31&s[0]){case 5:o.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:o.nalUnitType="sei_rbsp",o.escapedRBSP=r(s.subarray(1));break;case 7:o.nalUnitType="seq_parameter_set_rbsp",o.escapedRBSP=r(s.subarray(1)),o.config=a(o.escapedRBSP);break;case 8:o.nalUnitType="pic_parameter_set_rbsp";break;case 9:o.nalUnitType="access_unit_delimiter_rbsp"}e.trigger("data",o)}),o.on("done",function(){e.trigger("done")}),this.flush=function(){o.flush()},s=function(e,t){var i,n=8,r=8;for(i=0;i<e;i++)0!==r&&(r=(n+t.readExpGolomb()+256)%256),n=0===r?n:r},r=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},a=function(e){var t,i,n,r,a,o,l,u,c,h,d,f,p,m=0,g=0,v=0,y=0,b=1;if(i=(t=new We(e)).readUnsignedByte(),r=t.readUnsignedByte(),n=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),Fe[i]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=3!==a?8:12,p=0;p<d;p++)t.readBoolean()&&s(p<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),l=t.readUnsignedExpGolomb(),p=0;p<l;p++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),u=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),0===(h=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(m=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb(),y=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:f=[1,1];break;case 2:f=[12,11];break;case 3:f=[10,11];break;case 4:f=[16,11];break;case 5:f=[40,33];break;case 6:f=[24,11];break;case 7:f=[20,11];break;case 8:f=[32,11];break;case 9:f=[80,33];break;case 10:f=[18,11];break;case 11:f=[15,11];break;case 12:f=[64,33];break;case 13:f=[160,99];break;case 14:f=[4,3];break;case 15:f=[3,2];break;case 16:f=[2,1];break;case 255:f=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}f&&(b=f[0]/f[1])}return{profileIdc:i,levelIdc:n,profileCompatibility:r,width:Math.ceil((16*(u+1)-2*m-2*g)*b),height:(2-h)*(c+1)*16-2*v-2*y}}}).prototype=new re;var ze,qe={H264Stream:Be,NalByteStream:je},Ve=function(e,t){var i=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+i:10+i},Ge=function(e,t){return 6144&e[t+3]|e[t+4]<<3|(224&e[t+5])>>5};function $e(e,t){var i;if(e.length!==t.length)return!1;for(i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}function Ye(e,t,i,n,r,a){return{start:{dts:e,pts:e+(i-t)},end:{dts:e+(n-t),pts:e+(r-i)},prependedContentDuration:a,baseMediaDecodeTime:e}}(ze=function(){var e=new Uint8Array,t=0;ze.prototype.init.call(this),this.setTimestamp=function(e){t=e},this.push=function(i){var n,r,a,s=0,o=0;for(e.length?(a=e.length,(e=new Uint8Array(i.byteLength+a)).set(e.subarray(0,a)),e.set(i,a)):e=i;3<=e.length-o;)if(e[o]!=="I".charCodeAt(0)||e[o+1]!=="D".charCodeAt(0)||e[o+2]!=="3".charCodeAt(0))if(255!=(255&e[o])||240!=(240&e[o+1]))o++;else{if(e.length-o<7)break;if(o+(s=Ge(e,o))>e.length)break;r={type:"audio",data:e.subarray(o,o+s),pts:t,dts:t},this.trigger("data",r),o+=s}else{if(e.length-o<10)break;if(o+(s=Ve(e,o))>e.length)break;n={type:"timed-metadata",data:e.subarray(o,o+s)},this.trigger("data",n),o+=s}e=0<e.length-o?e.subarray(o):new Uint8Array}}).prototype=new re;var Xe,Ke,Qe,Je,Ze=ze,et=qe.H264Stream,tt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],it=["width","height","profileIdc","levelIdc","profileCompatibility"];function nt(e){return new Date(1e3*e-20828448e5)}function rt(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}function at(e,t){for(var i=e,n=0;n<t.length;n++){var r=t[n];if(i<r.size)return r;i-=r.size}return null}function st(e,t){var i=K.findBox(e,["moof","traf"]),n=K.findBox(e,["mdat"]),r={},a=[];return n.forEach(function(e,t){a.push({mdat:e,traf:i[t]})}),a.forEach(function(e){var i,n=e.mdat,a=e.traf,s=K.findBox(a,["tfhd"]),o=dt.parseTfhd(s[0]),l=o.trackId,u=K.findBox(a,["tfdt"]),c=0<u.length?dt.parseTfdt(u[0]).baseMediaDecodeTime:0,h=K.findBox(a,["trun"]);t===l&&0<h.length&&(i=function(e,t,i){var n,r,a,s,o=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(r=0;r+4<e.length;r+=a)if(a=o.getUint32(r),r+=4,!(a<=0))switch(31&e[r]){case 6:var u=e.subarray(r+1,r+1+a),c=at(r,t);n={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:ft(u),trackId:i},c?(n.pts=c.pts,n.dts=c.dts,s=c):(n.pts=s.pts,n.dts=s.dts),l.push(n)}return l}(n,function(e,t,i){var n=c,r=i.defaultSampleDuration||0,a=i.defaultSampleSize||0,s=i.trackId,o=[];return h.forEach(function(e){var t=dt.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=r),void 0===e.size&&(e.size=a),e.trackId=s,e.dts=n,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=n+e.compositionTimeOffset,n+=e.duration}),o=o.concat(t)}),o}(0,0,o),l),r[l]||(r[l]=[]),r[l]=r[l].concat(i))}),r}(Ke=function(e,t){var i=[],n=0,r=0,a=0,s=1/0;t=t||{},Ke.prototype.init.call(this),this.push=function(t){de(e,t),e&&tt.forEach(function(i){e[i]=t[i]}),i.push(t)},this.setEarliestDts=function(t){r=t-e.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){s=e},this.setAudioAppendStart=function(e){a=e},this.flush=function(){var o,l,u,c;0!==i.length&&(o=function(e,t,i){return t.minSegmentDts>=i?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=i&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))}(i,e,r),e.baseMediaDecodeTime=he(e,t.keepOriginalTimestamps),function(e,t,i,n){var r,a,s,o,l=0,u=0,c=0;if(t.length&&(r=ue(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(9e4/(e.samplerate/1024)),i&&n&&(l=r-Math.max(i,n),c=(u=Math.floor(l/a))*a),!(u<1||45e3<c))){for(s=(s=le[e.samplerate])||t[0].data,o=0;o<u;o++)t.splice(o,0,{data:s});e.baseMediaDecodeTime-=Math.floor(function(e,t){return te(ie(c),t)}(0,e.samplerate))}}(e,o,a,s),e.samples=function(e){var t,i=[];for(t=0;t<e.length;t++)i.push({size:e[t].data.byteLength,duration:1024});return i}(o),u=$.mdat(function(e){var t,i,n=0,r=new Uint8Array(function(e){var t,i=0;for(t=0;t<e.length;t++)i+=e[t].data.byteLength;return i}(e));for(t=0;t<e.length;t++)r.set((i=e[t]).data,n),n+=i.data.byteLength;return r}(o)),i=[],l=$.moof(n,[e]),c=new Uint8Array(l.byteLength+u.byteLength),n++,c.set(l),c.set(u,l.byteLength),ce(e),this.trigger("data",{track:e,boxes:c})),this.trigger("done","AudioSegmentStream")}}).prototype=new re,(Xe=function(e,t){var i,n,r=0,a=[],s=[];t=t||{},Xe.prototype.init.call(this),delete e.minPTS,this.gopCache_=[],this.push=function(t){de(e,t),"seq_parameter_set_rbsp"!==t.nalUnitType||i||(i=t.config,e.sps=[t.data],it.forEach(function(t){e[t]=i[t]},this)),"pic_parameter_set_rbsp"!==t.nalUnitType||n||(n=t.data,e.pps=[t.data]),a.push(t)},this.flush=function(){for(var i,n,o,l,u,c,h,d,f=0;a.length&&"access_unit_delimiter_rbsp"!==a[0].nalUnitType;)a.shift();if(0===a.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(i=function(e){var t,i,n=[],r=[];for(t=n.byteLength=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(i=e[t]).nalUnitType?(n.length&&(n.duration=i.dts-n.dts,r.push(n)),(n=[i]).byteLength=i.data.byteLength,n.pts=i.pts,n.dts=i.dts):("slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(n.keyFrame=!0),n.duration=i.dts-n.dts,n.byteLength+=i.data.byteLength,n.push(i));return r.length&&(!n.duration||n.duration<=0)&&(n.duration=r[r.length-1].duration),r.push(n),r}(a),(o=function(e){var t,i,n=[],r=[];for(n.byteLength=0,n.nalCount=0,n.duration=0,n.pts=e[0].pts,n.dts=e[0].dts,r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,t=0;t<e.length;t++)(i=e[t]).keyFrame?(n.length&&(r.push(n),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration),(n=[i]).nalCount=i.length,n.byteLength=i.byteLength,n.pts=i.pts,n.dts=i.dts,n.duration=i.duration):(n.duration+=i.duration,n.nalCount+=i.length,n.byteLength+=i.byteLength,n.push(i));return r.length&&n.duration<=0&&(n.duration=r[r.length-1].duration),r.byteLength+=n.byteLength,r.nalCount+=n.nalCount,r.duration+=n.duration,r.push(n),r}(i))[0][0].keyFrame||((n=this.getGopForFusion_(a[0],e))?(f=n.duration,o.unshift(n),o.byteLength+=n.byteLength,o.nalCount+=n.nalCount,o.pts=n.pts,o.dts=n.dts,o.duration+=n.duration):o=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e}(o)),s.length){var p;if(!(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(o):this.alignGopsAtStart_(o)))return this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");ce(e),o=p}de(e,o),e.samples=function(e,t){var i,n,r,a,s,o,l=0,u=[];for(i=0;i<e.length;i++)for(a=e[i],n=0;n<a.length;n++)s=a[n],o=void 0,(o={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}).dataOffset=l,o.compositionTimeOffset=s.pts-s.dts,o.duration=s.duration,o.size=4*s.length,o.size+=s.byteLength,s.keyFrame&&(o.flags.dependsOn=2,o.flags.isNonSyncSample=0),l+=(r=o).size,u.push(r);return u}(o),u=$.mdat(function(e){var t,i,n,r,a,s,o=0,l=new Uint8Array(e.byteLength+4*e.nalCount),u=new DataView(l.buffer);for(t=0;t<e.length;t++)for(r=e[t],i=0;i<r.length;i++)for(a=r[i],n=0;n<a.length;n++)u.setUint32(o,(s=a[n]).data.byteLength),l.set(s.data,o+=4),o+=s.data.byteLength;return l}(o)),e.baseMediaDecodeTime=he(e,t.keepOriginalTimestamps),this.trigger("processedGopsInfo",o.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),this.trigger("segmentTimingInfo",Ye(e.baseMediaDecodeTime,(h=o[0]).dts,h.pts,(d=o[o.length-1]).dts+d.duration,d.pts+d.duration,f)),this.gopCache_.unshift({gop:o.pop(),pps:e.pps,sps:e.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),a=[],this.trigger("baseMediaDecodeTime",e.baseMediaDecodeTime),this.trigger("timelineStartInfo",e.timelineStartInfo),l=$.moof(r,[e]),c=new Uint8Array(l.byteLength+u.byteLength),r++,c.set(l),c.set(u,l.byteLength),this.trigger("data",{track:e,boxes:c}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.resetStream_=function(){ce(e),n=i=void 0},this.getGopForFusion_=function(t){var i,n,r,a,s,o=1/0;for(s=0;s<this.gopCache_.length;s++)r=(a=this.gopCache_[s]).gop,e.pps&&$e(e.pps[0],a.pps[0])&&e.sps&&$e(e.sps[0],a.sps[0])&&(r.dts<e.timelineStartInfo.dts||-1e4<=(i=t.dts-r.dts-r.duration)&&i<=45e3&&(!n||i<o)&&(n=a,o=i));return n?n.gop:null},this.alignGopsAtStart_=function(e){var t,i,n,r,a,o,l,u;for(a=e.byteLength,o=e.nalCount,l=e.duration,t=i=0;t<s.length&&i<e.length&&(n=s[t]).pts!==(r=e[i]).pts;)r.pts>n.pts?t++:(i++,a-=r.byteLength,o-=r.nalCount,l-=r.duration);return 0===i?e:i===e.length?null:((u=e.slice(i)).byteLength=a,u.duration=l,u.nalCount=o,u.pts=u[0].pts,u.dts=u[0].dts,u)},this.alignGopsAtEnd_=function(e){var t,i,n,r,a,o,l;for(t=s.length-1,i=e.length-1,a=null,o=!1;0<=t&&0<=i;){if((n=s[t]).pts===(r=e[i]).pts){o=!0;break}n.pts>r.pts?t--:(t===s.length-1&&(a=i),i--)}if(!o&&null===a)return null;if(0===(l=o?i:a))return e;var u=e.slice(l),c=u.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return u.byteLength=c.byteLength,u.duration=c.duration,u.nalCount=c.nalCount,u.pts=u[0].pts,u.dts=u[0].dts,u},this.alignGopsWith=function(e){s=e}}).prototype=new re,(Je=function(e,t){this.numberOfTracks=0,this.metadataStream=t,this.remuxTracks=void 0===(e=e||{}).remux||!!e.remux,"boolean"==typeof e.keepOriginalTimestamps&&(this.keepOriginalTimestamps=e.keepOriginalTimestamps),this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,Je.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBoxes.push(e.boxes),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track),void("audio"===e.track.type&&(this.audioTrack=e.track)))}}).prototype=new re,Je.prototype.flush=function(e){var t,i,n,r,a=0,s={captions:[],captionStreams:{},metadata:[],info:{}},o=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}for(this.videoTrack?(o=this.videoTrack.timelineStartInfo.pts,it.forEach(function(e){s.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts,tt.forEach(function(e){s.info[e]=this.audioTrack[e]},this)),s.type=1===this.pendingTracks.length?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,n=$.initSegment(this.pendingTracks),s.initSegment=new Uint8Array(n.byteLength),s.initSegment.set(n),s.data=new Uint8Array(this.pendingBytes),r=0;r<this.pendingBoxes.length;r++)s.data.set(this.pendingBoxes[r],a),a+=this.pendingBoxes[r].byteLength;for(r=0;r<this.pendingCaptions.length;r++)(t=this.pendingCaptions[r]).startTime=t.startPts,this.keepOriginalTimestamps||(t.startTime-=o),t.startTime/=9e4,t.endTime=t.endPts,this.keepOriginalTimestamps||(t.endTime-=o),t.endTime/=9e4,s.captionStreams[t.stream]=!0,s.captions.push(t);for(r=0;r<this.pendingMetadata.length;r++)(i=this.pendingMetadata[r]).cueTime=i.pts,this.keepOriginalTimestamps||(i.cueTime-=o),i.cueTime/=9e4,s.metadata.push(i);s.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",s),this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},(Qe=function(e){var t,i,n=this,r=!0;Qe.prototype.init.call(this),this.baseMediaDecodeTime=(e=e||{}).baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new Re.MetadataStream,t.aacStream=new Ze,t.audioTimestampRolloverStream=new Re.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new Re.TimestampRolloverStream("timed-metadata"),t.adtsStream=new He,t.coalesceStream=new Je(e,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(r){"timed-metadata"!==r.type||t.audioSegmentStream||(i=i||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new Ke(i,e),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream))}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var r={};(this.transmuxPipeline_=r).type="ts",r.metadataStream=new Re.MetadataStream,r.packetStream=new Re.TransportPacketStream,r.parseStream=new Re.TransportParseStream,r.elementaryStream=new Re.ElementaryStream,r.videoTimestampRolloverStream=new Re.TimestampRolloverStream("video"),r.audioTimestampRolloverStream=new Re.TimestampRolloverStream("audio"),r.timedMetadataTimestampRolloverStream=new Re.TimestampRolloverStream("timed-metadata"),r.adtsStream=new He,r.h264Stream=new et,r.captionStream=new Re.CaptionStream,r.coalesceStream=new Je(e,r.metadataStream),r.headOfPipeline=r.packetStream,r.packetStream.pipe(r.parseStream).pipe(r.elementaryStream),r.elementaryStream.pipe(r.videoTimestampRolloverStream).pipe(r.h264Stream),r.elementaryStream.pipe(r.audioTimestampRolloverStream).pipe(r.adtsStream),r.elementaryStream.pipe(r.timedMetadataTimestampRolloverStream).pipe(r.metadataStream).pipe(r.coalesceStream),r.h264Stream.pipe(r.captionStream).pipe(r.coalesceStream),r.elementaryStream.on("data",function(a){var s;if("metadata"===a.type){for(s=a.tracks.length;s--;)t||"video"!==a.tracks[s].type?i||"audio"!==a.tracks[s].type||((i=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime):(t=a.tracks[s]).timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime;t&&!r.videoSegmentStream&&(r.coalesceStream.numberOfTracks++,r.videoSegmentStream=new Xe(t,e),r.videoSegmentStream.on("timelineStartInfo",function(e){i&&(i.timelineStartInfo=e,r.audioSegmentStream.setEarliestDts(e.dts))}),r.videoSegmentStream.on("processedGopsInfo",n.trigger.bind(n,"gopInfo")),r.videoSegmentStream.on("segmentTimingInfo",n.trigger.bind(n,"videoSegmentTimingInfo")),r.videoSegmentStream.on("baseMediaDecodeTime",function(e){i&&r.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),r.h264Stream.pipe(r.videoSegmentStream).pipe(r.coalesceStream)),i&&!r.audioSegmentStream&&(r.coalesceStream.numberOfTracks++,r.audioSegmentStream=new Ke(i,e),r.adtsStream.pipe(r.audioSegmentStream).pipe(r.coalesceStream))}}),r.coalesceStream.on("data",this.trigger.bind(this,"data")),r.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(n){var r=this.transmuxPipeline_;e.keepOriginalTimestamps||(this.baseMediaDecodeTime=n),i&&(i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,ce(i),e.keepOriginalTimestamps||(i.timelineStartInfo.baseMediaDecodeTime=n),r.audioTimestampRolloverStream&&r.audioTimestampRolloverStream.discontinuity()),t&&(r.videoSegmentStream&&(r.videoSegmentStream.gopCache_=[],r.videoTimestampRolloverStream.discontinuity()),t.timelineStartInfo.dts=void 0,t.timelineStartInfo.pts=void 0,ce(t),r.captionStream.reset(),e.keepOriginalTimestamps||(t.timelineStartInfo.baseMediaDecodeTime=n)),r.timedMetadataTimestampRolloverStream&&r.timedMetadataTimestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.alignGopsWith=function(e){t&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(r){var t=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)}(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),r=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){r=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new re;var ot,lt,ut={Transmuxer:Qe,VideoSegmentStream:Xe,AudioSegmentStream:Ke,AUDIO_PROPERTIES:tt,VIDEO_PROPERTIES:it,generateVideoSegmentTimingInfo:Ye},ct=K.parseType,ht={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:ot(e.subarray(78,e.byteLength))}},avcC:function(e){var t,i,n,r,a=new DataView(e.buffer,e.byteOffset,e.byteLength),s={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},o=31&e[5];for(n=6,r=0;r<o;r++)i=a.getUint16(n),n+=2,s.sps.push(new Uint8Array(e.subarray(n,n+i))),n+=i;for(t=e[n],n++,r=0;r<t;r++)i=a.getUint16(n),n+=2,s.pps.push(new Uint8Array(e.subarray(n,n+i))),n+=i;return s},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={majorBrand:ct(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},n=8;n<e.byteLength;)i.compatibleBrands.push(ct(e.subarray(n,n+4))),n+=4;return i},dinf:function(e){return{boxes:ot(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:ot(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:ct(e.subarray(8,12)),name:""},i=8;for(i=24;i<e.byteLength;i++){if(0===e[i]){i++;break}t.name+=String.fromCharCode(e[i])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,i,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=[];for(t=0;t+4<e.length;t+=i)if(i=n.getUint32(t),t+=4,i<=0)r.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:r.push("slice_layer_without_partitioning_rbsp");break;case 5:r.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:r.push("sei_rbsp");break;case 7:r.push("seq_parameter_set_rbsp");break;case 8:r.push("pic_parameter_set_rbsp");break;case 9:r.push("access_unit_delimiter_rbsp");break;default:r.push("UNKNOWN NAL - "+e[t]&31)}return r}(e)}},mdhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:i.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===r.version?(r.creationTime=nt(i.getUint32(n+=4)),r.modificationTime=nt(i.getUint32(n+=8)),r.timescale=i.getUint32(n+=4),n+=8):(r.creationTime=nt(i.getUint32(n)),r.modificationTime=nt(i.getUint32(n+=4)),r.timescale=i.getUint32(n+=4),n+=4),r.duration=i.getUint32(n),t=i.getUint16(n+=4),r.language+=String.fromCharCode(96+(t>>10)),r.language+=String.fromCharCode(96+((992&t)>>5)),r.language+=String.fromCharCode(96+(31&t)),r},mdia:function(e){return{boxes:ot(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:ot(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return 28<e.byteLength&&(i.streamDescriptor=ot(e.subarray(28))[0]),i},moof:function(e){return{boxes:ot(e)}},moov:function(e){return{boxes:ot(e)}},mvex:function(e){return{boxes:ot(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===n.version?(n.creationTime=nt(t.getUint32(i+=4)),n.modificationTime=nt(t.getUint32(i+=8)),n.timescale=t.getUint32(i+=4),i+=8):(n.creationTime=nt(t.getUint32(i)),n.modificationTime=nt(t.getUint32(i+=4)),n.timescale=t.getUint32(i+=4),i+=4),n.duration=t.getUint32(i),n.rate=t.getUint16(i+=4)+t.getUint16(i+2)/16,n.volume=t.getUint8(i+=4)+t.getUint8(i+1)/8,i+=2,i+=2,i+=8,n.matrix=new Uint32Array(e.subarray(i,i+36)),i+=36,n.nextTrackId=t.getUint32(i+=24),n},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)i.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return i},sidx:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8),earliestPresentationTime:i.getUint32(12),firstOffset:i.getUint32(16)},r=i.getUint16(22);for(t=24;r;t+=12,r--)n.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&i.getUint32(t),subsegmentDuration:i.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&i.getUint32(t+8)});return n},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:ot(e)}},stco:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},r=i.getUint32(4);for(t=8;r;t+=4,r--)n.chunkOffsets.push(i.getUint32(t));return n},stsc:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n=i.getUint32(4),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;n;t+=12,n--)r.sampleToChunks.push({firstChunk:i.getUint32(t),samplesPerChunk:i.getUint32(t+4),sampleDescriptionIndex:i.getUint32(t+8)});return r},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:ot(e.subarray(8))}},stsz:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:i.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)n.entries.push(i.getUint32(t));return n},stts:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},r=i.getUint32(4);for(t=8;r;t+=8,r--)n.timeToSamples.push({sampleCount:i.getUint32(t),sampleDelta:i.getUint32(t+4)});return n},styp:function(e){return ht.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,i=new DataView(e.buffer,e.byteOffset,e.byteLength),n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:i.getUint32(4)},r=1&n.flags[2],a=2&n.flags[2],s=8&n.flags[2],o=16&n.flags[2],l=32&n.flags[2],u=65536&n.flags[0],c=131072&n.flags[0];return t=8,r&&(t+=4,n.baseDataOffset=i.getUint32(12),t+=4),a&&(n.sampleDescriptionIndex=i.getUint32(t),t+=4),s&&(n.defaultSampleDuration=i.getUint32(t),t+=4),o&&(n.defaultSampleSize=i.getUint32(t),t+=4),l&&(n.defaultSampleFlags=i.getUint32(t)),u&&(n.durationIsEmpty=!0),!r&&c&&(n.baseDataOffsetIsMoof=!0),n},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=4,n={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===n.version?(n.creationTime=nt(t.getUint32(i+=4)),n.modificationTime=nt(t.getUint32(i+=8)),n.trackId=t.getUint32(i+=4),i+=4,i+=8):(n.creationTime=nt(t.getUint32(i)),n.modificationTime=nt(t.getUint32(i+=4)),n.trackId=t.getUint32(i+=4),i+=4,i+=4),n.duration=t.getUint32(i),i+=4,n.layer=t.getUint16(i+=8),n.alternateGroup=t.getUint16(i+=2),n.volume=t.getUint8(i+=2)+t.getUint8(i+1)/8,i+=2,i+=2,n.matrix=new Uint32Array(e.subarray(i,i+36)),n.width=t.getUint16(i+=36)+t.getUint16(i+2)/16,n.height=t.getUint16(i+=4)+t.getUint16(i+2)/16,n},traf:function(e){return{boxes:ot(e)}},trak:function(e){return{boxes:ot(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=1&i.flags[2],a=4&i.flags[2],s=1&i.flags[1],o=2&i.flags[1],l=4&i.flags[1],u=8&i.flags[1],c=n.getUint32(4),h=8;for(r&&(i.dataOffset=n.getInt32(h),h+=4),a&&c&&(t={flags:rt(e.subarray(h,h+4))},h+=4,s&&(t.duration=n.getUint32(h),h+=4),o&&(t.size=n.getUint32(h),h+=4),u&&(t.compositionTimeOffset=n.getUint32(h),h+=4),i.samples.push(t),c--);c--;)t={},s&&(t.duration=n.getUint32(h),h+=4),o&&(t.size=n.getUint32(h),h+=4),l&&(t.flags=rt(e.subarray(h,h+4)),h+=4),u&&(t.compositionTimeOffset=n.getUint32(h),h+=4),i.samples.push(t);return i},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},dt={inspect:ot=function(e){for(var t,i,n,r,a,s=0,o=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);s<e.byteLength;)i=t.getUint32(s),n=ct(e.subarray(s+4,s+8)),(a=(ht[n]||function(e){return{data:e}})(e.subarray(s+8,r=1<i?s+i:e.byteLength))).size=i,a.type=n,o.push(a),s=r;return o},textify:lt=function(e,t){var i;return t=t||0,i=new Array(2*t+1).join(" "),e.map(function(e,n){return i+e.type+"\n"+Object.keys(e).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(t){var n=i+"  "+t+": ",r=e[t];if(r instanceof Uint8Array||r instanceof Uint32Array){var a=Array.prototype.slice.call(new Uint8Array(r.buffer,r.byteOffset,r.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return a?1===a.length?n+"<"+a.join("").slice(1)+">":n+"<\n"+a.map(function(e){return i+"  "+e}).join("\n")+"\n"+i+"  >":n+"<>"}return n+JSON.stringify(r,null,2).split("\n").map(function(e,t){return 0===t?e:i+"  "+e}).join("\n")}).join("\n")+(e.boxes?"\n"+lt(e.boxes,t+1):"")}).join("\n")},parseTfdt:ht.tfdt,parseHdlr:ht.hdlr,parseTfhd:ht.tfhd,parseTrun:ht.trun,parseSidx:ht.sidx},ft=function(e){for(var t,i,n=e.byteLength,r=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(r.push(a+2),a+=2):a++;if(0===r.length)return e;t=n-r.length,i=new Uint8Array(t);var s=0;for(a=0;a<t;s++,a++)s===r[0]&&(s++,r.shift()),i[a]=e[s];return i},pt=_e.CaptionStream,mt={generator:$,probe:K,Transmuxer:ut.Transmuxer,AudioSegmentStream:ut.AudioSegmentStream,VideoSegmentStream:ut.VideoSegmentStream,CaptionParser:function(){var e,t,i,n,r,a=!1;this.isInitialized=function(){return a},this.init=function(){e=new pt,a=!0,e.on("data",function(e){e.startTime=e.startPts/n,e.endTime=e.endPts/n,r.captions.push(e),r.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length||i===e[0]&&n===t[i])},this.parse=function(e,a,s){var o;if(!this.isInitialized())return null;if(!a||!s)return null;if(this.isNewInit(a,s))n=s[i=a[0]];else if(!i||!n)return t.push(e),null;for(;0<t.length;){var l=t.shift();this.parse(l,a,s)}return null!==(o=function(e,t,i){return t?{seiNals:st(e,t)[t],timescale:i}:null}(e,i,n))&&o.seiNals?(this.pushNals(o.seiNals),this.flushStream(),r):null},this.pushNals=function(t){if(!this.isInitialized()||!t||0===t.length)return null;t.forEach(function(t){e.push(t)})},this.flushStream=function(){if(!this.isInitialized())return null;e.flush()},this.clearParsedCaptions=function(){r.captions=[],r.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;e.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){t=[],n=i=null,r?this.clearParsedCaptions():r={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},gt=(function(e,t,i){t&&function(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(vt.prototype,t)}(0,[{key:"init",value:function(){var e,t;this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new mt.Transmuxer(this.options),e=this.self,(t=this.transmuxer).on("data",function(t){var i=t.initSegment;t.initSegment={data:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength};var n=t.data;t.data=n.buffer,e.postMessage({action:"data",segment:t,byteOffset:n.byteOffset,byteLength:n.byteLength},[t.data])}),t.captionStream&&t.captionStream.on("data",function(t){e.postMessage({action:"caption",data:t})}),t.on("done",function(t){e.postMessage({action:"done"})}),t.on("gopInfo",function(t){e.postMessage({action:"gopInfo",gopInfo:t})}),t.on("videoSegmentTimingInfo",function(t){e.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})})}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*(e.timestampOffset||0)))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(e){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),vt);function vt(e,t){!function(e,t){if(!(e instanceof vt))throw new TypeError("Cannot call a class as a function")}(this),this.options=t||{},this.self=e,this.init()}new function(e){e.onmessage=function(t){"init"===t.data.action&&t.data.options?this.messageHandlers=new gt(e,t.data.options):(this.messageHandlers||(this.messageHandlers=new gt(e)),t.data&&t.data.action&&"init"!==t.data.action&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data))}}(i)}()}),ah={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},sh=(Xu(oh,hs.EventTarget),$u(oh,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,i){var n=t.player_;if(i.captions&&i.captions.length)for(var r in e.inbandTextTracks_||(e.inbandTextTracks_={}),i.captionStreams)if(!e.inbandTextTracks_[r]){n.tech_.trigger({type:"usage",name:"hls-608"});var a=n.textTracks().getTrackById(r);e.inbandTextTracks_[r]=a||n.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}i.metadata&&i.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=n.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=i.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(e){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/9e4,presentation:e.start.pts/9e4},end:{decode:e.end.dts/9e4,presentation:e.end.pts/9e4},baseMediaDecodeTime:e.baseMediaDecodeTime/9e4};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/9e4),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var e=this,t=["audio","video"];t.forEach(function(i){if(e[i+"Codec_"]&&!e[i+"Buffer_"]){var n=null;e.mediaSource_[i+"Buffer_"]?(n=e.mediaSource_[i+"Buffer_"]).updating=!1:(n=function(e,t){var i=e.addSourceBuffer(t),n=Object.create(null);function r(e){"function"==typeof i[e]?n[e]=function(){return i[e].apply(i,arguments)}:void 0===n[e]&&Object.defineProperty(n,e,{get:function(){return i[e]},set:function(t){return i[e]=t}})}for(var a in n.updating=!1,n.realBuffer_=i)r(a);return n}(e.mediaSource_.nativeMediaSource_,i+'/mp4;codecs="'+e[i+"Codec_"]+'"'),e.mediaSource_[i+"Buffer_"]=n),e[i+"Buffer_"]=n,["update","updatestart","updateend"].forEach(function(r){n.addEventListener(r,function(){if("audio"!==i||!e.audioDisabled_)return"updateend"===r&&(e[i+"Buffer_"].updating=!1),t.every(function(t){return!("audio"!==t||!e.audioDisabled_)||i===t||!e[t+"Buffer_"]||!e[t+"Buffer_"].updating})?e.trigger(r):void 0})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:function(e,t,i){if(null==t||!e.length)return[];var n=Math.ceil(9e4*(t-i+3)),r=void 0;for(r=0;r<e.length&&!(e[r].pts>n);r++);return e.slice(r)}(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,i){if(!t.length)return e;if(i)return t.slice();for(var n=t[0].pts,r=0;r<e.length&&!(e[r].pts>=n);r++);return e.slice(0,r).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,i,n){for(var r=Math.ceil(9e4*(t-n)),a=Math.ceil(9e4*(i-n)),s=e.slice(),o=e.length;o--&&!(e[o].pts<=a););if(-1===o)return s;for(var l=o+1;l--&&!(e[l].pts<=r););return l=Math.max(l,0),s.splice(l,o-l+1),s}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),Ic(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var i in this.inbandTextTracks_)Ic(e,t,this.inbandTextTracks_[i])}},{key:"processPendingSegments_",value:function(){var t={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};t=this.pendingBuffers_.reduce(function(e,t){var i=t.type,n=t.data,r=t.initSegment;return e[i].segments.push(n),e[i].bytes+=n.byteLength,e[i].initSegment=r,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[i].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},t),this.videoBuffer_||this.audioBuffer_||(0===t.video.bytes&&(this.videoCodec_=null),0===t.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),t.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:t.audio.info}),t.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:t.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(t.audio.segments.unshift(t.audio.initSegment),t.audio.bytes+=t.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var i=!1;this.videoBuffer_&&t.video.bytes?(t.video.segments.unshift(t.video.initSegment),t.video.bytes+=t.video.initSegment.byteLength,this.concatAndAppendSegments_(t.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(i=!0),function(t,i,n){var r=e.WebKitDataCue||e.VTTCue;if(i&&i.forEach(function(e){this.inbandTextTracks_[e.stream].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},t),n){var a=Mc(t.mediaSource_.duration);if(n.forEach(function(t){var i=t.cueTime+this.timestampOffset;!("number"!=typeof i||e.isNaN(i)||i<0)&&i<1/0&&t.frames.forEach(function(e){var t=new r(i,i,e.value||e.url||e.data||"");t.frame=e,t.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return hs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return hs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return hs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(t),this.metadataTrack_.addCue(t)},this)},t),t.metadataTrack_&&t.metadataTrack_.cues&&t.metadataTrack_.cues.length){for(var s=t.metadataTrack_.cues,o=[],l=0;l<s.length;l++)s[l]&&o.push(s[l]);var u=o.reduce(function(e,t){var i=e[t.startTime]||[];return i.push(t),e[t.startTime]=i,e},{}),c=Object.keys(u).sort(function(e,t){return Number(e)-Number(t)});c.forEach(function(e,t){var i=u[e],n=Number(c[t+1])||a;i.forEach(function(e){e.endTime=n})})}}}(this,t.captions,t.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(t.audio,this.audioBuffer_),this.pendingBuffers_.length=0,i&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var i=0,n=void 0;if(e.bytes){n=new Uint8Array(e.bytes),e.segments.forEach(function(e){n.set(e,i),i+=e.byteLength});try{t.updating=!0,t.appendBuffer(n)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),oh);function oh(e,t){Gu(this,oh);var i=Ku(this,(oh.__proto__||Object.getPrototypeOf(oh)).call(this,hs.EventTarget));i.timestampOffset_=0,i.pendingBuffers_=[],i.bufferUpdating_=!1,i.mediaSource_=e,i.codecs_=t,i.audioCodec_=null,i.videoCodec_=null,i.audioDisabled_=!1,i.appendAudioInitSegment_=!0,i.gopBuffer_=[],i.timeMapping_=0,i.safeAppend_=11<=hs.browser.IE_VERSION;var n={remux:!1,alignGopsAtEnd:i.safeAppend_};return i.codecs_.forEach(function(e){ih(e)?i.audioCodec_=e:nh(e)&&(i.videoCodec_=e)}),i.transmuxer_=new rh,i.transmuxer_.postMessage({action:"init",options:n}),i.transmuxer_.onmessage=function(e){return"data"===e.data.action?i.data_(e):"done"===e.data.action?i.done_(e):"gopInfo"===e.data.action?i.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?i.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(i,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&0<=e&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(i,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(i,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(i,"buffered",{get:function(){return function(e,t,i){var n=null,r=null,a=0,s=[],o=[];if(!e&&!t)return hs.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(i)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return hs.createTimeRange();for(var l=e.buffered,u=t.buffered,c=l.length;c--;)s.push({time:l.start(c),type:"start"}),s.push({time:l.end(c),type:"end"});for(c=u.length;c--;)s.push({time:u.start(c),type:"start"}),s.push({time:u.end(c),type:"end"});for(s.sort(function(e,t){return e.time-t.time}),c=0;c<s.length;c++)"start"===s[c].type?2==++a&&(n=s[c].time):"end"===s[c].type&&1==--a&&(r=s[c].time),null!==n&&null!==r&&(o.push([n,r]),r=n=null);return hs.createTimeRanges(o)}(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),i}var lh=(Xu(uh,hs.EventTarget),$u(uh,[{key:"addSeekableRange_",value:function(e,t){var i=void 0;if(this.duration!==1/0)throw(i=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",i.code=11,i;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,i=function(e){var t={type:"",parameters:{}},i=e.trim().split(";");return t.type=i.shift().trim(),i.forEach(function(e){var i=e.trim().split("=");if(1<i.length){var n=i[0].replace(/"/g,"").trim(),r=i[1].replace(/"/g,"").trim();t.parameters[n]=r}}),t}(e);if(/^(video|audio)\/mp2t$/i.test(i.type)){var n=[];i.parameters&&i.parameters.codecs&&(n=(n=Zc(n=i.parameters.codecs.split(","))).filter(function(e){return ih(e)||nh(e)})),0===n.length&&(n=["avc1.4d400d","mp4a.40.2"]),t=new sh(this,n),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}}]),uh);function uh(){Gu(this,uh);var i=Ku(this,(uh.__proto__||Object.getPrototypeOf(uh)).call(this)),n=void 0;for(n in i.nativeMediaSource_=new e.MediaSource,i.nativeMediaSource_)n in uh.prototype||"function"!=typeof i.nativeMediaSource_[n]||(i[n]=i.nativeMediaSource_[n].bind(i.nativeMediaSource_));return i.duration_=NaN,Object.defineProperty(i,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){(this.duration_=e)===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(i,"seekable",{get:function(){return this.duration_===1/0?hs.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(i,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(i,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),i.sourceBuffers=[],i.activeSourceBuffers_=[],i.updateActiveSourceBuffers_=function(){if(i.activeSourceBuffers_.length=0,1===i.sourceBuffers.length){var e=i.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void i.activeSourceBuffers_.push(e)}for(var t=!1,n=!0,r=0;r<i.player_.audioTracks().length;r++){var a=i.player_.audioTracks()[r];if(a.enabled&&"main"!==a.kind){n=!(t=!0);break}}i.sourceBuffers.forEach(function(e,r){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=t;else if(e.videoCodec_&&!e.audioCodec_)e.audioDisabled_=!0,n=!1;else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=r?n:!n,e.audioDisabled_))return;i.activeSourceBuffers_.push(e)})},i.onPlayerMediachange_=function(){i.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},i.onHlsReset_=function(){i.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})})},i.onHlsSegmentTimeMapping_=function(e){i.sourceBuffers.forEach(function(t){return t.timeMapping_=e.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},i),i.on("sourceopen",function(e){var n=t.querySelector('[src="'+i.url_+'"]');n&&(i.player_=hs(n.parentNode),i.player_&&(i.player_.tech_.on("hls-reset",i.onHlsReset_),i.player_.tech_.on("hls-segment-time-mapping",i.onHlsSegmentTimeMapping_),i.player_.audioTracks&&i.player_.audioTracks()&&(i.player_.audioTracks().on("change",i.updateActiveSourceBuffers_),i.player_.audioTracks().on("addtrack",i.updateActiveSourceBuffers_),i.player_.audioTracks().on("removetrack",i.updateActiveSourceBuffers_)),i.player_.on("mediachange",i.onPlayerMediachange_)))}),i.on("sourceended",function(e){for(var t=Mc(i.duration),n=0;n<i.sourceBuffers.length;n++){var r=i.sourceBuffers[n],a=r.metadataTrack_&&r.metadataTrack_.cues;a&&a.length&&(a[a.length-1].endTime=t)}}),i.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),i}var ch=0;function hh(e,t){var i=hs.mediaSources[e];if(!i)throw new Error("Media Source not found (Video.js)");i.trigger({type:"sourceopen",swfId:t})}function dh(){return!!e.MediaSource&&!!e.MediaSource.isTypeSupported&&e.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')}function fh(){if(this.MediaSource={open:hh,supportsNativeMediaSources:dh},dh())return new lh;throw new Error("Cannot use create a virtual MediaSource for this video")}hs.mediaSources={},fh.open=hh,fh.supportsNativeMediaSources=dh;var ph={createObjectURL:function(t){var i=void 0;return t instanceof lh?(i=e.URL.createObjectURL(t.nativeMediaSource_),t.url_=i):t instanceof lh?(i="blob:vjs-media-source/"+ch,ch++,hs.mediaSources[i]=t,i):(i=e.URL.createObjectURL(t),t.url_=i)}};function mh(e,t){for(var i=void 0,n=bh(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),r=0;r<t.playlists.length;r++){var a=Ju(n,t.playlists[r]);a?n=a:i=!0}return Qu(t,function(e,t,r,a){if(e.playlists&&e.playlists.length){var s=e.playlists[0].uri,o=Ju(n,e.playlists[0]);o&&((n=o).mediaGroups[t][r][a].playlists[0]=n.playlists[s],i=!1)}}),i?null:n}function gh(e){return e.uri+"-"+e.byterange.offset+"-"+(e.byterange.offset+e.byterange.length-1)}function vh(e,t){var i,n,r={};for(var a in e){var s=e[a].sidx;if(s){var o=gh(s);if(!t[o])break;i=t[o].sidxInfo,n=s,(Boolean(!i.map&&!n.map)||Boolean(i.map&&n.map&&i.map.byterange.offset===n.map.byterange.offset&&i.map.byterange.length===n.map.byterange.length))&&i.uri===n.uri&&i.byterange.offset===n.byterange.offset&&i.byterange.length===n.byterange.length&&(r[o]=t[o])}}return r}function yh(e,t,i,n,r){var a={uri:Vu(n.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t};return i(hs.mergeOptions(a,{responseType:"arraybuffer",headers:_c(a)}),r)}hs.MediaSource=fh,hs.URL=ph;var bh=hs.mergeOptions,_h=(Xu(Th,hs.EventTarget),$u(Th,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.stopRequest(),this.loadedPlaylists_={},e.clearTimeout(this.minimumUpdatePeriodTimeout_),e.clearTimeout(this.mediaRequest_),e.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(e,t,i,n){var r=this;return function(a,s){if(r.request){if(r.request=null,a)return r.error={status:s.status,message:"DASH playlist request error at URL: "+e.uri,response:s.response,code:2},i&&(r.state=i),r.trigger("error"),n(t,null);var o=new Uint8Array(s.response),l=al.parseSidx(o.subarray(8));return n(t,l)}}}},{key:"media",value:function(t){var i=this;if(!t)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var n=this.state;if("string"==typeof t){if(!this.master.playlists[t])throw new Error("Unknown playlist URI: "+t);t=this.master.playlists[t]}var r=!this.media_||t.uri!==this.media_.uri;if(r&&this.loadedPlaylists_[t.uri]&&this.loadedPlaylists_[t.uri].endList)return this.state="HAVE_METADATA",this.media_=t,void(r&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(r)if(this.media_&&this.trigger("mediachanging"),t.sidx){var a=void 0,s=void 0;s=this.masterPlaylistLoader_?(a=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.sidxMapping_):(a=this.master,this.sidxMapping_);var o=gh(t.sidx);s[o]={sidxInfo:t.sidx},this.request=yh(t.sidx,t,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(t,a,n,function(e,r){if(!e||!r)throw new Error("failed to request sidx");s[o].sidx=r,i.haveMetadata({startingState:n,playlist:e.playlists[t.uri]})}))}else this.mediaRequest_=e.setTimeout(this.haveMetadata.bind(this,{startingState:n,playlist:t}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,i=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[i.uri]=i,this.mediaRequest_=null,this.refreshMedia_(i.uri),this.trigger("HAVE_MASTER"===t?"loadedmetadata":"mediachange")}},{key:"pause",value:function(){this.stopRequest(),e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(t){var i=this;e.clearTimeout(this.mediaUpdateTimeout),e.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();t?this.mediaUpdateTimeout=e.setTimeout(function(){return i.load()},n?n.targetDuration/2*1e3:5e3):this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var e=no(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});e.uri=this.srcUrl;for(var t=0;t<e.playlists.length;t++){var i="placeholder-uri-"+t;e.playlists[t].uri=i,e.playlists[i]=e.playlists[t]}return Qu(e,function(t,i,n,r){if(t.playlists&&t.playlists.length){var a="placeholder-uri-"+i+"-"+n+"-"+r;t.playlists[0].uri=a,e.playlists[a]=t.playlists[0]}}),Zu(e),ec(e),e}},{key:"start",value:function(){var t=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=e.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,i){if(t.request){if(t.request=null,e)return t.error={status:i.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:i.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=i.responseText,t.masterLoaded_=i.responseHeaders&&i.responseHeaders.date?Date.parse(i.responseHeaders.date):Date.now(),t.srcUrl=Vu(t.handleManifestRedirects,t.srcUrl,i),t.syncClientServerClock_(t.onClientServerClockSync_.bind(t))}})}},{key:"syncClientServerClock_",value:function(e){var t=this,i=function(e){var t=Vs(e,"UTCTiming")[0];if(!t)return null;var i=Ys(t);switch(i.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":i.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":i.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":i.method="DIRECT",i.value=Date.parse(i.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error("UNSUPPORTED_UTC_TIMING_SCHEME")}return i}(io(this.masterXml_));return null===i?(this.clientOffset_=this.masterLoaded_-Date.now(),e()):"DIRECT"===i.method?(this.clientOffset_=i.value-Date.now(),e()):void(this.request=this.hls_.xhr({uri:qu(this.srcUrl,i.value),method:i.method,withCredentials:this.withCredentials},function(n,r){if(t.request){if(n)return t.clientOffset_=t.masterLoaded_-Date.now(),e();var a;a="HEAD"===i.method?r.responseHeaders&&r.responseHeaders.date?Date.parse(r.responseHeaders.date):t.masterLoaded_:Date.parse(r.responseText),t.clientOffset_=a-Date.now(),e()}}))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var t=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var t=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(i,n){if(t.request){if(t.request=null,i)return t.error={status:n.status,message:"DASH playlist request error at URL: "+t.srcUrl,responseText:n.responseText,code:2},"HAVE_NOTHING"===t.state&&(t.started=!1),t.trigger("error");t.masterXml_=n.responseText,t.sidxMapping_=function(e,t,i,n){var r=no(e,{manifestUri:t,clientOffset:i}),a=vh(r.playlists,n);return Qu(r,function(e,t,i,r){e.playlists&&e.playlists.length&&(a=bh(a,vh(e.playlists,n)))}),a}(t.masterXml_,t.srcUrl,t.clientOffset_,t.sidxMapping_);var r=t.parseMasterXml(),a=mh(t.master,r);if(a){var s=gh(t.media().sidx);if(t.sidxMapping_[s])t.master=a;else{var o=t.media();t.request=yh(o.sidx,o,t.hls_.xhr,{handleManifestRedirects:t.handleManifestRedirects},t.sidxRequestFinished_(o,r,t.state,function(i,n){if(!i||!n)throw new Error("failed to request sidx on minimumUpdatePeriod");t.sidxMapping_[s].sidx=n,t.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod),t.refreshMedia_(t.media().uri)}))}}t.minimumUpdatePeriodTimeout_=e.setTimeout(function(){t.trigger("minimumUpdatePeriod")},t.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(t){var i=this;if(!t)throw new Error("refreshMedia_ must take a media uri");var n,r=void 0;n=this.masterPlaylistLoader_?(r=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.parseMasterXml()):(r=this.master,this.parseMasterXml());var a=mh(r,n);a?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=a:this.master=a,this.media_=a.playlists[t]):(this.media_=n.playlists[t],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=e.setTimeout(function(){i.trigger("mediaupdatetimeout")},tc(this.media(),!!a))),this.trigger("loadedplaylist")}}]),Th);function Th(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3];Gu(this,Th);var r=Ku(this,(Th.__proto__||Object.getPrototypeOf(Th)).call(this)),a=i.withCredentials,s=void 0!==a&&a,o=i.handleManifestRedirects,l=void 0!==o&&o;if(r.hls_=t,r.withCredentials=s,r.handleManifestRedirects=l,!e)throw new Error("A non-empty playlist URL or playlist is required");return r.on("minimumUpdatePeriod",function(){r.refreshXml_()}),r.on("mediaupdatetimeout",function(){r.refreshMedia_(r.media().uri)}),r.state="HAVE_NOTHING",r.loadedPlaylists_={},"string"==typeof e?(r.srcUrl=e,r.sidxMapping_={},Ku(r)):(r.setupChildLoader(n,e),r)}function Sh(e){return hs.log.debug?hs.log.debug.bind(hs,"VHS:",e+" >"):function(){}}function kh(){}var wh=($u(Ch,[{key:"createSourceBuffer_",value:function(e,t){var i=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",function(){i.start_()}):this.start_()}},{key:"start_",value:function(){var e=this;this.started_=!0,this.onUpdateendCallback_=function(){var t=e.pendingCallback_;e.pendingCallback_=null,e.sourceBuffer_.removing=!1,e.logger_("buffered ["+Pc(e.buffered())+"]"),t&&t(),e.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var i=this;this.processedAppend_=!0,this.queueCallback_(function(){e.videoSegmentTimingInfoCallback&&i.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),i.sourceBuffer_.appendBuffer(e.bytes)},function(){e.videoSegmentTimingInfoCallback&&i.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()})}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:hs.createTimeRanges()}},{key:"remove",value:function(e,t,i){var n=this;this.processedAppend_&&this.queueCallback_(function(){n.logger_("remove ["+e+" => "+t+"]"),n.sourceBuffer_.removing=!0,n.sourceBuffer_.remove(e,t)},2<arguments.length&&void 0!==i?i:kh)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==kh}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){function e(){t.sourceBuffer_&&"open"===t.mediaSource.readyState&&t.sourceBuffer_.abort(),t.sourceBuffer_.removeEventListener("updateend",e)}var t=this;this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",e):e()}}]),Ch);function Ch(e,t,i,n){Gu(this,Ch),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=e,this.processedAppend_=!1,this.type_=i,this.mimeType_=t,this.logger_=Sh("SourceUpdater["+i+"]["+t+"]"),"closed"===e.readyState?e.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,t,n)):this.createSourceBuffer_(t,n)}function xh(e){e.forEach(function(e){e.abort()})}function Eh(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Dh,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Uh,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Mh,xhr:t}:null}function Lh(t,i){var n;return t&&(n=e.getComputedStyle(t))?n[i]:""}function Ah(e,t){var i=e.slice();e.sort(function(e,n){var r=t(e,n);return 0===r?i.indexOf(e)-i.indexOf(n):r})}function Ph(t,i){var n=void 0,r=void 0;return t.attributes.BANDWIDTH&&(n=t.attributes.BANDWIDTH),i.attributes.BANDWIDTH&&(r=i.attributes.BANDWIDTH),(n=n||e.Number.MAX_VALUE)-(r||e.Number.MAX_VALUE)}function Oh(e){return"number"==typeof e&&isFinite(e)}var Ih={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Mh=2,Dh=-101,Uh=-102,Rh=(Xu(Nh,hs.EventTarget),$u(Nh,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():hs.createTimeRanges()}},{key:"initSegment",value:function(e,t){var i=1<arguments.length&&void 0!==t&&t;if(!e)return null;var n=wc(e),r=this.initSegments_[n];return i&&!r&&e.bytes&&(this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),r||e}},{key:"segmentKey",value:function(e,t){var i=1<arguments.length&&void 0!==t&&t;if(!e)return null;var n=Cc(e),r=this.keyCache_[n];this.cacheEncryptionKeys_&&i&&!r&&e.bytes&&(this.keyCache_[n]=r={resolvedUri:e.resolvedUri,bytes:e.bytes});var a={resolvedUri:(r||e).resolvedUri};return r&&(a.bytes=r.bytes),a}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new wh(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e,t){var i=1<arguments.length&&void 0!==t?t:{};if(e){var n=this.playlist_,r=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=i,this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var a=null;if(n&&(n.id?a=n.id:n.uri&&(a=n.uri)),this.logger_("playlist update ["+a+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(n&&n.uri===e.uri){var s=e.mediaSequence-n.mediaSequence;this.logger_("live window shift ["+s+"]"),null!==this.mediaIndex&&(this.mediaIndex-=s),r&&(r.mediaIndex-=s,0<=r.mediaIndex&&(r.segment=e.segments[r.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(n,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_(),e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,i){if(this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,i),Ic(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Ic(e,t,this.inbandTextTracks_[n])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&e.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=e.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():e.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()||(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e,t){return function(e,t,i){return!(!e||!t)&&e.endList&&"open"===t.readyState&&i===e.segments.length}(1<arguments.length&&void 0!==t?t:this.playlist_,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,i,n,r,a){var s=0,o=void 0;e.length&&(s=e.end(e.length-1));var l=Math.max(0,s-r);if(!t.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!n&&1<=l)return null;if(null===a)return i=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,i,null,!0);if(null!==i){var u=t.segments[i];return this.generateSegmentInfo_(t,i+1,o=u&&u.end?u.end:s,!1)}if(this.fetchAtBuffer_){var c=Nc.getMediaInfoForTime(t,s,a.segmentIndex,a.time);i=c.mediaIndex,o=c.startTime}else{var h=Nc.getMediaInfoForTime(t,r,a.segmentIndex,a.time);i=h.mediaIndex,o=h.startTime}return this.generateSegmentInfo_(t,i,o,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var i=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return i.length?i[Math.min(i.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,i,n){if(t<0||t>=e.segments.length)return null;var r=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:r.resolvedUri,mediaIndex:t,isSyncRequest:n,startOfSegment:i,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:r.timeline,duration:r.duration,segment:r}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),i=e.bandwidth,n=this.pendingSegment_.duration,r=Nc.estimateSegmentRequestTime(n,i,this.playlist_,e.bytesReceived),a=function(e,t,i){var n=2<arguments.length&&void 0!==i?i:1;return((e.length?e.end(e.length-1):0)-t)/n}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(r<=a)return!1;var s=function(e){var t=e.currentTime,i=e.bandwidth,n=e.duration,r=e.segmentDuration,a=e.timeUntilRebuffer,s=e.currentTimeline,o=e.syncController,l=e.master.playlists.filter(function(e){return!Nc.isIncompatible(e)}),u=l.filter(Nc.isEnabled);u.length||(u=l.filter(function(e){return!Nc.isDisabled(e)}));var c=u.filter(Nc.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var l=o.getSyncPoint(e,n,s,t)?1:2;return{playlist:e,rebufferingImpact:Nc.estimateSegmentRequestTime(r,i,e)*l-a}}),h=c.filter(function(e){return e.rebufferingImpact<=0});return Ah(h,function(e,t){return Ph(t.playlist,e.playlist)}),h.length?h[0]:(Ah(c,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),c[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:i,duration:this.duration_(),segmentDuration:n,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(s){var o=.5;return a<=Hc&&(o=1),!(!s.playlist||s.playlist.uri===this.playlist_.uri||r-a-s.rebufferingImpact<o||(this.bandwidth=s.playlist.attributes.BANDWIDTH*Ih.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),0))}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=function(e,t,i,n,r,a,s){var o=[],l=function(e,t,i){var n=0,r=!1;return function(a,s){if(!r)return a?(r=!0,xh(e),i(a,s)):(n+=1)===e.length?(s.endOfAllRequests=Date.now(),s.encryptedBytes?function(e,t,i){var n;e.addEventListener("message",function n(r){if(r.data.source===t.requestId){e.removeEventListener("message",n);var a=r.data.decrypted;return t.bytes=new Uint8Array(a.bytes,a.byteOffset,a.byteLength),i(null,t)}}),n=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes)),e.postMessage(kc({source:t.requestId,encrypted:t.encryptedBytes,key:n,iv:t.key.iv}),[t.encryptedBytes.buffer,n.buffer])}(t,s,i):i(null,s)):void 0}}(o,i,s);if(r.key&&!r.key.bytes){var u=e(hs.mergeOptions(t,{uri:r.key.resolvedUri,responseType:"arraybuffer"}),function(e,t){return function(i,n){var r=n.response,a=Eh(i,n);if(a)return t(a,e);if(16!==r.byteLength)return t({status:n.status,message:"Invalid HLS key at URL: "+n.uri,code:Mh,xhr:n},e);var s=new DataView(r);return e.key.bytes=new Uint32Array([s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)]),t(null,e)}}(r,l));o.push(u)}if(r.map&&!r.map.bytes){var c=e(hs.mergeOptions(t,{uri:r.map.resolvedUri,responseType:"arraybuffer",headers:_c(r.map)}),function(e,t,i){return function(n,r){var a=r.response,s=Eh(n,r);return s?i(s,e):0===a.byteLength?i({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Mh,xhr:r},e):(e.map.bytes=new Uint8Array(r.response),t&&!t.isInitialized()&&t.init(),e.map.timescales=il.timescale(e.map.bytes),e.map.videoTrackIds=il.videoTrackIds(e.map.bytes),i(null,e))}}(r,n,l));o.push(c)}var h=e(hs.mergeOptions(t,{uri:r.resolvedUri,responseType:"arraybuffer",headers:_c(r)}),function(e,t,i){return function(n,r){var a=r.response,s=Eh(n,r),o=void 0;return s?i(s,e):0===a.byteLength?i({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:Mh,xhr:r},e):(e.stats={bandwidth:r.bandwidth,bytesReceived:r.bytesReceived||0,roundTripTime:r.roundTripTime||0},e.key?e.encryptedBytes=new Uint8Array(r.response):e.bytes=new Uint8Array(r.response),t&&e.map&&e.map.bytes&&(t.isInitialized()||t.init(),(o=t.parse(e.bytes,e.map.videoTrackIds,e.map.timescales))&&o.captions&&(e.captionStreams=o.captionStreams,e.fmp4Captions=o.captions)),i(null,e))}}(r,n,l));return h.addEventListener("progress",function(e,t){return function(i){return e.stats=hs.mergeOptions(e.stats,function(e){var t=e.target,i={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return i.bytesReceived=e.loaded,i.bandwidth=Math.floor(i.bytesReceived/i.roundTripTime*8*1e3),i}(i)),!e.stats.firstBytesReceivedAt&&e.stats.bytesReceived&&(e.stats.firstBytesReceivedAt=Date.now()),t(i,e)}}(r,a)),o.push(h),function(){return xh(o)}}(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(e){var t=function(e,t,i){var n;return n=e.length&&0<e.start(0)&&e.start(0)<t?e.start(0):t-30,Math.min(n,t-i)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<t&&this.remove(0,t)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,i={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var n=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);i.key=this.segmentKey(t.key),i.key.iv=n}return t.map&&(i.map=this.initSegment(t.map)),i}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===Uh?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===Dh?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(function(e,t,i){for(var n in i)if(!e[n]){t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(n);e[n]=r||t.addRemoteTextTrack({kind:"captions",id:n,label:n},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),function(e){var t=e.inbandTextTracks,i=e.captionArray,n=e.timestampOffset;if(i){var r=window.WebKitDataCue||window.VTTCue;i.forEach(function(e){var i=e.stream,a=e.startTime,s=e.endTime;t[i]&&t[i].addCue(new r(a+=n,s+=n,e.text))})}}({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,i=t.segment,n=this.syncController_.probeSegmentInfo(t);void 0===this.startingMedia_&&n&&(n.containsAudio||n.containsVideo)&&(this.startingMedia_={containsAudio:n.containsAudio,containsVideo:n.containsVideo});var r=function(e,t,i){return"main"===e&&t&&n?n.containsAudio||n.containsVideo?t.containsVideo&&!n.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.containsVideo&&n.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.startingMedia_);if(r)return this.error({message:r,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()&&(this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset"));var a=this.syncController_.mappingForTimeline(t.timeline);if(null!==a&&this.trigger({type:"segmenttimemapping",mapping:a}),this.state="APPENDING",i.map){var s=wc(i.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==s){var o=this.initSegment(i.map);this.sourceUpdater_.appendBuffer({bytes:o.bytes},function(){e.activeInitSegmentId_=s})}}t.byteLength=t.bytes.byteLength,this.mediaSecondsLoaded+="number"==typeof i.start&&"number"==typeof i.end?i.end-i.start:i.duration,this.logger_(function(e){var t=e.segment,i=e.playlist,n=i.mediaSequence,r=i.segments;return["appending ["+e.mediaIndex+"] of ["+n+", "+(n+(void 0===r?[]:r).length)+"] from playlist ["+i.id+"]","["+t.start+" => "+t.end+"] in timeline ["+e.timeline+"]"].join(" ")}(t)),this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var i=this.pendingSegment_.segment;i.videoTimingInfo||(i.videoTimingInfo={}),i.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,i.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,i.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,i.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,i=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(i&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,i=Date.now()-e.endOfAllRequests+1,n=Math.floor(e.byteLength/i*8*1e3);this.throughput.rate+=(n-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(t){if(this.segmentMetadataTrack_){var i=t.segment,n=i.start,r=i.end;if(Oh(n)&&Oh(r)){Ic(n,r,this.segmentMetadataTrack_);var a={custom:i.custom,dateTimeObject:i.dateTimeObject,dateTimeString:i.dateTimeString,bandwidth:t.playlist.attributes.BANDWIDTH,resolution:t.playlist.attributes.RESOLUTION,codecs:t.playlist.attributes.CODECS,byteLength:t.byteLength,uri:t.uri,timeline:t.timeline,playlist:t.playlist.uri,start:n,end:r},s=new(e.WebKitDataCue||e.VTTCue)(n,r,JSON.stringify(a));s.value=a,this.segmentMetadataTrack_.addCue(s)}}}}]),Nh);function Nh(e){Gu(this,Nh);var t=Ku(this,(Nh.__proto__||Object.getPrototypeOf(Nh)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return t.bandwidth=e.bandwidth,t.throughput={rate:0,count:0},t.roundTrip=NaN,t.resetStats_(),t.mediaIndex=null,t.hasPlayed_=e.hasPlayed,t.currentTime_=e.currentTime,t.seekable_=e.seekable,t.seeking_=e.seeking,t.duration_=e.duration,t.mediaSource_=e.mediaSource,t.hls_=e.hls,t.loaderType_=e.loaderType,t.startingMedia_=void 0,t.segmentMetadataTrack_=e.segmentMetadataTrack,t.goalBufferLength_=e.goalBufferLength,t.sourceType_=e.sourceType,t.inbandTextTracks_=e.inbandTextTracks,t.state_="INIT",t.checkBufferTimeout_=null,t.error_=void 0,t.currentTimeline_=-1,t.pendingSegment_=null,t.mimeType_=null,t.sourceUpdater_=null,t.xhrOptions_=null,t.activeInitSegmentId_=null,t.initSegments_={},t.cacheEncryptionKeys_=e.cacheEncryptionKeys,t.keyCache_={},t.captionParser_="main"===t.loaderType_?new Cu:null,t.decrypter_=e.decrypter,t.syncController_=e.syncController,t.syncPoint_={segmentIndex:0,time:0},t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")}),t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1}),t.fetchAtBuffer_=!1,t.logger_=Sh("SegmentLoader["+t.loaderType_+"]"),Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),t}function Bh(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}var jh=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),Fh=(Xu(Hh,Rh),$u(Hh,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return hs.createTimeRanges();var e=this.subtitlesTrack_.cues;return hs.createTimeRanges([[e[0].startTime,e[e.length-1].startTime]])}},{key:"initSegment",value:function(e,t){var i=1<arguments.length&&void 0!==t&&t;if(!e)return null;var n=wc(e),r=this.initSegments_[n];if(i&&!r&&e.bytes){var a=new Uint8Array(jh.byteLength+e.bytes.byteLength);a.set(e.bytes),a.set(jh,e.bytes.byteLength),this.initSegments_[n]=r={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:a}}return r||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){Ic(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline))return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var i=this.pendingSegment_,n=i.segment;if("function"!=typeof e.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){function r(){t.subtitlesTrack_.tech_.off("vttjsloaded",a),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")}var a=void 0;return a=function(){t.subtitlesTrack_.tech_.off("vttjserror",r),t.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",a),void this.subtitlesTrack_.tech_.one("vttjserror",r)}n.requested=!0;try{this.parseVTTCues_(i)}catch(i){return this.error({message:i.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(i,this.syncController_.timelines[i.timeline],this.playlist_),i.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");i.byteLength=i.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,i.cues.length&&this.remove(i.cues[0].endTime,i.cues[i.cues.length-1].endTime),i.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(t){var i=void 0,n=!1;"function"==typeof e.TextDecoder?i=new e.TextDecoder("utf8"):(i=e.WebVTT.StringDecoder(),n=!0);var r=new e.WebVTT.Parser(e,e.vttjs,i);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=t.cues.push.bind(t.cues),r.ontimestampmap=function(e){return t.timestampmap=e},r.onparsingerror=function(e){hs.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var a=t.segment.map.bytes;n&&(a=Bh(a)),r.parse(a)}var s=t.bytes;n&&(s=Bh(s)),r.parse(s),r.flush()}},{key:"updateTimeMapping_",value:function(e,t,i){var n=e.segment;if(t)if(e.cues.length){var r=e.timestampmap,a=r.MPEGTS/9e4-r.LOCAL+t.mapping;e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),i.syncInfo||(i.syncInfo={mediaSequence:i.mediaSequence+e.mediaIndex,time:Math.min(e.cues[0].startTime,e.cues[e.cues.length-1].startTime-n.duration)})}else n.empty=!0}}]),Hh);function Hh(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Gu(this,Hh);var i=Ku(this,(Hh.__proto__||Object.getPrototypeOf(Hh)).call(this,e,t));return i.mediaSource_=null,i.subtitlesTrack_=null,i}function Wh(e,t){for(var i=e.cues,n=0;n<i.length;n++){var r=i[n];if(t>=r.adStartTime&&t<=r.adEndTime)return r}return null}var zh=[{name:"VOD",run:function(e,t,i,n,r){return i===1/0?null:{time:0,segmentIndex:0}}},{name:"ProgramDateTime",run:function(e,t,i,n,r){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],s=null,o=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.dateTimeObject){var c=u.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,h=Math.abs(r-c);if(null!==o&&(0===h||o<h))break;o=h,s={time:c,segmentIndex:l}}}return s}},{name:"Segment",run:function(e,t,i,n,r){var a=t.segments||[],s=null,o=null;r=r||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.timeline===n&&void 0!==u.start){var c=Math.abs(r-u.start);if(null!==o&&o<c)break;(!s||null===o||c<=o)&&(o=c,s={time:u.start,segmentIndex:l})}}return s}},{name:"Discontinuity",run:function(e,t,i,n,r){var a=null;if(r=r||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var s=null,o=0;o<t.discontinuityStarts.length;o++){var l=t.discontinuityStarts[o],u=e.discontinuities[t.discontinuitySequence+o+1];if(u){var c=Math.abs(r-u.time);if(null!==s&&s<c)break;(!a||null===s||c<=s)&&(s=c,a={time:u.time,segmentIndex:l})}}return a}},{name:"Playlist",run:function(e,t,i,n,r){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],qh=(Xu(Vh,hs.EventTarget),$u(Vh,[{key:"getSyncPoint",value:function(e,t,i,n){var r=this.runStrategies_(e,t,i,n);return r.length?this.selectSyncPoint_(r,{key:"time",value:n}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var i=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!i.length)return null;var n=this.selectSyncPoint_(i,{key:"segmentIndex",value:0});return 0<n.segmentIndex&&(n.time*=-1),Math.abs(n.time+uc(e,n.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,i,n){for(var r=[],a=0;a<zh.length;a++){var s=zh[a],o=s.run(this,e,t,i,n);o&&(o.strategy=s.name,r.push({strategy:s.name,syncPoint:o}))}return r}},{key:"selectSyncPoint_",value:function(e,t){for(var i=e[0].syncPoint,n=Math.abs(e[0].syncPoint[t.key]-t.value),r=e[0].strategy,a=1;a<e.length;a++){var s=Math.abs(e[a].syncPoint[t.key]-t.value);s<n&&(n=s,i=e[a].syncPoint,r=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+r+"]: [time:"+i.time+", segmentIndex:"+i.segmentIndex+"]"),i}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var i=t.mediaSequence-e.mediaSequence-1;0<=i;i--){var n=e.segments[i];if(n&&void 0!==n.start){t.syncInfo={mediaSequence:e.mediaSequence+i,time:n.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t,i=e.segment,n=e.playlist;return(t=i.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,t)&&(this.saveDiscontinuitySyncInfo_(e),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:i.start})),t}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,i=il.timescale(t.map.bytes),n=il.startTime(i,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=n),{start:n,end:n+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=function(e,t){var i;return(i=Eu.aac.isLikelyAacData(e)?function(e){for(var t,i=!1,n=0,r=null,a=null,s=0,o=0;3<=e.length-o;){switch(Eu.aac.parseType(e,o)){case"timed-metadata":if(e.length-o<10){i=!0;break}if((s=Eu.aac.parseId3TagSize(e,o))>e.length){i=!0;break}null===a&&(t=e.subarray(o,o+s),a=Eu.aac.parseAacTimestamp(t)),o+=s;break;case"audio":if(e.length-o<7){i=!0;break}if((s=Eu.aac.parseAdtsSize(e,o))>e.length){i=!0;break}null===r&&(t=e.subarray(o,o+s),r=Eu.aac.parseSampleRate(t)),n++,o+=s;break;default:o++}if(i)return null}if(null===r||null===a)return null;var l=9e4/r;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*n*l,pts:a+1024*n*l}]}}(e):function(e){var t={pid:null,table:null},i={};for(var n in function(e,t){for(var i,n=0,r=Pu;r<e.byteLength;)if(71!==e[n]||71!==e[r])n++,r++;else{switch(i=e.subarray(n,r),Eu.ts.parseType(i,t.pid)){case"pat":t.pid||(t.pid=Eu.ts.parsePat(i));break;case"pmt":t.table||(t.table=Eu.ts.parsePmt(i))}if(t.pid&&t.table)return;n+=Pu,r+=Pu}}(e,t),t.table)if(t.table.hasOwnProperty(n))switch(t.table[n]){case Ml.H264_STREAM_TYPE:i.video=[],Au(e,t,i),0===i.video.length&&delete i.video;break;case Ml.ADTS_STREAM_TYPE:i.audio=[],Lu(e,t,i),0===i.audio.length&&delete i.audio}return i}(e))&&(i.audio||i.video)?(function(e,t){if(e.audio&&e.audio.length){var i=t;void 0===i&&(i=e.audio[0].dts),e.audio.forEach(function(e){e.dts=xu(e.dts,i),e.pts=xu(e.pts,i),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4})}if(e.video&&e.video.length){var n=t;if(void 0===n&&(n=e.video[0].dts),e.video.forEach(function(e){e.dts=xu(e.dts,n),e.pts=xu(e.pts,n),e.dtsTime=e.dts/9e4,e.ptsTime=e.pts/9e4}),e.firstKeyFrame){var r=e.firstKeyFrame;r.dts=xu(r.dts,n),r.pts=xu(r.pts,n),r.dtsTime=r.dts/9e4,r.ptsTime=r.dts/9e4}}}(i,t),i):null}(e.bytes,this.inspectCache_),i=void 0,n=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,i=t.video[0].dtsTime,n=t.video[1].dtsTime):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,i=t.audio[0].dtsTime,n=t.audio[1].dtsTime),{start:i,end:n,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var i=e.segment,n=this.timelines[e.timeline];if(null!==e.timestampOffset)this.timelines[e.timeline]=n={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+n.time+"] [mapping: "+n.mapping+"]"),i.start=e.startOfSegment,i.end=t.end+n.mapping;else{if(!n)return!1;i.start=t.start+n.mapping,i.end=t.end+n.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,i=e.segment;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var n=0;n<t.discontinuityStarts.length;n++){var r,a=t.discontinuityStarts[n],s=t.discontinuitySequence+n+1,o=a-e.mediaIndex,l=Math.abs(o);(!this.discontinuities[s]||this.discontinuities[s].accuracy>l)&&(r=o<0?i.start-uc(t,e.mediaIndex,a):i.end+uc(t,e.mediaIndex+1,a),this.discontinuities[s]={time:r,accuracy:l})}}}]),Vh);function Vh(){Gu(this,Vh);var e=Ku(this,(Vh.__proto__||Object.getPrototypeOf(Vh)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=Sh("SyncController"),e}function Gh(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)}function $h(e,t){(t.activePlaylistLoader=e).load()}var Yh=new Yc("./decrypter-worker.worker.js",function(e,t){var i,n,r,a,s,o,l;function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e){u(this,h),n=n||function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],i=e[1],n=t[4],r=i[4],a=void 0,s=void 0,o=void 0,l=[],u=[],c=void 0,h=void 0,d=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(s=o=0;!n[s];s^=c||1,o=u[o]||1)for(d=(d=o^o<<1^o<<2^o<<3^o<<4)>>8^255&d^99,p=16843009*l[h=l[c=l[r[n[s]=d]=s]]]^65537*h^257*c^16843008*s,f=257*l[d]^16843008*d,a=0;a<4;a++)t[a][s]=f=f<<24^f>>>8,i[a][d]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),i[a]=i[a].slice(0);return e}(),this._tables=[[n[0][0].slice(),n[0][1].slice(),n[0][2].slice(),n[0][3].slice(),n[0][4].slice()],[n[1][0].slice(),n[1][1].slice(),n[1][2].slice(),n[1][3].slice(),n[1][4].slice()]];var t=void 0,i=void 0,r=void 0,a=void 0,s=void 0,o=this._tables[0][4],l=this._tables[1],c=e.length,d=1;if(4!==c&&6!==c&&8!==c)throw new Error("Invalid aes key size");for(a=e.slice(0),this._key=[a,s=[]],t=c;t<4*c+28;t++)r=a[t-1],(t%c==0||8===c&&t%c==4)&&(r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[255&r],t%c==0&&(r=r<<8^r>>>24^d<<24,d=d<<1^283*(d>>7))),a[t]=a[t-c]^r;for(i=0;t;i++,t--)r=a[3&i?t:t-4],s[i]=t<=4||i<4?r:l[0][o[r>>>24]]^l[1][o[r>>16&255]]^l[2][o[r>>8&255]]^l[3][o[255&r]]}function d(){u(this,d),this.listeners={}}function f(){u(this,f);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,s.call(this,a));return e.jobs=[],e.delay=1,e.timeout_=null,e}function p(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}function m(e,t,i,n){u(this,m);var r=m.STEP,a=new Int32Array(e.buffer),s=new Uint8Array(e.byteLength),l=0;for(this.asyncStream_=new o,this.asyncStream_.push(this.decryptChunk_(a.subarray(l,l+r),t,i,s)),l=r;l<a.length;l+=r)i=new Uint32Array([p(a[l-4]),p(a[l-3]),p(a[l-2]),p(a[l-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(l,l+r),t,i,s));this.asyncStream_.push(function(){n(null,s.subarray(0,s.byteLength-s[s.byteLength-1]))})}i=function(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),e},n=null,h.prototype.decrypt=function(e,t,i,n,r,a){var s=this._key[1],o=e^s[0],l=n^s[1],u=i^s[2],c=t^s[3],h=void 0,d=void 0,f=void 0,p=s.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],b=v[1],_=v[2],T=v[3],S=v[4];for(m=0;m<p;m++)h=y[o>>>24]^b[l>>16&255]^_[u>>8&255]^T[255&c]^s[g],d=y[l>>>24]^b[u>>16&255]^_[c>>8&255]^T[255&o]^s[g+1],f=y[u>>>24]^b[c>>16&255]^_[o>>8&255]^T[255&l]^s[g+2],c=y[c>>>24]^b[o>>16&255]^_[l>>8&255]^T[255&u]^s[g+3],g+=4,o=h,l=d,u=f;for(m=0;m<4;m++)r[(3&-m)+a]=S[o>>>24]<<24^S[l>>16&255]<<16^S[u>>8&255]<<8^S[255&c]^s[g++],h=o,o=l,l=u,u=c,c=h},r=h,d.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},d.prototype.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e].splice(i,1),-1<i},d.prototype.trigger=function(e,t){var i=this.listeners[e];if(i)if(2===arguments.length)for(var n=i.length,r=0;r<n;++r)i[r].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),s=i.length,o=0;o<s;++o)i[o].apply(this,a)},d.prototype.dispose=function(){this.listeners={}},d.prototype.pipe=function(e){this.on("data",function(t){e.push(t)})},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,s=a=d),f.prototype.processJob_=function(){this.jobs.shift()(),this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},f.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},o=f,m.prototype.decryptChunk_=function(e,t,i,n){return function(){var a=function(e,t,i){var n=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),a=new r(Array.prototype.slice.call(t)),s=new Uint8Array(e.byteLength),o=new Int32Array(s.buffer),l=void 0,u=void 0,c=void 0,h=void 0,d=void 0,f=void 0,m=void 0,g=void 0,v=void 0;for(l=i[0],u=i[1],c=i[2],h=i[3],v=0;v<n.length;v+=4)d=p(n[v]),f=p(n[v+1]),m=p(n[v+2]),g=p(n[v+3]),a.decrypt(d,f,m,g,o,v),o[v]=p(o[v]^l),o[v+1]=p(o[v+1]^u),o[v+2]=p(o[v+2]^c),o[v+3]=p(o[v+3]^h),l=d,u=f,c=m,h=g;return s}(e,t,i);n.set(a,e.byteOffset)}},i(m,null,[{key:"STEP",get:function(){return 32e3}}]),l=m,new function(e){e.onmessage=function(t){var i=t.data,n=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),r=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),a=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new l(n,r,a,function(t,n){e.postMessage(function(e){var t={};return Object.keys(e).forEach(function(i){var n=e[i];t[i]=ArrayBuffer.isView(n)?{bytes:n.buffer,byteOffset:n.byteOffset,byteLength:n.byteLength}:n}),t}({source:i.source,decrypted:n}),[n.buffer])})}}(this)}),Xh={AUDIO:function(e,t){return function(){var i=t.mediaTypes[e],n=t.blacklistCurrentPlaylist;Gh(t.segmentLoaders[e],i);var r=i.activeTrack(),a=i.activeGroup(),s=(a.filter(function(e){return e.default})[0]||a[0]).id,o=i.tracks[s];if(r!==o){for(var l in hs.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),i.tracks)i.tracks[l].enabled=i.tracks[l]===o;i.onTrackChanged()}else n({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(e,t){return function(){var i=t.segmentLoaders[e],n=t.mediaTypes[e];hs.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),Gh(i,n);var r=n.activeTrack();r&&(r.mode="disabled"),n.onTrackChanged()}}},Kh={AUDIO:function(e,t,i){if(t){var n=i.tech,r=i.requestOptions,a=i.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),(!n.paused()||e.endList&&"none"!==n.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),n.paused()||a.load()}),t.on("error",Xh[e](e,i))}},SUBTITLES:function(e,t,i){var n=i.tech,r=i.requestOptions,a=i.segmentLoaders[e],s=i.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,r),a.track(s.activeTrack()),(!n.paused()||e.endList&&"none"!==n.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),r),n.paused()||a.load()}),t.on("error",Xh[e](e,i))}},Qh={AUDIO:function(e,t){var i,n,r=t.hls,a=t.sourceType,s=t.segmentLoaders[e],o=t.requestOptions,l=t.master.mediaGroups,u=t.mediaTypes[e],c=u.groups,h=u.tracks,d=t.masterPlaylistLoader;for(var f in l[e]&&0!==Object.keys(l[e]).length||(l[e]={main:{default:{default:!0}}}),l[e])for(var p in c[f]||(c[f]=[]),l[e][f]){var m,g=l[e][f][p];if(m=g.resolvedUri?new ac(g.resolvedUri,r,o):g.playlists&&"dash"===a?new _h(g.playlists[0],r,o,d):null,g=hs.mergeOptions({id:p,playlistLoader:m},g),Kh[e](e,g.playlistLoader,t),c[f].push(g),void 0===h[p]){var v=new hs.AudioTrack({id:p,kind:(i=g,n=void 0,n=i.default?"main":"alternative",i.characteristics&&0<=i.characteristics.indexOf("public.accessibility.describes-video")&&(n="main-desc"),n),enabled:!1,language:g.language,default:g.default,label:p});h[p]=v}}s.on("error",Xh[e](e,t))},SUBTITLES:function(e,t){var i=t.tech,n=t.hls,r=t.sourceType,a=t.segmentLoaders[e],s=t.requestOptions,o=t.master.mediaGroups,l=t.mediaTypes[e],u=l.groups,c=l.tracks,h=t.masterPlaylistLoader;for(var d in o[e])for(var f in u[d]||(u[d]=[]),o[e][d])if(!o[e][d][f].forced){var p=o[e][d][f],m=void 0;if("hls"===r?m=new ac(p.resolvedUri,n,s):"dash"===r&&(m=new _h(p.playlists[0],n,s,h)),p=hs.mergeOptions({id:f,playlistLoader:m},p),Kh[e](e,p.playlistLoader,t),u[d].push(p),void 0===c[f]){var g=i.addRemoteTextTrack({id:f,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:f},!1).track;c[f]=g}}a.on("error",Xh[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var i=t.tech,n=t.master.mediaGroups,r=t.mediaTypes[e],a=r.groups,s=r.tracks;for(var o in n[e])for(var l in a[o]||(a[o]=[]),n[e][o]){var u=n[e][o][l];if(u.instreamId.match(/CC\d/)&&(a[o].push(hs.mergeOptions({id:l},u)),void 0===s[l])){var c=i.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default&&u.autoselect,language:u.language,label:l},!1).track;s[l]=c}}}},Jh={AUDIO:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var n in i)if(i[n].enabled)return i[n];return null}},SUBTITLES:function(e,t){return function(){var i=t.mediaTypes[e].tracks;for(var n in i)if("showing"===i[n].mode)return i[n];return null}}},Zh=void 0,ed=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],td=(Xu(id,hs.EventTarget),$u(id,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var e=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=e.masterPlaylistLoader_.media(),i=1.5*t.targetDuration*1e3;e.requestOptions_.timeout=yc(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?0:i,t.endList&&"none"!==e.tech_.preload()&&(e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load()),function(e){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){Qh[t](t,e)});var t=e.mediaTypes,i=e.masterPlaylistLoader,n=e.tech,r=e.hls;["AUDIO","SUBTITLES"].forEach(function(i){var n,r,a,s;t[i].activeGroup=(a=i,s=e,function(e){var t=s.mediaTypes[a].groups,i=s.masterPlaylistLoader.media();if(!i)return null;var n=null;return i.attributes[a]&&(n=t[i.attributes[a]]),n=n||t.main,void 0===e?n:null===e?null:n.filter(function(t){return t.id===e.id})[0]||null}),t[i].activeTrack=Jh[i](i,e),t[i].onGroupChanged=(n=i,r=e,function(){var e=r.segmentLoaders,t=e[n],i=e.main,a=r.mediaTypes[n],s=a.activeTrack(),o=a.activeGroup(s),l=a.activePlaylistLoader;Gh(t,a),o&&(o.playlistLoader?(t.resyncLoader(),$h(o.playlistLoader,a)):l&&i.resetEverything())}),t[i].onTrackChanged=function(e,t){return function(){var i=t.segmentLoaders,n=i[e],r=i.main,a=t.mediaTypes[e],s=a.activeTrack(),o=a.activeGroup(s),l=a.activePlaylistLoader;Gh(n,a),o&&(o.playlistLoader?(l!==o.playlistLoader&&(n.track&&n.track(s),n.resetEverything()),$h(o.playlistLoader,a)):r.resetEverything())}}(i,e)});var a=t.AUDIO.activeGroup(),s=(a.filter(function(e){return e.default})[0]||a[0]).id;function o(){t.AUDIO.onTrackChanged(),n.trigger({type:"usage",name:"hls-audio-change"})}for(var l in t.AUDIO.tracks[s].enabled=!0,t.AUDIO.onTrackChanged(),i.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return t[e].onGroupChanged()})}),n.audioTracks().addEventListener("change",o),n.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged),r.on("dispose",function(){n.audioTracks().removeEventListener("change",o),n.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)}),n.clearTracks("audio"),t.AUDIO.tracks)n.audioTracks().addTrack(t.AUDIO.tracks[l])}({sourceType:e.sourceType_,segmentLoaders:{AUDIO:e.audioSegmentLoader_,SUBTITLES:e.subtitleSegmentLoader_,main:e.mainSegmentLoader_},tech:e.tech_,requestOptions:e.requestOptions_,masterPlaylistLoader:e.masterPlaylistLoader_,hls:e.hls_,master:e.master(),mediaTypes:e.mediaTypes_,blacklistCurrentPlaylist:e.blacklistCurrentPlaylist.bind(e)}),e.triggerPresenceUsage_(e.master(),t);try{e.setupSourceBuffers_()}catch(t){return hs.log.warn("Failed to create SourceBuffers",t),e.mediaSource.endOfStream("decode")}e.setupFirstPlay(),!e.mediaTypes_.AUDIO.activePlaylistLoader||e.mediaTypes_.AUDIO.activePlaylistLoader.media()?e.trigger("selectedinitialmedia"):e.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){e.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var t=e.masterPlaylistLoader_.media();if(!t){e.excludeUnsupportedVariants_();var i=void 0;return e.enableLowInitialPlaylist&&(i=e.selectInitialPlaylist()),i=i||e.selectPlaylist(),e.initialMedia_=i,void e.masterPlaylistLoader_.media(e.initialMedia_)}if(e.useCueTags_&&e.updateAdCues_(t),e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.updateDuration(),e.tech_.paused()||(e.mainSegmentLoader_.load(),e.audioSegmentLoader_&&e.audioSegmentLoader_.load()),!t.endList){function n(){var t=e.seekable();0!==t.length&&e.mediaSource.addSeekableRange_(t.start(0),t.end(0))}e.duration()!==1/0?e.tech_.one("durationchange",function t(){e.duration()===1/0?n():e.tech_.one("durationchange",t)}):n()}}),this.masterPlaylistLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){e.mainSegmentLoader_.abort(),e.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var t=e.masterPlaylistLoader_.media(),i=1.5*t.targetDuration*1e3;e.requestOptions_.timeout=yc(e.masterPlaylistLoader_.master,e.masterPlaylistLoader_.media())?0:i,e.mainSegmentLoader_.playlist(t,e.requestOptions_),e.mainSegmentLoader_.load(),e.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var t=e.masterPlaylistLoader_.media();e.stuckAtPlaylistEnd_(t)&&(e.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),e.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){e.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var i=e.mediaGroups||{},n=!0,r=Object.keys(i.AUDIO);for(var a in i.AUDIO)for(var s in i.AUDIO[a])i.AUDIO[a][s].uri||(n=!1);n&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(i.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),Zh.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),Zh.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),r.length&&1<Object.keys(i.AUDIO[r[0]]).length&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var e=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=e.selectPlaylist(),i=e.masterPlaylistLoader_.media(),n=e.tech_.buffered(),r=n.length?n.end(n.length-1)-e.tech_.currentTime():0,a=e.bufferLowWaterLine();(!i.endList||e.duration()<Ih.MAX_BUFFER_LOW_WATER_LINE||t.attributes.BANDWIDTH<i.attributes.BANDWIDTH||a<=r)&&e.masterPlaylistLoader_.media(t),e.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){e.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){e.blacklistCurrentPlaylist(e.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){e.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){e.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){e.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){e.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){e.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(t){e.tech_.trigger({type:"hls-segment-time-mapping",mapping:t.mapping})}),this.audioSegmentLoader_.on("ended",function(){e.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything(function(){e.tech_.setCurrentTime(hs.browser.IE_VERSION||hs.browser.IS_EDGE?e.tech_.currentTime()+.04:e.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.seekTo_(0),this.hasPlayed_()&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.seekTo_(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_())return!1;if(!t.endList){var i=this.seekable();if(!i.length)return!1;if(hs.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.seekTo_(i.end(0)),e.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.seekTo_(i.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return hs.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){hs.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var i=Zh.Playlist.playlistEnd(e,t),n=this.tech_.currentTime(),r=this.tech_.buffered();if(!r.length)return i-n<=.1;var a=r.end(r.length-1);return a-n<=.1&&i-a<=.1}},{key:"blacklistCurrentPlaylist",value:function(e,t){var i,n=0<arguments.length&&void 0!==e?e:{},r=t,a=void 0;if(a=n.playlist||this.masterPlaylistLoader_.media(),r=r||n.blacklistDuration||this.blacklistDuration,!a){this.error=n;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var s=1===this.masterPlaylistLoader_.master.playlists.filter(gc).length,o=this.masterPlaylistLoader_.master.playlists;return 1===o.length?(hs.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(s)):(s&&(hs.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),o.forEach(function(e){e.excludeUntil!==1/0&&delete e.excludeUntil}),this.tech_.trigger("retryplaylist")),a.excludeUntil=Date.now()+1e3*r,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),i=this.selectPlaylist(),hs.log.warn("Problem encountered with the current HLS playlist."+(n.message?" "+n.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(i,s))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Lc(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:Zh.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(this.masterPlaylistLoader_){var i=this.masterPlaylistLoader_.media();if(i){var n=this.syncController_.getExpiredTime(i,this.mediaSource.duration);if(null!==n&&0!==(e=Zh.Playlist.seekable(i,n)).length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(i=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(n=this.syncController_.getExpiredTime(i,this.mediaSource.duration)))return;if(0===(t=Zh.Playlist.seekable(i,n)).length)return}var r=void 0,a=void 0;this.seekable_&&this.seekable_.length&&(r=this.seekable_.end(0),a=this.seekable_.start(0)),this.seekable_=t?t.start(0)>e.end(0)||e.start(0)>t.end(0)?e:hs.createTimeRanges([[t.start(0)>e.start(0)?t.start(0):e.start(0),t.end(0)<e.end(0)?t.end(0):e.end(0)]]):e,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===r&&this.seekable_.start(0)===a||(this.logger_("seekable updated ["+Pc(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},{key:"updateDuration",value:function(){function e(){t.logger_("Setting duration from "+t.mediaSource.duration+" => "+n);try{t.mediaSource.duration=n}catch(e){hs.log.warn("Failed to set media source duration",e)}t.tech_.trigger("durationchange"),t.mediaSource.removeEventListener("sourceopen",e)}var t=this,i=this.mediaSource.duration,n=Zh.Playlist.duration(this.masterPlaylistLoader_.media()),r=this.tech_.buffered();0<r.length&&(n=Math.max(n,r.end(r.length-1))),i!==n&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",e):e())}},{key:"dispose",value:function(){var e=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(t){var i=e.mediaTypes_[t].groups;for(var n in i)i[n].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e,t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState){if((e=function(e,t){var i=t.segments&&t.segments.length&&t.segments[0].map?"mp4":"mp2t",n=function(e){var t=e.attributes||{};return t.CODECS?eh(t.CODECS):ah}(t),r=t.attributes||{},a=!0,s=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&r.AUDIO){var o=e.mediaGroups.AUDIO[r.AUDIO];if(o)for(var l in a=!(s=!0),o)if(!o[l].uri&&!o[l].playlists){a=!0;break}}s&&!n.audioProfile&&(a||(n.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var i=e.mediaGroups.AUDIO[t];if(!i)return null;for(var n in i){var r=i[n];if(r.default&&r.playlists)return eh(r.playlists[0].attributes.CODECS).audioProfile}return null}(e,r.AUDIO)),n.audioProfile||(hs.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),n.audioProfile=ah.audioProfile));var u={};n.videoCodec&&(u.video=""+n.videoCodec+n.videoObjectTypeIndicator),n.audioProfile&&(u.audio="mp4a.40."+n.audioProfile);var c=th("audio",i,[u.audio]),h=th("video",i,[u.video]),d=th("video",i,[u.video,u.audio]);return s?!a&&u.video?[h,c]:a||u.video?[d,c]:[c,c]:u.video?[d]:[c]}(this.masterPlaylistLoader_.master,t)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(e),this.excludeIncompatibleVariants_(t)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=1<e.length&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new hs.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(t){t.attributes.CODECS&&e.MediaSource&&e.MediaSource.isTypeSupported&&!e.MediaSource.isTypeSupported('video/mp4; codecs="'+function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return Zc([e])[0]})}(t.attributes.CODECS)+'"')&&(t.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(e){var t=2,i=null,n=void 0;e.attributes.CODECS&&(n=eh(e.attributes.CODECS),i=n.videoCodec,t=n.codecCount),this.master().playlists.forEach(function(e){var n={codecCount:2,videoCodec:null};e.attributes.CODECS&&(n=eh(e.attributes.CODECS)),n.codecCount!==t&&(e.excludeUntil=1/0),n.videoCodec!==i&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(t){var i=0,n=this.seekable();n.length&&(i=n.start(0)),function(t,i,n){if(t.segments)for(var r=2<arguments.length&&void 0!==n?n:0,a=void 0,s=0;s<t.segments.length;s++){var o=t.segments[s];if(a=a||Wh(i,r+o.duration/2)){if("cueIn"in o){a.endTime=r,a.adEndTime=r,r+=o.duration,a=null;continue}if(r<a.endTime){r+=o.duration;continue}a.endTime+=o.duration}else if("cueOut"in o&&((a=new e.VTTCue(r,r+o.duration,o.cueOut)).adStartTime=r,a.adEndTime=r+parseFloat(o.cueOut),i.addCue(a)),"cueOutCont"in o){var l,u,c=o.cueOutCont.split("/").map(parseFloat),h=ic(c,2);l=h[0],u=h[1],(a=new e.VTTCue(r,r+o.duration,"")).adStartTime=r-l,a.adEndTime=a.adStartTime+u,i.addCue(a)}r+=o.duration}}(t,this.cueTagsTrack_,i)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Ih.GOAL_BUFFER_LENGTH,i=Ih.GOAL_BUFFER_LENGTH_RATE,n=Math.max(t,Ih.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*i,n)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Ih.BUFFER_LOW_WATER_LINE,i=Ih.BUFFER_LOW_WATER_LINE_RATE,n=Math.max(t,Ih.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*i,n)}}]),id);function id(e){Gu(this,id);var t=Ku(this,(id.__proto__||Object.getPrototypeOf(id)).call(this)),i=e.url,n=e.handleManifestRedirects,r=e.withCredentials,a=e.tech,s=e.bandwidth,o=e.externHls,l=e.useCueTags,u=e.blacklistDuration,c=e.enableLowInitialPlaylist,h=e.sourceType,d=e.seekTo,f=e.cacheEncryptionKeys;if(!i)throw new Error("A non-empty playlist URL is required");Zh=o,t.withCredentials=r,t.tech_=a,t.hls_=a.hls,t.seekTo_=d,t.sourceType_=h,t.useCueTags_=l,t.blacklistDuration=u,t.enableLowInitialPlaylist=c,t.useCueTags_&&(t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues"),t.cueTagsTrack_.inBandMetadataTrackDispatchType=""),t.requestOptions_={withCredentials:r,handleManifestRedirects:n,timeout:null},t.mediaTypes_=function(){var e={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){e[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:kh,activeTrack:kh,onGroupChanged:kh,onTrackChanged:kh}}),e}(),t.mediaSource=new hs.MediaSource,t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_.bind(t)),t.seekable_=hs.createTimeRanges(),t.hasPlayed_=function(){return!1},t.syncController_=new qh(e),t.segmentMetadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,t.decrypter_=new Yh,t.inbandTextTracks_={};var p={hls:t.hls_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.mediaSource.duration},hasPlayed:function(){return t.hasPlayed_()},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:s,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_,cacheEncryptionKeys:f};return t.masterPlaylistLoader_="dash"===t.sourceType_?new _h(i,t.hls_,t.requestOptions_):new ac(i,t.hls_,t.requestOptions_),t.setupMasterPlaylistLoaderListeners_(),t.mainSegmentLoader_=new Rh(hs.mergeOptions(p,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e),t.audioSegmentLoader_=new Rh(hs.mergeOptions(p,{loaderType:"audio"}),e),t.subtitleSegmentLoader_=new Fh(hs.mergeOptions(p,{loaderType:"vtt"}),e),t.setupSegmentLoaderListeners_(),ed.forEach(function(e){t[e+"_"]=(function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}).bind(t,e)}),t.logger_=Sh("MPC"),t.masterPlaylistLoader_.load(),t}function nd(e,t,i){Gu(this,nd);var n=e.masterPlaylistController_,r=n[(e.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(n);if(t.attributes.RESOLUTION){var a=t.attributes.RESOLUTION;this.width=a.width,this.height=a.height}this.bandwidth=t.attributes.BANDWIDTH,this.id=i,this.enabled=function(e,t,i){return function(n){var r=e.master.playlists[t],a=mc(r),s=gc(r);return void 0===n?s:(n?delete r.disabled:r.disabled=!0,n===s||a||(i(),e.trigger(n?"renditionenabled":"renditiondisabled")),n)}}(e.playlists,t.uri,r)}var rd=["seeking","seeked","pause","playing","error"],ad=($u(sd,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&e.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=e.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var e=this.seekable(),t=this.tech_.currentTime(),i=void 0;return this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(i=e.end(e.length-1)),this.beforeSeekableWindow_(e,t)&&(i=e.start(0)+.1),void 0!==i&&(this.logger_("Trying to seek outside of seekable at time "+t+" with seekable range "+Pc(e)+". Seeking to "+i+"."),this.seekTo(i),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=Lc(this.tech_.buffered(),e);return t.length&&e+3<=t.end(0)?(this.cancelTimer_(),this.seekTo(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+t.start(0)+" -> "+t.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var i=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+i),this.cancelTimer_(),this.seekTo(i),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var n=this.tech_.buffered(),r=Ac(n,t);if(this.videoUnderflow_(r,n,t))return this.cancelTimer_(),this.seekTo(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(0<r.length){var a=r.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+r.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,i,n){var r=3<arguments.length&&void 0!==n&&n;if(!e.length)return!1;var a=e.end(e.length-1)+.1;return!i.endList&&r&&(a=e.end(e.length-1)+3*i.targetDuration),a<t}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-.1)}},{key:"videoUnderflow_",value:function(e,t,i){if(0===e.length){var n=this.gapFromVideoUnderflow_(t,i);if(n)return this.logger_("Encountered a gap in video from "+n.start+" to "+n.end+". Seeking to current time "+i),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),i=this.tech_.currentTime(),n=Ac(t,i);this.cancelTimer_(),0!==n.length&&i===e&&(this.logger_("skipTheGap_:","currentTime:",i,"scheduled currentTime:",e,"nextRange start:",n.start(0)),this.seekTo(n.start(0)+Hc),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var i=function(e){if(e.length<2)return hs.createTimeRanges();for(var t=[],i=1;i<e.length;i++){var n=e.end(i-1),r=e.start(i);t.push([n,r])}return hs.createTimeRanges(t)}(e),n=0;n<i.length;n++){var r=i.start(n),a=i.end(n);if(t-r<4&&2<t-r)return{start:r,end:a}}return null}}]),sd);function sd(t){var i=this;function n(){return i.monitorCurrentTime_()}function r(){return i.techWaiting_()}function a(){return i.cancelTimer_()}function s(){return i.fixesBadSeeks_()}Gu(this,sd),this.tech_=t.tech,this.seekable=t.seekable,this.seekTo=t.seekTo,this.allowSeeksWithinUnsafeLiveWindow=t.allowSeeksWithinUnsafeLiveWindow,this.media=t.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=Sh("PlaybackWatcher"),this.logger_("initialize"),this.tech_.on("seekablechanged",s),this.tech_.on("waiting",r),this.tech_.on(rd,a),this.tech_.on("canplay",n),this.dispose=function(){i.logger_("dispose"),i.tech_.off("seekablechanged",s),i.tech_.off("waiting",r),i.tech_.off(rd,a),i.tech_.off("canplay",n),i.checkCurrentTimeTimeout_&&e.clearTimeout(i.checkCurrentTimeTimeout_),i.cancelTimer_()}}function od(e){!function e(t,i){var n=0,r=0,a=hs.mergeOptions(ld,i);function s(){r&&t.currentTime(r)}function o(e){null!=e&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",s),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())}function l(){if(Date.now()-n<1e3*a.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(a.getSource&&"function"==typeof a.getSource)return n=Date.now(),a.getSource.call(t,o);hs.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}}function u(){t.off("loadedmetadata",s),t.off("error",l),t.off("dispose",u)}t.ready(function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})}),t.on("error",l),t.on("dispose",u),t.reloadSourceOnError=function(i){u(),e(t,i)}}(this,e)}var ld={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}};hs.use("*",function(e){return{setSource:function(e,t){t(null,e)},setCurrentTime:function(t){return e.vhs&&e.currentSource().src===e.vhs.source_.src&&e.vhs.setCurrentTime(t),t},play:function(){e.vhs&&e.currentSource().src===e.vhs.source_.src&&e.vhs.setCurrentTime(e.tech_.currentTime())}}});var ud={PlaylistLoader:ac,Playlist:Nc,Decrypter:Wu,AsyncStream:Bu,decrypt:Hu,utils:Fc,STANDARD_PLAYLIST_SELECTOR:function(){return function(t,i,n,r,a){var s=t.playlists.map(function(t){return{bandwidth:t.attributes.BANDWIDTH||e.Number.MAX_VALUE,width:t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width,height:t.attributes.RESOLUTION&&t.attributes.RESOLUTION.height,playlist:t}});Ah(s,function(e,t){return e.bandwidth-t.bandwidth});var o=(s=s.filter(function(e){return!Nc.isIncompatible(e.playlist)})).filter(function(e){return Nc.isEnabled(e.playlist)});o.length||(o=s.filter(function(e){return!Nc.isDisabled(e.playlist)}));var l=o.filter(function(e){return e.bandwidth*Ih.BANDWIDTH_VARIANCE<i}),u=l[l.length-1],c=l.filter(function(e){return e.bandwidth===u.bandwidth})[0];if(!1===a){var h=c||o[0]||s[0];return h?h.playlist:null}var d=l.filter(function(e){return e.width&&e.height});Ah(d,function(e,t){return e.width-t.width});var f=d.filter(function(e){return e.width===n&&e.height===r});u=f[f.length-1];var p=f.filter(function(e){return e.bandwidth===u.bandwidth})[0],m=void 0,g=void 0,v=void 0;p||(g=(m=d.filter(function(e){return e.width>n||e.height>r})).filter(function(e){return e.width===m[0].width&&e.height===m[0].height}),u=g[g.length-1],v=g.filter(function(e){return e.bandwidth===u.bandwidth})[0]);var y=v||p||c||o[0]||s[0];return y?y.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(Lh(this.tech_.el(),"width"),10),parseInt(Lh(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(Nc.isEnabled);return Ah(e,function(e,t){return Ph(e,t)}),e.filter(function(e){return eh(e.attributes.CODECS).videoCodec})[0]||null},comparePlaylistBandwidth:Ph,comparePlaylistResolution:function(t,i){var n=void 0,r=void 0;return t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(n=t.attributes.RESOLUTION.width),i.attributes.RESOLUTION&&i.attributes.RESOLUTION.width&&(r=i.attributes.RESOLUTION.width),(n=n||e.Number.MAX_VALUE)===(r=r||e.Number.MAX_VALUE)&&t.attributes.BANDWIDTH&&i.attributes.BANDWIDTH?t.attributes.BANDWIDTH-i.attributes.BANDWIDTH:n-r},xhr:bc()};function cd(e){return/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)?"hls":/^application\/dash\+xml/i.test(e)?"dash":null}function hd(e,t){for(var i=t.media(),n=-1,r=0;r<e.length;r++)if(e[r].id===i.uri){n=r;break}e.selectedIndex_=n,e.trigger({selectedIndex:n,type:"change"})}["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(e){Object.defineProperty(ud,e,{get:function(){return hs.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),Ih[e]},set:function(t){hs.log.warn("using Hls."+e+" is UNSAFE be sure you know what you are doing"),"number"!=typeof t||t<0?hs.log.warn("value of Hls."+e+" must be greater than or equal to 0"):Ih[e]=t}})});var dd="videojs-vhs";function fd(){if(!window.localStorage)return null;var e=window.localStorage.getItem(dd);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}ud.canPlaySource=function(){return hs.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},ud.supportsNativeHls=function(){var e=t.createElement("video");return!!hs.getTech("Html5").isSupported()&&["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(t){return/maybe|probably/i.test(e.canPlayType(t))})}(),ud.supportsNativeDash=!!hs.getTech("Html5").isSupported()&&/maybe|probably/i.test(t.createElement("video").canPlayType("application/dash+xml")),ud.supportsTypeNatively=function(e){return"hls"===e?ud.supportsNativeHls:"dash"===e&&ud.supportsNativeDash},ud.isSupported=function(){return hs.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var pd=(Xu(md,hs.getComponent("Component")),$u(md,[{key:"setOptions_",value:function(){var e=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var t=fd();t&&t.bandwidth&&(this.options_.bandwidth=t.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),t&&t.throughput&&(this.options_.throughput=t.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Ih.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Ih.INITIAL_BANDWIDTH,["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(t){void 0!==e.source_[t]&&(e.options_[t]=e.source_[t])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(e,t){var i=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=ud,this.options_.sourceType=cd(t),this.options_.seekTo=function(e){i.tech_.setCurrentTime(e),i.setCurrentTime(e)},this.masterPlaylistController_=new td(this.options_),this.playbackWatcher_=new ad(hs.mergeOptions(this.options_,{seekable:function(){return i.seekable()},media:function(){return i.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",function(){hs.players[i.tech_.options_.playerId].error(i.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):ud.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=ud.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){return Math.floor(1/(1/(this.bandwidth||1)+(0<this.throughput?1/this.throughput:0)))},set:function(){hs.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return i.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return i.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return i.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return i.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return i.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return i.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return i.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return i.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return Oc(i.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return i.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return i.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return i.tech_.name_},enumerable:!0},duration:{get:function(){return i.tech_.duration()},enumerable:!0},master:{get:function(){return i.playlists.master},enumerable:!0},playerDimensions:{get:function(){return i.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return Oc(i.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return i.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){i.options_.useBandwidthFromLocalStorage&&function(e){if(window.localStorage){var t=fd();t=t?hs.mergeOptions(t,e):e;try{window.localStorage.setItem(dd,JSON.stringify(t))}catch(e){return}}}({bandwidth:i.bandwidth,throughput:Math.round(i.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(e){var t=e.playlists;e.representations=function(){return t.master.playlists.filter(function(e){return!mc(e)}).map(function(t,i){return new nd(e,t,t.uri)})}}(i),function(e){if("dash"===e.options_.sourceType){var t=hs.players[e.tech_.options_.playerId];if(t.eme){var i=function(e,t,i){if(!e)return e;var n={};for(var r in e)n[r]={audioContentType:'audio/mp4; codecs="'+i.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+t.attributes.CODECS+'"'},t.contentProtection&&t.contentProtection[r]&&t.contentProtection[r].pssh&&(n[r].pssh=t.contentProtection[r].pssh),"string"==typeof e[r]&&(n[r].url=e[r]);return hs.mergeOptions(e,n)}(e.source_.keySystems,e.playlists.media(),e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());i&&(t.currentSource().keySystems=i,t.eme.initializeMediaKeys&&t.eme.initializeMediaKeys())}}}(i)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.tech_.ready(function(){return i.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(hs.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=hs.players[this.tech_.options_.playerId];t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(e,t){t.representations().forEach(function(t){e.addQualityLevel(t)}),hd(e,t.playlists)}(e.qualityLevels_,e)}),this.playlists.on("mediachange",function(){hd(e.qualityLevels_,e.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,i,n)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(n):void 0}(md.prototype.__proto__||Object.getPrototypeOf(md.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return function(e){var t=e.playlist,i=e.time,n=void 0===i?void 0:i,r=e.callback;if(!r)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===n)return r({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var i=0,n=void 0,r=0;r<t.segments.length&&!(e<=(i=(n=t.segments[r]).videoTimingInfo?n.videoTimingInfo.transmuxedPresentationEnd:i+n.duration));r++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(i<e){if(e>i+.25*a.duration)return null;n=a}return{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:i-n.duration,type:n.videoTimingInfo?"accurate":"estimate"}}(n,t);if(!a)return r({message:"valid programTime was not found"});if("estimate"===a.type)return r({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var s={mediaSeconds:n},o=function(e,t){if(!t.dateTimeObject)return null;var i=e-(t.videoTimingInfo.transmuxedPresentationStart+t.videoTimingInfo.transmuxerPrependedSeconds);return new Date(t.dateTimeObject.getTime()+1e3*i)}(n,a.segment);return o&&(s.programDateTime=o.toISOString()),r(null,s)}({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t,i,n){var r=!(2<arguments.length&&void 0!==i)||i,a=3<arguments.length&&void 0!==n?n:2;return function e(t){var i=t.programTime,n=t.playlist,r=t.retryCount,a=void 0===r?2:r,s=t.seekTo,o=t.pauseAfterSeek,l=void 0===o||o,u=t.tech,c=t.callback;if(!c)throw new Error("seekToProgramTime: callback must be provided");if(void 0===i||!n||!s)return c({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!n.endList&&!u.hasStarted_)return c({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++)if(!e.segments[t].dateTimeObject)return!1;return!0}(n))return c({message:"programDateTime tags must be provided in the manifest "+n.resolvedUri});var h=function(e,t){var i=void 0;try{i=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var n=t.segments[0];if(i<n.dateTimeObject)return null;for(var r=0;r<t.segments.length-1&&(n=t.segments[r],!(i<t.segments[r+1].dateTimeObject));r++);var a=t.segments[t.segments.length-1],s=a.dateTimeObject,o=a.videoTimingInfo?function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds}(a.videoTimingInfo):a.duration+.25*a.duration;return new Date(s.getTime()+1e3*o)<i?null:(s<i&&(n=a),{segment:n,estimatedStart:n.videoTimingInfo?n.videoTimingInfo.transmuxedPresentationStart:Nc.duration(t,t.mediaSequence+t.segments.indexOf(n)),type:n.videoTimingInfo?"accurate":"estimate"})}(i,n);if(!h)return c({message:i+" was not found in the stream"});var d=h.segment,f=function(e,t){var i=void 0,n=void 0;try{i=new Date(e),n=new Date(t)}catch(e){}var r=i.getTime();return(n.getTime()-r)/1e3}(d.dateTimeObject,i);if("estimate"===h.type)return 0===a?c({message:i+" is not buffered yet. Try again"}):(s(h.estimatedStart+f),void u.one("seeked",function(){e({programTime:i,playlist:n,retryCount:a-1,seekTo:s,pauseAfterSeek:l,tech:u,callback:c})}));var p=d.start+f;u.one("seeked",function(){return c(null,u.currentTime())}),l&&u.pause(),s(p)}({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:a,pauseAfterSeek:r,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),md);function md(e,i,n){Gu(this,md);var r=Ku(this,(md.__proto__||Object.getPrototypeOf(md)).call(this,i,n.hls));if(i.options_&&i.options_.playerId){var a=hs(i.options_.playerId);a.hasOwnProperty("hls")||Object.defineProperty(a,"hls",{get:function(){return hs.log.warn("player.hls is deprecated. Use player.tech().hls instead."),i.trigger({type:"usage",name:"hls-player-access"}),r},configurable:!0}),a.vhs=r,(a.dash=r).player_=a}if(r.tech_=i,r.source_=e,r.stats={},r.setOptions_(),r.options_.overrideNative&&i.overrideNativeAudioTracks&&i.overrideNativeVideoTracks)i.overrideNativeAudioTracks(!0),i.overrideNativeVideoTracks(!0);else if(r.options_.overrideNative&&(i.featuresNativeVideoTracks||i.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return r.on(t,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var i=t.fullscreenElement||t.webkitFullscreenElement||t.mozFullScreenElement||t.msFullscreenElement;i&&i.contains(r.tech_.el())&&r.masterPlaylistController_.smoothQualityChange_()}),r.on(r.tech_,"seeking",function(){0===this.tech_.currentTime()&&this.tech_.player_.loop()&&this.setCurrentTime(0)}),r.on(r.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),r.on(r.tech_,"play",r.play),r}var gd={name:"videojs-http-streaming",VERSION:"1.10.3",canHandleSource:function(e,t){var i=hs.mergeOptions(hs.options,1<arguments.length&&void 0!==t?t:{});return gd.canPlayType(e.type,i)},handleSource:function(e,t,i){var n=hs.mergeOptions(hs.options,2<arguments.length&&void 0!==i?i:{});return t.hls=new pd(e,t,n),t.hls.xhr=bc(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e,t){var i=hs.mergeOptions(hs.options,1<arguments.length&&void 0!==t?t:{}).hls.overrideNative,n=cd(e);return!n||ud.supportsTypeNatively(n)&&!i?"":"maybe"}};return void 0!==hs.MediaSource&&void 0!==hs.URL||(hs.MediaSource=fh,hs.URL=ph),fh.supportsNativeMediaSources()&&hs.getTech("Html5").registerSourceHandler(gd,0),hs.HlsHandler=pd,hs.HlsSourceHandler=gd,hs.Hls=ud,hs.use||hs.registerComponent("Hls",ud),hs.options.hls=hs.options.hls||{},hs.registerPlugin?hs.registerPlugin("reloadSourceOnError",od):hs.plugin("reloadSourceOnError",od),hs}),function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SimpleMDE=e()}(function(){return function e(t,i,n){function r(s,o){if(!i[s]){if(!t[s]){var l="function"==typeof require&&require;if(!o&&l)return l(s,!0);if(a)return a(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[s]={exports:{}};t[s][0].call(c.exports,function(e){return r(t[s][1][e]||e)},c,c.exports,e,t,i,n)}return i[s].exports}for(var a="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,i){"use strict";function n(e){return a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e]}function r(e,t,i){for(var r=[],a=t;i>a;a+=3)r.push(n((e[a]<<16)+(e[a+1]<<8)+e[a+2]));return r.join("")}i.toByteArray=function(e){var t,i,n,r,a,l,u=e.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");l=new o(3*u/4-(a="="===e[u-2]?2:"="===e[u-1]?1:0)),n=a>0?u-4:u;var c=0;for(t=0,i=0;n>t;t+=4,i+=3)r=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],l[c++]=r>>16&255,l[c++]=r>>8&255,l[c++]=255&r;return 2===a?(r=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,l[c++]=255&r):1===a&&(r=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,l[c++]=r>>8&255,l[c++]=255&r),l},i.fromByteArray=function(e){for(var t,i=e.length,n=i%3,s="",o=[],l=16383,u=0,c=i-n;c>u;u+=l)o.push(r(e,u,u+l>c?c:u+l));return 1===n?(s+=a[(t=e[i-1])>>2],s+=a[t<<4&63],s+="=="):2===n&&(s+=a[(t=(e[i-2]<<8)+e[i-1])>>10],s+=a[t>>4&63],s+=a[t<<2&63],s+="="),o.push(s),o.join("")};var a=[],s=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array;!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,i=e.length;i>t;++t)a[t]=e[t],s[e.charCodeAt(t)]=t;s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63}()},{}],2:[function(e,t,i){},{}],3:[function(e,t,i){(function(t){"use strict";function n(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function r(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=a.prototype:(null===e&&(e=new a(t)),e.length=t),e}function a(e,t,i){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return s(this,e,t,i)}function s(e,t,i,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,n){if(0>i||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===n?new Uint8Array(t,i):new Uint8Array(t,i,n),a.TYPED_ARRAY_SUPPORT?(e=t).__proto__=a.prototype:e=u(e,t),e}(e,t,i,n):"string"==typeof t?function(e,t,i){if("string"==typeof i&&""!==i||(i="utf8"),!a.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');return(e=r(e,0|h(t,i))).write(t,i),e}(e,t,i):function(e,t){if(a.isBuffer(t)){var i=0|c(t.length);return 0===(e=r(e,i)).length?e:(t.copy(e,0,0,i),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?r(e,0):u(e,t);if("Buffer"===t.type&&j(t.data))return u(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function o(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number')}function l(e,t){if(o(t),e=r(e,0>t?0:0|c(t)),!a.TYPED_ARRAY_SUPPORT)for(var i=0;t>i;i++)e[i]=0;return e}function u(e,t){var i=0|c(t.length);e=r(e,i);for(var n=0;i>n;n+=1)e[n]=255&t[n];return e}function c(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function h(e,t){if(a.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"binary":case"raw":case"raws":return i;case"utf8":case"utf-8":case void 0:return D(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return U(e).length;default:if(n)return D(e).length;t=(""+t).toLowerCase(),n=!0}}function d(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function f(e,t,i,n){function r(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}var a=1,s=e.length,o=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,o/=2,i/=2}for(var l=-1,u=0;s>i+u;u++)if(r(e,i+u)===r(t,-1===l?0:u-l)){if(-1===l&&(l=u),u-l+1===o)return(i+l)*a}else-1!==l&&(u-=u-l),l=-1;return-1}function p(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var a=t.length;if(a%2!=0)throw new Error("Invalid hex string");n>a/2&&(n=a/2);for(var s=0;n>s;s++){var o=parseInt(t.substr(2*s,2),16);if(isNaN(o))return s;e[i+s]=o}return s}function m(e,t,i,n){return R(D(t,e.length-i),e,i,n)}function g(e,t,i,n){return R(function(e){for(var t=[],i=0;i<e.length;i++)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function v(e,t,i,n){return g(e,t,i,n)}function y(e,t,i,n){return R(U(t),e,i,n)}function b(e,t,i,n){return R(function(e,t){for(var i,n,r=[],a=0;a<e.length&&!((t-=2)<0);a++)n=(i=e.charCodeAt(a))>>8,r.push(i%256),r.push(n);return r}(t,e.length-i),e,i,n)}function _(e,t,i){return N.fromByteArray(0===t&&i===e.length?e:e.slice(t,i))}function T(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;i>r;){var a,s,o,l,u=e[r],c=null,h=u>239?4:u>223?3:u>191?2:1;if(i>=r+h)switch(h){case 1:128>u&&(c=u);break;case 2:128==(192&(a=e[r+1]))&&(l=(31&u)<<6|63&a)>127&&(c=l);break;case 3:s=e[r+2],128==(192&(a=e[r+1]))&&128==(192&s)&&(l=(15&u)<<12|(63&a)<<6|63&s)>2047&&(55296>l||l>57343)&&(c=l);break;case 4:s=e[r+2],o=e[r+3],128==(192&(a=e[r+1]))&&128==(192&s)&&128==(192&o)&&(l=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&1114112>l&&(c=l)}null===c?(c=65533,h=1):c>65535&&(n.push((c-=65536)>>>10&1023|55296),c=56320|1023&c),n.push(c),r+=h}return function(e){var t=e.length;if(F>=t)return String.fromCharCode.apply(String,e);for(var i="",n=0;t>n;)i+=String.fromCharCode.apply(String,e.slice(n,n+=F));return i}(n)}function S(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;i>r;r++)n+=String.fromCharCode(127&e[r]);return n}function k(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;i>r;r++)n+=String.fromCharCode(e[r]);return n}function w(e,t,i){var n=e.length;(!t||0>t)&&(t=0),(!i||0>i||i>n)&&(i=n);for(var r="",a=t;i>a;a++)r+=M(e[a]);return r}function C(e,t,i){for(var n=e.slice(t,i),r="",a=0;a<n.length;a+=2)r+=String.fromCharCode(n[a]+256*n[a+1]);return r}function x(e,t,i){if(e%1!=0||0>e)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function E(e,t,i,n,r,s){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||s>t)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function L(e,t,i,n){0>t&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-i,2);a>r;r++)e[i+r]=(t&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function A(e,t,i,n){0>t&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-i,4);a>r;r++)e[i+r]=t>>>8*(n?r:3-r)&255}function P(e,t,i,n,r,a){if(i+n>e.length)throw new RangeError("Index out of range");if(0>i)throw new RangeError("Index out of range")}function O(e,t,i,n,r){return r||P(e,0,i,4),B.write(e,t,i,n,23,4),i+4}function I(e,t,i,n,r){return r||P(e,0,i,8),B.write(e,t,i,n,52,8),i+8}function M(e){return 16>e?"0"+e.toString(16):e.toString(16)}function D(e,t){t=t||1/0;for(var i,n=e.length,r=null,a=[],s=0;n>s;s++){if((i=e.charCodeAt(s))>55295&&57344>i){if(!r){if(i>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&a.push(239,191,189);continue}r=i;continue}if(56320>i){(t-=3)>-1&&a.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,128>i){if((t-=1)<0)break;a.push(i)}else if(2048>i){if((t-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(65536>i){if((t-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(1114112>i))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function U(e){return N.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function R(e,t,i,n){for(var r=0;n>r&&!(r+i>=t.length||r>=e.length);r++)t[r+i]=e[r];return r}var N=e("base64-js"),B=e("ieee754"),j=e("isarray");i.Buffer=a,i.SlowBuffer=function(e){return+e!=e&&(e=0),a.alloc(+e)},i.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),i.kMaxLength=n(),a.poolSize=8192,a._augment=function(e){return e.__proto__=a.prototype,e},a.from=function(e,t,i){return s(null,e,t,i)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(e,t,i){return function(e,t,i,n){return o(t),0>=t?r(e,t):void 0!==i?"string"==typeof n?r(e,t).fill(i,n):r(e,t).fill(i):r(e,t)}(null,e,t,i)},a.allocUnsafe=function(e){return l(null,e)},a.allocUnsafeSlow=function(e){return l(null,e)},a.isBuffer=function(e){return!(null==e||!e._isBuffer)},a.compare=function(e,t){if(!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,r=0,s=Math.min(i,n);s>r;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return n>i?-1:i>n?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!j(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;i++)t+=e[i].length;var n=a.allocUnsafe(t),r=0;for(i=0;i<e.length;i++){var s=e[i];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},a.byteLength=h,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;e>t;t+=2)d(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;e>t;t+=4)d(this,t,t+3),d(this,t+1,t+2);return this},a.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):(function(e,t,i){var n=!1;if((void 0===t||0>t)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),0>=i)return"";if((t>>>=0)>=(i>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return w(this,t,i);case"utf8":case"utf-8":return T(this,t,i);case"ascii":return S(this,t,i);case"binary":return k(this,t,i);case"base64":return _(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}).apply(this,arguments)},a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var e="",t=i.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},a.prototype.compare=function(e,t,i,n,r){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),0>t||i>e.length||0>n||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(t>>>=0),l=Math.min(s,o),u=this.slice(n,r),c=e.slice(t,i),h=0;l>h;++h)if(u[h]!==c[h]){s=u[h],o=c[h];break}return o>s?-1:s>o?1:0},a.prototype.indexOf=function(e,t,i){if("string"==typeof t?(i=t,t=0):t>2147483647?t=2147483647:-2147483648>t&&(t=-2147483648),0===this.length)return-1;if((t>>=0)>=this.length)return-1;if(0>t&&(t=Math.max(this.length+t,0)),"string"==typeof e&&(e=a.from(e,i)),a.isBuffer(e))return 0===e.length?-1:f(this,e,t,i);if("number"==typeof e)return a.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,e,t):f(this,[e],t,i);throw new TypeError("val must be string, number or Buffer")},a.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},a.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(0>i||0>t)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return p(this,e,t,i);case"utf8":case"utf-8":return m(this,e,t,i);case"ascii":return g(this,e,t,i);case"binary":return v(this,e,t,i);case"base64":return y(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,e,t,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var F=4096;a.prototype.slice=function(e,t){var i,n=this.length;if(0>(e=~~e)?0>(e+=n)&&(e=0):e>n&&(e=n),0>(t=void 0===t?n:~~t)?0>(t+=n)&&(t=0):t>n&&(t=n),e>t&&(t=e),a.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=a.prototype;else{var r=t-e;i=new a(r,void 0);for(var s=0;r>s;s++)i[s]=this[s+e]}return i},a.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var n=this[e],r=1,a=0;++a<t&&(r*=256);)n+=this[e+a]*r;return n},a.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},a.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},a.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var n=this[e],r=1,a=0;++a<t&&(r*=256);)n+=this[e+a]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||x(e,t,this.length);for(var n=t,r=1,a=this[e+--n];n>0&&(r*=256);)a+=this[e+--n]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},a.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},a.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},a.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),B.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),B.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),B.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),B.read(this,e,!1,52,8)},a.prototype.writeUIntLE=function(e,t,i,n){e=+e,t|=0,i|=0,n||E(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,a=0;for(this[t]=255&e;++a<i&&(r*=256);)this[t+a]=e/r&255;return t+i},a.prototype.writeUIntBE=function(e,t,i,n){e=+e,t|=0,i|=0,n||E(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+i},a.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,1,255,0),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},a.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},a.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},a.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):A(this,e,t,!0),t+4},a.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},a.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);E(this,e,t,i,r-1,-r)}var a=0,s=1,o=0;for(this[t]=255&e;++a<i&&(s*=256);)0>e&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+i},a.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);E(this,e,t,i,r-1,-r)}var a=i-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)0>e&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+i},a.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,1,127,-128),a.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),0>e&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},a.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},a.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):A(this,e,t,!0),t+4},a.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||E(this,e,t,4,2147483647,-2147483648),0>e&&(e=4294967295+e+1),a.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},a.prototype.writeFloatLE=function(e,t,i){return O(this,e,t,!0,i)},a.prototype.writeFloatBE=function(e,t,i){return O(this,e,t,!1,i)},a.prototype.writeDoubleLE=function(e,t,i){return I(this,e,t,!0,i)},a.prototype.writeDoubleBE=function(e,t,i){return I(this,e,t,!1,i)},a.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&i>n&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(0>t)throw new RangeError("targetStart out of bounds");if(0>i||i>=this.length)throw new RangeError("sourceStart out of bounds");if(0>n)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r,s=n-i;if(this===e&&t>i&&n>t)for(r=s-1;r>=0;r--)e[r+t]=this[r+i];else if(1e3>s||!a.TYPED_ARRAY_SUPPORT)for(r=0;s>r;r++)e[r+t]=this[r+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+s),t);return s},a.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===e.length){var r=e.charCodeAt(0);256>r&&(e=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(0>t||this.length<t||this.length<i)throw new RangeError("Out of range index");if(t>=i)return this;var s;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(s=t;i>s;s++)this[s]=e;else{var o=a.isBuffer(e)?e:D(new a(e,n).toString()),l=o.length;for(s=0;i-t>s;s++)this[s+t]=o[s%l]}return this};var H=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:15,isarray:16}],4:[function(e,t,i){"use strict";function n(e){return"function"!=typeof(e=e||{}).codeMirrorInstance||"function"!=typeof e.codeMirrorInstance.defineMode?void console.log("CodeMirror Spell Checker: You must provide an instance of CodeMirror via the option `codeMirrorInstance`"):(String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),void e.codeMirrorInstance.defineMode("spell-checker",function(t){if(!n.aff_loading){n.aff_loading=!0;var i=new XMLHttpRequest;i.open("GET","https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.aff",!0),i.onload=function(){4===i.readyState&&200===i.status&&(n.aff_data=i.responseText,2==++n.num_loaded&&(n.typo=new r("en_US",n.aff_data,n.dic_data,{platform:"any"})))},i.send(null)}if(!n.dic_loading){n.dic_loading=!0;var a=new XMLHttpRequest;a.open("GET","https://cdn.jsdelivr.net/codemirror.spell-checker/latest/en_US.dic",!0),a.onload=function(){4===a.readyState&&200===a.status&&(n.dic_data=a.responseText,2==++n.num_loaded&&(n.typo=new r("en_US",n.aff_data,n.dic_data,{platform:"any"})))},a.send(null)}var s='!"#$%&()*+,-./:;<=>?@[\\]^_`{|}~ ',o={token:function(e){var t=e.peek(),i="";if(s.includes(t))return e.next(),null;for(;null!=(t=e.peek())&&!s.includes(t);)i+=t,e.next();return n.typo&&!n.typo.check(i)?"spell-error":null}},l=e.codeMirrorInstance.getMode(t,t.backdrop||"text/plain");return e.codeMirrorInstance.overlayMode(l,o,!0)}))}var r=e("typo-js");n.num_loaded=0,n.aff_loading=!1,n.dic_loading=!1,n.aff_data="",n.dic_data="",t.exports=n},{"typo-js":18}],5:[function(e,t,i){!function(e){"use strict";e.defineOption("fullScreen",!1,function(t,i,n){n==e.Init&&(n=!1),!n!=!i&&(i?function(e){var t=e.getWrapperElement();e.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height="auto",t.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",e.refresh()}(t):function(e){var t=e.getWrapperElement();t.className=t.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var i=e.state.fullScreenRestore;t.style.width=i.width,t.style.height=i.height,window.scrollTo(i.scrollLeft,i.scrollTop),e.refresh()}(t))})}("object"==typeof i&&"object"==typeof t?e("../../lib/codemirror"):CodeMirror)},{"../../lib/codemirror":10}],6:[function(e,t,i){!function(e){function t(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function i(e){t(e);var i=e.state.placeholder=document.createElement("pre");i.style.cssText="height: 0; overflow: visible",i.className="CodeMirror-placeholder";var n=e.getOption("placeholder");"string"==typeof n&&(n=document.createTextNode(n)),i.appendChild(n),e.display.lineSpace.insertBefore(i,e.display.lineSpace.firstChild)}function n(e){a(e)&&i(e)}function r(e){var n=e.getWrapperElement(),r=a(e);n.className=n.className.replace(" CodeMirror-empty","")+(r?" CodeMirror-empty":""),r?i(e):t(e)}function a(e){return 1===e.lineCount()&&""===e.getLine(0)}e.defineOption("placeholder","",function(i,a,s){var o=s&&s!=e.Init;if(a&&!o)i.on("blur",n),i.on("change",r),i.on("swapDoc",r),r(i);else if(!a&&o){i.off("blur",n),i.off("change",r),i.off("swapDoc",r),t(i);var l=i.getWrapperElement();l.className=l.className.replace(" CodeMirror-empty","")}a&&!i.hasFocus()&&n(i)})}("object"==typeof i&&"object"==typeof t?e("../../lib/codemirror"):CodeMirror)},{"../../lib/codemirror":10}],7:[function(e,t,i){!function(e){"use strict";var t=/^(\s*)(>[> ]*|[*+-]\s|(\d+)([.)]))(\s*)/,i=/^(\s*)(>[> ]*|[*+-]|(\d+)[.)])(\s*)$/,n=/[*+-]\s/;e.commands.newlineAndIndentContinueMarkdownList=function(r){if(r.getOption("disableInput"))return e.Pass;for(var a=r.listSelections(),s=[],o=0;o<a.length;o++){var l=a[o].head,u=r.getStateAfter(l.line),c=!1!==u.list,h=0!==u.quote,d=r.getLine(l.line),f=t.exec(d);if(!a[o].empty()||!c&&!h||!f)return void r.execCommand("newlineAndIndent");if(i.test(d))r.replaceRange("",{line:l.line,ch:0},{line:l.line,ch:l.ch+1}),s[o]="\n";else{var p=f[1],m=f[5],g=n.test(f[2])||f[2].indexOf(">")>=0?f[2]:parseInt(f[3],10)+1+f[4];s[o]="\n"+p+g+m}}r.replaceSelections(s)}}("object"==typeof i&&"object"==typeof t?e("../../lib/codemirror"):CodeMirror)},{"../../lib/codemirror":10}],8:[function(e,t,i){!function(e){"use strict";e.overlayMode=function(t,i,n){return{startState:function(){return{base:e.startState(t),overlay:e.startState(i),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(n){return{base:e.copyState(t,n.base),overlay:e.copyState(i,n.overlay),basePos:n.basePos,baseCur:null,overlayPos:n.overlayPos,overlayCur:null}},token:function(e,r){return(e!=r.streamSeen||Math.min(r.basePos,r.overlayPos)<e.start)&&(r.streamSeen=e,r.basePos=r.overlayPos=e.start),e.start==r.basePos&&(r.baseCur=t.token(e,r.base),r.basePos=e.pos),e.start==r.overlayPos&&(e.pos=e.start,r.overlayCur=i.token(e,r.overlay),r.overlayPos=e.pos),e.pos=Math.min(r.basePos,r.overlayPos),null==r.overlayCur?r.baseCur:null!=r.baseCur&&r.overlay.combineTokens||n&&null==r.overlay.combineTokens?r.baseCur+" "+r.overlayCur:r.overlayCur},indent:t.indent&&function(e,i){return t.indent(e.base,i)},electricChars:t.electricChars,innerMode:function(e){return{state:e.base,mode:t}},blankLine:function(e){t.blankLine&&t.blankLine(e.base),i.blankLine&&i.blankLine(e.overlay)}}}}("object"==typeof i&&"object"==typeof t?e("../../lib/codemirror"):CodeMirror)},{"../../lib/codemirror":10}],9:[function(e,t,i){!function(e){"use strict";function t(e){e.operation(function(){!function(e){if(!e.somethingSelected())return r(e);if(e.listSelections().length>1)return a(e);var t=e.getCursor("start"),i=e.getCursor("end"),o=e.state.markedSelection;if(!o.length)return n(e,t,i);var u=o[0].find(),c=o[o.length-1].find();if(!u||!c||i.line-t.line<s||l(t,c.to)>=0||l(i,u.from)<=0)return a(e);for(;l(t,u.from)>0;)o.shift().clear(),u=o[0].find();for(l(t,u.from)<0&&(u.to.line-t.line<s?(o.shift().clear(),n(e,t,u.to,0)):n(e,t,u.from,0));l(i,c.to)<0;)o.pop().clear(),c=o[o.length-1].find();l(i,c.to)>0&&(i.line-c.from.line<s?(o.pop().clear(),n(e,c.from,i)):n(e,c.to,i))}(e)})}function i(e){e.state.markedSelection.length&&e.operation(function(){r(e)})}function n(e,t,i,n){if(0!=l(t,i))for(var r=e.state.markedSelection,a=e.state.markedSelectionStyle,u=t.line;;){var c=u==t.line?t:o(u,0),h=u+s,d=h>=i.line,f=d?i:o(h,0),p=e.markText(c,f,{className:a});if(null==n?r.push(p):r.splice(n++,0,p),d)break;u=h}}function r(e){for(var t=e.state.markedSelection,i=0;i<t.length;++i)t[i].clear();t.length=0}function a(e){r(e);for(var t=e.listSelections(),i=0;i<t.length;i++)n(e,t[i].from(),t[i].to())}e.defineOption("styleSelectedText",!1,function(n,s,o){var l=o&&o!=e.Init;s&&!l?(n.state.markedSelection=[],n.state.markedSelectionStyle="string"==typeof s?s:"CodeMirror-selectedtext",a(n),n.on("cursorActivity",t),n.on("change",i)):!s&&l&&(n.off("cursorActivity",t),n.off("change",i),r(n),n.state.markedSelection=n.state.markedSelectionStyle=null)});var s=8,o=e.Pos,l=e.cmpPos}("object"==typeof i&&"object"==typeof t?e("../../lib/codemirror"):CodeMirror)},{"../../lib/codemirror":10}],10:[function(e,t,i){!function(e){"object"==typeof i&&"object"==typeof t?t.exports=e():(this||window).CodeMirror=e()}(function(){"use strict";function e(i,n){if(!(this instanceof e))return new e(i,n);this.options=n=n?Gn(n):{},Gn(na,n,!1),d(n);var r=n.value;"string"==typeof r&&(r=new Ea(r,n.mode,null,n.lineSeparator)),this.doc=r;var a=new e.inputStyles[n.inputStyle](this),o=this.display=new t(i,r,a);o.wrapper.CodeMirror=this,l(this),s(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),n.autofocus&&!Ir&&o.input.focus(),g(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new jn,keySeq:null,specialChars:null};var u=this;for(var c in Sr&&11>kr&&setTimeout(function(){u.display.input.reset(!0)},20),function(e){function t(){n.activeTouch&&(r=setTimeout(function(){n.activeTouch=null},1e3),(a=n.activeTouch).end=+new Date)}function i(e,t){if(null==t.left)return!0;var i=t.left-e.left,n=t.top-e.top;return i*i+n*n>400}var n=e.display;Ma(n.scroller,"mousedown",gt(e,Pt)),Ma(n.scroller,"dblclick",Sr&&11>kr?gt(e,function(t){if(!Un(e,t)){var i=At(e,t);if(i&&!It(e,t)&&!Lt(e.display,t)){Pa(t);var n=e.findWordAt(i);pe(e.doc,n.anchor,n.head)}}}):function(t){Un(e,t)||Pa(t)}),Br||Ma(n.scroller,"contextmenu",function(t){Gt(e,t)});var r,a={end:0};Ma(n.scroller,"touchstart",function(t){if(!Un(e,t)&&!function(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}(t)){clearTimeout(r);var i=+new Date;n.activeTouch={start:i,moved:!1,prev:i-a.end<=300?a:null},1==t.touches.length&&(n.activeTouch.left=t.touches[0].pageX,n.activeTouch.top=t.touches[0].pageY)}}),Ma(n.scroller,"touchmove",function(){n.activeTouch&&(n.activeTouch.moved=!0)}),Ma(n.scroller,"touchend",function(r){var a=n.activeTouch;if(a&&!Lt(n,r)&&null!=a.left&&!a.moved&&new Date-a.start<300){var s,o=e.coordsChar(n.activeTouch,"page");s=!a.prev||i(a,a.prev)?new se(o,o):!a.prev.prev||i(a,a.prev.prev)?e.findWordAt(o):new se(Hr(o.line,0),ce(e.doc,Hr(o.line+1,0))),e.setSelection(s.anchor,s.head),e.focus(),Pa(r)}t()}),Ma(n.scroller,"touchcancel",t),Ma(n.scroller,"scroll",function(){n.scroller.clientHeight&&(Ut(e,n.scroller.scrollTop),Rt(e,n.scroller.scrollLeft,!0),Ra(e,"scroll",e))}),Ma(n.scroller,"mousewheel",function(t){Nt(e,t)}),Ma(n.scroller,"DOMMouseScroll",function(t){Nt(e,t)}),Ma(n.wrapper,"scroll",function(){n.wrapper.scrollTop=n.wrapper.scrollLeft=0}),n.dragFunctions={enter:function(t){Un(e,t)||Ia(t)},over:function(t){Un(e,t)||(function(e,t){var i=At(e,t);if(i){var n=document.createDocumentFragment();Ae(e,i,n),e.display.dragCursor||(e.display.dragCursor=Qn("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),Zn(e.display.dragCursor,n)}}(e,t),Ia(t))},start:function(t){!function(e,t){if(Sr&&(!e.state.draggingText||+new Date-Kr<100))Ia(t);else if(!Un(e,t)&&!Lt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!Lr)){var i=Qn("img",null,null,"position: fixed; left: 0; top: 0;");i.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Er&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),t.dataTransfer.setDragImage(i,0,0),Er&&i.parentNode.removeChild(i)}}(e,t)},drop:gt(e,Mt),leave:function(t){Un(e,t)||Dt(e)}};var s=n.input.getField();Ma(s,"keyup",function(t){Wt.call(e,t)}),Ma(s,"keydown",gt(e,Ht)),Ma(s,"keypress",gt(e,zt)),Ma(s,"focus",$n(qt,e)),Ma(s,"blur",$n(Vt,e))}(this),function(){var e;is||(Ma(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,nr(Et)},100))}),Ma(window,"blur",function(){nr(Vt)}),is=!0)}(),lt(this),this.curOp.forceUpdate=!0,un(this,r),n.autofocus&&!Ir||u.hasFocus()?setTimeout($n(qt,this),20):Vt(this),ra)ra.hasOwnProperty(c)&&ra[c](this,n[c],aa);T(this),n.finishInit&&n.finishInit(this);for(var h=0;h<ua.length;++h)ua[h](this);ut(this),wr&&n.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}function t(e,t,i){var n=this;this.input=i,n.scrollbarFiller=Qn("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=Qn("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=Qn("div",null,"CodeMirror-code"),n.selectionDiv=Qn("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=Qn("div",null,"CodeMirror-cursors"),n.measure=Qn("div",null,"CodeMirror-measure"),n.lineMeasure=Qn("div",null,"CodeMirror-measure"),n.lineSpace=Qn("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none"),n.mover=Qn("div",[Qn("div",[n.lineSpace],"CodeMirror-lines")],null,"position: relative"),n.sizer=Qn("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=Qn("div",null,null,"position: absolute; height: "+Ba+"px; width: 1px;"),n.gutters=Qn("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=Qn("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=Qn("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),Sr&&8>kr&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),wr||br&&Ir||(n.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(n.wrapper):e(n.wrapper)),n.viewFrom=n.viewTo=t.first,n.reportedViewFrom=n.reportedViewTo=t.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,i.init(n)}function i(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),n(t)}function n(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,Ie(e,100),e.state.modeGen++,e.curOp&&Tt(e)}function r(e){var t=st(e.display),i=e.options.lineWrapping,n=i&&Math.max(5,e.display.scroller.clientWidth/ot(e.display)-3);return function(r){if(Ni(e.doc,r))return 0;var a=0;if(r.widgets)for(var s=0;s<r.widgets.length;s++)r.widgets[s].height&&(a+=r.widgets[s].height);return i?a+(Math.ceil(r.text.length/n)||1)*t:a+t}}function a(e){var t=e.doc,i=r(e);t.iter(function(e){var t=i(e);t!=e.height&&fn(e,t)})}function s(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Xe(e)}function o(e){l(e),Tt(e),setTimeout(function(){_(e)},20)}function l(e){var t=e.display.gutters,i=e.options.gutters;Jn(t);for(var n=0;n<i.length;++n){var r=i[n],a=t.appendChild(Qn("div",null,"CodeMirror-gutter "+r));"CodeMirror-linenumbers"==r&&(e.display.lineGutter=a,a.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=n?"":"none",u(e)}function u(e){e.display.sizer.style.marginLeft=e.display.gutters.offsetWidth+"px"}function c(e){if(0==e.height)return 0;for(var t,i=e.text.length,n=e;t=Oi(n);)n=(r=t.find(0,!0)).from.line,i+=r.from.ch-r.to.ch;for(n=e;t=Ii(n);){var r=t.find(0,!0);i-=n.text.length-r.from.ch,i+=(n=r.to.line).text.length-r.to.ch}return i}function h(e){var t=e.display,i=e.doc;t.maxLine=cn(i,i.first),t.maxLineLength=c(t.maxLine),t.maxLineChanged=!0,i.iter(function(e){var i=c(e);i>t.maxLineLength&&(t.maxLineLength=i,t.maxLine=e)})}function d(e){var t=Wn(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function f(e){var t=e.display,i=t.gutters.offsetWidth,n=Math.round(e.doc.height+Re(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:n,scrollHeight:n+Be(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function p(e,t,i){this.cm=i;var n=this.vert=Qn("div",[Qn("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=Qn("div",[Qn("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(n),e(r),Ma(n,"scroll",function(){n.clientHeight&&t(n.scrollTop,"vertical")}),Ma(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,Sr&&8>kr&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function m(){}function g(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&es(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),Ma(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,i){"horizontal"==i?Rt(t,e):Ut(t,e)},t),t.display.scrollbars.addClass&&ts(t.display.wrapper,t.display.scrollbars.addClass)}function v(e,t){t||(t=f(e));var i=e.display.barWidth,n=e.display.barHeight;y(e,t);for(var r=0;4>r&&i!=e.display.barWidth||n!=e.display.barHeight;r++)i!=e.display.barWidth&&e.options.lineWrapping&&A(e),y(e,f(e)),i=e.display.barWidth,n=e.display.barHeight}function y(e,t){var i=e.display,n=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=n.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=n.bottom)+"px",i.heightForcer.style.borderBottom=n.bottom+"px solid transparent",n.right&&n.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=n.bottom+"px",i.scrollbarFiller.style.width=n.right+"px"):i.scrollbarFiller.style.display="",n.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=n.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function b(e,t,i){var n=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop;n=Math.floor(n-Ue(e));var r=i&&null!=i.bottom?i.bottom:n+e.wrapper.clientHeight,a=mn(t,n),s=mn(t,r);if(i&&i.ensure){var o=i.ensure.from.line,l=i.ensure.to.line;a>o?(a=o,s=mn(t,gn(cn(t,o))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=s&&(a=mn(t,gn(cn(t,l))-e.wrapper.clientHeight),s=l)}return{from:a,to:Math.max(s,a+1)}}function _(e){var t=e.display,i=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var n=k(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,a=n+"px",s=0;s<i.length;s++)if(!i[s].hidden){e.options.fixedGutter&&i[s].gutter&&(i[s].gutter.style.left=a);var o=i[s].alignable;if(o)for(var l=0;l<o.length;l++)o[l].style.left=a}e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}}function T(e){if(!e.options.lineNumbers)return!1;var t=e.doc,i=S(e.options,t.first+t.size-1),n=e.display;if(i.length!=n.lineNumChars){var r=n.measure.appendChild(Qn("div",[Qn("div",i)],"CodeMirror-linenumber CodeMirror-gutter-elt")),a=r.firstChild.offsetWidth,s=r.offsetWidth-a;return n.lineGutter.style.width="",n.lineNumInnerWidth=Math.max(a,n.lineGutter.offsetWidth-s)+1,n.lineNumWidth=n.lineNumInnerWidth+s,n.lineNumChars=n.lineNumInnerWidth?i.length:-1,n.lineGutter.style.width=n.lineNumWidth+"px",u(e),!0}return!1}function S(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function k(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function w(e,t,i){var n=e.display;this.viewport=t,this.visible=b(n,e.doc,t),this.editorIsHidden=!n.wrapper.offsetWidth,this.wrapperHeight=n.wrapper.clientHeight,this.wrapperWidth=n.wrapper.clientWidth,this.oldDisplayWidth=je(e),this.force=i,this.dims=O(e),this.events=[]}function C(e,t){var i=e.display,n=e.doc;if(t.editorIsHidden)return kt(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==xt(e))return!1;T(e)&&(kt(e),t.dims=O(e));var r=n.first+n.size,a=Math.max(t.visible.from-e.options.viewportMargin,n.first),s=Math.min(r,t.visible.to+e.options.viewportMargin);i.viewFrom<a&&a-i.viewFrom<20&&(a=Math.max(n.first,i.viewFrom)),i.viewTo>s&&i.viewTo-s<20&&(s=Math.min(r,i.viewTo)),Fr&&(a=Ui(e.doc,a),s=Ri(e.doc,s));var o=a!=i.viewFrom||s!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth;(function(e,t,i){var n=e.display;0==n.view.length||t>=n.viewTo||i<=n.viewFrom?(n.view=_t(e,t,i),n.viewFrom=t):(n.viewFrom>t?n.view=_t(e,t,n.viewFrom).concat(n.view):n.viewFrom<t&&(n.view=n.view.slice(wt(e,t))),n.viewFrom=t,n.viewTo<i?n.view=n.view.concat(_t(e,n.viewTo,i)):n.viewTo>i&&(n.view=n.view.slice(0,wt(e,i)))),n.viewTo=i})(e,a,s),i.viewOffset=gn(cn(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px";var l=xt(e);if(!o&&0==l&&!t.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo))return!1;var u=er();return l>4&&(i.lineDiv.style.display="none"),function(e,t,i){function n(t){var i=t.nextSibling;return wr&&Mr&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var r=e.display,a=e.options.lineNumbers,s=r.lineDiv,o=s.firstChild,l=r.view,u=r.viewFrom,c=0;c<l.length;c++){var h=l[c];if(h.hidden);else if(h.node&&h.node.parentNode==s){for(;o!=h.node;)o=n(o);var d=a&&null!=t&&u>=t&&h.lineNumber;h.changes&&(Wn(h.changes,"gutter")>-1&&(d=!1),I(e,h,u,i)),d&&(Jn(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(S(e.options,u)))),o=h.node.nextSibling}else{var f=j(e,h,u,i);s.insertBefore(f,o)}u+=h.size}for(;o;)o=n(o)}(e,i.updateLineNumbers,t.dims),l>4&&(i.lineDiv.style.display=""),i.renderedView=i.view,u&&er()!=u&&u.offsetHeight&&u.focus(),Jn(i.cursorDiv),Jn(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,o&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,Ie(e,400)),i.updateLineNumbers=null,!0}function x(e,t){for(var i=t.viewport,n=!0;(n&&e.options.lineWrapping&&t.oldDisplayWidth!=je(e)||(i&&null!=i.top&&(i={top:Math.min(e.doc.height+Re(e.display)-Fe(e),i.top)}),t.visible=b(e.display,e.doc,i),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&C(e,t);n=!1){A(e);var r=f(e);Ee(e),v(e,r),L(e,r)}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function E(e,t){var i=new w(e,t);if(C(e,i)){A(e),x(e,i);var n=f(e);Ee(e),v(e,n),L(e,n),i.finish()}}function L(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Be(e)+"px"}function A(e){for(var t=e.display,i=t.lineDiv.offsetTop,n=0;n<t.view.length;n++){var r,a=t.view[n];if(!a.hidden){if(Sr&&8>kr){var s=a.node.offsetTop+a.node.offsetHeight;r=s-i,i=s}else{var o=a.node.getBoundingClientRect();r=o.bottom-o.top}var l=a.line.height-r;if(2>r&&(r=st(t)),(l>.001||-.001>l)&&(fn(a.line,r),P(a.line),a.rest))for(var u=0;u<a.rest.length;u++)P(a.rest[u])}}}function P(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function O(e){for(var t=e.display,i={},n={},r=t.gutters.clientLeft,a=t.gutters.firstChild,s=0;a;a=a.nextSibling,++s)i[e.options.gutters[s]]=a.offsetLeft+a.clientLeft+r,n[e.options.gutters[s]]=a.clientWidth;return{fixedPos:k(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:n,wrapperWidth:t.wrapper.clientWidth}}function I(e,t,i,n){for(var r=0;r<t.changes.length;r++){var a=t.changes[r];"text"==a?U(e,t):"gutter"==a?N(e,t,i,n):"class"==a?R(t):"widget"==a&&B(e,t,n)}t.changes=null}function M(e){return e.node==e.text&&(e.node=Qn("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),Sr&&8>kr&&(e.node.style.zIndex=2)),e.node}function D(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):Qi(e,t)}function U(e,t){var i=t.text.className,n=D(e,t);t.text==t.node&&(t.node=n.pre),t.text.parentNode.replaceChild(n.pre,t.text),t.text=n.pre,n.bgClass!=t.bgClass||n.textClass!=t.textClass?(t.bgClass=n.bgClass,t.textClass=n.textClass,R(t)):i&&(t.text.className=i)}function R(e){(function(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var i=M(e);e.background=i.insertBefore(Qn("div",null,t),i.firstChild)}})(e),e.line.wrapClass?M(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className=""),e.text.className=(e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass)||""}function N(e,t,i,n){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var r=M(t);t.gutterBackground=Qn("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px; width: "+n.gutterTotalWidth+"px"),r.insertBefore(t.gutterBackground,t.text)}var a=t.line.gutterMarkers;if(e.options.lineNumbers||a){r=M(t);var s=t.gutter=Qn("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?n.fixedPos:-n.gutterTotalWidth)+"px");if(e.display.input.setUneditable(s),r.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||a&&a["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(Qn("div",S(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+n.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),a)for(var o=0;o<e.options.gutters.length;++o){var l=e.options.gutters[o],u=a.hasOwnProperty(l)&&a[l];u&&s.appendChild(Qn("div",[u],"CodeMirror-gutter-elt","left: "+n.gutterLeft[l]+"px; width: "+n.gutterWidth[l]+"px"))}}}function B(e,t,i){t.alignable&&(t.alignable=null);for(var n=t.node.firstChild;n;n=r){var r=n.nextSibling;"CodeMirror-linewidget"==n.className&&t.node.removeChild(n)}F(e,t,i)}function j(e,t,i,n){var r=D(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),R(t),N(e,t,i,n),F(e,t,n),t.node}function F(e,t,i){if(H(e,t.line,t,i,!0),t.rest)for(var n=0;n<t.rest.length;n++)H(e,t.rest[n],t,i,!1)}function H(e,t,i,n,r){if(t.widgets)for(var a=M(i),s=0,o=t.widgets;s<o.length;++s){var l=o[s],u=Qn("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||u.setAttribute("cm-ignore-events","true"),W(l,u,i,n),e.display.input.setUneditable(u),r&&l.above?a.insertBefore(u,i.gutter||i.text):a.appendChild(u),Mn(l,"redraw")}}function W(e,t,i,n){if(e.noHScroll){(i.alignable||(i.alignable=[])).push(t);var r=n.wrapperWidth;t.style.left=n.fixedPos+"px",e.coverGutter||(r-=n.gutterTotalWidth,t.style.paddingLeft=n.gutterTotalWidth+"px"),t.style.width=r+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-n.gutterTotalWidth+"px"))}function z(e){return Hr(e.line,e.ch)}function q(e,t){return Wr(e,t)<0?t:e}function V(e,t){return Wr(e,t)<0?e:t}function G(e){e.state.focused||(e.display.input.focus(),qt(e))}function $(e,t,i,n,r){var a=e.doc;e.display.shift=!1,n||(n=a.sel);var s=e.state.pasteIncoming||"paste"==r,o=a.splitLines(t),l=null;if(s&&n.ranges.length>1)if(zr&&zr.text.join("\n")==t){if(n.ranges.length%zr.text.length==0){l=[];for(var u=0;u<zr.text.length;u++)l.push(a.splitLines(zr.text[u]))}}else o.length==n.ranges.length&&(l=zn(o,function(e){return[e]}));for(u=n.ranges.length-1;u>=0;u--){var c=n.ranges[u],h=c.from(),d=c.to();c.empty()&&(i&&i>0?h=Hr(h.line,h.ch-i):e.state.overwrite&&!s?d=Hr(d.line,Math.min(cn(a,d.line).text.length,d.ch+Hn(o).length)):zr&&zr.lineWise&&zr.text.join("\n")==t&&(h=d=Hr(h.line,0)));var f=e.curOp.updateInput,p={from:h,to:d,text:l?l[u%l.length]:o,origin:r||(s?"paste":e.state.cutIncoming?"cut":"+input")};Qt(e.doc,p),Mn(e,"inputRead",e,p)}t&&!s&&X(e,t),si(e),e.curOp.updateInput=f,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function Y(e,t){var i=e.clipboardData&&e.clipboardData.getData("text/plain");return i?(e.preventDefault(),t.isReadOnly()||t.options.disableInput||mt(t,function(){$(t,i,0,null,"paste")}),!0):void 0}function X(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var i=e.doc.sel,n=i.ranges.length-1;n>=0;n--){var r=i.ranges[n];if(!(r.head.ch>100||n&&i.ranges[n-1].head.line==r.head.line)){var a=e.getModeAt(r.head),s=!1;if(a.electricChars){for(var o=0;o<a.electricChars.length;o++)if(t.indexOf(a.electricChars.charAt(o))>-1){s=li(e,r.head.line,"smart");break}}else a.electricInput&&a.electricInput.test(cn(e.doc,r.head.line).text.slice(0,r.head.ch))&&(s=li(e,r.head.line,"smart"));s&&Mn(e,"electricInput",e,r.head.line)}}}function K(e){for(var t=[],i=[],n=0;n<e.doc.sel.ranges.length;n++){var r=e.doc.sel.ranges[n].head.line,a={anchor:Hr(r,0),head:Hr(r+1,0)};i.push(a),t.push(e.getRange(a.anchor,a.head))}return{text:t,ranges:i}}function Q(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function J(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new jn,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function Z(){var e=Qn("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=Qn("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return wr?e.style.width="1000px":e.setAttribute("wrap","off"),Or&&(e.style.border="1px solid black"),Q(e),t}function ee(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new jn,this.gracePeriod=!1}function te(e,t){var i=ze(e,t.line);if(!i||i.hidden)return null;var n=cn(e.doc,t.line),r=He(i,n,t.line),a=vn(n),s="left";a&&(s=fr(a,t.ch)%2?"right":"left");var o=Ge(r.map,t.ch,s);return o.offset="right"==o.collapse?o.end:o.start,o}function ie(e,t){return t&&(e.bad=!0),e}function ne(e,t,i){var n;if(t==e.display.lineDiv){if(!(n=e.display.lineDiv.childNodes[i]))return ie(e.clipPos(Hr(e.display.viewTo-1)),!0);t=null,i=0}else for(n=t;;n=n.parentNode){if(!n||n==e.display.lineDiv)return null;if(n.parentNode&&n.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var a=e.display.view[r];if(a.node==n)return re(a,t,i)}}function re(e,t,i){function n(t,i,n){for(var r=-1;r<(c?c.length:0);r++)for(var a=0>r?u.map:c[r],s=0;s<a.length;s+=3){var o=a[s+2];if(o==t||o==i){var l=pn(0>r?e.line:e.rest[r]),h=a[s]+n;return(0>n||o!=t)&&(h=a[s+(n?1:0)]),Hr(l,h)}}}var r=e.text.firstChild,a=!1;if(!t||!Qa(r,t))return ie(Hr(pn(e.line),0),!0);if(t==r&&(a=!0,t=r.childNodes[i],i=0,!t)){var s=e.rest?Hn(e.rest):e.line;return ie(Hr(pn(s),s.text.length),a)}var o=3==t.nodeType?t:null,l=t;for(o||1!=t.childNodes.length||3!=t.firstChild.nodeType||(o=t.firstChild,i&&(i=o.nodeValue.length));l.parentNode!=r;)l=l.parentNode;var u=e.measure,c=u.maps,h=n(o,l,i);if(h)return ie(h,a);for(var d=l.nextSibling,f=o?o.nodeValue.length-i:0;d;d=d.nextSibling){if(h=n(d,d.firstChild,0))return ie(Hr(h.line,h.ch-f),a);f+=d.textContent.length}var p=l.previousSibling;for(f=i;p;p=p.previousSibling){if(h=n(p,p.firstChild,-1))return ie(Hr(h.line,h.ch+f),a);f+=d.textContent.length}}function ae(e,t){this.ranges=e,this.primIndex=t}function se(e,t){this.anchor=e,this.head=t}function oe(e,t){var i=e[t];e.sort(function(e,t){return Wr(e.from(),t.from())}),t=Wn(e,i);for(var n=1;n<e.length;n++){var r=e[n],a=e[n-1];if(Wr(a.to(),r.from())>=0){var s=V(a.from(),r.from()),o=q(a.to(),r.to()),l=a.empty()?r.from()==r.head:a.from()==a.head;t>=n&&--t,e.splice(--n,2,new se(l?o:s,l?s:o))}}return new ae(e,t)}function le(e,t){return new ae([new se(e,t||e)],0)}function ue(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function ce(e,t){if(t.line<e.first)return Hr(e.first,0);var i=e.first+e.size-1;return t.line>i?Hr(i,cn(e,i).text.length):function(e,t){var i=e.ch;return null==i||i>t?Hr(e.line,t):0>i?Hr(e.line,0):e}(t,cn(e,t.line).text.length)}function he(e,t){return t>=e.first&&t<e.first+e.size}function de(e,t){for(var i=[],n=0;n<t.length;n++)i[n]=ce(e,t[n]);return i}function fe(e,t,i,n){if(e.cm&&e.cm.display.shift||e.extend){var r=t.anchor;if(n){var a=Wr(i,r)<0;a!=Wr(n,r)<0?(r=i,i=n):a!=Wr(i,n)<0&&(i=n)}return new se(r,i)}return new se(n||i,i)}function pe(e,t,i,n){be(e,new ae([fe(e,e.sel.primary(),t,i)],0),n)}function me(e,t,i){for(var n=[],r=0;r<e.sel.ranges.length;r++)n[r]=fe(e,e.sel.ranges[r],t[r],null);be(e,oe(n,e.sel.primIndex),i)}function ge(e,t,i,n){var r=e.sel.ranges.slice(0);r[t]=i,be(e,oe(r,e.sel.primIndex),n)}function ve(e,t,i,n){be(e,le(t,i),n)}function ye(e,t,i){var n=e.history.done,r=Hn(n);r&&r.ranges?(n[n.length-1]=t,_e(e,t,i)):be(e,t,i)}function be(e,t,i){_e(e,t,i),function(e,t,i,n){var r=e.history,a=n&&n.origin;i==r.lastSelOp||a&&r.lastSelOrigin==a&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==a||function(e,t,i,n){var r=t.charAt(0);return"*"==r||"+"==r&&i.ranges.length==n.ranges.length&&i.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}(e,a,Hn(r.done),t))?r.done[r.done.length-1]=t:Sn(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=a,r.lastSelOp=i,n&&!1!==n.clearRedo&&_n(r.undone)}(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function _e(e,t,i){(Nn(e,"beforeSelectionChange")||e.cm&&Nn(e.cm,"beforeSelectionChange"))&&(t=function(e,t,i){var n={ranges:t.ranges,update:function(t){this.ranges=[];for(var i=0;i<t.length;i++)this.ranges[i]=new se(ce(e,t[i].anchor),ce(e,t[i].head))},origin:i&&i.origin};return Ra(e,"beforeSelectionChange",e,n),e.cm&&Ra(e.cm,"beforeSelectionChange",e.cm,n),n.ranges!=t.ranges?oe(n.ranges,n.ranges.length-1):t}(e,t,i));var n=i&&i.bias||(Wr(t.primary().head,e.sel.primary().head)<0?-1:1);Te(e,ke(e,t,n,!0)),i&&!1===i.scroll||!e.cm||si(e.cm)}function Te(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Rn(e.cm)),Mn(e,"cursorActivity",e))}function Se(e){Te(e,ke(e,e.sel,null,!1))}function ke(e,t,i,n){for(var r,a=0;a<t.ranges.length;a++){var s=t.ranges[a],o=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[a],l=Ce(e,s.anchor,o&&o.anchor,i,n),u=Ce(e,s.head,o&&o.head,i,n);(r||l!=s.anchor||u!=s.head)&&(r||(r=t.ranges.slice(0,a)),r[a]=new se(l,u))}return r?oe(r,t.primIndex):t}function we(e,t,i,n,r){var a=cn(e,t.line);if(a.markedSpans)for(var s=0;s<a.markedSpans.length;++s){var o=a.markedSpans[s],l=o.marker;if((null==o.from||(l.inclusiveLeft?o.from<=t.ch:o.from<t.ch))&&(null==o.to||(l.inclusiveRight?o.to>=t.ch:o.to>t.ch))){if(r&&(Ra(l,"beforeCursorEnter"),l.explicitlyCleared)){if(a.markedSpans){--s;continue}break}if(!l.atomic)continue;if(i){var u,c=l.find(0>n?1:-1);if((0>n?l.inclusiveRight:l.inclusiveLeft)&&(c=xe(e,c,-n,c&&c.line==t.line?a:null)),c&&c.line==t.line&&(u=Wr(c,i))&&(0>n?0>u:u>0))return we(e,c,t,n,r)}var h=l.find(0>n?-1:1);return(0>n?l.inclusiveLeft:l.inclusiveRight)&&(h=xe(e,h,n,h.line==t.line?a:null)),h?we(e,h,t,n,r):null}}return t}function Ce(e,t,i,n,r){var a=n||1;return we(e,t,i,a,r)||!r&&we(e,t,i,a,!0)||we(e,t,i,-a,r)||!r&&we(e,t,i,-a,!0)||(e.cantEdit=!0,Hr(e.first,0))}function xe(e,t,i,n){return 0>i&&0==t.ch?t.line>e.first?ce(e,Hr(t.line-1)):null:i>0&&t.ch==(n||cn(e,t.line)).text.length?t.line<e.first+e.size-1?Hr(t.line+1,0):null:new Hr(t.line,t.ch+i)}function Ee(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Le(e,t){for(var i=e.doc,n={},r=n.cursors=document.createDocumentFragment(),a=n.selection=document.createDocumentFragment(),s=0;s<i.sel.ranges.length;s++)if(!1!==t||s!=i.sel.primIndex){var o=i.sel.ranges[s];if(!(o.from().line>=e.display.viewTo||o.to().line<e.display.viewFrom)){var l=o.empty();(l||e.options.showCursorWhenSelecting)&&Ae(e,o.head,r),l||Pe(e,o,a)}}return n}function Ae(e,t,i){var n=tt(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),r=i.appendChild(Qn("div","\xa0","CodeMirror-cursor"));if(r.style.left=n.left+"px",r.style.top=n.top+"px",r.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",n.other){var a=i.appendChild(Qn("div","\xa0","CodeMirror-cursor CodeMirror-secondarycursor"));a.style.display="",a.style.left=n.other.left+"px",a.style.top=n.other.top+"px",a.style.height=.85*(n.other.bottom-n.other.top)+"px"}}function Pe(e,t,i){function n(e,t,i,n){0>t&&(t=0),t=Math.round(t),n=Math.round(n),o.appendChild(Qn("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==i?c-e:i)+"px; height: "+(n-t)+"px"))}function r(t,i,r){function a(i,n){return et(e,Hr(t,i),"div",h,n)}var o,l,h=cn(s,t),d=h.text.length;return function(e,t,i,n){if(!e)return n(t,i,"ltr");for(var r=!1,a=0;a<e.length;++a){var s=e[a];(s.from<i&&s.to>t||t==i&&s.to==t)&&(n(Math.max(s.from,t),Math.min(s.to,i),1==s.level?"rtl":"ltr"),r=!0)}r||n(t,i,"ltr")}(vn(h),i||0,null==r?d:r,function(e,t,s){var h,f,p,m=a(e,"left");if(e==t)h=m,f=p=m.left;else{if(h=a(t-1,"right"),"rtl"==s){var g=m;m=h,h=g}f=m.left,p=h.right}null==i&&0==e&&(f=u),h.top-m.top>3&&(n(f,m.top,null,m.bottom),f=u,m.bottom<h.top&&n(f,m.bottom,null,h.top)),null==r&&t==d&&(p=c),(!o||m.top<o.top||m.top==o.top&&m.left<o.left)&&(o=m),(!l||h.bottom>l.bottom||h.bottom==l.bottom&&h.right>l.right)&&(l=h),u+1>f&&(f=u),n(f,h.top,p-f,h.bottom)}),{start:o,end:l}}var a=e.display,s=e.doc,o=document.createDocumentFragment(),l=Ne(e.display),u=l.left,c=Math.max(a.sizerWidth,je(e)-a.sizer.offsetLeft)-l.right,h=t.from(),d=t.to();if(h.line==d.line)r(h.line,h.ch,d.ch);else{var f=cn(s,h.line),p=cn(s,d.line),m=Di(f)==Di(p),g=r(h.line,h.ch,m?f.text.length+1:null).end,v=r(d.line,m?0:null,d.ch).start;m&&(g.top<v.top-2?(n(g.right,g.top,null,g.bottom),n(u,v.top,v.left,v.bottom)):n(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&n(u,g.bottom,null,v.top)}i.appendChild(o)}function Oe(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var i=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function Ie(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,$n(Me,e))}function Me(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var i=+new Date+e.options.workTime,n=ha(t.mode,De(e,t.frontier)),r=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(a){if(t.frontier>=e.display.viewFrom){var s=a.styles,o=a.text.length>e.options.maxHighlightLength,l=$i(e,a,o?ha(t.mode,n):n,!0);a.styles=l.styles;var u=a.styleClasses,c=l.classes;c?a.styleClasses=c:u&&(a.styleClasses=null);for(var h=!s||s.length!=a.styles.length||u!=c&&(!u||!c||u.bgClass!=c.bgClass||u.textClass!=c.textClass),d=0;!h&&d<s.length;++d)h=s[d]!=a.styles[d];h&&r.push(t.frontier),a.stateAfter=o?n:ha(t.mode,n)}else a.text.length<=e.options.maxHighlightLength&&Xi(e,a.text,n),a.stateAfter=t.frontier%5==0?ha(t.mode,n):null;return++t.frontier,+new Date>i?(Ie(e,e.options.workDelay),!0):void 0}),r.length&&mt(e,function(){for(var t=0;t<r.length;t++)St(e,r[t],"text")})}}function De(e,t,i){var n=e.doc,r=e.display;if(!n.mode.startState)return!0;var a=function(e,t,i){for(var n,r,a=e.doc,s=i?-1:t-(e.doc.mode.innerMode?1e3:100),o=t;o>s;--o){if(o<=a.first)return a.first;var l=cn(a,o-1);if(l.stateAfter&&(!i||o<=a.frontier))return o;var u=za(l.text,null,e.options.tabSize);(null==r||n>u)&&(r=o-1,n=u)}return r}(e,t,i),s=a>n.first&&cn(n,a-1).stateAfter;return s=s?ha(n.mode,s):da(n.mode),n.iter(a,t,function(i){Xi(e,i.text,s),i.stateAfter=a==t-1||a%5==0||a>=r.viewFrom&&a<r.viewTo?ha(n.mode,s):null,++a}),i&&(n.frontier=a),s}function Ue(e){return e.lineSpace.offsetTop}function Re(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function Ne(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=Zn(e.measure,Qn("pre","x")),i=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,n={left:parseInt(i.paddingLeft),right:parseInt(i.paddingRight)};return isNaN(n.left)||isNaN(n.right)||(e.cachedPaddingH=n),n}function Be(e){return Ba-e.display.nativeBarWidth}function je(e){return e.display.scroller.clientWidth-Be(e)-e.display.barWidth}function Fe(e){return e.display.scroller.clientHeight-Be(e)-e.display.barHeight}function He(e,t,i){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var n=0;n<e.rest.length;n++)if(e.rest[n]==t)return{map:e.measure.maps[n],cache:e.measure.caches[n]};for(n=0;n<e.rest.length;n++)if(pn(e.rest[n])>i)return{map:e.measure.maps[n],cache:e.measure.caches[n],before:!0}}function We(e,t,i,n){return Ve(e,qe(e,t),i,n)}function ze(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[wt(e,t)];var i=e.display.externalMeasured;return i&&t>=i.lineN&&t<i.lineN+i.size?i:void 0}function qe(e,t){var i=pn(t),n=ze(e,i);n&&!n.text?n=null:n&&n.changes&&(I(e,n,i,O(e)),e.curOp.forceUpdate=!0),n||(n=function(e,t){var i=pn(t=Di(t)),n=e.display.externalMeasured=new bt(e.doc,t,i);n.lineN=i;var r=n.built=Qi(e,n);return n.text=r.pre,Zn(e.display.lineMeasure,r.pre),n}(e,t));var r=He(n,t,i);return{line:t,view:n,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function Ve(e,t,i,n,r){t.before&&(i=-1);var a,s=i+(n||"");return t.cache.hasOwnProperty(s)?a=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(function(e,t,i){var n=e.options.lineWrapping,r=n&&je(e);if(!t.measure.heights||n&&t.measure.width!=r){var a=t.measure.heights=[];if(n){t.measure.width=r;for(var s=t.text.firstChild.getClientRects(),o=0;o<s.length-1;o++){var l=s[o],u=s[o+1];Math.abs(l.bottom-u.bottom)>2&&a.push((l.bottom+u.top)/2-i.top)}}a.push(i.bottom-i.top)}}(e,t.view,t.rect),t.hasHeights=!0),(a=function(e,t,i,n){var r,a=Ge(t.map,i,n),s=a.node,o=a.start,l=a.end,u=a.collapse;if(3==s.nodeType){for(var c=0;4>c;c++){for(;o&&Kn(t.line.text.charAt(a.coverStart+o));)--o;for(;a.coverStart+l<a.coverEnd&&Kn(t.line.text.charAt(a.coverStart+l));)++l;if(Sr&&9>kr&&0==o&&l==a.coverEnd-a.coverStart)r=s.parentNode.getBoundingClientRect();else if(Sr&&e.options.lineWrapping){var h=$a(s,o,l).getClientRects();r=h.length?h["right"==n?h.length-1:0]:$r}else r=$a(s,o,l).getBoundingClientRect()||$r;if(r.left||r.right||0==o)break;l=o,o-=1,u="right"}Sr&&11>kr&&(r=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=os)return os;var t=Zn(e,Qn("span","x")),i=t.getBoundingClientRect(),n=$a(t,0,1).getBoundingClientRect();return os=Math.abs(i.left-n.left)>1}(e))return t;var i=screen.logicalXDPI/screen.deviceXDPI,n=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*n,bottom:t.bottom*n}}(e.display.measure,r))}else o>0&&(u=n="right"),r=e.options.lineWrapping&&(h=s.getClientRects()).length>1?h["right"==n?h.length-1:0]:s.getBoundingClientRect();if(Sr&&9>kr&&!o&&(!r||!r.left&&!r.right)){var d=s.parentNode.getClientRects()[0];r=d?{left:d.left,right:d.left+ot(e.display),top:d.top,bottom:d.bottom}:$r}var f=r.top-t.rect.top,p=r.bottom-t.rect.top,m=(f+p)/2,g=t.view.measure.heights;for(c=0;c<g.length-1&&!(m<g[c]);c++);var v={left:("right"==u?r.right:r.left)-t.rect.left,right:("left"==u?r.left:r.right)-t.rect.left,top:c?g[c-1]:0,bottom:g[c]};return r.left||r.right||(v.bogus=!0),e.options.singleCursorHeightPerLine||(v.rtop=f,v.rbottom=p),v}(e,t,i,n)).bogus||(t.cache[s]=a)),{left:a.left,right:a.right,top:r?a.rtop:a.top,bottom:r?a.rbottom:a.bottom}}function Ge(e,t,i){for(var n,r,a,s,o=0;o<e.length;o+=3){var l=e[o],u=e[o+1];if(l>t?(r=0,a=1,s="left"):u>t?a=1+(r=t-l):(o==e.length-3||t==u&&e[o+3]>t)&&(r=(a=u-l)-1,t>=u&&(s="right")),null!=r){if(n=e[o+2],l==u&&i==(n.insertLeft?"left":"right")&&(s=i),"left"==i&&0==r)for(;o&&e[o-2]==e[o-3]&&e[o-1].insertLeft;)n=e[2+(o-=3)],s="left";if("right"==i&&r==u-l)for(;o<e.length-3&&e[o+3]==e[o+4]&&!e[o+5].insertLeft;)n=e[(o+=3)+2],s="right";break}}return{node:n,start:r,end:a,collapse:s,coverStart:l,coverEnd:u}}function $e(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function Ye(e){e.display.externalMeasure=null,Jn(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)$e(e.display.view[t])}function Xe(e){Ye(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Ke(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Qe(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function Je(e,t,i,n){if(t.widgets)for(var r=0;r<t.widgets.length;++r)if(t.widgets[r].above){var a=Fi(t.widgets[r]);i.top+=a,i.bottom+=a}if("line"==n)return i;n||(n="local");var s=gn(t);if("local"==n?s+=Ue(e.display):s-=e.display.viewOffset,"page"==n||"window"==n){var o=e.display.lineSpace.getBoundingClientRect();s+=o.top+("window"==n?0:Qe());var l=o.left+("window"==n?0:Ke());i.left+=l,i.right+=l}return i.top+=s,i.bottom+=s,i}function Ze(e,t,i){if("div"==i)return t;var n=t.left,r=t.top;if("page"==i)n-=Ke(),r-=Qe();else if("local"==i||!i){var a=e.display.sizer.getBoundingClientRect();n+=a.left,r+=a.top}var s=e.display.lineSpace.getBoundingClientRect();return{left:n-s.left,top:r-s.top}}function et(e,t,i,n,r){return n||(n=cn(e.doc,t.line)),Je(e,n,We(e,n,t.ch,r),i)}function tt(e,t,i,n,r,a){function s(t,s){var o=Ve(e,r,t,s?"right":"left",a);return s?o.left=o.right:o.right=o.left,Je(e,n,o,i)}function o(e,t){var i=l[t],n=i.level%2;return e==sr(i)&&t&&i.level<l[t-1].level?(e=or(i=l[--t])-(i.level%2?0:1),n=!0):e==or(i)&&t<l.length-1&&i.level<l[t+1].level&&(e=sr(i=l[++t])-i.level%2,n=!1),n&&e==i.to&&e>i.from?s(e-1):s(e,n)}n=n||cn(e.doc,t.line),r||(r=qe(e,n));var l=vn(n),u=t.ch;if(!l)return s(u);var c=o(u,fr(l,u));return null!=us&&(c.other=o(u,us)),c}function it(e,t){var i=0;t=ce(e.doc,t),e.options.lineWrapping||(i=ot(e.display)*t.ch);var n=cn(e.doc,t.line),r=gn(n)+Ue(e.display);return{left:i,right:i,top:r,bottom:r+n.height}}function nt(e,t,i,n){var r=Hr(e,t);return r.xRel=n,i&&(r.outside=!0),r}function rt(e,t,i){var n=e.doc;if(0>(i+=e.display.viewOffset))return nt(n.first,0,!0,-1);var r=mn(n,i),a=n.first+n.size-1;if(r>a)return nt(n.first+n.size-1,cn(n,a).text.length,!0,1);0>t&&(t=0);for(var s=cn(n,r);;){var o=at(e,s,r,t,i),l=Ii(s),u=l&&l.find(0,!0);if(!l||!(o.ch>u.from.ch||o.ch==u.from.ch&&o.xRel>0))return o;r=pn(s=u.to.line)}}function at(e,t,i,n,r){function a(n){var r=tt(e,Hr(i,n),"line",t,u);return o=!0,s>r.bottom?r.left-l:s<r.top?r.left+l:(o=!1,r.left)}var s=r-gn(t),o=!1,l=2*e.display.wrapper.clientWidth,u=qe(e,t),c=vn(t),h=t.text.length,d=lr(t),f=ur(t),p=a(d),m=o,g=a(f),v=o;if(n>g)return nt(i,f,v,1);for(;;){if(c?f==d||f==mr(t,d,1):1>=f-d){for(var y=p>n||g-n>=n-p?d:f,b=n-(y==d?p:g);Kn(t.text.charAt(y));)++y;return nt(i,y,y==d?m:v,-1>b?-1:b>1?1:0)}var _=Math.ceil(h/2),T=d+_;if(c){T=d;for(var S=0;_>S;++S)T=mr(t,T,1)}var k=a(T);k>n?(f=T,g=k,(v=o)&&(g+=1e3),h=_):(d=T,p=k,m=o,h-=_)}}function st(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==qr){qr=Qn("pre");for(var t=0;49>t;++t)qr.appendChild(document.createTextNode("x")),qr.appendChild(Qn("br"));qr.appendChild(document.createTextNode("x"))}Zn(e.measure,qr);var i=qr.offsetHeight/50;return i>3&&(e.cachedTextHeight=i),Jn(e.measure),i||1}function ot(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=Qn("span","xxxxxxxxxx"),i=Qn("pre",[t]);Zn(e.measure,i);var n=t.getBoundingClientRect(),r=(n.right-n.left)/10;return r>2&&(e.cachedCharWidth=r),r||10}function lt(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Xr},Yr?Yr.ops.push(e.curOp):e.curOp.ownsGroup=Yr={ops:[e.curOp],delayedCallbacks:[]}}function ut(e){var t=e.curOp.ownsGroup;if(t)try{!function(e){var t=e.delayedCallbacks,i=0;do{for(;i<t.length;i++)t[i].call(null);for(var n=0;n<e.ops.length;n++){var r=e.ops[n];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(i<t.length)}(t)}finally{Yr=null;for(var i=0;i<t.ops.length;i++)t.ops[i].cm.curOp=null;!function(e){for(var t=e.ops,i=0;i<t.length;i++)ct(t[i]);for(i=0;i<t.length;i++)ht(t[i]);for(i=0;i<t.length;i++)dt(t[i]);for(i=0;i<t.length;i++)ft(t[i]);for(i=0;i<t.length;i++)pt(t[i])}(t)}}function ct(e){var t=e.cm,i=t.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Be(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Be(e)+"px",t.scrollbarsClipped=!0)})(t),e.updateMaxLine&&h(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<i.viewFrom||e.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new w(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function ht(e){e.updatedDisplay=e.mustUpdate&&C(e.cm,e.update)}function dt(e){var t=e.cm,i=t.display;e.updatedDisplay&&A(t),e.barMeasure=f(t),i.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=We(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+e.adjustWidthTo+Be(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+e.adjustWidthTo-je(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=i.input.prepareSelection(e.focus))}function ft(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Rt(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var i=e.focus&&e.focus==er()&&(!document.hasFocus||document.hasFocus());e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,i),(e.updatedDisplay||e.startHeight!=t.doc.height)&&v(t,e.barMeasure),e.updatedDisplay&&L(t,e.barMeasure),e.selectionChanged&&Oe(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),i&&G(e.cm)}function pt(e){var t=e.cm,i=t.display,n=t.doc;if(e.updatedDisplay&&x(t,e.update),null==i.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(i.wheelStartX=i.wheelStartY=null),null==e.scrollTop||i.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(n.scrollTop=Math.max(0,Math.min(i.scroller.scrollHeight-i.scroller.clientHeight,e.scrollTop)),i.scrollbars.setScrollTop(n.scrollTop),i.scroller.scrollTop=n.scrollTop),null==e.scrollLeft||i.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(n.scrollLeft=Math.max(0,Math.min(i.scroller.scrollWidth-i.scroller.clientWidth,e.scrollLeft)),i.scrollbars.setScrollLeft(n.scrollLeft),i.scroller.scrollLeft=n.scrollLeft,_(t)),e.scrollToPos){var r=function(e,t,i,n){null==n&&(n=0);for(var r=0;5>r;r++){var a=!1,s=tt(e,t),o=i&&i!=t?tt(e,i):s,l=ri(e,Math.min(s.left,o.left),Math.min(s.top,o.top)-n,Math.max(s.left,o.left),Math.max(s.bottom,o.bottom)+n),u=e.doc.scrollTop,c=e.doc.scrollLeft;if(null!=l.scrollTop&&(Ut(e,l.scrollTop),Math.abs(e.doc.scrollTop-u)>1&&(a=!0)),null!=l.scrollLeft&&(Rt(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-c)>1&&(a=!0)),!a)break}return s}(t,ce(n,e.scrollToPos.from),ce(n,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&function(e,t){if(!Un(e,"scrollCursorIntoView")){var i=e.display,n=i.sizer.getBoundingClientRect(),r=null;if(t.top+n.top<0?r=!0:t.bottom+n.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null!=r&&!Pr){var a=Qn("div","\u200b",null,"position: absolute; top: "+(t.top-i.viewOffset-Ue(e.display))+"px; height: "+(t.bottom-t.top+Be(e)+i.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(a),a.scrollIntoView(r),e.display.lineSpace.removeChild(a)}}}(t,r)}var a=e.maybeHiddenMarkers,s=e.maybeUnhiddenMarkers;if(a)for(var o=0;o<a.length;++o)a[o].lines.length||Ra(a[o],"hide");if(s)for(o=0;o<s.length;++o)s[o].lines.length&&Ra(s[o],"unhide");i.wrapper.offsetHeight&&(n.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ra(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function mt(e,t){if(e.curOp)return t();lt(e);try{return t()}finally{ut(e)}}function gt(e,t){return function(){if(e.curOp)return t.apply(e,arguments);lt(e);try{return t.apply(e,arguments)}finally{ut(e)}}}function vt(e){return function(){if(this.curOp)return e.apply(this,arguments);lt(this);try{return e.apply(this,arguments)}finally{ut(this)}}}function yt(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);lt(t);try{return e.apply(this,arguments)}finally{ut(t)}}}function bt(e,t,i){this.line=t,this.rest=function(e){for(var t,i;t=Ii(e);)e=t.find(1,!0).line,(i||(i=[])).push(e);return i}(t),this.size=this.rest?pn(Hn(this.rest))-i+1:1,this.node=this.text=null,this.hidden=Ni(e,t)}function _t(e,t,i){for(var n,r=[],a=t;i>a;a=n){var s=new bt(e.doc,cn(e.doc,a),a);n=a+s.size,r.push(s)}return r}function Tt(e,t,i,n){null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),n||(n=0);var r=e.display;if(n&&i<r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>t)&&(r.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=r.viewTo)Fr&&Ui(e.doc,t)<r.viewTo&&kt(e);else if(i<=r.viewFrom)Fr&&Ri(e.doc,i+n)>r.viewFrom?kt(e):(r.viewFrom+=n,r.viewTo+=n);else if(t<=r.viewFrom&&i>=r.viewTo)kt(e);else if(t<=r.viewFrom)(a=Ct(e,i,i+n,1))?(r.view=r.view.slice(a.index),r.viewFrom=a.lineN,r.viewTo+=n):kt(e);else if(i>=r.viewTo){var a;(a=Ct(e,t,t,-1))?(r.view=r.view.slice(0,a.index),r.viewTo=a.lineN):kt(e)}else{var s=Ct(e,t,t,-1),o=Ct(e,i,i+n,1);s&&o?(r.view=r.view.slice(0,s.index).concat(_t(e,s.lineN,o.lineN)).concat(r.view.slice(o.index)),r.viewTo+=n):kt(e)}var l=r.externalMeasured;l&&(i<l.lineN?l.lineN+=n:t<l.lineN+l.size&&(r.externalMeasured=null))}function St(e,t,i){e.curOp.viewChanged=!0;var n=e.display,r=e.display.externalMeasured;if(r&&t>=r.lineN&&t<r.lineN+r.size&&(n.externalMeasured=null),!(t<n.viewFrom||t>=n.viewTo)){var a=n.view[wt(e,t)];if(null!=a.node){var s=a.changes||(a.changes=[]);-1==Wn(s,i)&&s.push(i)}}}function kt(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function wt(e,t){if(t>=e.display.viewTo)return null;if(0>(t-=e.display.viewFrom))return null;for(var i=e.display.view,n=0;n<i.length;n++)if(0>(t-=i[n].size))return n}function Ct(e,t,i,n){var r,a=wt(e,t),s=e.display.view;if(!Fr||i==e.doc.first+e.doc.size)return{index:a,lineN:i};for(var o=0,l=e.display.viewFrom;a>o;o++)l+=s[o].size;if(l!=t){if(n>0){if(a==s.length-1)return null;r=l+s[a].size-t,a++}else r=l-t;t+=r,i+=r}for(;Ui(e.doc,i)!=i;){if(a==(0>n?0:s.length-1))return null;i+=n*s[a-(0>n?1:0)].size,a+=n}return{index:a,lineN:i}}function xt(e){for(var t=e.display.view,i=0,n=0;n<t.length;n++){var r=t[n];r.hidden||r.node&&!r.changes||++i}return i}function Et(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function Lt(e,t){for(var i=Pn(t);i!=e.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==e.sizer&&i!=e.mover)return!0}function At(e,t,i,n){var r=e.display;if(!i&&"true"==Pn(t).getAttribute("cm-not-content"))return null;var a,s,o=r.lineSpace.getBoundingClientRect();try{a=t.clientX-o.left,s=t.clientY-o.top}catch(t){return null}var l,u=rt(e,a,s);if(n&&1==u.xRel&&(l=cn(e.doc,u.line).text).length==u.ch){var c=za(l,l.length,e.options.tabSize)-l.length;u=Hr(u.line,Math.max(0,Math.round((a-Ne(e.display).left)/ot(e.display))-c))}return u}function Pt(e){var t=this,i=t.display;if(!(Un(t,e)||i.activeTouch&&i.input.supportsTouch())){if(i.shift=e.shiftKey,Lt(i,e))return void(wr||(i.scroller.draggable=!1,setTimeout(function(){i.scroller.draggable=!0},100)));if(!It(t,e)){var n=At(t,e);switch(window.focus(),On(e)){case 1:t.state.selectingText?t.state.selectingText(e):n?function(e,t,i){Sr?setTimeout($n(G,e),0):e.curOp.focus=er();var n,r=+new Date;Gr&&Gr.time>r-400&&0==Wr(Gr.pos,i)?n="triple":Vr&&Vr.time>r-400&&0==Wr(Vr.pos,i)?(n="double",Gr={time:r,pos:i}):(n="single",Vr={time:r,pos:i});var a,s=e.doc.sel,o=Mr?t.metaKey:t.ctrlKey;e.options.dragDrop&&ns&&!e.isReadOnly()&&"single"==n&&(a=s.contains(i))>-1&&(Wr((a=s.ranges[a]).from(),i)<0||i.xRel>0)&&(Wr(a.to(),i)>0||i.xRel<0)?function(e,t,i,n){var r=e.display,a=+new Date,s=gt(e,function(o){wr&&(r.scroller.draggable=!1),e.state.draggingText=!1,Ua(document,"mouseup",s),Ua(r.scroller,"drop",s),Math.abs(t.clientX-o.clientX)+Math.abs(t.clientY-o.clientY)<10&&(Pa(o),!n&&+new Date-200<a&&pe(e.doc,i),wr||Sr&&9==kr?setTimeout(function(){document.body.focus(),r.input.focus()},20):r.input.focus())});wr&&(r.scroller.draggable=!0),e.state.draggingText=s,r.scroller.dragDrop&&r.scroller.dragDrop(),Ma(document,"mouseup",s),Ma(r.scroller,"drop",s)}(e,t,i,o):function(e,t,i,n,r){function a(t){if(0!=Wr(g,t))if(g=t,"rect"==n){for(var r=[],a=e.options.tabSize,s=za(cn(u,i.line).text,i.ch,a),o=za(cn(u,t.line).text,t.ch,a),l=Math.min(s,o),f=Math.max(s,o),p=Math.min(i.line,t.line),m=Math.min(e.lastLine(),Math.max(i.line,t.line));m>=p;p++){var v=cn(u,p).text,y=qa(v,l,a);l==f?r.push(new se(Hr(p,y),Hr(p,y))):v.length>y&&r.push(new se(Hr(p,y),Hr(p,qa(v,f,a))))}r.length||r.push(new se(i,i)),be(u,oe(d.ranges.slice(0,h).concat(r),h),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var b=c,_=b.anchor,T=t;if("single"!=n){if("double"==n)var S=e.findWordAt(t);else S=new se(Hr(t.line,0),ce(u,Hr(t.line+1,0)));Wr(S.anchor,_)>0?(T=S.head,_=V(b.from(),S.anchor)):(T=S.anchor,_=q(b.to(),S.head))}(r=d.ranges.slice(0))[h]=new se(ce(u,_),T),be(u,oe(r,h),Ha)}}function s(t){var i=++y,r=At(e,t,!0,"rect"==n);if(r)if(0!=Wr(r,g)){e.curOp.focus=er(),a(r);var o=b(l,u);(r.line>=o.to||r.line<o.from)&&setTimeout(gt(e,function(){y==i&&s(t)}),150)}else{var c=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;c&&setTimeout(gt(e,function(){y==i&&(l.scroller.scrollTop+=c,s(t))}),50)}}function o(t){e.state.selectingText=!1,y=1/0,Pa(t),l.input.focus(),Ua(document,"mousemove",_),Ua(document,"mouseup",T),u.history.lastSelOrigin=null}var l=e.display,u=e.doc;Pa(t);var c,h,d=u.sel,f=d.ranges;if(r&&!t.shiftKey?(h=u.sel.contains(i),c=h>-1?f[h]:new se(i,i)):(c=u.sel.primary(),h=u.sel.primIndex),Dr?t.shiftKey&&t.metaKey:t.altKey)n="rect",r||(c=new se(i,i)),i=At(e,t,!0,!0),h=-1;else if("double"==n){var p=e.findWordAt(i);c=e.display.shift||u.extend?fe(u,c,p.anchor,p.head):p}else if("triple"==n){var m=new se(Hr(i.line,0),ce(u,Hr(i.line+1,0)));c=e.display.shift||u.extend?fe(u,c,m.anchor,m.head):m}else c=fe(u,c,i);r?-1==h?(h=f.length,be(u,oe(f.concat([c]),h),{scroll:!1,origin:"*mouse"})):f.length>1&&f[h].empty()&&"single"==n&&!t.shiftKey?(be(u,oe(f.slice(0,h).concat(f.slice(h+1)),0),{scroll:!1,origin:"*mouse"}),d=u.sel):ge(u,h,c,Ha):(h=0,be(u,new ae([c],0),Ha),d=u.sel);var g=i,v=l.wrapper.getBoundingClientRect(),y=0,_=gt(e,function(e){On(e)?s(e):o(e)}),T=gt(e,o);e.state.selectingText=T,Ma(document,"mousemove",_),Ma(document,"mouseup",T)}(e,t,i,n,o)}(t,e,n):Pn(e)==i.scroller&&Pa(e);break;case 2:wr&&(t.state.lastMiddleDown=+new Date),n&&pe(t.doc,n),setTimeout(function(){i.input.focus()},20),Pa(e);break;case 3:Br?Gt(t,e):function(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,Vt(e))},100)}(t)}}}}function Ot(e,t,i,n){try{var r=t.clientX,a=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;n&&Pa(t);var s=e.display,o=s.lineDiv.getBoundingClientRect();if(a>o.bottom||!Nn(e,i))return An(t);a-=o.top-s.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var u=s.gutters.childNodes[l];if(u&&u.getBoundingClientRect().right>=r){var c=mn(e.doc,a);return Ra(e,i,e,c,e.options.gutters[l],t),An(t)}}}function It(e,t){return Ot(e,t,"gutterClick",!0)}function Mt(e){var t=this;if(Dt(t),!Un(t,e)&&!Lt(t.display,e)){Pa(e),Sr&&(Kr=+new Date);var i=At(t,e,!0),n=e.dataTransfer.files;if(i&&!t.isReadOnly())if(n&&n.length&&window.FileReader&&window.File)for(var r=n.length,a=Array(r),s=0,o=function(e,n){if(!t.options.allowDropFileTypes||-1!=Wn(t.options.allowDropFileTypes,e.type)){var o=new FileReader;o.onload=gt(t,function(){var e=o.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),a[n]=e,++s==r){var l={from:i=ce(t.doc,i),to:i,text:t.doc.splitLines(a.join(t.doc.lineSeparator())),origin:"paste"};Qt(t.doc,l),ye(t.doc,le(i,ia(l)))}}),o.readAsText(e)}},l=0;r>l;++l)o(n[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{if(a=e.dataTransfer.getData("Text")){if(t.state.draggingText&&!(Mr?e.altKey:e.ctrlKey))var u=t.listSelections();if(_e(t.doc,le(i,i)),u)for(l=0;l<u.length;++l)ni(t.doc,"",u[l].anchor,u[l].head,"drag");t.replaceSelection(a,"around","paste"),t.display.input.focus()}}catch(e){}}}}function Dt(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Ut(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,br||E(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),br&&E(e),Ie(e,100))}function Rt(e,t,i){(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,_(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Nt(e,t){var i=Zr(t),n=i.x,r=i.y,a=e.display,s=a.scroller,o=s.scrollHeight>s.clientHeight;if(n&&s.scrollWidth>s.clientWidth||r&&o){if(r&&Mr&&wr)e:for(var l=t.target,u=a.view;l!=s;l=l.parentNode)for(var c=0;c<u.length;c++)if(u[c].node==l){e.display.currentWheelTarget=l;break e}if(n&&!br&&!Er&&null!=Jr)return r&&o&&Ut(e,Math.max(0,Math.min(s.scrollTop+r*Jr,s.scrollHeight-s.clientHeight))),Rt(e,Math.max(0,Math.min(s.scrollLeft+n*Jr,s.scrollWidth-s.clientWidth))),(!r||r&&o)&&Pa(t),void(a.wheelStartX=null);if(r&&null!=Jr){var h=r*Jr,d=e.doc.scrollTop,f=d+a.wrapper.clientHeight;0>h?d=Math.max(0,d+h-50):f=Math.min(e.doc.height,f+h+50),E(e,{top:d,bottom:f})}20>Qr&&(null==a.wheelStartX?(a.wheelStartX=s.scrollLeft,a.wheelStartY=s.scrollTop,a.wheelDX=n,a.wheelDY=r,setTimeout(function(){if(null!=a.wheelStartX){var e=s.scrollLeft-a.wheelStartX,t=s.scrollTop-a.wheelStartY,i=t&&a.wheelDY&&t/a.wheelDY||e&&a.wheelDX&&e/a.wheelDX;a.wheelStartX=a.wheelStartY=null,i&&(Jr=(Jr*Qr+i)/(Qr+1),++Qr)}},200)):(a.wheelDX+=n,a.wheelDY+=r))}}function Bt(e,t,i){if("string"==typeof t&&!(t=fa[t]))return!1;e.display.input.ensurePolled();var n=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),r=t(e)!=ja}finally{e.display.shift=n,e.state.suppressEdits=!1}return r}function jt(e,t,i,n){var r=e.state.keySeq;if(r){if(ga(t))return"handled";ea.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),t=r+" "+t}var a=function(e,t,i){for(var n=0;n<e.state.keyMaps.length;n++){var r=ma(t,e.state.keyMaps[n],i,e);if(r)return r}return e.options.extraKeys&&ma(t,e.options.extraKeys,i,e)||ma(t,e.options.keyMap,i,e)}(e,t,n);return"multi"==a&&(e.state.keySeq=t),"handled"==a&&Mn(e,"keyHandled",e,t,i),"handled"!=a&&"multi"!=a||(Pa(i),Oe(e)),r&&!a&&/\'$/.test(t)?(Pa(i),!0):!!a}function Ft(e,t){var i=va(t,!0);return!!i&&(t.shiftKey&&!e.state.keySeq?jt(e,"Shift-"+i,t,function(t){return Bt(e,t,!0)})||jt(e,i,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?Bt(e,t):void 0}):jt(e,i,t,function(t){return Bt(e,t)}))}function Ht(e){var t=this;if(t.curOp.focus=er(),!Un(t,e)){Sr&&11>kr&&27==e.keyCode&&(e.returnValue=!1);var i=e.keyCode;t.display.shift=16==i||e.shiftKey;var n=Ft(t,e);Er&&(ta=n?i:null,!n&&88==i&&!ss&&(Mr?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=i||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||function(e){function t(e){18!=e.keyCode&&e.altKey||(es(i,"CodeMirror-crosshair"),Ua(document,"keyup",t),Ua(document,"mouseover",t))}var i=e.display.lineDiv;ts(i,"CodeMirror-crosshair"),Ma(document,"keyup",t),Ma(document,"mouseover",t)}(t)}}function Wt(e){16==e.keyCode&&(this.doc.sel.shift=!1),Un(this,e)}function zt(e){var t=this;if(!(Lt(t.display,e)||Un(t,e)||e.ctrlKey&&!e.altKey||Mr&&e.metaKey)){var i=e.keyCode,n=e.charCode;if(Er&&i==ta)return ta=null,void Pa(e);Er&&(!e.which||e.which<10)&&Ft(t,e)||function(e,t,i){return jt(e,"'"+i+"'",t,function(t){return Bt(e,t,!0)})}(t,e,String.fromCharCode(null==n?i:n))||t.display.input.onKeyPress(e)}}function qt(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Ra(e,"focus",e),e.state.focused=!0,ts(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),wr&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Oe(e))}function Vt(e){e.state.delayingBlurEvent||(e.state.focused&&(Ra(e,"blur",e),e.state.focused=!1,es(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function Gt(e,t){Lt(e.display,t)||function(e,t){return!!Nn(e,"gutterContextMenu")&&Ot(e,t,"gutterContextMenu",!1)}(e,t)||Un(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function $t(e,t){if(Wr(e,t.from)<0)return e;if(Wr(e,t.to)<=0)return ia(t);var i=e.line+t.text.length-(t.to.line-t.from.line)-1,n=e.ch;return e.line==t.to.line&&(n+=ia(t).ch-t.to.ch),Hr(i,n)}function Yt(e,t){for(var i=[],n=0;n<e.sel.ranges.length;n++){var r=e.sel.ranges[n];i.push(new se($t(r.anchor,t),$t(r.head,t)))}return oe(i,e.sel.primIndex)}function Xt(e,t,i){return e.line==t.line?Hr(i.line,e.ch-t.ch+i.ch):Hr(i.line+(e.line-t.line),e.ch)}function Kt(e,t,i){var n={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return i&&(n.update=function(t,i,n,r){t&&(this.from=ce(e,t)),i&&(this.to=ce(e,i)),n&&(this.text=n),void 0!==r&&(this.origin=r)}),Ra(e,"beforeChange",e,n),e.cm&&Ra(e.cm,"beforeChange",e.cm,n),n.canceled?null:{from:n.from,to:n.to,text:n.text,origin:n.origin}}function Qt(e,t,i){if(e.cm){if(!e.cm.curOp)return gt(e.cm,Qt)(e,t,i);if(e.cm.state.suppressEdits)return}if(!(Nn(e,"beforeChange")||e.cm&&Nn(e.cm,"beforeChange"))||(t=Kt(e,t,!0))){var n=jr&&!i&&function(e,t,i){var n=null;if(e.iter(t.line,i.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var i=e.markedSpans[t].marker;!i.readOnly||n&&-1!=Wn(n,i)||(n||(n=[])).push(i)}}),!n)return null;for(var r=[{from:t,to:i}],a=0;a<n.length;++a)for(var s=n[a],o=s.find(0),l=0;l<r.length;++l){var u=r[l];if(!(Wr(u.to,o.from)<0||Wr(u.from,o.to)>0)){var c=[l,1],h=Wr(u.from,o.from),d=Wr(u.to,o.to);(0>h||!s.inclusiveLeft&&!h)&&c.push({from:u.from,to:o.from}),(d>0||!s.inclusiveRight&&!d)&&c.push({from:o.to,to:u.to}),r.splice.apply(r,c),l+=c.length-1}}return r}(e,t.from,t.to);if(n)for(var r=n.length-1;r>=0;--r)Jt(e,{from:n[r].from,to:n[r].to,text:r?[""]:t.text});else Jt(e,t)}}function Jt(e,t){if(1!=t.text.length||""!=t.text[0]||0!=Wr(t.from,t.to)){var i=Yt(e,t);Tn(e,t,i,e.cm?e.cm.curOp.id:NaN),ti(e,t,i,Si(e,t));var n=[];ln(e,function(e,i){i||-1!=Wn(n,e.history)||(Ln(e.history,t),n.push(e.history)),ti(e,t,null,Si(e,t))})}}function Zt(e,t,i){if(!e.cm||!e.cm.state.suppressEdits){for(var n,r=e.history,a=e.sel,s="undo"==t?r.done:r.undone,o="undo"==t?r.undone:r.done,l=0;l<s.length&&(n=s[l],i?!n.ranges||n.equals(e.sel):n.ranges);l++);if(l!=s.length){for(r.lastOrigin=r.lastSelOrigin=null;(n=s.pop()).ranges;){if(Sn(n,o),i&&!n.equals(e.sel))return void be(e,n,{clearRedo:!1});a=n}var u=[];Sn(a,o),o.push({changes:u,generation:r.generation}),r.generation=n.generation||++r.maxGeneration;var c=Nn(e,"beforeChange")||e.cm&&Nn(e.cm,"beforeChange");for(l=n.changes.length-1;l>=0;--l){var h=n.changes[l];if(h.origin=t,c&&!Kt(e,h,!1))return void(s.length=0);u.push(bn(e,h));var d=l?Yt(e,h):Hn(s);ti(e,h,d,wi(e,h)),!l&&e.cm&&e.cm.scrollIntoView({from:h.from,to:ia(h)});var f=[];ln(e,function(e,t){t||-1!=Wn(f,e.history)||(Ln(e.history,h),f.push(e.history)),ti(e,h,null,wi(e,h))})}}}}function ei(e,t){if(0!=t&&(e.first+=t,e.sel=new ae(zn(e.sel.ranges,function(e){return new se(Hr(e.anchor.line+t,e.anchor.ch),Hr(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Tt(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,n=i.viewFrom;n<i.viewTo;n++)St(e.cm,n,"gutter")}}function ti(e,t,i,n){if(e.cm&&!e.cm.curOp)return gt(e.cm,ti)(e,t,i,n);if(t.to.line<e.first)ei(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var r=t.text.length-1-(e.first-t.from.line);ei(e,r),t={from:Hr(e.first,0),to:Hr(t.to.line+r,t.to.ch),text:[Hn(t.text)],origin:t.origin}}var a=e.lastLine();t.to.line>a&&(t={from:t.from,to:Hr(a,cn(e,a).text.length),text:[t.text[0]],origin:t.origin}),t.removed=hn(e,t.from,t.to),i||(i=Yt(e,t)),e.cm?ii(e.cm,t,n):an(e,t,n),_e(e,i,Fa)}}function ii(e,t,i){var n=e.doc,a=e.display,s=t.from,o=t.to,l=!1,u=s.line;e.options.lineWrapping||(u=pn(Di(cn(n,s.line))),n.iter(u,o.line+1,function(e){return e==a.maxLine?(l=!0,!0):void 0})),n.sel.contains(t.from,t.to)>-1&&Rn(e),an(n,t,i,r(e)),e.options.lineWrapping||(n.iter(u,s.line+t.text.length,function(e){var t=c(e);t>a.maxLineLength&&(a.maxLine=e,a.maxLineLength=t,a.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),n.frontier=Math.min(n.frontier,s.line),Ie(e,400);var h=t.text.length-(o.line-s.line)-1;t.full?Tt(e):s.line!=o.line||1!=t.text.length||rn(e.doc,t)?Tt(e,s.line,o.line+1,h):St(e,s.line,"text");var d=Nn(e,"changes"),f=Nn(e,"change");if(f||d){var p={from:s,to:o,text:t.text,removed:t.removed,origin:t.origin};f&&Mn(e,"change",e,p),d&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(p)}e.display.selForContextMenu=null}function ni(e,t,i,n,r){if(n||(n=i),Wr(n,i)<0){var a=n;n=i,i=a}"string"==typeof t&&(t=e.splitLines(t)),Qt(e,{from:i,to:n,text:t,origin:r})}function ri(e,t,i,n,r){var a=e.display,s=st(e.display);0>i&&(i=0);var o=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:a.scroller.scrollTop,l=Fe(e),u={};r-i>l&&(r=i+l);var c=e.doc.height+Re(a),h=r>c-s;if(o>i)u.scrollTop=s>i?0:i;else if(r>o+l){var d=Math.min(i,(h?c:r)-l);d!=o&&(u.scrollTop=d)}var f=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:a.scroller.scrollLeft,p=je(e)-(e.options.fixedGutter?a.gutters.offsetWidth:0),m=n-t>p;return m&&(n=t+p),10>t?u.scrollLeft=0:f>t?u.scrollLeft=Math.max(0,t-(m?0:10)):n>p+f-3&&(u.scrollLeft=n+(m?0:10)-p),u}function ai(e,t,i){null==t&&null==i||oi(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=i&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+i)}function si(e){oi(e);var t=e.getCursor(),i=t,n=t;e.options.lineWrapping||(i=t.ch?Hr(t.line,t.ch-1):t,n=Hr(t.line,t.ch+1)),e.curOp.scrollToPos={from:i,to:n,margin:e.options.cursorScrollMargin,isCursor:!0}}function oi(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var i=it(e,t.from),n=it(e,t.to),r=ri(e,Math.min(i.left,n.left),Math.min(i.top,n.top)-t.margin,Math.max(i.right,n.right),Math.max(i.bottom,n.bottom)+t.margin);e.scrollTo(r.scrollLeft,r.scrollTop)}}function li(e,t,i,n){var r,a=e.doc;null==i&&(i="add"),"smart"==i&&(a.mode.indent?r=De(e,t):i="prev");var s=e.options.tabSize,o=cn(a,t),l=za(o.text,null,s);o.stateAfter&&(o.stateAfter=null);var u,c=o.text.match(/^\s*/)[0];if(n||/\S/.test(o.text)){if("smart"==i&&((u=a.mode.indent(r,o.text.slice(c.length),o.text))==ja||u>150)){if(!n)return;i="prev"}}else u=0,i="not";"prev"==i?u=t>a.first?za(cn(a,t-1).text,null,s):0:"add"==i?u=l+e.options.indentUnit:"subtract"==i?u=l-e.options.indentUnit:"number"==typeof i&&(u=l+i),u=Math.max(0,u);var h="",d=0;if(e.options.indentWithTabs)for(var f=Math.floor(u/s);f;--f)d+=s,h+="\t";if(u>d&&(h+=Fn(u-d)),h!=c)return ni(a,h,Hr(t,0),Hr(t,c.length),"+input"),o.stateAfter=null,!0;for(f=0;f<a.sel.ranges.length;f++){var p=a.sel.ranges[f];if(p.head.line==t&&p.head.ch<c.length){ge(a,f,new se(d=Hr(t,c.length),d));break}}}function ui(e,t,i,n){var r=t,a=t;return"number"==typeof t?a=cn(e,ue(e,t)):r=pn(t),null==r?null:(n(a,r)&&e.cm&&St(e.cm,r,i),a)}function ci(e,t){for(var i=e.doc.sel.ranges,n=[],r=0;r<i.length;r++){for(var a=t(i[r]);n.length&&Wr(a.from,Hn(n).to)<=0;){var s=n.pop();if(Wr(s.from,a.from)<0){a.from=s.from;break}}n.push(a)}mt(e,function(){for(var t=n.length-1;t>=0;t--)ni(e.doc,"",n[t].from,n[t].to,"+delete");si(e)})}function hi(e,t,i,n,r){function a(){var t=o+i;return!(t<e.first||t>=e.first+e.size)&&(o=t,c=cn(e,t))}function s(e){var t=(r?mr:gr)(c,l,i,!0);if(null==t){if(e||!a())return!1;l=r?(0>i?ur:lr)(c):0>i?c.text.length:0}else l=t;return!0}var o=t.line,l=t.ch,u=i,c=cn(e,o);if("char"==n)s();else if("column"==n)s(!0);else if("word"==n||"group"==n)for(var h=null,d="group"==n,f=e.cm&&e.cm.getHelper(t,"wordChars"),p=!0;!(0>i)||s(!p);p=!1){var m=c.text.charAt(l)||"\n",g=Yn(m,f)?"w":d&&"\n"==m?"n":!d||/\s/.test(m)?null:"p";if(!d||p||g||(g="s"),h&&h!=g){0>i&&(i=1,s());break}if(g&&(h=g),i>0&&!s(!p))break}var v=Ce(e,Hr(o,l),t,u,!0);return Wr(t,v)||(v.hitSide=!0),v}function di(e,t,i,n){var r,a=e.doc,s=t.left;if("page"==n){var o=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);r=t.top+i*(o-(0>i?1.5:.5)*st(e.display))}else"line"==n&&(r=i>0?t.bottom+3:t.top-3);for(;;){var l=rt(e,s,r);if(!l.outside)break;if(0>i?0>=r:r>=a.height){l.hitSide=!0;break}r+=5*i}return l}function fi(t,i,n,r){e.defaults[t]=i,n&&(ra[t]=r?function(e,t,i){i!=aa&&n(e,t,i)}:n)}function pi(e){for(var t,i,n,r,a=e.split(/-(?!$)/),s=(e=a[a.length-1],0);s<a.length-1;s++){var o=a[s];if(/^(cmd|meta|m)$/i.test(o))r=!0;else if(/^a(lt)?$/i.test(o))t=!0;else if(/^(c|ctrl|control)$/i.test(o))i=!0;else{if(!/^s(hift)$/i.test(o))throw new Error("Unrecognized modifier name: "+o);n=!0}}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),n&&(e="Shift-"+e),e}function mi(e){return"string"==typeof e?pa[e]:e}function gi(e,t,i,n,r){if(n&&n.shared)return function(e,t,i,n,r){(n=Gn(n)).shared=!1;var a=[gi(e,t,i,n,r)],s=a[0],o=n.widgetNode;return ln(e,function(e){o&&(n.widgetNode=o.cloneNode(!0)),a.push(gi(e,ce(e,t),ce(e,i),n,r));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;s=Hn(a)}),new Ta(a,s)}(e,t,i,n,r);if(e.cm&&!e.cm.curOp)return gt(e.cm,gi)(e,t,i,n,r);var a=new _a(e,r),s=Wr(t,i);if(n&&Gn(n,a,!1),s>0||0==s&&!1!==a.clearWhenEmpty)return a;if(a.replacedWith&&(a.collapsed=!0,a.widgetNode=Qn("span",[a.replacedWith],"CodeMirror-widget"),n.handleMouseEvents||a.widgetNode.setAttribute("cm-ignore-events","true"),n.insertLeft&&(a.widgetNode.insertLeft=!0)),a.collapsed){if(Mi(e,t.line,t,i,a)||t.line!=i.line&&Mi(e,i.line,t,i,a))throw new Error("Inserting collapsed marker partially overlapping an existing one");Fr=!0}a.addToHistory&&Tn(e,{from:t,to:i,origin:"markText"},e.sel,NaN);var o,l=t.line,u=e.cm;if(e.iter(l,i.line+1,function(e){u&&a.collapsed&&!u.options.lineWrapping&&Di(e)==u.display.maxLine&&(o=!0),a.collapsed&&l!=t.line&&fn(e,0),function(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}(e,new bi(a,l==t.line?t.ch:null,l==i.line?i.ch:null)),++l}),a.collapsed&&e.iter(t.line,i.line+1,function(t){Ni(e,t)&&fn(t,0)}),a.clearOnEnter&&Ma(a,"beforeCursorEnter",function(){a.clear()}),a.readOnly&&(jr=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),a.collapsed&&(a.id=++ba,a.atomic=!0),u){if(o&&(u.curOp.updateMaxLine=!0),a.collapsed)Tt(u,t.line,i.line+1);else if(a.className||a.title||a.startStyle||a.endStyle||a.css)for(var c=t.line;c<=i.line;c++)St(u,c,"text");a.atomic&&Se(u.doc),Mn(u,"markerAdded",u,a)}return a}function vi(e){return e.findMarks(Hr(e.first,0),e.clipPos(Hr(e.lastLine())),function(e){return e.parent})}function yi(e){for(var t=0;t<e.length;t++){var i=e[t],n=[i.primary.doc];ln(i.primary.doc,function(e){n.push(e)});for(var r=0;r<i.markers.length;r++){var a=i.markers[r];-1==Wn(n,a.doc)&&(a.parent=null,i.markers.splice(r--,1))}}}function bi(e,t,i){this.marker=e,this.from=t,this.to=i}function _i(e,t){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(n.marker==t)return n}}function Ti(e,t){for(var i,n=0;n<e.length;++n)e[n]!=t&&(i||(i=[])).push(e[n]);return i}function Si(e,t){if(t.full)return null;var i=he(e,t.from.line)&&cn(e,t.from.line).markedSpans,n=he(e,t.to.line)&&cn(e,t.to.line).markedSpans;if(!i&&!n)return null;var r=t.from.ch,a=t.to.ch,s=0==Wr(t.from,t.to),o=function(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var a=e[r],s=a.marker;null!=a.from&&!(s.inclusiveLeft?a.from<=t:a.from<t)&&(a.from!=t||"bookmark"!=s.type||i&&a.marker.insertLeft)||(n||(n=[])).push(new bi(s,a.from,null==a.to||(s.inclusiveRight?a.to>=t:a.to>t)?null:a.to))}return n}(i,r,s),l=function(e,t,i){if(e)for(var n,r=0;r<e.length;++r){var a=e[r],s=a.marker;(null==a.to||(s.inclusiveRight?a.to>=t:a.to>t)||a.from==t&&"bookmark"==s.type&&(!i||a.marker.insertLeft))&&(n||(n=[])).push(new bi(s,null==a.from||(s.inclusiveLeft?a.from<=t:a.from<t)?null:a.from-t,null==a.to?null:a.to-t))}return n}(n,a,s),u=1==t.text.length,c=Hn(t.text).length+(u?r:0);if(o)for(var h=0;h<o.length;++h)null==(d=o[h]).to&&((f=_i(l,d.marker))?u&&(d.to=null==f.to?null:f.to+c):d.to=r);if(l)for(h=0;h<l.length;++h){var d,f;null!=(d=l[h]).to&&(d.to+=c),null==d.from?(f=_i(o,d.marker))||(d.from=c,u&&(o||(o=[])).push(d)):(d.from+=c,u&&(o||(o=[])).push(d))}o&&(o=ki(o)),l&&l!=o&&(l=ki(l));var p=[o];if(!u){var m,g=t.text.length-2;if(g>0&&o)for(h=0;h<o.length;++h)null==o[h].to&&(m||(m=[])).push(new bi(o[h].marker,null,null));for(h=0;g>h;++h)p.push(m);p.push(l)}return p}function ki(e){for(var t=0;t<e.length;++t){var i=e[t];null!=i.from&&i.from==i.to&&!1!==i.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function wi(e,t){var i=function(e,t){var i=t["spans_"+e.id];if(!i)return null;for(var n=0,r=[];n<t.text.length;++n)r.push(wn(i[n]));return r}(e,t),n=Si(e,t);if(!i)return n;if(!n)return i;for(var r=0;r<i.length;++r){var a=i[r],s=n[r];if(a&&s)e:for(var o=0;o<s.length;++o){for(var l=s[o],u=0;u<a.length;++u)if(a[u].marker==l.marker)continue e;a.push(l)}else s&&(i[r]=s)}return i}function Ci(e){var t=e.markedSpans;if(t){for(var i=0;i<t.length;++i)t[i].marker.detachLine(e);e.markedSpans=null}}function xi(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function Ei(e){return e.inclusiveLeft?-1:0}function Li(e){return e.inclusiveRight?1:0}function Ai(e,t){var i=e.lines.length-t.lines.length;if(0!=i)return i;var n=e.find(),r=t.find(),a=Wr(n.from,r.from)||Ei(e)-Ei(t);return a?-a:Wr(n.to,r.to)||Li(e)-Li(t)||t.id-e.id}function Pi(e,t){var i,n=Fr&&e.markedSpans;if(n)for(var r,a=0;a<n.length;++a)(r=n[a]).marker.collapsed&&null==(t?r.from:r.to)&&(!i||Ai(i,r.marker)<0)&&(i=r.marker);return i}function Oi(e){return Pi(e,!0)}function Ii(e){return Pi(e,!1)}function Mi(e,t,i,n,r){var a=cn(e,t),s=Fr&&a.markedSpans;if(s)for(var o=0;o<s.length;++o){var l=s[o];if(l.marker.collapsed){var u=l.marker.find(0),c=Wr(u.from,i)||Ei(l.marker)-Ei(r),h=Wr(u.to,n)||Li(l.marker)-Li(r);if(!(c>=0&&0>=h||0>=c&&h>=0)&&(0>=c&&(l.marker.inclusiveRight&&r.inclusiveLeft?Wr(u.to,i)>=0:Wr(u.to,i)>0)||c>=0&&(l.marker.inclusiveRight&&r.inclusiveLeft?Wr(u.from,n)<=0:Wr(u.from,n)<0)))return!0}}}function Di(e){for(var t;t=Oi(e);)e=t.find(-1,!0).line;return e}function Ui(e,t){var i=cn(e,t),n=Di(i);return i==n?t:pn(n)}function Ri(e,t){if(t>e.lastLine())return t;var i,n=cn(e,t);if(!Ni(e,n))return t;for(;i=Ii(n);)n=i.find(1,!0).line;return pn(n)+1}function Ni(e,t){var i=Fr&&t.markedSpans;if(i)for(var n,r=0;r<i.length;++r)if((n=i[r]).marker.collapsed){if(null==n.from)return!0;if(!n.marker.widgetNode&&0==n.from&&n.marker.inclusiveLeft&&Bi(e,t,n))return!0}}function Bi(e,t,i){if(null==i.to){var n=i.marker.find(1,!0);return Bi(e,n.line,_i(n.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(var r,a=0;a<t.markedSpans.length;++a)if((r=t.markedSpans[a]).marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(null==r.to||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&Bi(e,t,r))return!0}function ji(e,t,i){gn(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&ai(e,null,i)}function Fi(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Qa(document.body,e.node)){var i="position: relative;";e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),Zn(t.display.measure,Qn("div",[e.node],null,i))}return e.height=e.node.parentNode.offsetHeight}function Hi(e){e.parent=null,Ci(e)}function Wi(e,t){if(e)for(;;){var i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!i)break;e=e.slice(0,i.index)+e.slice(i.index+i[0].length);var n=i[1]?"bgClass":"textClass";null==t[n]?t[n]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[n])||(t[n]+=" "+i[2])}return e}function zi(t,i){if(t.blankLine)return t.blankLine(i);if(t.innerMode){var n=e.innerMode(t,i);return n.mode.blankLine?n.mode.blankLine(n.state):void 0}}function qi(t,i,n,r){for(var a=0;10>a;a++){r&&(r[0]=e.innerMode(t,n).mode);var s=t.token(i,n);if(i.pos>i.start)return s}throw new Error("Mode "+t.name+" failed to advance stream.")}function Vi(e,t,i,n){function r(e){return{start:h.start,end:h.pos,string:h.current(),type:a||null,state:e?ha(s.mode,c):c}}var a,s=e.doc,o=s.mode;t=ce(s,t);var l,u=cn(s,t.line),c=De(e,t.line,i),h=new ya(u.text,e.options.tabSize);for(n&&(l=[]);(n||h.pos<t.ch)&&!h.eol();)h.start=h.pos,a=qi(o,h,c),n&&l.push(r(!0));return n?l:r()}function Gi(e,t,i,n,r,a,s){var o=i.flattenSpans;null==o&&(o=e.options.flattenSpans);var l,u=0,c=null,h=new ya(t,e.options.tabSize),d=e.options.addModeClass&&[null];for(""==t&&Wi(zi(i,n),a);!h.eol();){if(h.pos>e.options.maxHighlightLength?(o=!1,s&&Xi(e,t,n,h.pos),h.pos=t.length,l=null):l=Wi(qi(i,h,n,d),a),d){var f=d[0].name;f&&(l="m-"+(l?f+" "+l:f))}if(!o||c!=l){for(;u<h.start;)r(u=Math.min(h.start,u+5e4),c);c=l}h.start=h.pos}for(;u<h.pos;){var p=Math.min(h.pos,u+5e4);r(p,c),u=p}}function $i(e,t,i,n){var r=[e.state.modeGen],a={};Gi(e,t.text,e.doc.mode,i,function(e,t){r.push(e,t)},a,n);for(var s=0;s<e.state.overlays.length;++s){var o=e.state.overlays[s],l=1,u=0;Gi(e,t.text,o.mode,!0,function(e,t){for(var i=l;e>u;){var n=r[l];n>e&&r.splice(l,1,e,r[l+1],n),l+=2,u=Math.min(e,n)}if(t)if(o.opaque)r.splice(i,l-i,e,"cm-overlay "+t),l=i+2;else for(;l>i;i+=2){var a=r[i+1];r[i+1]=(a?a+" ":"")+"cm-overlay "+t}},a)}return{styles:r,classes:a.bgClass||a.textClass?a:null}}function Yi(e,t,i){if(!t.styles||t.styles[0]!=e.state.modeGen){var n=De(e,pn(t)),r=$i(e,t,t.text.length>e.options.maxHighlightLength?ha(e.doc.mode,n):n);t.stateAfter=n,t.styles=r.styles,r.classes?t.styleClasses=r.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.frontier&&e.doc.frontier++}return t.styles}function Xi(e,t,i,n){var r=e.doc.mode,a=new ya(t,e.options.tabSize);for(a.start=a.pos=n||0,""==t&&zi(r,i);!a.eol();)qi(r,a,i),a.start=a.pos}function Ki(e,t){if(!e||/^\s*$/.test(e))return null;var i=t.addModeClass?Ca:wa;return i[e]||(i[e]=e.replace(/\S+/g,"cm-$&"))}function Qi(e,t){var i=Qn("span",null,null,wr?"padding-right: .1px":null),n={pre:Qn("pre",[i],"CodeMirror-line"),content:i,col:0,pos:0,cm:e,splitSpaces:(Sr||wr)&&e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var a,s=r?t.rest[r-1]:t.line;n.pos=0,n.addToken=Ji,ar(e.display.measure)&&(a=vn(s))&&(n.addToken=en(n.addToken,a)),n.map=[],nn(s,n,Yi(e,s,t!=e.display.externalMeasured&&pn(s))),s.styleClasses&&(s.styleClasses.bgClass&&(n.bgClass=ir(s.styleClasses.bgClass,n.bgClass||"")),s.styleClasses.textClass&&(n.textClass=ir(s.styleClasses.textClass,n.textClass||""))),0==n.map.length&&n.map.push(0,0,n.content.appendChild(rr(e.display.measure))),0==r?(t.measure.map=n.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(n.map),(t.measure.caches||(t.measure.caches=[])).push({}))}if(wr){var o=n.content.lastChild;(/\bcm-tab\b/.test(o.className)||o.querySelector&&o.querySelector(".cm-tab"))&&(n.content.className="cm-tab-wrap-hack")}return Ra(e,"renderLine",e,t.line,n.pre),n.pre.className&&(n.textClass=ir(n.pre.className,n.textClass||"")),n}function Ji(e,t,i,n,r,a,s){if(t){var o=e.splitSpaces?t.replace(/ {3,}/g,Zi):t,l=e.cm.state.specialChars,u=!1;if(l.test(t))for(var c=document.createDocumentFragment(),h=0;;){l.lastIndex=h;var d=l.exec(t),f=d?d.index-h:t.length-h;if(f){var p=document.createTextNode(o.slice(h,h+f));c.appendChild(Sr&&9>kr?Qn("span",[p]):p),e.map.push(e.pos,e.pos+f,p),e.col+=f,e.pos+=f}if(!d)break;if(h+=f+1,"\t"==d[0]){var m=e.cm.options.tabSize,g=m-e.col%m;(p=c.appendChild(Qn("span",Fn(g),"cm-tab"))).setAttribute("role","presentation"),p.setAttribute("cm-text","\t"),e.col+=g}else"\r"==d[0]||"\n"==d[0]?((p=c.appendChild(Qn("span","\r"==d[0]?"\u240d":"\u2424","cm-invalidchar"))).setAttribute("cm-text",d[0]),e.col+=1):((p=e.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),c.appendChild(Sr&&9>kr?Qn("span",[p]):p),e.col+=1);e.map.push(e.pos,e.pos+1,p),e.pos++}else e.col+=t.length,c=document.createTextNode(o),e.map.push(e.pos,e.pos+t.length,c),Sr&&9>kr&&(u=!0),e.pos+=t.length;if(i||n||r||u||s){var v=i||"";n&&(v+=n),r&&(v+=r);var y=Qn("span",[c],v,s);return a&&(y.title=a),e.content.appendChild(y)}e.content.appendChild(c)}}function Zi(e){for(var t=" ",i=0;i<e.length-2;++i)t+=i%2?" ":"\xa0";return t+" "}function en(e,t){return function(i,n,r,a,s,o,l){r=r?r+" cm-force-border":"cm-force-border";for(var u=i.pos,c=u+n.length;;){for(var h=0;h<t.length;h++){var d=t[h];if(d.to>u&&d.from<=u)break}if(d.to>=c)return e(i,n,r,a,s,o,l);e(i,n.slice(0,d.to-u),r,a,null,o,l),a=null,n=n.slice(d.to-u),u=d.to}}}function tn(e,t,i,n){var r=!n&&i.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!n&&e.cm.display.input.needsContentAttribute&&(r||(r=e.content.appendChild(document.createElement("span"))),r.setAttribute("cm-marker",i.id)),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t}function nn(e,t,i){var n=e.markedSpans,r=e.text,a=0;if(n)for(var s,o,l,u,c,h,d,f=r.length,p=0,m=1,g="",v=0;;){if(v==p){l=u=c=h=o="",d=null,v=1/0;for(var y,b=[],_=0;_<n.length;++_){var T=n[_],S=T.marker;"bookmark"==S.type&&T.from==p&&S.widgetNode?b.push(S):T.from<=p&&(null==T.to||T.to>p||S.collapsed&&T.to==p&&T.from==p)?(null!=T.to&&T.to!=p&&v>T.to&&(v=T.to,u=""),S.className&&(l+=" "+S.className),S.css&&(o=(o?o+";":"")+S.css),S.startStyle&&T.from==p&&(c+=" "+S.startStyle),S.endStyle&&T.to==v&&(y||(y=[])).push(S.endStyle,T.to),S.title&&!h&&(h=S.title),S.collapsed&&(!d||Ai(d.marker,S)<0)&&(d=T)):T.from>p&&v>T.from&&(v=T.from)}if(y)for(_=0;_<y.length;_+=2)y[_+1]==v&&(u+=" "+y[_]);if(!d||d.from==p)for(_=0;_<b.length;++_)tn(t,0,b[_]);if(d&&(d.from||0)==p){if(tn(t,(null==d.to?f+1:d.to)-p,d.marker,null==d.from),null==d.to)return;d.to==p&&(d=!1)}}if(p>=f)break;for(var k=Math.min(f,v);;){if(g){var w=p+g.length;if(!d){var C=w>k?g.slice(0,k-p):g;t.addToken(t,C,s?s+l:l,c,p+C.length==v?u:"",h,o)}if(w>=k){g=g.slice(k-p),p=k;break}p=w,c=""}g=r.slice(a,a=i[m++]),s=Ki(i[m++],t.cm.options)}}else for(m=1;m<i.length;m+=2)t.addToken(t,r.slice(a,a=i[m]),Ki(i[m+1],t.cm.options))}function rn(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Hn(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function an(e,t,i,n){function r(e){return i?i[e]:null}function a(e,i,r){(function(e,t,i,n){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),Ci(e),xi(e,i);var r=n?n(e):1;r!=e.height&&fn(e,r)})(e,i,r,n),Mn(e,"change",e,t)}function s(e,t){for(var i=e,a=[];t>i;++i)a.push(new ka(u[i],r(i),n));return a}var o=t.from,l=t.to,u=t.text,c=cn(e,o.line),h=cn(e,l.line),d=Hn(u),f=r(u.length-1),p=l.line-o.line;if(t.full)e.insert(0,s(0,u.length)),e.remove(u.length,e.size-u.length);else if(rn(e,t)){var m=s(0,u.length-1);a(h,h.text,f),p&&e.remove(o.line,p),m.length&&e.insert(o.line,m)}else c==h?1==u.length?a(c,c.text.slice(0,o.ch)+d+c.text.slice(l.ch),f):((m=s(1,u.length-1)).push(new ka(d+c.text.slice(l.ch),f,n)),a(c,c.text.slice(0,o.ch)+u[0],r(0)),e.insert(o.line+1,m)):1==u.length?(a(c,c.text.slice(0,o.ch)+u[0]+h.text.slice(l.ch),r(0)),e.remove(o.line+1,p)):(a(c,c.text.slice(0,o.ch)+u[0],r(0)),a(h,d+h.text.slice(l.ch),f),m=s(1,u.length-1),p>1&&e.remove(o.line+1,p-1),e.insert(o.line+1,m));Mn(e,"change",e,t)}function sn(e){this.lines=e,this.parent=null;for(var t=0,i=0;t<e.length;++t)e[t].parent=this,i+=e[t].height;this.height=i}function on(e){this.children=e;for(var t=0,i=0,n=0;n<e.length;++n){var r=e[n];t+=r.chunkSize(),i+=r.height,r.parent=this}this.size=t,this.height=i,this.parent=null}function ln(e,t,i){!function e(n,r,a){if(n.linked)for(var s=0;s<n.linked.length;++s){var o=n.linked[s];if(o.doc!=r){var l=a&&o.sharedHist;i&&!l||(t(o.doc,l),e(o.doc,n,l))}}}(e,null,!0)}function un(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),i(e),e.options.lineWrapping||h(e),e.options.mode=t.modeOption,Tt(e)}function cn(e,t){if(0>(t-=e.first)||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var i=e;!i.lines;)for(var n=0;;++n){var r=i.children[n],a=r.chunkSize();if(a>t){i=r;break}t-=a}return i.lines[t]}function hn(e,t,i){var n=[],r=t.line;return e.iter(t.line,i.line+1,function(e){var a=e.text;r==i.line&&(a=a.slice(0,i.ch)),r==t.line&&(a=a.slice(t.ch)),n.push(a),++r}),n}function dn(e,t,i){var n=[];return e.iter(t,i,function(e){n.push(e.text)}),n}function fn(e,t){var i=t-e.height;if(i)for(var n=e;n;n=n.parent)n.height+=i}function pn(e){if(null==e.parent)return null;for(var t=e.parent,i=Wn(t.lines,e),n=t.parent;n;t=n,n=n.parent)for(var r=0;n.children[r]!=t;++r)i+=n.children[r].chunkSize();return i+t.first}function mn(e,t){var i=e.first;e:do{for(var n=0;n<e.children.length;++n){var r=e.children[n],a=r.height;if(a>t){e=r;continue e}t-=a,i+=r.chunkSize()}return i}while(!e.lines);for(n=0;n<e.lines.length;++n){var s=e.lines[n].height;if(s>t)break;t-=s}return i+n}function gn(e){for(var t=0,i=(e=Di(e)).parent,n=0;n<i.lines.length;++n){var r=i.lines[n];if(r==e)break;t+=r.height}for(var a=i.parent;a;a=(i=a).parent)for(n=0;n<a.children.length;++n){var s=a.children[n];if(s==i)break;t+=s.height}return t}function vn(e){var t=e.order;return null==t&&(t=e.order=cs(e.text)),t}function yn(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function bn(e,t){var i={from:z(t.from),to:ia(t),text:hn(e,t.from,t.to)};return kn(e,i,t.from.line,t.to.line+1),ln(e,function(e){kn(e,i,t.from.line,t.to.line+1)},!0),i}function _n(e){for(;e.length&&Hn(e).ranges;)e.pop()}function Tn(e,t,i,n){var r=e.history;r.undone.length=0;var a,s=+new Date;if((r.lastOp==n||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&r.lastModTime>s-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(a=function(e,t){return r.lastOp==n?(_n(e.done),Hn(e.done)):e.done.length&&!Hn(e.done).ranges?Hn(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Hn(e.done)):void 0}(r))){var o=Hn(a.changes);0==Wr(t.from,t.to)&&0==Wr(t.from,o.to)?o.to=ia(t):a.changes.push(bn(e,t))}else{var l=Hn(r.done);for(l&&l.ranges||Sn(e.sel,r.done),a={changes:[bn(e,t)],generation:r.generation},r.done.push(a);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(i),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=s,r.lastOp=r.lastSelOp=n,r.lastOrigin=r.lastSelOrigin=t.origin,o||Ra(e,"historyAdded")}function Sn(e,t){var i=Hn(t);i&&i.ranges&&i.equals(e)||t.push(e)}function kn(e,t,i,n){var r=t["spans_"+e.id],a=0;e.iter(Math.max(e.first,i),Math.min(e.first+e.size,n),function(i){i.markedSpans&&((r||(r=t["spans_"+e.id]={}))[a]=i.markedSpans),++a})}function wn(e){if(!e)return null;for(var t,i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t||(t=e.slice(0,i)):t&&t.push(e[i]);return t?t.length?t:null:e}function Cn(e,t,i){for(var n=0,r=[];n<e.length;++n){var a=e[n];if(a.ranges)r.push(i?ae.prototype.deepCopy.call(a):a);else{var s=a.changes,o=[];r.push({changes:o});for(var l=0;l<s.length;++l){var u,c=s[l];if(o.push({from:c.from,to:c.to,text:c.text}),t)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&Wn(t,Number(u[1]))>-1&&(Hn(o)[h]=c[h],delete c[h])}}}return r}function xn(e,t,i,n){i<e.line?e.line+=n:t<e.line&&(e.line=t,e.ch=0)}function En(e,t,i,n){for(var r=0;r<e.length;++r){var a=e[r],s=!0;if(a.ranges){a.copied||((a=e[r]=a.deepCopy()).copied=!0);for(var o=0;o<a.ranges.length;o++)xn(a.ranges[o].anchor,t,i,n),xn(a.ranges[o].head,t,i,n)}else{for(o=0;o<a.changes.length;++o){var l=a.changes[o];if(i<l.from.line)l.from=Hr(l.from.line+n,l.from.ch),l.to=Hr(l.to.line+n,l.to.ch);else if(t<=l.to.line){s=!1;break}}s||(e.splice(0,r+1),r=0)}}}function Ln(e,t){var i=t.from.line,n=t.to.line,r=t.text.length-(n-i)-1;En(e.done,i,n,r),En(e.undone,i,n,r)}function An(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Pn(e){return e.target||e.srcElement}function On(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Mr&&e.ctrlKey&&1==t&&(t=3),t}function In(e,t,i){var n=e._handlers&&e._handlers[t];return i?n&&n.length>0?n.slice():Da:n||Da}function Mn(e,t){function i(e){return function(){e.apply(null,a)}}var n=In(e,t,!1);if(n.length){var r,a=Array.prototype.slice.call(arguments,2);Yr?r=Yr.delayedCallbacks:Na?r=Na:(r=Na=[],setTimeout(Dn,0));for(var s=0;s<n.length;++s)r.push(i(n[s]))}}function Dn(){var e=Na;Na=null;for(var t=0;t<e.length;++t)e[t]()}function Un(e,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ra(e,i||t.type,e,t),An(t)||t.codemirrorIgnore}function Rn(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var i=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),n=0;n<t.length;++n)-1==Wn(i,t[n])&&i.push(t[n])}function Nn(e,t){return In(e,t).length>0}function Bn(e){e.prototype.on=function(e,t){Ma(this,e,t)},e.prototype.off=function(e,t){Ua(this,e,t)}}function jn(){this.id=null}function Fn(e){for(;Va.length<=e;)Va.push(Hn(Va)+" ");return Va[e]}function Hn(e){return e[e.length-1]}function Wn(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function zn(e,t){for(var i=[],n=0;n<e.length;n++)i[n]=t(e[n],n);return i}function qn(){}function Vn(e,t){var i;return Object.create?i=Object.create(e):(qn.prototype=e,i=new qn),t&&Gn(t,i),i}function Gn(e,t,i){for(var n in t||(t={}),e)!e.hasOwnProperty(n)||!1===i&&t.hasOwnProperty(n)||(t[n]=e[n]);return t}function $n(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Yn(e,t){return t?!!(t.source.indexOf("\\w")>-1&&Xa(e))||t.test(e):Xa(e)}function Xn(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function Kn(e){return e.charCodeAt(0)>=768&&Ka.test(e)}function Qn(e,t,i,n){var r=document.createElement(e);if(i&&(r.className=i),n&&(r.style.cssText=n),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var a=0;a<t.length;++a)r.appendChild(t[a]);return r}function Jn(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function Zn(e,t){return Jn(e).appendChild(t)}function er(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function tr(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function ir(e,t){for(var i=e.split(" "),n=0;n<i.length;n++)i[n]&&!tr(i[n]).test(t)&&(t+=" "+i[n]);return t}function nr(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++){var n=t[i].CodeMirror;n&&e(n)}}function rr(e){if(null==Ja){var t=Qn("span","\u200b");Zn(e,Qn("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ja=t.offsetWidth<=1&&t.offsetHeight>2&&!(Sr&&8>kr))}var i=Ja?Qn("span","\u200b"):Qn("span","\xa0",null,"display: inline-block; width: 1px; margin-right: -1px");return i.setAttribute("cm-text",""),i}function ar(e){if(null!=Za)return Za;var t=Zn(e,document.createTextNode("A\u062eA")),i=$a(t,0,1).getBoundingClientRect();if(!i||i.left==i.right)return!1;var n=$a(t,1,2).getBoundingClientRect();return Za=n.right-i.right<3}function sr(e){return e.level%2?e.to:e.from}function or(e){return e.level%2?e.from:e.to}function lr(e){var t=vn(e);return t?sr(t[0]):0}function ur(e){var t=vn(e);return t?or(Hn(t)):e.text.length}function cr(e,t){var i=cn(e.doc,t),n=Di(i);n!=i&&(t=pn(n));var r=vn(n),a=r?r[0].level%2?ur(n):lr(n):0;return Hr(t,a)}function hr(e,t){var i=cr(e,t.line),n=cn(e.doc,i.line),r=vn(n);if(!r||0==r[0].level){var a=Math.max(0,n.text.search(/\S/));return Hr(i.line,t.line==i.line&&t.ch<=a&&t.ch?0:a)}return i}function dr(e,t,i){var n=e[0].level;return t==n||i!=n&&i>t}function fr(e,t){us=null;for(var i,n=0;n<e.length;++n){var r=e[n];if(r.from<t&&r.to>t)return n;if(r.from==t||r.to==t){if(null!=i)return dr(e,r.level,e[i].level)?(r.from!=r.to&&(us=i),n):(r.from!=r.to&&(us=n),i);i=n}}return i}function pr(e,t,i,n){if(!n)return t+i;do{t+=i}while(t>0&&Kn(e.text.charAt(t)));return t}function mr(e,t,i,n){var r=vn(e);if(!r)return gr(e,t,i,n);for(var a=fr(r,t),s=r[a],o=pr(e,t,s.level%2?-i:i,n);;){if(o>s.from&&o<s.to)return o;if(o==s.from||o==s.to)return fr(r,o)==a?o:i>0==(s=r[a+=i]).level%2?s.to:s.from;if(!(s=r[a+=i]))return null;o=i>0==s.level%2?pr(e,s.to,-1,n):pr(e,s.from,1,n)}}function gr(e,t,i,n){var r=t+i;if(n)for(;r>0&&Kn(e.text.charAt(r));)r+=i;return 0>r||r>e.text.length?null:r}var vr=navigator.userAgent,yr=navigator.platform,br=/gecko\/\d/i.test(vr),_r=/MSIE \d/.test(vr),Tr=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(vr),Sr=_r||Tr,kr=Sr&&(_r?document.documentMode||6:Tr[1]),wr=/WebKit\//.test(vr),Cr=wr&&/Qt\/\d+\.\d+/.test(vr),xr=/Chrome\//.test(vr),Er=/Opera\//.test(vr),Lr=/Apple Computer/.test(navigator.vendor),Ar=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(vr),Pr=/PhantomJS/.test(vr),Or=/AppleWebKit/.test(vr)&&/Mobile\/\w+/.test(vr),Ir=Or||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(vr),Mr=Or||/Mac/.test(yr),Dr=/\bCrOS\b/.test(vr),Ur=/win/i.test(yr),Rr=Er&&vr.match(/Version\/(\d*\.\d*)/);Rr&&(Rr=Number(Rr[1])),Rr&&Rr>=15&&(Er=!1,wr=!0);var Nr=Mr&&(Cr||Er&&(null==Rr||12.11>Rr)),Br=br||Sr&&kr>=9,jr=!1,Fr=!1;p.prototype=Gn({update:function(e){var t=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,n=e.nativeBarWidth;return i?(this.vert.style.display="block",this.vert.style.bottom=t?n+"px":"0",this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+(e.viewHeight-(t?n:0)))+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),t?(this.horiz.style.display="block",this.horiz.style.right=i?n+"px":"0",this.horiz.style.left=e.barLeft+"px",this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+(e.viewWidth-e.barLeft-(i?n:0))+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&e.clientHeight>0&&(0==n&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?n:0,bottom:t?n:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){this.horiz.style.height=this.vert.style.width=Mr&&!Ar?"12px":"18px",this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new jn,this.disableVert=new jn},enableZeroWidthBar:function(e,t){e.style.pointerEvents="auto",t.set(1e3,function i(){var n=e.getBoundingClientRect();document.elementFromPoint(n.left+1,n.bottom-1)!=e?e.style.pointerEvents="none":t.set(1e3,i)})},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},p.prototype),m.prototype=Gn({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},m.prototype),e.scrollbarModel={native:p,null:m},w.prototype.signal=function(e,t){Nn(e,t)&&this.events.push(arguments)},w.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ra.apply(null,this.events[e])};var Hr=e.Pos=function(e,t){return this instanceof Hr?(this.line=e,void(this.ch=t)):new Hr(e,t)},Wr=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},zr=null;J.prototype=Gn({init:function(e){function t(e){if(!Un(n,e)){if(n.somethingSelected())zr={lineWise:!1,text:n.getSelections()},i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,a.value=zr.text.join("\n"),Ga(a));else{if(!n.options.lineWiseCopyCut)return;var t=K(n);zr={lineWise:!0,text:t.text},"cut"==e.type?n.setSelections(t.ranges,null,Fa):(i.prevInput="",a.value=t.text.join("\n"),Ga(a))}"cut"==e.type&&(n.state.cutIncoming=!0)}}var i=this,n=this.cm,r=this.wrapper=Z(),a=this.textarea=r.firstChild;e.wrapper.insertBefore(r,e.wrapper.firstChild),Or&&(a.style.width="0px"),Ma(a,"input",function(){Sr&&kr>=9&&i.hasSelection&&(i.hasSelection=null),i.poll()}),Ma(a,"paste",function(e){Un(n,e)||Y(e,n)||(n.state.pasteIncoming=!0,i.fastPoll())}),Ma(a,"cut",t),Ma(a,"copy",t),Ma(e.scroller,"paste",function(t){Lt(e,t)||Un(n,t)||(n.state.pasteIncoming=!0,i.focus())}),Ma(e.lineSpace,"selectstart",function(t){Lt(e,t)||Pa(t)}),Ma(a,"compositionstart",function(){var e=n.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:e,range:n.markText(e,n.getCursor("to"),{className:"CodeMirror-composing"})}}),Ma(a,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,i=e.doc,n=Le(e);if(e.options.moveInputWithCursor){var r=tt(e,i.sel.primary().head,"div"),a=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();n.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-a.top)),n.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-a.left))}return n},showSelection:function(e){var t=this.cm.display;Zn(t.cursorDiv,e.cursors),Zn(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,i,n=this.cm,r=n.doc;if(n.somethingSelected()){this.prevInput="";var a=r.sel.primary(),s=(t=ss&&(a.to().line-a.from().line>100||(i=n.getSelection()).length>1e3))?"-":i||n.getSelection();this.textarea.value=s,n.state.focused&&Ga(this.textarea),Sr&&kr>=9&&(this.hasSelection=s)}else e||(this.prevInput=this.textarea.value="",Sr&&kr>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!Ir||er()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){var e=!1,t=this;t.pollingFast=!0,t.polling.set(20,function i(){t.poll()||e?(t.pollingFast=!1,t.slowPoll()):(e=!0,t.polling.set(60,i))})},poll:function(){var e=this.cm,t=this.textarea,i=this.prevInput;if(this.contextMenuPending||!e.state.focused||as(t)&&!i&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var n=t.value;if(n==i&&!e.somethingSelected())return!1;if(Sr&&kr>=9&&this.hasSelection===n||Mr&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var r=n.charCodeAt(0);if(8203!=r||i||(i="\u200b"),8666==r)return this.reset(),this.cm.execCommand("undo")}for(var a=0,s=Math.min(i.length,n.length);s>a&&i.charCodeAt(a)==n.charCodeAt(a);)++a;var o=this;return mt(e,function(){$(e,n.slice(a),i.length-a,null,o.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?t.value=o.prevInput="":o.prevInput=n,o.composing&&(o.composing.range.clear(),o.composing.range=e.markText(o.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){Sr&&kr>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=s.selectionStart){var e=r.somethingSelected(),t="\u200b"+(e?s.value:"");s.value="\u21da",s.value=t,n.prevInput=e?"":"\u200b",s.selectionStart=1,s.selectionEnd=t.length,a.selForContextMenu=r.doc.sel}}function i(){if(n.contextMenuPending=!1,n.wrapper.style.cssText=c,s.style.cssText=u,Sr&&9>kr&&a.scrollbars.setScrollTop(a.scroller.scrollTop=l),null!=s.selectionStart){(!Sr||Sr&&9>kr)&&t();var e=0,i=function(){a.selForContextMenu==r.doc.sel&&0==s.selectionStart&&s.selectionEnd>0&&"\u200b"==n.prevInput?gt(r,fa.selectAll)(r):e++<10?a.detectingSelectAll=setTimeout(i,500):a.input.reset()};a.detectingSelectAll=setTimeout(i,200)}}var n=this,r=n.cm,a=r.display,s=n.textarea,o=At(r,e),l=a.scroller.scrollTop;if(o&&!Er){r.options.resetSelectionOnContextMenu&&-1==r.doc.sel.contains(o)&&gt(r,be)(r.doc,le(o),Fa);var u=s.style.cssText,c=n.wrapper.style.cssText;n.wrapper.style.cssText="position: absolute";var h=n.wrapper.getBoundingClientRect();if(s.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(e.clientY-h.top-5)+"px; left: "+(e.clientX-h.left-5)+"px; z-index: 1000; background: "+(Sr?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",wr)var d=window.scrollY;if(a.input.focus(),wr&&window.scrollTo(null,d),a.input.reset(),r.somethingSelected()||(s.value=n.prevInput=" "),n.contextMenuPending=!0,a.selForContextMenu=r.doc.sel,clearTimeout(a.detectingSelectAll),Sr&&kr>=9&&t(),Br){Ia(e);var f=function(){Ua(window,"mouseup",f),setTimeout(i,20)};Ma(window,"mouseup",f)}else setTimeout(i,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:qn,needsContentAttribute:!1},J.prototype),ee.prototype=Gn({init:function(e){function t(e){if(!Un(n,e)){if(n.somethingSelected())zr={lineWise:!1,text:n.getSelections()},"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;var t=K(n);zr={lineWise:!0,text:t.text},"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,Fa),n.replaceSelection("",null,"cut")})}if(e.clipboardData&&!Or)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",zr.text.join("\n"));else{var i=Z(),r=i.firstChild;n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),r.value=zr.text.join("\n");var a=document.activeElement;Ga(r),setTimeout(function(){n.display.lineSpace.removeChild(i),a.focus()},50)}}}var i=this,n=i.cm,r=i.div=e.lineDiv;Q(r),Ma(r,"paste",function(e){Un(n,e)||Y(e,n)}),Ma(r,"compositionstart",function(e){var t=e.data;if(i.composing={sel:n.doc.sel,data:t,startData:t},t){var r=n.doc.sel.primary(),a=n.getLine(r.head.line).indexOf(t,Math.max(0,r.head.ch-t.length));a>-1&&a<=r.head.ch&&(i.composing.sel=le(Hr(r.head.line,a),Hr(r.head.line,a+t.length)))}}),Ma(r,"compositionupdate",function(e){i.composing.data=e.data}),Ma(r,"compositionend",function(e){var t=i.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||i.applyComposition(t),i.composing==t&&(i.composing=null)},50))}),Ma(r,"touchstart",function(){i.forceCompositionEnd()}),Ma(r,"input",function(){i.composing||!n.isReadOnly()&&i.pollContent()||mt(i.cm,function(){Tt(n)})}),Ma(r,"copy",t),Ma(r,"cut",t)},prepareSelection:function(){var e=Le(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),i=ne(this.cm,e.anchorNode,e.anchorOffset),n=ne(this.cm,e.focusNode,e.focusOffset);if(!i||i.bad||!n||n.bad||0!=Wr(V(i,n),t.from())||0!=Wr(q(i,n),t.to())){var r=te(this.cm,t.from()),a=te(this.cm,t.to());if(r||a){var s=this.cm.display.view,o=e.rangeCount&&e.getRangeAt(0);if(r){if(!a){var l=s[s.length-1].measure,u=l.maps?l.maps[l.maps.length-1]:l.map;a={node:u[u.length-1],offset:u[u.length-2]-u[u.length-3]}}}else r={node:s[0].measure.map[2],offset:0};try{var h=$a(r.node,r.offset,a.offset,a.node)}catch(c){}h&&(!br&&this.cm.state.focused?(e.collapse(r.node,r.offset),h.collapsed||e.addRange(h)):(e.removeAllRanges(),e.addRange(h)),o&&null==e.anchorNode?e.addRange(o):br&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){Zn(this.cm.display.cursorDiv,e.cursors),Zn(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Qa(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){var e=this;this.selectionInEditor()?this.pollSelection():mt(this.cm,function(){e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))})},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var i=ne(t,e.anchorNode,e.anchorOffset),n=ne(t,e.focusNode,e.focusOffset);i&&n&&mt(t,function(){be(t.doc,le(i,n),Fa),(i.bad||n.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e,t=this.cm,i=t.display,n=t.doc.sel.primary(),r=n.from(),a=n.to();if(r.line<i.viewFrom||a.line>i.viewTo-1)return!1;if(r.line==i.viewFrom||0==(e=wt(t,r.line)))var s=pn(i.view[0].line),o=i.view[0].node;else s=pn(i.view[e].line),o=i.view[e-1].node.nextSibling;var l=wt(t,a.line);if(l==i.view.length-1)var u=i.viewTo-1,c=i.lineDiv.lastChild;else u=pn(i.view[l+1].line)-1,c=i.view[l+1].node.previousSibling;for(var h=t.doc.splitLines(function(e,t,i,n,r){function a(t){if(1==t.nodeType){var i=t.getAttribute("cm-text");if(null!=i)return""==i&&(i=t.textContent.replace(/\u200b/g,"")),void(s+=i);var u,c=t.getAttribute("cm-marker");if(c){var h=e.findMarks(Hr(n,0),Hr(r+1,0),function(e){return function(t){return t.id==e}}(+c));return void(h.length&&(u=h[0].find())&&(s+=hn(e.doc,u.from,u.to).join(l)))}if("false"==t.getAttribute("contenteditable"))return;for(var d=0;d<t.childNodes.length;d++)a(t.childNodes[d]);/^(pre|div|p)$/i.test(t.nodeName)&&(o=!0)}else if(3==t.nodeType){var f=t.nodeValue;if(!f)return;o&&(s+=l,o=!1),s+=f}}for(var s="",o=!1,l=e.doc.lineSeparator();a(t),t!=i;)t=t.nextSibling;return s}(t,o,c,s,u)),d=hn(t.doc,Hr(s,0),Hr(u,cn(t.doc,u).text.length));h.length>1&&d.length>1;)if(Hn(h)==Hn(d))h.pop(),d.pop(),u--;else{if(h[0]!=d[0])break;h.shift(),d.shift(),s++}for(var f=0,p=0,m=h[0],g=d[0],v=Math.min(m.length,g.length);v>f&&m.charCodeAt(f)==g.charCodeAt(f);)++f;for(var y=Hn(h),b=Hn(d),_=Math.min(y.length-(1==h.length?f:0),b.length-(1==d.length?f:0));_>p&&y.charCodeAt(y.length-p-1)==b.charCodeAt(b.length-p-1);)++p;h[h.length-1]=y.slice(0,y.length-p),h[0]=h[0].slice(f);var T=Hr(s,f),S=Hr(u,d.length?Hn(d).length-p:0);return h.length>1||h[0]||Wr(T,S)?(ni(t.doc,h,T,S,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){this.cm.isReadOnly()?gt(this.cm,Tt)(this.cm):e.data&&e.data!=e.startData&&gt(this.cm,$)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||gt(this.cm,$)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:qn,resetPosition:qn,needsContentAttribute:!0},ee.prototype),e.inputStyles={textarea:J,contenteditable:ee},ae.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var i=this.ranges[t],n=e.ranges[t];if(0!=Wr(i.anchor,n.anchor)||0!=Wr(i.head,n.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new se(z(this.ranges[t].anchor),z(this.ranges[t].head));return new ae(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var i=0;i<this.ranges.length;i++){var n=this.ranges[i];if(Wr(t,n.from())>=0&&Wr(e,n.to())<=0)return i}return-1}},se.prototype={from:function(){return V(this.anchor,this.head)},to:function(){return q(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var qr,Vr,Gr,$r={left:0,right:0,top:0,bottom:0},Yr=null,Xr=0,Kr=0,Qr=0,Jr=null;Sr?Jr=-.53:br?Jr=15:xr?Jr=-.7:Lr&&(Jr=-1/3);var Zr=function(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}};e.wheelEventPixels=function(e){var t=Zr(e);return t.x*=Jr,t.y*=Jr,t};var ea=new jn,ta=null,ia=e.changeEnd=function(e){return e.text?Hr(e.from.line+e.text.length-1,Hn(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var i=this.options,n=i[e];i[e]==t&&"mode"!=e||(i[e]=t,ra.hasOwnProperty(e)&&gt(this,ra[e])(this,t,n))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](mi(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:vt(function(t,i){var n=t.token?t:e.getMode(this.options,t);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:t,opaque:i&&i.opaque}),this.state.modeGen++,Tt(this)}),removeOverlay:vt(function(e){for(var t=this.state.overlays,i=0;i<t.length;++i){var n=t[i].modeSpec;if(n==e||"string"==typeof e&&n.name==e)return t.splice(i,1),this.state.modeGen++,void Tt(this)}}),indentLine:vt(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),he(this.doc,e)&&li(this,e,t,i)}),indentSelection:vt(function(e){for(var t=this.doc.sel.ranges,i=-1,n=0;n<t.length;n++){var r=t[n];if(r.empty())r.head.line>i&&(li(this,r.head.line,e,!0),i=r.head.line,n==this.doc.sel.primIndex&&si(this));else{var a=r.from(),s=r.to(),o=Math.max(i,a.line);i=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=o;i>l;++l)li(this,l,e);var u=this.doc.sel.ranges;0==a.ch&&t.length==u.length&&u[n].from().ch>0&&ge(this.doc,n,new se(a,u[n].to()),Fa)}}}),getTokenAt:function(e,t){return Vi(this,e,t)},getLineTokens:function(e,t){return Vi(this,Hr(e),t,!0)},getTokenTypeAt:function(e){e=ce(this.doc,e);var t,i=Yi(this,cn(this.doc,e.line)),n=0,r=(i.length-1)/2,a=e.ch;if(0==a)t=i[2];else for(;;){var s=n+r>>1;if((s?i[2*s-1]:0)>=a)r=s;else{if(!(i[2*s+1]<a)){t=i[2*s+2];break}n=s+1}}var o=t?t.indexOf("cm-overlay "):-1;return 0>o?t:0==o?null:t.slice(0,o-1)},getModeAt:function(t){var i=this.doc.mode;return i.innerMode?e.innerMode(i,this.getTokenAt(t).state).mode:i},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i=[];if(!ca.hasOwnProperty(t))return i;var n=ca[t],r=this.getModeAt(e);if("string"==typeof r[t])n[r[t]]&&i.push(n[r[t]]);else if(r[t])for(var a=0;a<r[t].length;a++){var s=n[r[t][a]];s&&i.push(s)}else r.helperType&&n[r.helperType]?i.push(n[r.helperType]):n[r.name]&&i.push(n[r.name]);for(a=0;a<n._global.length;a++){var o=n._global[a];o.pred(r,this)&&-1==Wn(i,o.val)&&i.push(o.val)}return i},getStateAfter:function(e,t){var i=this.doc;return De(this,(e=ue(i,null==e?i.first+i.size-1:e))+1,t)},cursorCoords:function(e,t){var i=this.doc.sel.primary();return tt(this,null==e?i.head:"object"==typeof e?ce(this.doc,e):e?i.from():i.to(),t||"page")},charCoords:function(e,t){return et(this,ce(this.doc,e),t||"page")},coordsChar:function(e,t){return rt(this,(e=Ze(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Ze(this,{top:e,left:0},t||"page").top,mn(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var i,n=!1;if("number"==typeof e){var r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0),i=cn(this.doc,e)}else i=e;return Je(this,i,{top:0,left:0},t||"page").top+(n?this.doc.height-gn(i):0)},defaultTextHeight:function(){return st(this.display)},defaultCharWidth:function(){return ot(this.display)},setGutterMarker:vt(function(e,t,i){return ui(this.doc,e,"gutter",function(e){var n=e.gutterMarkers||(e.gutterMarkers={});return n[t]=i,!i&&Xn(n)&&(e.gutterMarkers=null),!0})}),clearGutter:vt(function(e){var t=this,i=t.doc,n=i.first;i.iter(function(i){i.gutterMarkers&&i.gutterMarkers[e]&&(i.gutterMarkers[e]=null,St(t,n,"gutter"),Xn(i.gutterMarkers)&&(i.gutterMarkers=null)),++n})}),lineInfo:function(e){if("number"==typeof e){if(!he(this.doc,e))return null;var t=e;if(!(e=cn(this.doc,e)))return null}else if(null==(t=pn(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,n,r){var a=this.display,s=(e=tt(this,ce(this.doc,e))).bottom,o=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),a.sizer.appendChild(t),"over"==n)s=e.top;else if("above"==n||"near"==n){var l=Math.max(a.wrapper.clientHeight,this.doc.height),u=Math.max(a.sizer.clientWidth,a.lineSpace.clientWidth);("above"==n||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?s=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(s=e.bottom),o+t.offsetWidth>u&&(o=u-t.offsetWidth)}t.style.top=s+"px",t.style.left=t.style.right="","right"==r?(o=a.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?o=0:"middle"==r&&(o=(a.sizer.clientWidth-t.offsetWidth)/2),t.style.left=o+"px"),i&&function(e,t,i,n,r){var a=ri(e,o,s,n,r);null!=a.scrollTop&&Ut(e,a.scrollTop),null!=a.scrollLeft&&Rt(e,a.scrollLeft)}(this,0,0,o+t.offsetWidth,s+t.offsetHeight)},triggerOnKeyDown:vt(Ht),triggerOnKeyPress:vt(zt),triggerOnKeyUp:Wt,execCommand:function(e){return fa.hasOwnProperty(e)?fa[e].call(null,this):void 0},triggerElectric:vt(function(e){X(this,e)}),findPosH:function(e,t,i,n){var r=1;0>t&&(r=-1,t=-t);for(var a=0,s=ce(this.doc,e);t>a&&!(s=hi(this.doc,s,r,i,n)).hitSide;++a);return s},moveH:vt(function(e,t){var i=this;i.extendSelectionsBy(function(n){return i.display.shift||i.doc.extend||n.empty()?hi(i.doc,n.head,e,t,i.options.rtlMoveVisually):0>e?n.from():n.to()},Wa)}),deleteH:vt(function(e,t){var i=this.doc;this.doc.sel.somethingSelected()?i.replaceSelection("",null,"+delete"):ci(this,function(n){var r=hi(i,n.head,e,t,!1);return 0>e?{from:r,to:n.head}:{from:n.head,to:r}})}),findPosV:function(e,t,i,n){var r=1,a=n;0>t&&(r=-1,t=-t);for(var s=0,o=ce(this.doc,e);t>s;++s){var l=tt(this,o,"div");if(null==a?a=l.left:l.left=a,(o=di(this,l,r,i)).hitSide)break}return o},moveV:vt(function(e,t){var i=this,n=this.doc,r=[],a=!i.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(s){if(a)return 0>e?s.from():s.to();var o=tt(i,s.head,"div");null!=s.goalColumn&&(o.left=s.goalColumn),r.push(o.left);var l=di(i,o,e,t);return"page"==t&&s==n.sel.primary()&&ai(i,null,et(i,l,"div").top-o.top),l},Wa),r.length)for(var s=0;s<n.sel.ranges.length;s++)n.sel.ranges[s].goalColumn=r[s]}),findWordAt:function(e){var t=cn(this.doc,e.line).text,i=e.ch,n=e.ch;if(t){var r=this.getHelper(e,"wordChars");(e.xRel<0||n==t.length)&&i?--i:++n;for(var a=t.charAt(i),s=Yn(a,r)?function(e){return Yn(e,r)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Yn(e)};i>0&&s(t.charAt(i-1));)--i;for(;n<t.length&&s(t.charAt(n));)++n}return new se(Hr(e.line,i),Hr(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?ts(this.display.cursorDiv,"CodeMirror-overwrite"):es(this.display.cursorDiv,"CodeMirror-overwrite"),Ra(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==er()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:vt(function(e,t){null==e&&null==t||oi(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Be(this)-this.display.barHeight,width:e.scrollWidth-Be(this)-this.display.barWidth,clientHeight:Fe(this),clientWidth:je(this)}},scrollIntoView:vt(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Hr(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)oi(this),this.curOp.scrollToPos=e;else{var i=ri(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(i.scrollLeft,i.scrollTop)}}),setSize:vt(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var n=this;null!=e&&(n.display.wrapper.style.width=i(e)),null!=t&&(n.display.wrapper.style.height=i(t)),n.options.lineWrapping&&Ye(this);var r=n.display.viewFrom;n.doc.iter(r,n.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){St(n,r,"widget");break}++r}),n.curOp.forceUpdate=!0,Ra(n,"refresh",this)}),operation:function(e){return mt(this,e)},refresh:vt(function(){var e=this.display.cachedTextHeight;Tt(this),this.curOp.forceUpdate=!0,Xe(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),u(this),(null==e||Math.abs(e-st(this.display))>.5)&&a(this),Ra(this,"refresh",this)}),swapDoc:vt(function(e){var t=this.doc;return t.cm=null,un(this,e),Xe(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,Mn(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Bn(e);var na=e.defaults={},ra=e.optionHandlers={},aa=e.Init={toString:function(){return"CodeMirror.Init"}};fi("value","",function(e,t){e.setValue(t)},!0),fi("mode",null,function(e,t){e.doc.modeOption=t,i(e)},!0),fi("indentUnit",2,i,!0),fi("indentWithTabs",!1),fi("smartIndent",!0),fi("tabSize",4,function(e){n(e),Xe(e),Tt(e)},!0),fi("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var i=[],n=e.doc.first;e.doc.iter(function(e){for(var r=0;;){var a=e.text.indexOf(t,r);if(-1==a)break;r=a+t.length,i.push(Hr(n,a))}n++});for(var r=i.length-1;r>=0;r--)ni(e.doc,t,i[r],Hr(i[r].line,i[r].ch+t.length))}}),fi("specialChars",/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,i,n){t.state.specialChars=new RegExp(i.source+(i.test("\t")?"":"|\t"),"g"),n!=e.Init&&t.refresh()}),fi("specialCharPlaceholder",function(e){var t=Qn("span","\u2022","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t},function(e){e.refresh()},!0),fi("electricChars",!0),fi("inputStyle",Ir?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),fi("rtlMoveVisually",!Ur),fi("wholeLineUpdateBefore",!0),fi("theme","default",function(e){s(e),o(e)},!0),fi("keyMap","default",function(t,i,n){var r=mi(i),a=n!=e.Init&&mi(n);a&&a.detach&&a.detach(t,r),r.attach&&r.attach(t,a||null)}),fi("extraKeys",null),fi("lineWrapping",!1,function(e){e.options.lineWrapping?(ts(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(es(e.display.wrapper,"CodeMirror-wrap"),h(e)),a(e),Tt(e),Xe(e),setTimeout(function(){v(e)},100)},!0),fi("gutters",[],function(e){d(e.options),o(e)},!0),fi("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?k(e.display)+"px":"0",e.refresh()},!0),fi("coverGutterNextToScrollbar",!1,function(e){v(e)},!0),fi("scrollbarStyle","native",function(e){g(e),v(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),fi("lineNumbers",!1,function(e){d(e.options),o(e)},!0),fi("firstLineNumber",1,o,!0),fi("lineNumberFormatter",function(e){return e},o,!0),fi("showCursorWhenSelecting",!1,Ee,!0),fi("resetSelectionOnContextMenu",!0),fi("lineWiseCopyCut",!0),fi("readOnly",!1,function(e,t){"nocursor"==t?(Vt(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),fi("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),fi("dragDrop",!0,function(t,i,n){if(!i!=!(n&&n!=e.Init)){var r=t.display.dragFunctions,a=i?Ma:Ua;a(t.display.scroller,"dragstart",r.start),a(t.display.scroller,"dragenter",r.enter),a(t.display.scroller,"dragover",r.over),a(t.display.scroller,"dragleave",r.leave),a(t.display.scroller,"drop",r.drop)}}),fi("allowDropFileTypes",null),fi("cursorBlinkRate",530),fi("cursorScrollMargin",0),fi("cursorHeight",1,Ee,!0),fi("singleCursorHeightPerLine",!0,Ee,!0),fi("workTime",100),fi("workDelay",100),fi("flattenSpans",!0,n,!0),fi("addModeClass",!1,n,!0),fi("pollInterval",100),fi("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),fi("historyEventDelay",1250),fi("viewportMargin",10,function(e){e.refresh()},!0),fi("maxHighlightLength",1e4,n,!0),fi("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),fi("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),fi("autofocus",null);var sa=e.modes={},oa=e.mimeModes={};e.defineMode=function(t,i){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(i.dependencies=Array.prototype.slice.call(arguments,2)),sa[t]=i},e.defineMIME=function(e,t){oa[e]=t},e.resolveMode=function(t){if("string"==typeof t&&oa.hasOwnProperty(t))t=oa[t];else if(t&&"string"==typeof t.name&&oa.hasOwnProperty(t.name)){var i=oa[t.name];"string"==typeof i&&(i={name:i}),(t=Vn(i,t)).name=i.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,i){i=e.resolveMode(i);var n=sa[i.name];if(!n)return e.getMode(t,"text/plain");var r=n(t,i);if(la.hasOwnProperty(i.name)){var a=la[i.name];for(var s in a)a.hasOwnProperty(s)&&(r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=a[s])}if(r.name=i.name,i.helperType&&(r.helperType=i.helperType),i.modeProps)for(var s in i.modeProps)r[s]=i.modeProps[s];return r},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var la=e.modeExtensions={};e.extendMode=function(e,t){Gn(t,la.hasOwnProperty(e)?la[e]:la[e]={})},e.defineExtension=function(t,i){e.prototype[t]=i},e.defineDocExtension=function(e,t){Ea.prototype[e]=t},e.defineOption=fi;var ua=[];e.defineInitHook=function(e){ua.push(e)};var ca=e.helpers={};e.registerHelper=function(t,i,n){ca.hasOwnProperty(t)||(ca[t]=e[t]={_global:[]}),ca[t][i]=n},e.registerGlobalHelper=function(t,i,n,r){e.registerHelper(t,i,r),ca[t]._global.push({pred:n,val:r})};var ha=e.copyState=function(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var i={};for(var n in t){var r=t[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i},da=e.startState=function(e,t,i){return!e.startState||e.startState(t,i)};e.innerMode=function(e,t){for(;e.innerMode;){var i=e.innerMode(t);if(!i||i.mode==e)break;t=i.state,e=i.mode}return i||{mode:e,state:t}};var fa=e.commands={selectAll:function(e){e.setSelection(Hr(e.firstLine(),0),Hr(e.lastLine()),Fa)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Fa)},killLine:function(e){ci(e,function(t){if(t.empty()){var i=cn(e.doc,t.head.line).text.length;return t.head.ch==i&&t.head.line<e.lastLine()?{from:t.head,to:Hr(t.head.line+1,0)}:{from:t.head,to:Hr(t.head.line,i)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){ci(e,function(t){return{from:Hr(t.from().line,0),to:ce(e.doc,Hr(t.to().line+1,0))}})},delLineLeft:function(e){ci(e,function(e){return{from:Hr(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){ci(e,function(t){var i=e.charCoords(t.head,"div").top+5;return{from:e.coordsChar({left:0,top:i},"div"),to:t.from()}})},delWrappedLineRight:function(e){ci(e,function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:n}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Hr(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Hr(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return cr(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return hr(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return function(e,t){for(var i,n=cn(e.doc,t);i=Ii(n);)n=i.find(1,!0).line,t=null;var r=vn(n),a=r?r[0].level%2?lr(n):ur(n):n.text.length;return Hr(null==t?pn(n):t,a)}(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:i},"div")},Wa)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:i},"div")},Wa)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var i=e.charCoords(t.head,"div").top+5,n=e.coordsChar({left:0,top:i},"div");return n.ch<e.getLine(n.line).search(/\S/)?hr(e,t.head):n},Wa)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],i=e.listSelections(),n=e.options.tabSize,r=0;r<i.length;r++){var a=i[r].from(),s=za(e.getLine(a.line),a.ch,n);t.push(Fn(n-s%n))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){mt(e,function(){for(var t=e.listSelections(),i=[],n=0;n<t.length;n++){var r=t[n].head,a=cn(e.doc,r.line).text;if(a)if(r.ch==a.length&&(r=new Hr(r.line,r.ch-1)),r.ch>0)r=new Hr(r.line,r.ch+1),e.replaceRange(a.charAt(r.ch-1)+a.charAt(r.ch-2),Hr(r.line,r.ch-2),r,"+transpose");else if(r.line>e.doc.first){var s=cn(e.doc,r.line-1).text;s&&e.replaceRange(a.charAt(0)+e.doc.lineSeparator()+s.charAt(s.length-1),Hr(r.line-1,s.length-1),Hr(r.line,1),"+transpose")}i.push(new se(r,r))}e.setSelections(i)})},newlineAndIndent:function(e){mt(e,function(){for(var t=e.listSelections().length,i=0;t>i;i++){var n=e.listSelections()[i];e.replaceRange(e.doc.lineSeparator(),n.anchor,n.head,"+input"),e.indentLine(n.from().line+1,null,!0)}si(e)})},openLine:function(e){e.replaceSelection("\n","start")},toggleOverwrite:function(e){e.toggleOverwrite()}},pa=e.keyMap={};pa.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},pa.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},pa.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},pa.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},pa.default=Mr?pa.macDefault:pa.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];if(/^(name|fallthrough|(de|at)tach)$/.test(i))continue;if("..."==n){delete e[i];continue}for(var r=zn(i.split(" "),pi),a=0;a<r.length;a++){var s,o;a==r.length-1?(o=r.join(" "),s=n):(o=r.slice(0,a+1).join(" "),s="...");var l=t[o];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+o)}else t[o]=s}delete e[i]}for(var u in t)e[u]=t[u];return e};var ma=e.lookupKey=function(e,t,i,n){var r=(t=mi(t)).call?t.call(e,n):t[e];if(!1===r)return"nothing";if("..."===r)return"multi";if(null!=r&&i(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ma(e,t.fallthrough,i,n);for(var a=0;a<t.fallthrough.length;a++){var s=ma(e,t.fallthrough[a],i,n);if(s)return s}}},ga=e.isModifierKey=function(e){var t="string"==typeof e?e:ls[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},va=e.keyName=function(e,t){if(Er&&34==e.keyCode&&e.char)return!1;var i=ls[e.keyCode],n=i;return null!=n&&!e.altGraphKey&&(e.altKey&&"Alt"!=i&&(n="Alt-"+n),(Nr?e.metaKey:e.ctrlKey)&&"Ctrl"!=i&&(n="Ctrl-"+n),(Nr?e.ctrlKey:e.metaKey)&&"Cmd"!=i&&(n="Cmd-"+n),!t&&e.shiftKey&&"Shift"!=i&&(n="Shift-"+n),n)};e.fromTextArea=function(t,i){function n(){t.value=u.getValue()}if((i=i?Gn(i):{}).value=t.value,!i.tabindex&&t.tabIndex&&(i.tabindex=t.tabIndex),!i.placeholder&&t.placeholder&&(i.placeholder=t.placeholder),null==i.autofocus){var r=er();i.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}if(t.form&&(Ma(t.form,"submit",n),!i.leaveSubmitMethodAlone)){var a=t.form,s=a.submit;try{var l=a.submit=function(){n(),a.submit=s,a.submit(),a.submit=l}}catch(o){}}i.finishInit=function(e){e.save=n,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,n(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Ua(t.form,"submit",n),"function"==typeof t.form.submit&&(t.form.submit=s))}},t.style.display="none";var u=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},i);return u};var ya=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ya.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var i=t==e;else i=t&&(e.test?e.test(t):e(t));return i?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=za(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?za(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return za(this.string,null,this.tabSize)-(this.lineStart?za(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,i){if("string"!=typeof e){var n=this.string.slice(this.pos).match(e);return n&&n.index>0?null:(n&&!1!==t&&(this.pos+=n[0].length),n)}var r=function(e){return i?e.toLowerCase():e};return r(this.string.substr(this.pos,e.length))==r(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ba=0,_a=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ba};Bn(_a),_a.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&lt(e),Nn(this,"clear")){var i=this.find();i&&Mn(this,"clear",i.from,i.to)}for(var n=null,r=null,a=0;a<this.lines.length;++a){var s=this.lines[a],o=_i(s.markedSpans,this);e&&!this.collapsed?St(e,pn(s),"text"):e&&(null!=o.to&&(r=pn(s)),null!=o.from&&(n=pn(s))),s.markedSpans=Ti(s.markedSpans,o),null==o.from&&this.collapsed&&!Ni(this.doc,s)&&e&&fn(s,st(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(a=0;a<this.lines.length;++a){var l=Di(this.lines[a]),u=c(l);u>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=u,e.display.maxLineChanged=!0)}null!=n&&e&&this.collapsed&&Tt(e,n,r+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Se(e.doc)),e&&Mn(e,"markerCleared",e,this),t&&ut(e),this.parent&&this.parent.clear()}},_a.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var i,n,r=0;r<this.lines.length;++r){var a=this.lines[r],s=_i(a.markedSpans,this);if(null!=s.from&&(i=Hr(t?a:pn(a),s.from),-1==e))return i;if(null!=s.to&&(n=Hr(t?a:pn(a),s.to),1==e))return n}return i&&{from:i,to:n}},_a.prototype.changed=function(){var e=this.find(-1,!0),t=this,i=this.doc.cm;e&&i&&mt(i,function(){var n=e.line,r=pn(e.line),a=ze(i,r);if(a&&($e(a),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!Ni(t.doc,n)&&null!=t.height){var s=t.height;t.height=null;var o=Fi(t)-s;o&&fn(n,n.height+o)}})},_a.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Wn(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},_a.prototype.detachLine=function(e){if(this.lines.splice(Wn(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},ba=0;var Ta=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var i=0;i<e.length;++i)e[i].parent=this};Bn(Ta),Ta.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Mn(this,"clear")}},Ta.prototype.find=function(e,t){return this.primary.find(e,t)};var Sa=e.LineWidget=function(e,t,i){if(i)for(var n in i)i.hasOwnProperty(n)&&(this[n]=i[n]);this.doc=e,this.node=t};Bn(Sa),Sa.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,i=this.line,n=pn(i);if(null!=n&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(i.widgets=null);var a=Fi(this);fn(i,Math.max(0,i.height-a)),e&&mt(e,function(){ji(e,i,-a),St(e,n,"widget")})}},Sa.prototype.changed=function(){var e=this.height,t=this.doc.cm,i=this.line;this.height=null;var n=Fi(this)-e;n&&(fn(i,i.height+n),t&&mt(t,function(){t.curOp.forceUpdate=!0,ji(t,i,n)}))};var ka=e.Line=function(e,t,i){this.text=e,xi(this,t),this.height=i?i(this):1};Bn(ka),ka.prototype.lineNo=function(){return pn(this)};var wa={},Ca={};sn.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i=e,n=e+t;n>i;++i){var r=this.lines[i];this.height-=r.height,Hi(r),Mn(r,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var n=0;n<t.length;++n)t[n].parent=this},iterN:function(e,t,i){for(var n=e+t;n>e;++e)if(i(this.lines[e]))return!0}},on.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var i=0;i<this.children.length;++i){var n=this.children[i],r=n.chunkSize();if(r>e){var a=Math.min(t,r-e),s=n.height;if(n.removeInner(e,a),this.height-=s-n.height,r==a&&(this.children.splice(i--,1),n.parent=null),0==(t-=a))break;e=0}else e-=r}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof sn))){var o=[];this.collapse(o),this.children=[new sn(o)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){this.size+=t.length,this.height+=i;for(var n=0;n<this.children.length;++n){var r=this.children[n],a=r.chunkSize();if(a>=e){if(r.insertInner(e,t,i),r.lines&&r.lines.length>50){for(var s=r.lines.length%25+25,o=s;o<r.lines.length;){var l=new sn(r.lines.slice(o,o+=25));r.height-=l.height,this.children.splice(++n,0,l),l.parent=this}r.lines=r.lines.slice(0,s),this.maybeSpill()}break}e-=a}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=new on(e.children.splice(e.children.length-5,5));if(e.parent){e.size-=t.size,e.height-=t.height;var i=Wn(e.parent.children,e);e.parent.children.splice(i+1,0,t)}else{var n=new on(e.children);n.parent=e,e.children=[n,t],e=n}t.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var n=0;n<this.children.length;++n){var r=this.children[n],a=r.chunkSize();if(a>e){var s=Math.min(t,a-e);if(r.iterN(e,s,i))return!0;if(0==(t-=s))break;e=0}else e-=a}}};var xa=0,Ea=e.Doc=function(e,t,i,n){if(!(this instanceof Ea))return new Ea(e,t,i,n);null==i&&(i=0),on.call(this,[new sn([new ka("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=i;var r=Hr(i,0);this.sel=le(r),this.history=new yn(null),this.id=++xa,this.modeOption=t,this.lineSep=n,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),an(this,{from:r,to:r,text:e}),be(this,le(r),Fa)};Ea.prototype=Vn(on.prototype,{constructor:Ea,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,n=0;n<t.length;++n)i+=t[n].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=dn(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:yt(function(e){var t=Hr(this.first,0),i=this.first+this.size-1;Qt(this,{from:t,to:Hr(i,cn(this,i).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),be(this,le(t))}),replaceRange:function(e,t,i,n){ni(this,e,t=ce(this,t),i=i?ce(this,i):t,n)},getRange:function(e,t,i){var n=hn(this,ce(this,e),ce(this,t));return!1===i?n:n.join(i||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return he(this,e)?cn(this,e):void 0},getLineNumber:function(e){return pn(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=cn(this,e)),Di(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return ce(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:yt(function(e,t,i){ve(this,ce(this,"number"==typeof e?Hr(e,t||0):e),null,i)}),setSelection:yt(function(e,t,i){ve(this,ce(this,e),ce(this,t||e),i)}),extendSelection:yt(function(e,t,i){pe(this,ce(this,e),t&&ce(this,t),i)}),extendSelections:yt(function(e,t){me(this,de(this,e),t)}),extendSelectionsBy:yt(function(e,t){me(this,de(this,zn(this.sel.ranges,e)),t)}),setSelections:yt(function(e,t,i){if(e.length){for(var n=0,r=[];n<e.length;n++)r[n]=new se(ce(this,e[n].anchor),ce(this,e[n].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),be(this,oe(r,t),i)}}),addSelection:yt(function(e,t,i){var n=this.sel.ranges.slice(0);n.push(new se(ce(this,e),ce(this,t||e))),be(this,oe(n,n.length-1),i)}),getSelection:function(e){for(var t,i=this.sel.ranges,n=0;n<i.length;n++){var r=hn(this,i[n].from(),i[n].to());t=t?t.concat(r):r}return!1===e?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],i=this.sel.ranges,n=0;n<i.length;n++){var r=hn(this,i[n].from(),i[n].to());!1!==e&&(r=r.join(e||this.lineSeparator())),t[n]=r}return t},replaceSelection:function(e,t,i){for(var n=[],r=0;r<this.sel.ranges.length;r++)n[r]=e;this.replaceSelections(n,t,i||"+input")},replaceSelections:yt(function(e,t,i){for(var n=[],r=this.sel,a=0;a<r.ranges.length;a++){var s=r.ranges[a];n[a]={from:s.from(),to:s.to(),text:this.splitLines(e[a]),origin:i}}var o=t&&"end"!=t&&function(e,t,i){for(var n=[],r=Hr(e.first,0),a=r,s=0;s<t.length;s++){var o=t[s],l=Xt(o.from,r,a),u=Xt(ia(o),r,a);if(r=o.to,a=u,"around"==i){var c=e.sel.ranges[s],h=Wr(c.head,c.anchor)<0;n[s]=new se(h?u:l,h?l:u)}else n[s]=new se(l,l)}return new ae(n,e.sel.primIndex)}(this,n,t);for(a=n.length-1;a>=0;a--)Qt(this,n[a]);o?ye(this,o):this.cm&&si(this.cm)}),undo:yt(function(){Zt(this,"undo")}),redo:yt(function(){Zt(this,"redo")}),undoSelection:yt(function(){Zt(this,"undo",!0)}),redoSelection:yt(function(){Zt(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,i=0,n=0;n<e.done.length;n++)e.done[n].ranges||++t;for(n=0;n<e.undone.length;n++)e.undone[n].ranges||++i;return{undo:t,redo:i}},clearHistory:function(){this.history=new yn(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Cn(this.history.done),undone:Cn(this.history.undone)}},setHistory:function(e){var t=this.history=new yn(this.history.maxGeneration);t.done=Cn(e.done.slice(0),null,!0),t.undone=Cn(e.undone.slice(0),null,!0)},addLineClass:yt(function(e,t,i){return ui(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[n]){if(tr(i).test(e[n]))return!1;e[n]+=" "+i}else e[n]=i;return!0})}),removeLineClass:yt(function(e,t,i){return ui(this,e,"gutter"==t?"gutter":"class",function(e){var n="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",r=e[n];if(!r)return!1;if(null==i)e[n]=null;else{var a=r.match(tr(i));if(!a)return!1;var s=a.index+a[0].length;e[n]=r.slice(0,a.index)+(a.index&&s!=r.length?" ":"")+r.slice(s)||null}return!0})}),addLineWidget:yt(function(e,t,i){return function(e,t,i,n){var r=new Sa(e,i,n),a=e.cm;return a&&r.noHScroll&&(a.display.alignWidgets=!0),ui(e,t,"widget",function(t){var i=t.widgets||(t.widgets=[]);if(null==r.insertAt?i.push(r):i.splice(Math.min(i.length-1,Math.max(0,r.insertAt)),0,r),r.line=t,a&&!Ni(e,t)){var n=gn(t)<e.scrollTop;fn(t,t.height+Fi(r)),n&&ai(a,null,r.height),a.curOp.forceUpdate=!0}return!0}),r}(this,e,t,i)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return gi(this,ce(this,e),ce(this,t),i,i&&i.type||"range")},setBookmark:function(e,t){var i={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return gi(this,e=ce(this,e),e,i,"bookmark")},findMarksAt:function(e){var t=[],i=cn(this,(e=ce(this,e)).line).markedSpans;if(i)for(var n=0;n<i.length;++n){var r=i[n];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(e,t,i){e=ce(this,e),t=ce(this,t);var n=[],r=e.line;return this.iter(e.line,t.line+1,function(a){var s=a.markedSpans;if(s)for(var o=0;o<s.length;o++){var l=s[o];null!=l.to&&r==e.line&&e.ch>=l.to||null==l.from&&r!=e.line||null!=l.from&&r==t.line&&l.from>=t.ch||i&&!i(l.marker)||n.push(l.marker.parent||l.marker)}++r}),n},getAllMarks:function(){var e=[];return this.iter(function(t){var i=t.markedSpans;if(i)for(var n=0;n<i.length;++n)null!=i[n].from&&e.push(i[n].marker)}),e},posFromIndex:function(e){var t,i=this.first,n=this.lineSeparator().length;return this.iter(function(r){var a=r.text.length+n;return a>e?(t=e,!0):(e-=a,void++i)}),ce(this,Hr(i,t))},indexFromPos:function(e){var t=(e=ce(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var i=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+i}),t},copy:function(e){var t=new Ea(dn(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,i=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to);var n=new Ea(dn(this,t,i),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(n.history=this.history),(this.linked||(this.linked=[])).push({doc:n,sharedHist:e.sharedHist}),n.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var i=0;i<t.length;i++){var n=t[i],r=n.find(),a=e.clipPos(r.from),s=e.clipPos(r.to);if(Wr(a,s)){var o=gi(e,a,s,n.primary,n.primary.type);n.markers.push(o),o.parent=n}}}(n,vi(this)),n},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var i=0;i<this.linked.length;++i)if(this.linked[i].doc==t){this.linked.splice(i,1),t.unlinkDoc(this),yi(vi(this));break}if(t.history==this.history){var n=[t.id];ln(t,function(e){n.push(e.id)},!0),t.history=new yn(null),t.history.done=Cn(this.history.done,n),t.history.undone=Cn(this.history.undone,n)}},iterLinkedDocs:function(e){ln(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):rs(e)},lineSeparator:function(){return this.lineSep||"\n"}}),Ea.prototype.eachLine=Ea.prototype.iter;var La="iter insert remove copy getEditor constructor".split(" ");for(var Aa in Ea.prototype)Ea.prototype.hasOwnProperty(Aa)&&Wn(La,Aa)<0&&(e.prototype[Aa]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ea.prototype[Aa]));Bn(Ea);var Pa=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},Oa=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Ia=e.e_stop=function(e){Pa(e),Oa(e)},Ma=e.on=function(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else{var n=e._handlers||(e._handlers={});(n[t]||(n[t]=[])).push(i)}},Da=[],Ua=e.off=function(e,t,i){if(e.removeEventListener)e.removeEventListener(t,i,!1);else if(e.detachEvent)e.detachEvent("on"+t,i);else for(var n=In(e,t,!1),r=0;r<n.length;++r)if(n[r]==i){n.splice(r,1);break}},Ra=e.signal=function(e,t){var i=In(e,t,!0);if(i.length)for(var n=Array.prototype.slice.call(arguments,2),r=0;r<i.length;++r)i[r].apply(null,n)},Na=null,Ba=30,ja=e.Pass={toString:function(){return"CodeMirror.Pass"}},Fa={scroll:!1},Ha={origin:"*mouse"},Wa={origin:"+move"};jn.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var za=e.countColumn=function(e,t,i,n,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var a=n||0,s=r||0;;){var o=e.indexOf("\t",a);if(0>o||o>=t)return s+(t-a);s+=o-a,s+=i-s%i,a=o+1}},qa=e.findColumn=function(e,t,i){for(var n=0,r=0;;){var a=e.indexOf("\t",n);-1==a&&(a=e.length);var s=a-n;if(a==e.length||r+s>=t)return n+Math.min(s,t-r);if(r+=a-n,n=a+1,(r+=i-r%i)>=t)return n}},Va=[""],Ga=function(e){e.select()};Or?Ga=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:Sr&&(Ga=function(e){try{e.select()}catch(t){}});var $a,Ya=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Xa=e.isWordChar=function(e){return/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Ya.test(e))},Ka=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;$a=document.createRange?function(e,t,i,n){var r=document.createRange();return r.setEnd(n||e,i),r.setStart(e,t),r}:function(e,t,i){var n=document.body.createTextRange();try{n.moveToElementText(e.parentNode)}catch(r){return n}return n.collapse(!0),n.moveEnd("character",i),n.moveStart("character",t),n};var Qa=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)};Sr&&11>kr&&(er=function(){try{return document.activeElement}catch(e){return document.body}});var Ja,Za,es=e.rmClass=function(e,t){var i=e.className,n=tr(t).exec(i);if(n){var r=i.slice(n.index+n[0].length);e.className=i.slice(0,n.index)+(r?n[1]+r:"")}},ts=e.addClass=function(e,t){var i=e.className;tr(t).test(i)||(e.className+=(i?" ":"")+t)},is=!1,ns=function(){if(Sr&&9>kr)return!1;var e=Qn("div");return"draggable"in e||"dragDrop"in e}(),rs=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,i=[],n=e.length;n>=t;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var a=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),s=a.indexOf("\r");-1!=s?(i.push(a.slice(0,s)),t+=s+1):(i.push(a),t=r+1)}return i}:function(e){return e.split(/\r\n?|\n/)},as=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(i){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},ss=function(){var e=Qn("div");return"oncopy"in e||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),os=null,ls=e.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var e=0;10>e;e++)ls[e+48]=ls[e+96]=String(e);for(e=65;90>=e;e++)ls[e]=String.fromCharCode(e);for(e=1;12>=e;e++)ls[e+111]=ls[e+63235]="F"+e}();var us,cs=function(){function e(e){return 247>=e?i.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?n.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,i){this.level=e,this.from=t,this.to=i}var i="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,a=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,l=/[1n]/,u="L";return function(i){if(!r.test(i))return!1;for(var n=i.length,c=[],h=0;n>h;++h)c.push(v=e(i.charCodeAt(h)));h=0;for(var d=u;n>h;++h)"m"==(v=c[h])?c[h]=d:d=v;h=0;for(var f=u;n>h;++h)"1"==(v=c[h])&&"r"==f?c[h]="n":s.test(v)&&(f=v,"r"==v&&(c[h]="R"));for(h=1,d=c[0];n-1>h;++h)"+"==(v=c[h])&&"1"==d&&"1"==c[h+1]?c[h]="1":","!=v||d!=c[h+1]||"1"!=d&&"n"!=d||(c[h]=d),d=v;for(h=0;n>h;++h)if(","==(v=c[h]))c[h]="N";else if("%"==v){for(var p=h+1;n>p&&"%"==c[p];++p);for(var m=h&&"!"==c[h-1]||n>p&&"1"==c[p]?"1":"N",g=h;p>g;++g)c[g]=m;h=p-1}for(h=0,f=u;n>h;++h){var v=c[h];"L"==f&&"1"==v?c[h]="L":s.test(v)&&(f=v)}for(h=0;n>h;++h)if(a.test(c[h])){for(p=h+1;n>p&&a.test(c[p]);++p);for(m="L"==(h?c[h-1]:u)||"L"==(n>p?c[p]:u)?"L":"R",g=h;p>g;++g)c[g]=m;h=p-1}var y,b=[];for(h=0;n>h;)if(o.test(c[h])){var _=h;for(++h;n>h&&o.test(c[h]);++h);b.push(new t(0,_,h))}else{var T=h,S=b.length;for(++h;n>h&&"L"!=c[h];++h);for(g=T;h>g;)if(l.test(c[g])){g>T&&b.splice(S,0,new t(1,T,g));var k=g;for(++g;h>g&&l.test(c[g]);++g);b.splice(S,0,new t(2,k,g)),T=g}else++g;h>T&&b.splice(S,0,new t(1,T,h))}return 1==b[0].level&&(y=i.match(/^\s+/))&&(b[0].from=y[0].length,b.unshift(new t(0,0,y[0].length))),1==Hn(b).level&&(y=i.match(/\s+$/))&&(Hn(b).to-=y[0].length,b.push(new t(0,n-y[0].length,n))),2==b[0].level&&b.unshift(new t(1,b[0].to,b[0].to)),b[0].level!=Hn(b).level&&b.push(new t(b[0].level,n,n)),b}}();return e.version="5.15.2",e})},{}],11:[function(e,t,i){var n;n=function(e){"use strict";var t=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\.beep|\.lwz|\.xpc|\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\.beeps?|xmpp|xri|ymsgr|z39\.50[rs]?):(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?\xab\xbb\u201c\u201d\u2018\u2019]))/i;e.defineMode("gfm",function(i,n){var r=0,a={startState:function(){return{code:!1,codeBlock:!1,ateSpace:!1}},copyState:function(e){return{code:e.code,codeBlock:e.codeBlock,ateSpace:e.ateSpace}},token:function(e,i){if(i.combineTokens=null,i.codeBlock)return e.match(/^```+/)?(i.codeBlock=!1,null):(e.skipToEnd(),null);if(e.sol()&&(i.code=!1),e.sol()&&e.match(/^```+/))return e.skipToEnd(),i.codeBlock=!0,null;if("`"===e.peek()){e.next();var a=e.pos;e.eatWhile("`");var s=1+e.pos-a;return i.code?s===r&&(i.code=!1):(r=s,i.code=!0),null}if(i.code)return e.next(),null;if(e.eatSpace())return i.ateSpace=!0,null;if((e.sol()||i.ateSpace)&&(i.ateSpace=!1,!1!==n.gitHubSpice)){if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+@)?(?:[a-f0-9]{7,40}\b)/))return i.combineTokens=!0,"link";if(e.match(/^(?:[a-zA-Z0-9\-_]+\/)?(?:[a-zA-Z0-9\-_]+)?#[0-9]+\b/))return i.combineTokens=!0,"link"}return e.match(t)&&"]("!=e.string.slice(e.start-2,e.start)&&(0==e.start||/\W/.test(e.string.charAt(e.start-1)))?(i.combineTokens=!0,"link"):(e.next(),null)},blankLine:function(e){return e.code=!1,null}},s={underscoresBreakWords:!1,taskLists:!0,fencedCodeBlocks:"```",strikethrough:!0};for(var o in n)s[o]=n[o];return s.name="markdown",e.overlayMode(e.getMode(i,s),a)},"markdown"),e.defineMIME("text/x-gfm","gfm")},"object"==typeof i&&"object"==typeof t?n(e("../../lib/codemirror"),e("../markdown/markdown"),e("../../addon/mode/overlay")):n(CodeMirror)},{"../../addon/mode/overlay":8,"../../lib/codemirror":10,"../markdown/markdown":12}],12:[function(e,t,i){var n;n=function(e){"use strict";e.defineMode("markdown",function(t,i){function n(i){if(e.findModeByName){var n=e.findModeByName(i);n&&(i=n.mime||n.mimes[0])}var r=e.getMode(t,i);return"null"==r.name?null:r}function r(e,t,i){return t.f=t.inline=i,i(e,t)}function a(e){return!e||!/\S/.test(e.string)}function s(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.strikethrough=!1,e.quote=0,e.indentedCode=!1,_&&e.f==l&&(e.f=f,e.block=o),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.prevLine=e.thisLine,e.thisLine=null,null}function o(t,s){var o=t.sol(),l=!1!==s.list,c=s.indentedCode;s.indentedCode=!1,l&&(s.indentationDiff>=0?(s.indentationDiff<4&&(s.indentation-=s.indentationDiff),s.list=null):s.list=s.indentation>0&&null);var d=null;if(s.indentationDiff>=4)return t.skipToEnd(),c||a(s.prevLine)?(s.indentation-=4,s.indentedCode=!0,T.code):null;if(t.eatSpace())return null;if((d=t.match(E))&&d[1].length<=6)return s.header=d[1].length,i.highlightFormatting&&(s.formatting="header"),s.f=s.inline,h(s);if(!(a(s.prevLine)||s.quote||l||c)&&(d=t.match(L)))return s.header="="==d[0].charAt(0)?1:2,i.highlightFormatting&&(s.formatting="header"),s.f=s.inline,h(s);if(t.eat(">"))return s.quote=o?1:s.quote+1,i.highlightFormatting&&(s.formatting="quote"),t.eatSpace(),h(s);if("["===t.peek())return r(t,s,g);if(t.match(k,!0))return s.hr=!0,T.hr;if((a(s.prevLine)||l)&&(t.match(w,!1)||t.match(C,!1))){var f=null;for(t.match(w,!0)?f="ul":(t.match(C,!0),f="ol"),s.indentation=t.column()+t.current().length,s.list=!0;s.listStack&&t.column()<s.listStack[s.listStack.length-1];)s.listStack.pop();return s.listStack.push(s.indentation),i.taskLists&&t.match(x,!1)&&(s.taskList=!0),s.f=s.inline,i.highlightFormatting&&(s.formatting=["list","list-"+f]),h(s)}return i.fencedCodeBlocks&&(d=t.match(P,!0))?(s.fencedChars=d[1],s.localMode=n(d[2]),s.localMode&&(s.localState=e.startState(s.localMode)),s.f=s.block=u,i.highlightFormatting&&(s.formatting="code-block"),s.code=-1,h(s)):r(t,s,s.inline)}function l(t,i){var n=b.token(t,i.htmlState);if(!_){var r=e.innerMode(b,i.htmlState);("xml"==r.mode.name&&null===r.state.tagStart&&!r.state.context&&r.state.tokenize.isInText||i.md_inside&&t.current().indexOf(">")>-1)&&(i.f=f,i.block=o,i.htmlState=null)}return n}function u(e,t){return t.fencedChars&&e.match(t.fencedChars,!1)?(t.localMode=t.localState=null,t.f=t.block=c,null):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),T.code)}function c(e,t){e.match(t.fencedChars),t.block=o,t.f=f,t.fencedChars=null,i.highlightFormatting&&(t.formatting="code-block"),t.code=1;var n=h(t);return t.code=0,n}function h(e){var t=[];if(e.formatting){t.push(T.formatting),"string"==typeof e.formatting&&(e.formatting=[e.formatting]);for(var n=0;n<e.formatting.length;n++)t.push(T.formatting+"-"+e.formatting[n]),"header"===e.formatting[n]&&t.push(T.formatting+"-"+e.formatting[n]+"-"+e.header),"quote"===e.formatting[n]&&t.push(!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=e.quote?T.formatting+"-"+e.formatting[n]+"-"+e.quote:"error")}if(e.taskOpen)return t.push("meta"),t.length?t.join(" "):null;if(e.taskClosed)return t.push("property"),t.length?t.join(" "):null;if(e.linkHref?t.push(T.linkHref,"url"):(e.strong&&t.push(T.strong),e.em&&t.push(T.em),e.strikethrough&&t.push(T.strikethrough),e.linkText&&t.push(T.linkText),e.code&&t.push(T.code)),e.header&&t.push(T.header,T.header+"-"+e.header),e.quote&&(t.push(T.quote),t.push(!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=e.quote?T.quote+"-"+e.quote:T.quote+"-"+i.maxBlockquoteDepth)),!1!==e.list){var r=(e.listStack.length-1)%3;t.push(r?1===r?T.list2:T.list3:T.list1)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function d(e,t){return e.match(A,!0)?h(t):void 0}function f(t,n){var r=n.text(t,n);if(void 0!==r)return r;if(n.list)return n.list=null,h(n);if(n.taskList)return"x"!==t.match(x,!0)[1]?n.taskOpen=!0:n.taskClosed=!0,i.highlightFormatting&&(n.formatting="task"),n.taskList=!1,h(n);if(n.taskOpen=!1,n.taskClosed=!1,n.header&&t.match(/^#+$/,!0))return i.highlightFormatting&&(n.formatting="header"),h(n);var a=t.sol(),s=t.next();if(n.linkTitle){n.linkTitle=!1;var o=s;if("("===s&&(o=")"),o=(o+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),t.match(new RegExp("^\\s*(?:[^"+o+"\\\\]+|\\\\\\\\|\\\\.)"+o),!0))return T.linkHref}if("`"===s){var u=n.formatting;i.highlightFormatting&&(n.formatting="code"),t.eatWhile("`");var c=t.current().length;if(0==n.code)return n.code=c,h(n);if(c==n.code){var d=h(n);return n.code=0,d}return n.formatting=u,h(n)}if(n.code)return h(n);if("\\"===s&&(t.next(),i.highlightFormatting)){var f=h(n),g=T.formatting+"-escape";return f?f+" "+g:g}if("!"===s&&t.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return t.match(/\[[^\]]*\]/),n.inline=n.f=m,T.image;if("["===s&&t.match(/[^\]]*\](\(.*\)| ?\[.*?\])/,!1))return n.linkText=!0,i.highlightFormatting&&(n.formatting="link"),h(n);if("]"===s&&n.linkText&&t.match(/\(.*?\)| ?\[.*?\]/,!1))return i.highlightFormatting&&(n.formatting="link"),f=h(n),n.linkText=!1,n.inline=n.f=m,f;if("<"===s&&t.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1))return n.f=n.inline=p,i.highlightFormatting&&(n.formatting="link"),(f=h(n))?f+=" ":f="",f+T.linkInline;if("<"===s&&t.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1))return n.f=n.inline=p,i.highlightFormatting&&(n.formatting="link"),(f=h(n))?f+=" ":f="",f+T.linkEmail;if("<"===s&&t.match(/^(!--|\w)/,!1)){var v=t.string.indexOf(">",t.pos);if(-1!=v){var y=t.string.substring(t.start,v);/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(y)&&(n.md_inside=!0)}return t.backUp(1),n.htmlState=e.startState(b),function(e,t,i){return t.f=t.block=i,i(e,t)}(t,n,l)}if("<"===s&&t.match(/^\/\w*?>/))return n.md_inside=!1,"tag";var _=!1;if(!i.underscoresBreakWords&&"_"===s&&"_"!==t.peek()&&t.match(/(\w)/,!1)){var S=t.pos-2;if(S>=0){var k=t.string.charAt(S);"_"!==k&&k.match(/(\w)/,!1)&&(_=!0)}}if("*"===s||"_"===s&&!_)if(a&&" "===t.peek());else{if(n.strong===s&&t.eat(s))return i.highlightFormatting&&(n.formatting="strong"),d=h(n),n.strong=!1,d;if(!n.strong&&t.eat(s))return n.strong=s,i.highlightFormatting&&(n.formatting="strong"),h(n);if(n.em===s)return i.highlightFormatting&&(n.formatting="em"),d=h(n),n.em=!1,d;if(!n.em)return n.em=s,i.highlightFormatting&&(n.formatting="em"),h(n)}else if(" "===s&&(t.eat("*")||t.eat("_"))){if(" "===t.peek())return h(n);t.backUp(1)}if(i.strikethrough)if("~"===s&&t.eatWhile(s)){if(n.strikethrough)return i.highlightFormatting&&(n.formatting="strikethrough"),d=h(n),n.strikethrough=!1,d;if(t.match(/^[^\s]/,!1))return n.strikethrough=!0,i.highlightFormatting&&(n.formatting="strikethrough"),h(n)}else if(" "===s&&t.match(/^~~/,!0)){if(" "===t.peek())return h(n);t.backUp(2)}return" "===s&&(t.match(/ +$/,!1)?n.trailingSpace++:n.trailingSpace&&(n.trailingSpaceNewLine=!0)),h(n)}function p(e,t){if(">"===e.next()){t.f=t.inline=f,i.highlightFormatting&&(t.formatting="link");var n=h(t);return n?n+=" ":n="",n+T.linkInline}return e.match(/^[^>]+/,!0),T.linkInline}function m(e,t){if(e.eatSpace())return null;var n=e.next();return"("===n||"["===n?(t.f=t.inline=function(e){return function(t,n){if(t.next()===e){n.f=n.inline=f,i.highlightFormatting&&(n.formatting="link-string");var r=h(n);return n.linkHref=!1,r}return t.match(O[e]),n.linkHref=!0,h(n)}}("("===n?")":"]"),i.highlightFormatting&&(t.formatting="link-string"),t.linkHref=!0,h(t)):"error"}function g(e,t){return e.match(/^([^\]\\]|\\.)*\]:/,!1)?(t.f=v,e.next(),i.highlightFormatting&&(t.formatting="link"),t.linkText=!0,h(t)):r(e,t,f)}function v(e,t){if(e.match(/^\]:/,!0)){t.f=t.inline=y,i.highlightFormatting&&(t.formatting="link");var n=h(t);return t.linkText=!1,n}return e.match(/^([^\]\\]|\\.)+/,!0),T.linkText}function y(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),void 0===e.peek()?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=f,T.linkHref+" url")}var b=e.getMode(t,"text/html"),_="null"==b.name;void 0===i.highlightFormatting&&(i.highlightFormatting=!1),void 0===i.maxBlockquoteDepth&&(i.maxBlockquoteDepth=0),void 0===i.underscoresBreakWords&&(i.underscoresBreakWords=!0),void 0===i.taskLists&&(i.taskLists=!1),void 0===i.strikethrough&&(i.strikethrough=!1),void 0===i.tokenTypeOverrides&&(i.tokenTypeOverrides={});var T={header:"header",code:"comment",quote:"quote",list1:"variable-2",list2:"variable-3",list3:"keyword",hr:"hr",image:"tag",formatting:"formatting",linkInline:"link",linkEmail:"link",linkText:"link",linkHref:"string",em:"em",strong:"strong",strikethrough:"strikethrough"};for(var S in T)T.hasOwnProperty(S)&&i.tokenTypeOverrides[S]&&(T[S]=i.tokenTypeOverrides[S]);var k=/^([*\-_])(?:\s*\1){2,}\s*$/,w=/^[*\-+]\s+/,C=/^[0-9]+([.)])\s+/,x=/^\[(x| )\](?=\s)/,E=i.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,L=/^ *(?:\={1,}|-{1,})\s*$/,A=/^[^#!\[\]*_\\<>` "'(~]+/,P=new RegExp("^("+(!0===i.fencedCodeBlocks?"~~~+|```+":i.fencedCodeBlocks)+")[ \\t]*([\\w+#-]*)"),O={")":/^(?:[^\\\(\)]|\\.|\((?:[^\\\(\)]|\\.)*\))*?(?=\))/,"]":/^(?:[^\\\[\]]|\\.|\[(?:[^\\\[\\]]|\\.)*\])*?(?=\])/},I={startState:function(){return{f:o,prevLine:null,thisLine:null,block:o,htmlState:null,indentation:0,inline:f,text:d,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,code:0,em:!1,strong:!1,header:0,hr:!1,taskList:!1,list:!1,listStack:[],quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,fencedChars:null}},copyState:function(t){return{f:t.f,prevLine:t.prevLine,thisLine:t.thisLine,block:t.block,htmlState:t.htmlState&&e.copyState(b,t.htmlState),indentation:t.indentation,localMode:t.localMode,localState:t.localMode?e.copyState(t.localMode,t.localState):null,inline:t.inline,text:t.text,formatting:!1,linkTitle:t.linkTitle,code:t.code,em:t.em,strong:t.strong,strikethrough:t.strikethrough,header:t.header,hr:t.hr,taskList:t.taskList,list:t.list,listStack:t.listStack.slice(0),quote:t.quote,indentedCode:t.indentedCode,trailingSpace:t.trailingSpace,trailingSpaceNewLine:t.trailingSpaceNewLine,md_inside:t.md_inside,fencedChars:t.fencedChars}},token:function(e,t){if(t.formatting=!1,e!=t.thisLine){var i=t.header||t.hr;if(t.header=0,t.hr=!1,e.match(/^\s*$/,!0)||i){if(s(t),!i)return null;t.prevLine=null}t.prevLine=t.thisLine,t.thisLine=e,t.taskList=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.f=t.block;var n=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length;if(t.indentationDiff=Math.min(n-t.indentation,4),t.indentation=t.indentation+t.indentationDiff,n>0)return null}return t.f(e,t)},innerMode:function(e){return e.block==l?{state:e.htmlState,mode:b}:e.localState?{state:e.localState,mode:e.localMode}:{state:e,mode:I}},blankLine:s,getType:h,fold:"markdown"};return I},"xml"),e.defineMIME("text/x-markdown","markdown")},"object"==typeof i&&"object"==typeof t?n(e("../../lib/codemirror"),e("../xml/xml"),e("../meta")):n(CodeMirror)},{"../../lib/codemirror":10,"../meta":13,"../xml/xml":14}],13:[function(e,t,i){!function(e){"use strict";e.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["pgp"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mime:"text/x-coffeescript",mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"]},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Jade",mime:"text/x-jade",mode:"jade",ext:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"null",mode:"jinja2"},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mime:"text/n-triples",mode:"ntriples",ext:["nt"]},{name:"Objective C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mime:"application/x-httpd-php",mode:"php",ext:["php","php3","php4","php5","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mime:"text/x-sh",mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mime:"text/x-yaml",mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var t=0;t<e.modeInfo.length;t++){var i=e.modeInfo[t];i.mimes&&(i.mime=i.mimes[0])}e.findModeByMIME=function(t){t=t.toLowerCase();for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.mime==t)return n;if(n.mimes)for(var r=0;r<n.mimes.length;r++)if(n.mimes[r]==t)return n}},e.findModeByExtension=function(t){for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.ext)for(var r=0;r<n.ext.length;r++)if(n.ext[r]==t)return n}},e.findModeByFileName=function(t){for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.file&&n.file.test(t))return n}var r=t.lastIndexOf("."),a=r>-1&&t.substring(r+1,t.length);return a?e.findModeByExtension(a):void 0},e.findModeByName=function(t){t=t.toLowerCase();for(var i=0;i<e.modeInfo.length;i++){var n=e.modeInfo[i];if(n.name.toLowerCase()==t)return n;if(n.alias)for(var r=0;r<n.alias.length;r++)if(n.alias[r].toLowerCase()==t)return n}}}("object"==typeof i&&"object"==typeof t?e("../lib/codemirror"):CodeMirror)},{"../lib/codemirror":10}],14:[function(e,t,i){!function(e){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},i={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1};e.defineMode("xml",function(n,r){function a(e,t){function i(i){return t.tokenize=i,i(e,t)}var n=e.next();return"<"==n?e.eat("!")?e.eat("[")?e.match("CDATA[")?i(o("atom","]]>")):null:e.match("--")?i(o("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),i(function e(t){return function(i,n){for(var r;null!=(r=i.next());){if("<"==r)return n.tokenize=e(t+1),n.tokenize(i,n);if(">"==r){if(1==t){n.tokenize=a;break}return n.tokenize=e(t-1),n.tokenize(i,n)}}return"meta"}}(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=o("meta","?>"),"meta"):(_=e.eat("/")?"closeTag":"openTag",t.tokenize=s,"tag bracket"):"&"==n?(e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"))?"atom":"error":(e.eatWhile(/[^&<]/),null)}function s(e,t){var i=e.next();if(">"==i||"/"==i&&e.eat(">"))return t.tokenize=a,_=">"==i?"endTag":"selfcloseTag","tag bracket";if("="==i)return _="equals",null;if("<"==i){t.tokenize=a,t.state=h,t.tagName=t.tagStart=null;var n=t.tokenize(e,t);return n?n+" tag error":"tag error"}return/[\'\"]/.test(i)?(t.tokenize=function(e){var t=function(t,i){for(;!t.eol();)if(t.next()==e){i.tokenize=s;break}return"string"};return t.isInAttribute=!0,t}(i),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function o(e,t){return function(i,n){for(;!i.eol();){if(i.match(t)){n.tokenize=a;break}i.next()}return e}}function l(e,t,i){this.prev=e.context,this.tagName=t,this.indent=e.indented,this.startOfLine=i,(k.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function u(e){e.context&&(e.context=e.context.prev)}function c(e,t){for(var i;;){if(!e.context)return;if(!k.contextGrabbers.hasOwnProperty(i=e.context.tagName)||!k.contextGrabbers[i].hasOwnProperty(t))return;u(e)}}function h(e,t,i){return"openTag"==e?(i.tagStart=t.column(),d):"closeTag"==e?f:h}function d(e,t,i){return"word"==e?(i.tagName=t.current(),T="tag",g):(T="error",d)}function f(e,t,i){if("word"==e){var n=t.current();return i.context&&i.context.tagName!=n&&k.implicitlyClosed.hasOwnProperty(i.context.tagName)&&u(i),i.context&&i.context.tagName==n||!1===k.matchClosing?(T="tag",p):(T="tag error",m)}return T="error",m}function p(e,t,i){return"endTag"!=e?(T="error",p):(u(i),h)}function m(e,t,i){return T="error",p(e,0,i)}function g(e,t,i){if("word"==e)return T="attribute",v;if("endTag"==e||"selfcloseTag"==e){var n=i.tagName,r=i.tagStart;return i.tagName=i.tagStart=null,"selfcloseTag"==e||k.autoSelfClosers.hasOwnProperty(n)?c(i,n):(c(i,n),i.context=new l(i,n,r==i.indented)),h}return T="error",g}function v(e,t,i){return"equals"==e?y:(k.allowMissing||(T="error"),g(e,0,i))}function y(e,t,i){return"string"==e?b:"word"==e&&k.allowUnquoted?(T="string",g):(T="error",g(e,0,i))}function b(e,t,i){return"string"==e?b:g(e,0,i)}var _,T,S=n.indentUnit,k={},w=r.htmlMode?t:i;for(var C in w)k[C]=w[C];for(var C in r)k[C]=r[C];return a.isInText=!0,{startState:function(e){var t={tokenize:a,state:h,indented:e||0,tagName:null,tagStart:null,context:null};return null!=e&&(t.baseIndent=e),t},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;_=null;var i=t.tokenize(e,t);return(i||_)&&"comment"!=i&&(T=null,t.state=t.state(_||i,e,t),T&&(i="error"==T?i+" error":T)),i},indent:function(t,i,n){var r=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+S;if(r&&r.noIndent)return e.Pass;if(t.tokenize!=s&&t.tokenize!=a)return n?n.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==k.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+S*(k.multilineTagIndentFactor||1);if(k.alignCDATA&&/<!\[CDATA\[/.test(i))return 0;var o=i&&/^<(\/)?([\w_:\.-]*)/.exec(i);if(o&&o[1])for(;r;){if(r.tagName==o[2]){r=r.prev;break}if(!k.implicitlyClosed.hasOwnProperty(r.tagName))break;r=r.prev}else if(o)for(;r;){var l=k.contextGrabbers[r.tagName];if(!l||!l.hasOwnProperty(o[2]))break;r=r.prev}for(;r&&r.prev&&!r.startOfLine;)r=r.prev;return r?r.indent+S:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:k.htmlMode?"html":"xml",helperType:k.htmlMode?"html":"xml",skipAttribute:function(e){e.state==y&&(e.state=g)}}}),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}("object"==typeof i&&"object"==typeof t?e("../../lib/codemirror"):CodeMirror)},{"../../lib/codemirror":10}],15:[function(e,t,i){i.read=function(e,t,i,n,r){var a,s,o=8*r-n-1,l=(1<<o)-1,u=l>>1,c=-7,h=i?r-1:0,d=i?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-c)-1,f>>=-c,c+=o;c>0;a=256*a+e[t+h],h+=d,c-=8);for(s=a&(1<<-c)-1,a>>=-c,c+=n;c>0;s=256*s+e[t+h],h+=d,c-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),a-=u}return(f?-1:1)*s*Math.pow(2,a-n)},i.write=function(e,t,i,n,r,a){var s,o,l,u=8*a-r-1,c=(1<<u)-1,h=c>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:a-1,p=n?1:-1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(o=0,s=c):s+h>=1?(o=(t*l-1)*Math.pow(2,r),s+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;e[i+f]=255&o,f+=p,o/=256,r-=8);for(s=s<<r|o,u+=r;u>0;e[i+f]=255&s,f+=p,s/=256,u-=8);e[i+f-p]|=128*m}},{}],16:[function(e,t,i){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],17:[function(e,t,i){(function(e){(function(){function e(e){this.tokens=[],this.tokens.links={},this.options=e||c.defaults,this.rules=h.normal,this.options.gfm&&(this.rules=this.options.tables?h.tables:h.gfm)}function n(e,t){if(this.options=t||c.defaults,this.links=e,this.rules=d.normal,this.renderer=this.options.renderer||new r,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.rules=this.options.breaks?d.breaks:d.gfm:this.options.pedantic&&(this.rules=d.pedantic)}function r(e){this.options=e||{}}function a(e){this.tokens=[],this.token=null,this.options=e||c.defaults,this.options.renderer=this.options.renderer||new r,this.renderer=this.options.renderer,this.renderer.options=this.options}function s(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function o(e,t){return e=e.source,t=t||"",function i(n,r){return n?(r=(r=r.source||r).replace(/(^|[^\[])\^/g,"$1"),e=e.replace(n,r),i):new RegExp(e,t)}}function l(){}function u(e){for(var t,i,n=1;n<arguments.length;n++)for(i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}function c(t,i,n){if(n||"function"==typeof i){n||(n=i,i=null);var r,o,h=(i=u({},c.defaults,i||{})).highlight,d=0;try{r=e.lex(t,i)}catch(l){return n(l)}o=r.length;var f=function(e){if(e)return i.highlight=h,n(e);var t;try{t=a.parse(r,i)}catch(o){e=o}return i.highlight=h,e?n(e):n(null,t)};if(!h||h.length<3)return f();if(delete i.highlight,!o)return f();for(;d<r.length;d++)!function(e){"code"!==e.type?--o||f():h(e.text,e.lang,function(t,i){return t?f(t):null==i||i===e.text?--o||f():(e.text=i,e.escaped=!0,void(--o||f()))})}(r[d])}else try{return i&&(i=u({},c.defaults,i)),a.parse(e.lex(t,i),i)}catch(l){if(l.message+="\nPlease report this to https://github.com/chjj/marked.",(i||c.defaults).silent)return"<p>An error occured:</p><pre>"+s(l.message+"",!0)+"</pre>";throw l}}var h={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:l,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:l,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:l,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/,bullet:/(?:[*+-]|\d+\.)/,item:/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/};h.item=o(h.item,"gm")(/bull/g,h.bullet)(),h.list=o(h.list)(/bull/g,h.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+h.def.source+")")(),h.blockquote=o(h.blockquote)("def",h.def)(),h._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",h.html=o(h.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,h._tag)(),h.paragraph=o(h.paragraph)("hr",h.hr)("heading",h.heading)("lheading",h.lheading)("blockquote",h.blockquote)("tag","<"+h._tag)("def",h.def)(),h.normal=u({},h),h.gfm=u({},h.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\s*\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),h.gfm.paragraph=o(h.paragraph)("(?!","(?!"+h.gfm.fences.source.replace("\\1","\\2")+"|"+h.list.source.replace("\\1","\\3")+"|")(),h.tables=u({},h.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),e.rules=h,e.lex=function(t,i){return new e(i).lex(t)},e.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},e.prototype.token=function(e,t,i){var n,r,a,s,o,l,u,c,d;for(e=e.replace(/^ +$/gm,"");e;)if((a=this.rules.newline.exec(e))&&(e=e.substring(a[0].length),a[0].length>1&&this.tokens.push({type:"space"})),a=this.rules.code.exec(e))e=e.substring(a[0].length),a=a[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?a:a.replace(/\n+$/,"")});else if(a=this.rules.fences.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"code",lang:a[2],text:a[3]||""});else if(a=this.rules.heading.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"heading",depth:a[1].length,text:a[2]});else if(t&&(a=this.rules.nptable.exec(e))){for(e=e.substring(a[0].length),l={type:"table",header:a[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3].replace(/\n$/,"").split("\n")},c=0;c<l.align.length;c++)l.align[c]=/^ *-+: *$/.test(l.align[c])?"right":/^ *:-+: *$/.test(l.align[c])?"center":/^ *:-+ *$/.test(l.align[c])?"left":null;for(c=0;c<l.cells.length;c++)l.cells[c]=l.cells[c].split(/ *\| */);this.tokens.push(l)}else if(a=this.rules.lheading.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"heading",depth:"="===a[2]?1:2,text:a[1]});else if(a=this.rules.hr.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"hr"});else if(a=this.rules.blockquote.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"blockquote_start"}),a=a[0].replace(/^ *> ?/gm,""),this.token(a,t,!0),this.tokens.push({type:"blockquote_end"});else if(a=this.rules.list.exec(e)){for(e=e.substring(a[0].length),this.tokens.push({type:"list_start",ordered:(s=a[2]).length>1}),n=!1,d=(a=a[0].match(this.rules.item)).length,c=0;d>c;c++)u=(l=a[c]).length,~(l=l.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(u-=l.length,l=l.replace(this.options.pedantic?/^ {1,4}/gm:new RegExp("^ {1,"+u+"}","gm"),"")),this.options.smartLists&&c!==d-1&&(s===(o=h.bullet.exec(a[c+1])[0])||s.length>1&&o.length>1||(e=a.slice(c+1).join("\n")+e,c=d-1)),r=n||/\n\n(?!\s*$)/.test(l),c!==d-1&&(n="\n"===l.charAt(l.length-1),r||(r=n)),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(l,!1,i),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(a=this.rules.html.exec(e))e=e.substring(a[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===a[1]||"script"===a[1]||"style"===a[1]),text:a[0]});else if(!i&&t&&(a=this.rules.def.exec(e)))e=e.substring(a[0].length),this.tokens.links[a[1].toLowerCase()]={href:a[2],title:a[3]};else if(t&&(a=this.rules.table.exec(e))){for(e=e.substring(a[0].length),l={type:"table",header:a[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:a[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:a[3].replace(/(?: *\| *)?\n$/,"").split("\n")},c=0;c<l.align.length;c++)l.align[c]=/^ *-+: *$/.test(l.align[c])?"right":/^ *:-+: *$/.test(l.align[c])?"center":/^ *:-+ *$/.test(l.align[c])?"left":null;for(c=0;c<l.cells.length;c++)l.cells[c]=l.cells[c].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(l)}else if(t&&(a=this.rules.paragraph.exec(e)))e=e.substring(a[0].length),this.tokens.push({type:"paragraph",text:"\n"===a[1].charAt(a[1].length-1)?a[1].slice(0,-1):a[1]});else if(a=this.rules.text.exec(e))e=e.substring(a[0].length),this.tokens.push({type:"text",text:a[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var d={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:l,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:[^_]|__)+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:l,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/,_inside:/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,_href:/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/};d.link=o(d.link)("inside",d._inside)("href",d._href)(),d.reflink=o(d.reflink)("inside",d._inside)(),d.normal=u({},d),d.pedantic=u({},d.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),d.gfm=u({},d.normal,{escape:o(d.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:o(d.text)("]|","~]|")("|","|https?://|")()}),d.breaks=u({},d.gfm,{br:o(d.br)("{2,}","*")(),text:o(d.gfm.text)("{2,}","*")()}),n.rules=d,n.output=function(e,t,i){return new n(t,i).output(e)},n.prototype.output=function(e){for(var t,i,n,r,a="";e;)if(r=this.rules.escape.exec(e))e=e.substring(r[0].length),a+=r[1];else if(r=this.rules.autolink.exec(e))e=e.substring(r[0].length),"@"===r[2]?(i=":"===r[1].charAt(6)?this.mangle(r[1].substring(7)):this.mangle(r[1]),n=this.mangle("mailto:")+i):n=i=s(r[1]),a+=this.renderer.link(n,null,i);else if(this.inLink||!(r=this.rules.url.exec(e))){if(r=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(r[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(r[0])&&(this.inLink=!1),e=e.substring(r[0].length),a+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):s(r[0]):r[0];else if(r=this.rules.link.exec(e))e=e.substring(r[0].length),this.inLink=!0,a+=this.outputLink(r,{href:r[2],title:r[3]}),this.inLink=!1;else if((r=this.rules.reflink.exec(e))||(r=this.rules.nolink.exec(e))){if(e=e.substring(r[0].length),t=(r[2]||r[1]).replace(/\s+/g," "),!(t=this.links[t.toLowerCase()])||!t.href){a+=r[0].charAt(0),e=r[0].substring(1)+e;continue}this.inLink=!0,a+=this.outputLink(r,t),this.inLink=!1}else if(r=this.rules.strong.exec(e))e=e.substring(r[0].length),a+=this.renderer.strong(this.output(r[2]||r[1]));else if(r=this.rules.em.exec(e))e=e.substring(r[0].length),a+=this.renderer.em(this.output(r[2]||r[1]));else if(r=this.rules.code.exec(e))e=e.substring(r[0].length),a+=this.renderer.codespan(s(r[2],!0));else if(r=this.rules.br.exec(e))e=e.substring(r[0].length),a+=this.renderer.br();else if(r=this.rules.del.exec(e))e=e.substring(r[0].length),a+=this.renderer.del(this.output(r[1]));else if(r=this.rules.text.exec(e))e=e.substring(r[0].length),a+=this.renderer.text(s(this.smartypants(r[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}else e=e.substring(r[0].length),i=s(r[1]),a+=this.renderer.link(n=i,null,i);return a},n.prototype.outputLink=function(e,t){var i=s(t.href),n=t.title?s(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(i,n,this.output(e[1])):this.renderer.image(i,n,s(e[1]))},n.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026"):e},n.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,i="",n=e.length,r=0;n>r;r++)t=e.charCodeAt(r),Math.random()>.5&&(t="x"+t.toString(16)),i+="&#"+t+";";return i},r.prototype.code=function(e,t,i){if(this.options.highlight){var n=this.options.highlight(e,t);null!=n&&n!==e&&(i=!0,e=n)}return t?'<pre><code class="'+this.options.langPrefix+s(t,!0)+'">'+(i?e:s(e,!0))+"\n</code></pre>\n":"<pre><code>"+(i?e:s(e,!0))+"\n</code></pre>"},r.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},r.prototype.html=function(e){return e},r.prototype.heading=function(e,t,i){return"<h"+t+' id="'+this.options.headerPrefix+i.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},r.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},r.prototype.list=function(e,t){var i=t?"ol":"ul";return"<"+i+">\n"+e+"</"+i+">\n"},r.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},r.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},r.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},r.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},r.prototype.tablecell=function(e,t){var i=t.header?"th":"td";return(t.align?"<"+i+' style="text-align:'+t.align+'">':"<"+i+">")+e+"</"+i+">\n"},r.prototype.strong=function(e){return"<strong>"+e+"</strong>"},r.prototype.em=function(e){return"<em>"+e+"</em>"},r.prototype.codespan=function(e){return"<code>"+e+"</code>"},r.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},r.prototype.del=function(e){return"<del>"+e+"</del>"},r.prototype.link=function(e,t,i){if(this.options.sanitize){try{var r=decodeURIComponent(function(e){return e.replace(/&([#\w]+);/g,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(n){return""}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:"))return""}var a='<a href="'+e+'"';return t&&(a+=' title="'+t+'"'),a+">"+i+"</a>"},r.prototype.image=function(e,t,i){var n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+(this.options.xhtml?"/>":">")},r.prototype.text=function(e){return e},a.parse=function(e,t,i){return new a(t,i).parse(e)},a.prototype.parse=function(e){this.inline=new n(e.links,this.options,this.renderer),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},a.prototype.next=function(){return this.token=this.tokens.pop()},a.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},a.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},a.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var e,t,i,n,r="",a="";for(i="",e=0;e<this.token.header.length;e++)i+=this.renderer.tablecell(this.inline.output(this.token.header[e]),{header:!0,align:this.token.align[e]});for(r+=this.renderer.tablerow(i),e=0;e<this.token.cells.length;e++){for(t=this.token.cells[e],i="",n=0;n<t.length;n++)i+=this.renderer.tablecell(this.inline.output(t[n]),{header:!1,align:this.token.align[n]});a+=this.renderer.tablerow(i)}return this.renderer.table(r,a);case"blockquote_start":for(a="";"blockquote_end"!==this.next().type;)a+=this.tok();return this.renderer.blockquote(a);case"list_start":a="";for(var s=this.token.ordered;"list_end"!==this.next().type;)a+=this.tok();return this.renderer.list(a,s);case"list_item_start":for(a="";"list_item_end"!==this.next().type;)a+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(a);case"loose_item_start":for(a="";"list_item_end"!==this.next().type;)a+=this.tok();return this.renderer.listitem(a);case"html":var o=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(o);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},l.exec=l,c.options=c.setOptions=function(e){return u(c.defaults,e),c},c.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new r,xhtml:!1},c.Parser=a,c.parser=a.parse,c.Renderer=r,c.Lexer=e,c.lexer=e.lex,c.InlineLexer=n,c.inlineLexer=n.output,c.parse=c,void 0!==t&&"object"==typeof i?t.exports=c:this.marked=c}).call(function(){return this||("undefined"!=typeof window?window:e)}())}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(e,t,i){(function(i,n){"use strict";var r=function(e,t,i,r){if(r=r||{},this.dictionary=null,this.rules={},this.dictionaryTable={},this.compoundRules=[],this.compoundRuleCodes={},this.replacementTable=[],this.flags=r.flags||{},e){if(this.dictionary=e,"undefined"!=typeof window&&"chrome"in window&&"extension"in window.chrome&&"getURL"in window.chrome.extension)t||(t=this._readFile(chrome.extension.getURL("lib/typo/dictionaries/"+e+"/"+e+".aff"))),i||(i=this._readFile(chrome.extension.getURL("lib/typo/dictionaries/"+e+"/"+e+".dic")));else{if(r.dictionaryPath)var a=r.dictionaryPath;else a=void 0!==n?n+"/dictionaries":"./dictionaries";t||(t=this._readFile(a+"/"+e+"/"+e+".aff")),i||(i=this._readFile(a+"/"+e+"/"+e+".dic"))}this.rules=this._parseAFF(t),this.compoundRuleCodes={};for(var s=0,o=this.compoundRules.length;o>s;s++)for(var l=this.compoundRules[s],u=0,c=l.length;c>u;u++)this.compoundRuleCodes[l[u]]=[];for(var s in"ONLYINCOMPOUND"in this.flags&&(this.compoundRuleCodes[this.flags.ONLYINCOMPOUND]=[]),this.dictionaryTable=this._parseDIC(i),this.compoundRuleCodes)0==this.compoundRuleCodes[s].length&&delete this.compoundRuleCodes[s];for(s=0,o=this.compoundRules.length;o>s;s++){var h=this.compoundRules[s],d="";for(u=0,c=h.length;c>u;u++){var f=h[u];d+=f in this.compoundRuleCodes?"("+this.compoundRuleCodes[f].join("|")+")":f}this.compoundRules[s]=new RegExp(d,"i")}}return this};r.prototype={load:function(e){for(var t in e)this[t]=e[t];return this},_readFile:function(t,n){if(n||(n="utf8"),"undefined"!=typeof XMLHttpRequest){var r=new XMLHttpRequest;return r.open("GET",t,!1),r.overrideMimeType&&r.overrideMimeType("text/plain; charset="+n),r.send(null),r.responseText}if(void 0!==e){var a=e("fs");try{if(a.existsSync(t)){var s=a.statSync(t),o=a.openSync(t,"r"),l=new i(s.size);return a.readSync(o,l,0,l.length,null),l.toString(n,0,l.length)}console.log("Path "+t+" does not exist.")}catch(u){return console.log(u),""}}},_parseAFF:function(e){for(var t={},i=(e=this._removeAffixComments(e)).split("\n"),n=0,r=i.length;r>n;n++){var a=(b=i[n]).split(/\s+/),s=a[0];if("PFX"==s||"SFX"==s){for(var o=a[1],l=a[2],u=[],c=n+1,h=n+1+(y=parseInt(a[3],10));h>c;c++){var d=(_=(b=i[c]).split(/\s+/))[2],f=_[3].split("/"),p=f[0];"0"===p&&(p="");var m=this.parseRuleCodes(f[1]),g=_[4],v={};v.add=p,m.length>0&&(v.continuationClasses=m),"."!==g&&(v.match="SFX"===s?new RegExp(g+"$"):new RegExp("^"+g)),"0"!=d&&(v.remove="SFX"===s?new RegExp(d+"$"):d),u.push(v)}t[o]={type:s,combineable:"Y"==l,entries:u},n+=y}else if("COMPOUNDRULE"===s){var y;for(c=n+1,h=n+1+(y=parseInt(a[1],10));h>c;c++){var b,_=(b=i[c]).split(/\s+/);this.compoundRules.push(_[1])}n+=y}else"REP"===s?3===(_=b.split(/\s+/)).length&&this.replacementTable.push([_[1],_[2]]):this.flags[s]=a[1]}return t},_removeAffixComments:function(e){return(e=(e=(e=e.replace(/#.*$/gm,"")).replace(/^\s\s*/m,"").replace(/\s\s*$/m,"")).replace(/\n{2,}/g,"\n")).replace(/^\s\s*/,"").replace(/\s\s*$/,"")},_parseDIC:function(e){function t(e,t){e in n&&"object"==typeof n[e]||(n[e]=[]),n[e].push(t)}for(var i=(e=this._removeDicComments(e)).split("\n"),n={},r=1,a=i.length;a>r;r++){var s=i[r].split("/",2),o=s[0];if(s.length>1){var l=this.parseRuleCodes(s[1]);"NEEDAFFIX"in this.flags&&-1!=l.indexOf(this.flags.NEEDAFFIX)||t(o,l);for(var u=0,c=l.length;c>u;u++){var h=l[u],d=this.rules[h];if(d)for(var f=this._applyRule(o,d),p=0,m=f.length;m>p;p++){var g=f[p];if(t(g,[]),d.combineable)for(var v=u+1;c>v;v++){var y=this.rules[l[v]];if(y&&y.combineable&&d.type!=y.type)for(var b=this._applyRule(g,y),_=0,T=b.length;T>_;_++)t(b[_],[])}}h in this.compoundRuleCodes&&this.compoundRuleCodes[h].push(o)}}else t(o.trim(),[])}return n},_removeDicComments:function(e){return e.replace(/^\t.*$/gm,"")},parseRuleCodes:function(e){if(!e)return[];if(!("FLAG"in this.flags))return e.split("");if("long"===this.flags.FLAG){for(var t=[],i=0,n=e.length;n>i;i+=2)t.push(e.substr(i,2));return t}return"num"===this.flags.FLAG?textCode.split(","):void 0},_applyRule:function(e,t){for(var i=t.entries,n=[],r=0,a=i.length;a>r;r++){var s=i[r];if(!s.match||e.match(s.match)){var o=e;if(s.remove&&(o=o.replace(s.remove,"")),"SFX"===t.type?o+=s.add:o=s.add+o,n.push(o),"continuationClasses"in s)for(var l=0,u=s.continuationClasses.length;u>l;l++){var c=this.rules[s.continuationClasses[l]];c&&(n=n.concat(this._applyRule(o,c)))}}}return n},check:function(e){var t=e.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(this.checkExact(t))return!0;if(t.toUpperCase()===t){var i=t[0]+t.substring(1).toLowerCase();if(this.hasFlag(i,"KEEPCASE"))return!1;if(this.checkExact(i))return!0}var n=t.toLowerCase();if(n!==t){if(this.hasFlag(n,"KEEPCASE"))return!1;if(this.checkExact(n))return!0}return!1},checkExact:function(e){var t=this.dictionaryTable[e];if(void 0===t){if("COMPOUNDMIN"in this.flags&&e.length>=this.flags.COMPOUNDMIN)for(var i=0,n=this.compoundRules.length;n>i;i++)if(e.match(this.compoundRules[i]))return!0;return!1}if("object"==typeof t){for(i=0,n=t.length;n>i;i++)if(!this.hasFlag(e,"ONLYINCOMPOUND",t[i]))return!0;return!1}},hasFlag:function(e,t,i){return!!(t in this.flags&&(void 0===i&&(i=Array.prototype.concat.apply([],this.dictionaryTable[e])),i&&-1!==i.indexOf(this.flags[t])))},alphabet:"",suggest:function(e,t){function i(e){for(var t=[],i=0,n=e.length;n>i;i++){for(var r=e[i],a=[],s=0,o=r.length+1;o>s;s++)a.push([r.substring(0,s),r.substring(s,r.length)]);var u=[];for(s=0,o=a.length;o>s;s++)(p=a[s])[1]&&u.push(p[0]+p[1].substring(1));var c=[];for(s=0,o=a.length;o>s;s++)(p=a[s])[1].length>1&&c.push(p[0]+p[1][1]+p[1][0]+p[1].substring(2));var h=[];for(s=0,o=a.length;o>s;s++)if((p=a[s])[1])for(var d=0,f=l.alphabet.length;f>d;d++)h.push(p[0]+l.alphabet[d]+p[1].substring(1));for(s=0,o=a.length;o>s;s++){var p;if((p=a[s])[1])for(d=0,f=l.alphabet.length;f>d;d++)h.push(p[0]+l.alphabet[d]+p[1])}t=(t=(t=(t=t.concat(u)).concat(c)).concat(h)).concat([])}return t}function n(e){for(var t=[],i=0;i<e.length;i++)l.check(e[i])&&t.push(e[i]);return t}if(t||(t=5),this.check(e))return[];for(var r=0,a=this.replacementTable.length;a>r;r++){var s=this.replacementTable[r];if(-1!==e.indexOf(s[0])){var o=e.replace(s[0],s[1]);if(this.check(o))return[o]}}var l=this;return l.alphabet="abcdefghijklmnopqrstuvwxyz",function(e){for(var r=i([e]),a=i(r),s=n(r).concat(n(a)),o={},u=0,c=s.length;c>u;u++)s[u]in o?o[s[u]]+=1:o[s[u]]=1;var h=[];for(var u in o)h.push([u,o[u]]);h.sort(function(e,t){return e[1]<t[1]?-1:1}).reverse();var d=[];for(u=0,c=Math.min(t,h.length);c>u;u++)l.hasFlag(h[u][0],"NOSUGGEST")||d.push(h[u][0]);return d}(e)}},void 0!==t&&(t.exports=r)}).call(this,e("buffer").Buffer,"/node_modules/typo-js")},{buffer:3,fs:2}],19:[function(e,t,i){var n=e("codemirror");n.commands.tabAndIndentMarkdownList=function(e){var t=e.listSelections();if(!1!==e.getStateAfter(t[0].head.line).list)e.execCommand("indentMore");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var i=Array(e.options.tabSize+1).join(" ");e.replaceSelection(i)}},n.commands.shiftTabAndUnindentMarkdownList=function(e){var t=e.listSelections();if(!1!==e.getStateAfter(t[0].head.line).list)e.execCommand("indentLess");else if(e.options.indentWithTabs)e.execCommand("insertTab");else{var i=Array(e.options.tabSize+1).join(" ");e.replaceSelection(i)}}},{codemirror:10}],20:[function(e,t,i){"use strict";function n(e){return W?e.replace("Ctrl","Cmd"):e.replace("Cmd","Ctrl")}function r(e,t,i){e=e||{};var n=document.createElement("a");return t=null==t||t,e.title&&t&&(n.title=s(e.title,e.action,i),W&&(n.title=n.title.replace("Ctrl","\u2318"),n.title=n.title.replace("Alt","\u2325"))),n.tabIndex=-1,n.className=e.className,n}function a(){var e=document.createElement("i");return e.className="separator",e.innerHTML="|",e}function s(e,t,i){var r,a=e;return t&&i[r=V(t)]&&(a+=" ("+n(i[r])+")"),a}function o(e,t){t=t||e.getCursor("start");var i=e.getTokenAt(t);if(!i.type)return{};for(var n,r,a=i.type.split(" "),s={},o=0;o<a.length;o++)"strong"===(n=a[o])?s.bold=!0:"variable-2"===n?(r=e.getLine(t.line),/^\s*\d+\.\s/.test(r)?s["ordered-list"]=!0:s["unordered-list"]=!0):"atom"===n?s.quote=!0:"em"===n?s.italic=!0:"quote"===n?s.quote=!0:"strikethrough"===n?s.strikethrough=!0:"comment"===n?s.code=!0:"link"===n?s.link=!0:"tag"===n?s.image=!0:n.match(/^header(\-[1-6])?$/)&&(s[n.replace("header","heading")]=!0);return s}function l(e){var t=e.codemirror;t.setOption("fullScreen",!t.getOption("fullScreen")),t.getOption("fullScreen")?($=document.body.style.overflow,document.body.style.overflow="hidden"):document.body.style.overflow=$;var i=t.getWrapperElement();/fullscreen/.test(i.previousSibling.className)?i.previousSibling.className=i.previousSibling.className.replace(/\s*fullscreen\b/,""):i.previousSibling.className+=" fullscreen";var n=e.toolbarElements.fullscreen;/active/.test(n.className)?n.className=n.className.replace(/\s*active\s*/g,""):n.className+=" active";var r=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(r.className)&&L(e)}function u(e){M(e,"bold",e.options.blockStyles.bold)}function c(e){M(e,"italic",e.options.blockStyles.italic)}function h(e){M(e,"strikethrough","~~")}function d(e){function t(e){if("object"!=typeof e)throw"fencing_line() takes a 'line' object (not a line number, or line text).  Got: "+typeof e+": "+e;return e.styles&&e.styles[2]&&-1!==e.styles[2].indexOf("formatting-code-block")}function i(e){return e.state.base.base||e.state.base}function n(e,n,r,a,s){r=r||e.getLineHandle(n),a=a||e.getTokenAt({line:n,ch:1}),s=s||!!r.text&&e.getTokenAt({line:n,ch:r.text.length-1});var o=a.type?a.type.split(" "):[];return s&&i(s).indentedCode?"indented":-1!==o.indexOf("comment")&&(i(a).fencedChars||i(s).fencedChars||t(r)?"fenced":"single")}var r,a,s,o=e.options.blockStyles.code,l=e.codemirror,u=l.getCursor("start"),c=l.getCursor("end"),h=l.getTokenAt({line:u.line,ch:u.ch||1}),d=l.getLineHandle(u.line),f=n(l,u.line,d,h);if("single"===f){var p=d.text.slice(0,u.ch).replace("`",""),m=d.text.slice(u.ch).replace("`","");l.replaceRange(p+m,{line:u.line,ch:0},{line:u.line,ch:99999999999999}),u.ch--,u!==c&&c.ch--,l.setSelection(u,c),l.focus()}else if("fenced"===f)if(u.line!==c.line||u.ch!==c.ch){for(r=u.line;r>=0&&!t(d=l.getLineHandle(r));r--);var g,v,y,b,_=i(l.getTokenAt({line:r,ch:1})).fencedChars;t(l.getLineHandle(u.line))?(g="",v=u.line):t(l.getLineHandle(u.line-1))?(g="",v=u.line-1):(g=_+"\n",v=u.line),t(l.getLineHandle(c.line))?(y="",b=c.line,0===c.ch&&(b+=1)):0!==c.ch&&t(l.getLineHandle(c.line+1))?(y="",b=c.line+1):(y=_+"\n",b=c.line+1),0===c.ch&&(b-=1),l.operation(function(){l.replaceRange(y,{line:b,ch:0},{line:b+(y?0:1),ch:0}),l.replaceRange(g,{line:v,ch:0},{line:v+(g?0:1),ch:0})}),l.setSelection({line:v+(g?1:0),ch:0},{line:b+(g?1:-1),ch:0}),l.focus()}else{var T=u.line;if(t(l.getLineHandle(u.line))&&("fenced"===n(l,u.line+1)?(r=u.line,T=u.line+1):(a=u.line,T=u.line-1)),void 0===r)for(r=T;r>=0&&!t(d=l.getLineHandle(r));r--);if(void 0===a)for(s=l.lineCount(),a=T;s>a&&!t(d=l.getLineHandle(a));a++);l.operation(function(){l.replaceRange("",{line:r,ch:0},{line:r+1,ch:0}),l.replaceRange("",{line:a-1,ch:0},{line:a,ch:0})}),l.focus()}else if("indented"===f){if(u.line!==c.line||u.ch!==c.ch)r=u.line,a=c.line,0===c.ch&&a--;else{for(r=u.line;r>=0;r--)if(!(d=l.getLineHandle(r)).text.match(/^\s*$/)&&"indented"!==n(l,r,d)){r+=1;break}for(s=l.lineCount(),a=u.line;s>a;a++)if(!(d=l.getLineHandle(a)).text.match(/^\s*$/)&&"indented"!==n(l,a,d)){a-=1;break}}var S=l.getLineHandle(a+1),k=S&&l.getTokenAt({line:a+1,ch:S.text.length-1});k&&i(k).indentedCode&&l.replaceRange("\n",{line:a+1,ch:0});for(var w=r;a>=w;w++)l.indentLine(w,"subtract");l.focus()}else u.line===c.line&&u.ch===c.ch&&0===u.ch||u.line!==c.line?function(e,t,i,n){var r=u.line+1,a=c.line+1,s=u.line!==c.line,o="\n"+n;s&&a++,s&&0===c.ch&&(o=n+"\n",a--),P(e,!1,[n+"\n",o]),e.setSelection({line:r,ch:0},{line:a,ch:0})}(l,0,0,o):P(l,!1,["`","`"])}function f(e){I(e.codemirror,"quote")}function p(e){O(e.codemirror,"smaller")}function m(e){O(e.codemirror,"bigger")}function g(e){O(e.codemirror,void 0,1)}function v(e){O(e.codemirror,void 0,2)}function y(e){O(e.codemirror,void 0,3)}function b(e){I(e.codemirror,"unordered-list")}function _(e){I(e.codemirror,"ordered-list")}function T(e){!function(e){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className))for(var t,i=e.getCursor("start"),n=e.getCursor("end"),r=i.line;r<=n.line;r++)t=(t=e.getLine(r)).replace(/^[ ]*([# ]+|\*|\-|[> ]+|[0-9]+(.|\)))[ ]*/,""),e.replaceRange(t,{line:r,ch:0},{line:r,ch:99999999999999})}(e.codemirror)}function S(e){var t=e.codemirror,i=o(t),n=e.options,r="http://";return!(n.promptURLs&&(r=prompt(n.promptTexts.link),!r))&&void P(t,i.link,n.insertTexts.link,r)}function k(e){var t=e.codemirror,i=o(t),n=e.options,r="http://";return!(n.promptURLs&&(r=prompt(n.promptTexts.image),!r))&&void P(t,i.image,n.insertTexts.image,r)}function w(e){var t=e.codemirror;P(t,o(t).table,e.options.insertTexts.table)}function C(e){var t=e.codemirror;P(t,o(t).image,e.options.insertTexts.horizontalRule)}function x(e){var t=e.codemirror;t.undo(),t.focus()}function E(e){var t=e.codemirror;t.redo(),t.focus()}function L(e){var t=e.codemirror,i=t.getWrapperElement(),n=i.nextSibling,r=e.toolbarElements["side-by-side"],a=!1;/editor-preview-active-side/.test(n.className)?(n.className=n.className.replace(/\s*editor-preview-active-side\s*/g,""),r.className=r.className.replace(/\s*active\s*/g,""),i.className=i.className.replace(/\s*CodeMirror-sided\s*/g," ")):(setTimeout(function(){t.getOption("fullScreen")||l(e),n.className+=" editor-preview-active-side"},1),r.className+=" active",i.className+=" CodeMirror-sided",a=!0);var s=i.lastChild;if(/editor-preview-active/.test(s.className)){s.className=s.className.replace(/\s*editor-preview-active\s*/g,"");var o=e.toolbarElements.preview,u=i.previousSibling;o.className=o.className.replace(/\s*active\s*/g,""),u.className=u.className.replace(/\s*disabled-for-preview*/g,"")}t.sideBySideRenderingFunction||(t.sideBySideRenderingFunction=function(){n.innerHTML=e.options.previewRender(e.value(),n)}),a?(n.innerHTML=e.options.previewRender(e.value(),n),t.on("update",t.sideBySideRenderingFunction)):t.off("update",t.sideBySideRenderingFunction),t.refresh()}function A(e){var t=e.codemirror,i=t.getWrapperElement(),n=i.previousSibling,r=!!e.options.toolbar&&e.toolbarElements.preview,a=i.lastChild;a&&/editor-preview/.test(a.className)||((a=document.createElement("div")).className="editor-preview",i.appendChild(a)),/editor-preview-active/.test(a.className)?(a.className=a.className.replace(/\s*editor-preview-active\s*/g,""),r&&(r.className=r.className.replace(/\s*active\s*/g,""),n.className=n.className.replace(/\s*disabled-for-preview*/g,""))):(setTimeout(function(){a.className+=" editor-preview-active"},1),r&&(r.className+=" active",n.className+=" disabled-for-preview")),a.innerHTML=e.options.previewRender(e.value(),a);var s=t.getWrapperElement().nextSibling;/editor-preview-active-side/.test(s.className)&&L(e)}function P(e,t,i,n){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){var r,a=i[0],s=i[1],o=e.getCursor("start"),l=e.getCursor("end");n&&(s=s.replace("#url#",n)),t?(a=(r=e.getLine(o.line)).slice(0,o.ch),s=r.slice(o.ch),e.replaceRange(a+s,{line:o.line,ch:0})):(r=e.getSelection(),e.replaceSelection(a+r+s),o.ch+=a.length,o!==l&&(l.ch+=a.length)),e.setSelection(o,l),e.focus()}}function O(e,t,i){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var n=e.getCursor("start"),r=e.getCursor("end"),a=n.line;a<=r.line;a++)!function(n){var r=e.getLine(n),a=r.search(/[^#]/);r=void 0!==t?0>=a?"bigger"==t?"###### "+r:"# "+r:6==a&&"smaller"==t?r.substr(7):1==a&&"bigger"==t?r.substr(2):"bigger"==t?r.substr(1):"#"+r:1==i?0>=a?"# "+r:a==i?r.substr(a+1):"# "+r.substr(a+1):2==i?0>=a?"## "+r:a==i?r.substr(a+1):"## "+r.substr(a+1):0>=a?"### "+r:a==i?r.substr(a+1):"### "+r.substr(a+1),e.replaceRange(r,{line:n,ch:0},{line:n,ch:99999999999999})}(a);e.focus()}}function I(e,t){if(!/editor-preview-active/.test(e.getWrapperElement().lastChild.className)){for(var i=o(e),n=e.getCursor("start"),r=e.getCursor("end"),a={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},s={quote:"> ","unordered-list":"* ","ordered-list":"1. "},l=n.line;l<=r.line;l++)!function(n){var r=e.getLine(n);r=i[t]?r.replace(a[t],"$1"):s[t]+r,e.replaceRange(r,{line:n,ch:0},{line:n,ch:99999999999999})}(l);e.focus()}}function M(e,t,i,n){if(!/editor-preview-active/.test(e.codemirror.getWrapperElement().lastChild.className)){n=void 0===n?i:n;var r,a=e.codemirror,s=o(a),l=i,u=n,c=a.getCursor("start"),h=a.getCursor("end");s[t]?(l=(r=a.getLine(c.line)).slice(0,c.ch),u=r.slice(c.ch),"bold"==t?(l=l.replace(/(\*\*|__)(?![\s\S]*(\*\*|__))/,""),u=u.replace(/(\*\*|__)/,"")):"italic"==t?(l=l.replace(/(\*|_)(?![\s\S]*(\*|_))/,""),u=u.replace(/(\*|_)/,"")):"strikethrough"==t&&(l=l.replace(/(\*\*|~~)(?![\s\S]*(\*\*|~~))/,""),u=u.replace(/(\*\*|~~)/,"")),a.replaceRange(l+u,{line:c.line,ch:0},{line:c.line,ch:99999999999999}),"bold"==t||"strikethrough"==t?(c.ch-=2,c!==h&&(h.ch-=2)):"italic"==t&&(c.ch-=1,c!==h&&(h.ch-=1))):(r=a.getSelection(),"bold"==t?r=(r=r.split("**").join("")).split("__").join(""):"italic"==t?r=(r=r.split("*").join("")).split("_").join(""):"strikethrough"==t&&(r=r.split("~~").join("")),a.replaceSelection(l+r+u),c.ch+=i.length,h.ch=c.ch+r.length),a.setSelection(c,h),a.focus()}}function D(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]instanceof Array?t[i].concat(e[i]instanceof Array?e[i]:[]):null!==t[i]&&"object"==typeof t[i]&&t[i].constructor===Object?D(e[i]||{},t[i]):t[i]);return e}function U(e){for(var t=1;t<arguments.length;t++)e=D(e,arguments[t]);return e}function R(e){var t=e.match(/[a-zA-Z0-9_\u0392-\u03c9\u0410-\u04F9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g),i=0;if(null===t)return i;for(var n=0;n<t.length;n++)i+=t[n].charCodeAt(0)>=19968?t[n].length:1;return i}function N(e){(e=e||{}).parent=this;var t=!0;if(!1===e.autoDownloadFontAwesome&&(t=!1),!0!==e.autoDownloadFontAwesome)for(var i=document.styleSheets,n=0;n<i.length;n++)i[n].href&&i[n].href.indexOf("//maxcdn.bootstrapcdn.com/font-awesome/")>-1&&(t=!1);if(t){var r=document.createElement("link");r.rel="stylesheet",r.href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(r)}if(e.element)this.element=e.element;else if(null===e.element)return void console.log("SimpleMDE: Error. No element was found.");if(void 0===e.toolbar)for(var a in e.toolbar=[],Y)Y.hasOwnProperty(a)&&(-1!=a.indexOf("separator-")&&e.toolbar.push("|"),(!0===Y[a].default||e.showIcons&&e.showIcons.constructor===Array&&-1!=e.showIcons.indexOf(a))&&e.toolbar.push(a));e.hasOwnProperty("status")||(e.status=["autosave","lines","words","cursor"]),e.previewRender||(e.previewRender=function(e){return this.parent.markdown(e)}),e.parsingConfig=U({highlightFormatting:!0},e.parsingConfig||{}),e.insertTexts=U({},X,e.insertTexts||{}),e.promptTexts=K,e.blockStyles=U({},Q,e.blockStyles||{}),e.shortcuts=U({},q,e.shortcuts||{}),null!=e.autosave&&null!=e.autosave.unique_id&&""!=e.autosave.unique_id&&(e.autosave.uniqueId=e.autosave.unique_id),this.options=e,this.render(),!e.initialValue||this.options.autosave&&!0===this.options.autosave.foundSavedValue||this.value(e.initialValue)}function B(){if("object"!=typeof localStorage)return!1;try{localStorage.setItem("smde_localStorage",1),localStorage.removeItem("smde_localStorage")}catch(e){return!1}return!0}var j=e("codemirror");e("codemirror/addon/edit/continuelist.js"),e("./codemirror/tablist"),e("codemirror/addon/display/fullscreen.js"),e("codemirror/mode/markdown/markdown.js"),e("codemirror/addon/mode/overlay.js"),e("codemirror/addon/display/placeholder.js"),e("codemirror/addon/selection/mark-selection.js"),e("codemirror/mode/gfm/gfm.js"),e("codemirror/mode/xml/xml.js");var F=e("codemirror-spell-checker"),H=e("marked"),W=/Mac/.test(navigator.platform),z={toggleBold:u,toggleItalic:c,drawLink:S,toggleHeadingSmaller:p,toggleHeadingBigger:m,drawImage:k,toggleBlockquote:f,toggleOrderedList:_,toggleUnorderedList:b,toggleCodeBlock:d,togglePreview:A,toggleStrikethrough:h,toggleHeading1:g,toggleHeading2:v,toggleHeading3:y,cleanBlock:T,drawTable:w,drawHorizontalRule:C,undo:x,redo:E,toggleSideBySide:L,toggleFullScreen:l},q={toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeadingSmaller:"Cmd-H",toggleHeadingBigger:"Shift-Cmd-H",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleBlockquote:"Cmd-'",toggleOrderedList:"Cmd-Alt-L",toggleUnorderedList:"Cmd-L",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11"},V=function(e){for(var t in z)if(z[t]===e)return t;return null},G=function(){var e,t=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0),t},$="",Y={bold:{name:"bold",action:u,className:"fa fa-bold",title:"Bold",default:!0},italic:{name:"italic",action:c,className:"fa fa-italic",title:"Italic",default:!0},strikethrough:{name:"strikethrough",action:h,className:"fa fa-strikethrough",title:"Strikethrough"},heading:{name:"heading",action:p,className:"fa fa-header",title:"Heading",default:!0},"heading-smaller":{name:"heading-smaller",action:p,className:"fa fa-header fa-header-x fa-header-smaller",title:"Smaller Heading"},"heading-bigger":{name:"heading-bigger",action:m,className:"fa fa-header fa-header-x fa-header-bigger",title:"Bigger Heading"},"heading-1":{name:"heading-1",action:g,className:"fa fa-header fa-header-x fa-header-1",title:"Big Heading"},"heading-2":{name:"heading-2",action:v,className:"fa fa-header fa-header-x fa-header-2",title:"Medium Heading"},"heading-3":{name:"heading-3",action:y,className:"fa fa-header fa-header-x fa-header-3",title:"Small Heading"},"separator-1":{name:"separator-1"},code:{name:"code",action:d,className:"fa fa-code",title:"Code"},quote:{name:"quote",action:f,className:"fa fa-quote-left",title:"Quote",default:!0},"unordered-list":{name:"unordered-list",action:b,className:"fa fa-list-ul",title:"Generic List",default:!0},"ordered-list":{name:"ordered-list",action:_,className:"fa fa-list-ol",title:"Numbered List",default:!0},"clean-block":{name:"clean-block",action:T,className:"fa fa-eraser fa-clean-block",title:"Clean block"},"separator-2":{name:"separator-2"},link:{name:"link",action:S,className:"fa fa-link",title:"Create Link",default:!0},image:{name:"image",action:k,className:"fa fa-picture-o",title:"Insert Image",default:!0},table:{name:"table",action:w,className:"fa fa-table",title:"Insert Table"},"horizontal-rule":{name:"horizontal-rule",action:C,className:"fa fa-minus",title:"Insert Horizontal Line"},"separator-3":{name:"separator-3"},preview:{name:"preview",action:A,className:"fa fa-eye no-disable",title:"Toggle Preview",default:!0},"side-by-side":{name:"side-by-side",action:L,className:"fa fa-columns no-disable no-mobile",title:"Toggle Side by Side",default:!0},fullscreen:{name:"fullscreen",action:l,className:"fa fa-arrows-alt no-disable no-mobile",title:"Toggle Fullscreen",default:!0},"separator-4":{name:"separator-4"},guide:{name:"guide",action:"https://simplemde.com/markdown-guide",className:"fa fa-question-circle",title:"Markdown Guide",default:!0},"separator-5":{name:"separator-5"},undo:{name:"undo",action:x,className:"fa fa-undo no-disable",title:"Undo"},redo:{name:"redo",action:E,className:"fa fa-repeat no-disable",title:"Redo"}},X={link:["[","](#url#)"],image:["![](","#url#)"],table:["","\n\n| Column 1 | Column 2 | Column 3 |\n| -------- | -------- | -------- |\n| Text     | Text     | Text     |\n\n"],horizontalRule:["","\n\n-----\n\n"]},K={link:"URL for the link:",image:"URL of the image:"},Q={bold:"**",code:"```",italic:"*"};N.prototype.markdown=function(e){if(H){var t={};return t.breaks=!this.options||!this.options.renderingConfig||!1!==this.options.renderingConfig.singleLineBreaks,this.options&&this.options.renderingConfig&&!0===this.options.renderingConfig.codeSyntaxHighlighting&&window.hljs&&(t.highlight=function(e){return window.hljs.highlightAuto(e).value}),H.setOptions(t),H(e)}},N.prototype.render=function(e){if(e||(e=this.element||document.getElementsByTagName("textarea")[0]),!this._rendered||this._rendered!==e){this.element=e;var t,i,r=this.options,a=this,s={};for(var o in r.shortcuts)null!==r.shortcuts[o]&&null!==z[o]&&function(e){s[n(r.shortcuts[e])]=function(){z[e](a)}}(o);if(s.Enter="newlineAndIndentContinueMarkdownList",s.Tab="tabAndIndentMarkdownList",s["Shift-Tab"]="shiftTabAndUnindentMarkdownList",s.Esc=function(e){e.getOption("fullScreen")&&l(a)},document.addEventListener("keydown",function(e){27==(e=e||window.event).keyCode&&a.codemirror.getOption("fullScreen")&&l(a)},!1),!1!==r.spellChecker?(t="spell-checker",(i=r.parsingConfig).name="gfm",i.gitHubSpice=!1,F({codeMirrorInstance:j})):((t=r.parsingConfig).name="gfm",t.gitHubSpice=!1),this.codemirror=j.fromTextArea(e,{mode:t,backdrop:i,theme:"paper",tabSize:null!=r.tabSize?r.tabSize:2,indentUnit:null!=r.tabSize?r.tabSize:2,indentWithTabs:!1!==r.indentWithTabs,lineNumbers:!1,autofocus:!0===r.autofocus,extraKeys:s,lineWrapping:!1!==r.lineWrapping,allowDropFileTypes:["text/plain"],placeholder:r.placeholder||e.getAttribute("placeholder")||"",styleSelectedText:null==r.styleSelectedText||r.styleSelectedText}),!0===r.forceSync){var u=this.codemirror;u.on("change",function(){u.save()})}this.gui={},!1!==r.toolbar&&(this.gui.toolbar=this.createToolbar()),!1!==r.status&&(this.gui.statusbar=this.createStatusbar()),null!=r.autosave&&!0===r.autosave.enabled&&this.autosave(),this.gui.sideBySide=this.createSideBySide(),this._rendered=this.element;var c=this.codemirror;setTimeout((function(){c.refresh()}).bind(c),0)}},N.prototype.autosave=function(){if(B()){var e=this;if(null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("SimpleMDE: You must set a uniqueId to use the autosave feature");null!=e.element.form&&null!=e.element.form&&e.element.form.addEventListener("submit",function(){localStorage.removeItem("smde_"+e.options.autosave.uniqueId)}),!0!==this.options.autosave.loaded&&("string"==typeof localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&""!=localStorage.getItem("smde_"+this.options.autosave.uniqueId)&&(this.codemirror.setValue(localStorage.getItem("smde_"+this.options.autosave.uniqueId)),this.options.autosave.foundSavedValue=!0),this.options.autosave.loaded=!0),localStorage.setItem("smde_"+this.options.autosave.uniqueId,e.value());var t=document.getElementById("autosaved");if(null!=t&&null!=t&&""!=t){var i=new Date,n=i.getHours(),r=i.getMinutes(),a="am",s=n;s>=12&&(s=n-12,a="pm"),0==s&&(s=12),t.innerHTML="Autosaved: "+s+":"+(r=10>r?"0"+r:r)+" "+a}this.autosaveTimeoutId=setTimeout(function(){e.autosave()},this.options.autosave.delay||1e4)}else console.log("SimpleMDE: localStorage not available, cannot autosave")},N.prototype.clearAutosavedValue=function(){if(B()){if(null==this.options.autosave||null==this.options.autosave.uniqueId||""==this.options.autosave.uniqueId)return void console.log("SimpleMDE: You must set a uniqueId to clear the autosave value");localStorage.removeItem("smde_"+this.options.autosave.uniqueId)}else console.log("SimpleMDE: localStorage not available, cannot autosave")},N.prototype.createSideBySide=function(){var e=this.codemirror,t=e.getWrapperElement(),i=t.nextSibling;i&&/editor-preview-side/.test(i.className)||((i=document.createElement("div")).className="editor-preview-side",t.parentNode.insertBefore(i,t.nextSibling));var n=!1,r=!1;return e.on("scroll",function(e){if(n)n=!1;else{r=!0;var t=e.getScrollInfo().height-e.getScrollInfo().clientHeight,a=parseFloat(e.getScrollInfo().top)/t;i.scrollTop=(i.scrollHeight-i.clientHeight)*a}}),i.onscroll=function(){if(r)r=!1;else{n=!0;var t=i.scrollHeight-i.clientHeight,a=parseFloat(i.scrollTop)/t,s=(e.getScrollInfo().height-e.getScrollInfo().clientHeight)*a;e.scrollTo(0,s)}},i},N.prototype.createToolbar=function(e){if((e=e||this.options.toolbar)&&0!==e.length){var t;for(t=0;t<e.length;t++)null!=Y[e[t]]&&(e[t]=Y[e[t]]);var i=document.createElement("div");i.className="editor-toolbar";var n=this,s={};for(n.toolbar=e,t=0;t<e.length;t++)if(("guide"!=e[t].name||!1!==n.options.toolbarGuideIcon)&&!(n.options.hideIcons&&-1!=n.options.hideIcons.indexOf(e[t].name)||("fullscreen"==e[t].name||"side-by-side"==e[t].name)&&G())){if("|"===e[t]){for(var l=!1,u=t+1;u<e.length;u++)"|"===e[u]||n.options.hideIcons&&-1!=n.options.hideIcons.indexOf(e[u].name)||(l=!0);if(!l)continue}!function(e){var t;t="|"===e?a():r(e,n.options.toolbarTips,n.options.shortcuts),e.action&&("function"==typeof e.action?t.onclick=function(t){t.preventDefault(),e.action(n)}:"string"==typeof e.action&&(t.href=e.action,t.target="_blank")),s[e.name||e]=t,i.appendChild(t)}(e[t])}n.toolbarElements=s;var c=this.codemirror;c.on("cursorActivity",function(){var e=o(c);for(var t in s)!function(t){var i=s[t];e[t]?i.className+=" active":"fullscreen"!=t&&"side-by-side"!=t&&(i.className=i.className.replace(/\s*active\s*/g,""))}(t)});var h=c.getWrapperElement();return h.parentNode.insertBefore(i,h),i}},N.prototype.createStatusbar=function(e){var t=this.options,i=this.codemirror;if((e=e||this.options.status)&&0!==e.length){var n,r,a,s=[];for(n=0;n<e.length;n++)if(r=void 0,a=void 0,"object"==typeof e[n])s.push({className:e[n].className,defaultValue:e[n].defaultValue,onUpdate:e[n].onUpdate});else{var o=e[n];"words"===o?(a=function(e){e.innerHTML=R(i.getValue())},r=function(e){e.innerHTML=R(i.getValue())}):"lines"===o?(a=function(e){e.innerHTML=i.lineCount()},r=function(e){e.innerHTML=i.lineCount()}):"cursor"===o?(a=function(e){e.innerHTML="0:0"},r=function(e){var t=i.getCursor();e.innerHTML=t.line+":"+t.ch}):"autosave"===o&&(a=function(e){null!=t.autosave&&!0===t.autosave.enabled&&e.setAttribute("id","autosaved")}),s.push({className:o,defaultValue:a,onUpdate:r})}var l=document.createElement("div");for(l.className="editor-statusbar",n=0;n<s.length;n++){var u=s[n],c=document.createElement("span");c.className=u.className,"function"==typeof u.defaultValue&&u.defaultValue(c),"function"==typeof u.onUpdate&&this.codemirror.on("update",function(e,t){return function(){t.onUpdate(e)}}(c,u)),l.appendChild(c)}var h=this.codemirror.getWrapperElement();return h.parentNode.insertBefore(l,h.nextSibling),l}},N.prototype.value=function(e){return void 0===e?this.codemirror.getValue():(this.codemirror.getDoc().setValue(e),this)},N.toggleBold=u,N.toggleItalic=c,N.toggleStrikethrough=h,N.toggleBlockquote=f,N.toggleHeadingSmaller=p,N.toggleHeadingBigger=m,N.toggleHeading1=g,N.toggleHeading2=v,N.toggleHeading3=y,N.toggleCodeBlock=d,N.toggleUnorderedList=b,N.toggleOrderedList=_,N.cleanBlock=T,N.drawLink=S,N.drawImage=k,N.drawTable=w,N.drawHorizontalRule=C,N.undo=x,N.redo=E,N.togglePreview=A,N.toggleSideBySide=L,N.toggleFullScreen=l,N.prototype.toggleBold=function(){u(this)},N.prototype.toggleItalic=function(){c(this)},N.prototype.toggleStrikethrough=function(){h(this)},N.prototype.toggleBlockquote=function(){f(this)},N.prototype.toggleHeadingSmaller=function(){p(this)},N.prototype.toggleHeadingBigger=function(){m(this)},N.prototype.toggleHeading1=function(){g(this)},N.prototype.toggleHeading2=function(){v(this)},N.prototype.toggleHeading3=function(){y(this)},N.prototype.toggleCodeBlock=function(){d(this)},N.prototype.toggleUnorderedList=function(){b(this)},N.prototype.toggleOrderedList=function(){_(this)},N.prototype.cleanBlock=function(){T(this)},N.prototype.drawLink=function(){S(this)},N.prototype.drawImage=function(){k(this)},N.prototype.drawTable=function(){w(this)},N.prototype.drawHorizontalRule=function(){C(this)},N.prototype.undo=function(){x(this)},N.prototype.redo=function(){E(this)},N.prototype.togglePreview=function(){A(this)},N.prototype.toggleSideBySide=function(){L(this)},N.prototype.toggleFullScreen=function(){l(this)},N.prototype.isPreviewActive=function(){var e=this.codemirror.getWrapperElement();return/editor-preview-active/.test(e.lastChild.className)},N.prototype.isSideBySideActive=function(){var e=this.codemirror.getWrapperElement();return/editor-preview-active-side/.test(e.nextSibling.className)},N.prototype.isFullscreenActive=function(){return this.codemirror.getOption("fullScreen")},N.prototype.getState=function(){return o(this.codemirror)},N.prototype.toTextArea=function(){var e=this.codemirror,t=e.getWrapperElement();t.parentNode&&(this.gui.toolbar&&t.parentNode.removeChild(this.gui.toolbar),this.gui.statusbar&&t.parentNode.removeChild(this.gui.statusbar),this.gui.sideBySide&&t.parentNode.removeChild(this.gui.sideBySide)),e.toTextArea(),this.autosaveTimeoutId&&(clearTimeout(this.autosaveTimeoutId),this.autosaveTimeoutId=void 0,this.clearAutosavedValue())},t.exports=N},{"./codemirror/tablist":19,codemirror:10,"codemirror-spell-checker":4,"codemirror/addon/display/fullscreen.js":5,"codemirror/addon/display/placeholder.js":6,"codemirror/addon/edit/continuelist.js":7,"codemirror/addon/mode/overlay.js":8,"codemirror/addon/selection/mark-selection.js":9,"codemirror/mode/gfm/gfm.js":11,"codemirror/mode/markdown/markdown.js":12,"codemirror/mode/xml/xml.js":14,marked:17}]},{},[20])(20)});